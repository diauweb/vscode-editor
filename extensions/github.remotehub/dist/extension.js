var Vy=Object.defineProperty;var s=(ae,h)=>Vy(ae,"name",{value:h,configurable:!0});(()=>{var __webpack_modules__={271:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var Q=V(7185);class j extends Q.EventTarget{constructor(){super();throw new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const G=se.get(this);if(typeof G!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return G}}s(j,"AbortSignal"),Q.defineEventAttribute(j.prototype,"abort");function ie(){const F=Object.create(j.prototype);return Q.EventTarget.call(F),se.set(F,!1),F}s(ie,"createAbortSignal");function pe(F){se.get(F)===!1&&(se.set(F,!0),F.dispatchEvent({type:"abort"}))}s(pe,"abortSignal");const se=new WeakMap;Object.defineProperties(j.prototype,{aborted:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(j.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class de{constructor(){W.set(this,ie())}get signal(){return q(this)}abort(){pe(q(this))}}s(de,"AbortController");const W=new WeakMap;function q(F){const G=W.get(F);if(G==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${F===null?"null":typeof F}`);return G}s(q,"getSignal"),Object.defineProperties(de.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(de.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),h.AbortController=de,h.AbortSignal=j,h.default=de,ae.exports=de,ae.exports.AbortController=ae.exports.default=de,ae.exports.AbortSignal=j},5186:(ae,h,V)=>{var Q=V(3698),j=V(2505),ie=V(6417),pe=Function.bind,se=pe.bind(pe);function de(me,L,ue){var Ne=se(ie,null).apply(null,ue?[L,ue]:[L]);me.api={remove:Ne},me.remove=Ne,["before","error","after","wrap"].forEach(function(nt){var We=ue?[L,nt,ue]:[L,nt];me[nt]=me.api[nt]=se(j,null).apply(null,We)})}s(de,"bindApi");function W(){var me="h",L={registry:{}},ue=Q.bind(null,L,me);return de(ue,L,me),ue}s(W,"HookSingular");function q(){var me={registry:{}},L=Q.bind(null,me);return de(L,me),L}s(q,"HookCollection");var F=!1;function G(){return F||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),F=!0),q()}s(G,"Hook"),G.Singular=W.bind(),G.Collection=q.bind(),ae.exports=G,ae.exports.Hook=G,ae.exports.Singular=G.Singular,ae.exports.Collection=G.Collection},2505:ae=>{ae.exports=h;function h(V,Q,j,ie){var pe=ie;V.registry[j]||(V.registry[j]=[]),Q==="before"&&(ie=s(function(se,de){return Promise.resolve().then(pe.bind(null,de)).then(se.bind(null,de))},"hook")),Q==="after"&&(ie=s(function(se,de){var W;return Promise.resolve().then(se.bind(null,de)).then(function(q){return W=q,pe(W,de)}).then(function(){return W})},"hook")),Q==="error"&&(ie=s(function(se,de){return Promise.resolve().then(se.bind(null,de)).catch(function(W){return pe(W,de)})},"hook")),V.registry[j].push({hook:ie,orig:pe})}s(h,"addHook")},3698:ae=>{ae.exports=h;function h(V,Q,j,ie){if(typeof j!="function")throw new Error("method for before hook must be a function");return ie||(ie={}),Array.isArray(Q)?Q.reverse().reduce(function(pe,se){return h.bind(null,V,se,pe,ie)},j)():Promise.resolve().then(function(){return V.registry[Q]?V.registry[Q].reduce(function(pe,se){return se.hook.bind(null,pe,ie)},j)():j(ie)})}s(h,"register")},6417:ae=>{ae.exports=h;function h(V,Q,j){if(!!V.registry[Q]){var ie=V.registry[Q].map(function(pe){return pe.orig}).indexOf(j);ie!==-1&&V.registry[Q].splice(ie,1)}}s(h,"removeHook")},6744:(ae,h,V)=>{"use strict";const Q=V(3349),j=V(7529),ie=V(8050),pe=V(4339),se=s((de,W={})=>{let q=[];if(Array.isArray(de))for(let F of de){let G=se.create(F,W);Array.isArray(G)?q.push(...G):q.push(G)}else q=[].concat(se.create(de,W));return W&&W.expand===!0&&W.nodupes===!0&&(q=[...new Set(q)]),q},"braces");se.parse=(de,W={})=>pe(de,W),se.stringify=(de,W={})=>Q(typeof de=="string"?se.parse(de,W):de,W),se.compile=(de,W={})=>(typeof de=="string"&&(de=se.parse(de,W)),j(de,W)),se.expand=(de,W={})=>{typeof de=="string"&&(de=se.parse(de,W));let q=ie(de,W);return W.noempty===!0&&(q=q.filter(Boolean)),W.nodupes===!0&&(q=[...new Set(q)]),q},se.create=(de,W={})=>de===""||de.length<3?[de]:W.expand!==!0?se.compile(de,W):se.expand(de,W),ae.exports=se},7529:(ae,h,V)=>{"use strict";const Q=V(2664),j=V(3083),ie=s((pe,se={})=>{let de=s((W,q={})=>{let F=j.isInvalidBrace(q),G=W.invalid===!0&&se.escapeInvalid===!0,me=F===!0||G===!0,L=se.escapeInvalid===!0?"\\":"",ue="";if(W.isOpen===!0||W.isClose===!0)return L+W.value;if(W.type==="open")return me?L+W.value:"(";if(W.type==="close")return me?L+W.value:")";if(W.type==="comma")return W.prev.type==="comma"?"":me?W.value:"|";if(W.value)return W.value;if(W.nodes&&W.ranges>0){let Ne=j.reduce(W.nodes),nt=Q(...Ne,{...se,wrap:!1,toRegex:!0});if(nt.length!==0)return Ne.length>1&&nt.length>1?`(${nt})`:nt}if(W.nodes)for(let Ne of W.nodes)ue+=de(Ne,W);return ue},"walk");return de(pe)},"compile");ae.exports=ie},6611:ae=>{"use strict";ae.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},8050:(ae,h,V)=>{"use strict";const Q=V(2664),j=V(3349),ie=V(3083),pe=s((de="",W="",q=!1)=>{let F=[];if(de=[].concat(de),W=[].concat(W),!W.length)return de;if(!de.length)return q?ie.flatten(W).map(G=>`{${G}}`):W;for(let G of de)if(Array.isArray(G))for(let me of G)F.push(pe(me,W,q));else for(let me of W)q===!0&&typeof me=="string"&&(me=`{${me}}`),F.push(Array.isArray(me)?pe(G,me,q):G+me);return ie.flatten(F)},"append"),se=s((de,W={})=>{let q=W.rangeLimit===void 0?1e3:W.rangeLimit,F=s((G,me={})=>{G.queue=[];let L=me,ue=me.queue;for(;L.type!=="brace"&&L.type!=="root"&&L.parent;)L=L.parent,ue=L.queue;if(G.invalid||G.dollar){ue.push(pe(ue.pop(),j(G,W)));return}if(G.type==="brace"&&G.invalid!==!0&&G.nodes.length===2){ue.push(pe(ue.pop(),["{}"]));return}if(G.nodes&&G.ranges>0){let Ee=ie.reduce(G.nodes);if(ie.exceedsLimit(...Ee,W.step,q))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let Ce=Q(...Ee,W);Ce.length===0&&(Ce=j(G,W)),ue.push(pe(ue.pop(),Ce)),G.nodes=[];return}let Ne=ie.encloseBrace(G),nt=G.queue,We=G;for(;We.type!=="brace"&&We.type!=="root"&&We.parent;)We=We.parent,nt=We.queue;for(let Ee=0;Ee<G.nodes.length;Ee++){let Ce=G.nodes[Ee];if(Ce.type==="comma"&&G.type==="brace"){Ee===1&&nt.push(""),nt.push("");continue}if(Ce.type==="close"){ue.push(pe(ue.pop(),nt,Ne));continue}if(Ce.value&&Ce.type!=="open"){nt.push(pe(nt.pop(),Ce.value));continue}Ce.nodes&&F(Ce,G)}return nt},"walk");return ie.flatten(F(de))},"expand");ae.exports=se},4339:(ae,h,V)=>{"use strict";const Q=V(3349),{MAX_LENGTH:j,CHAR_BACKSLASH:ie,CHAR_BACKTICK:pe,CHAR_COMMA:se,CHAR_DOT:de,CHAR_LEFT_PARENTHESES:W,CHAR_RIGHT_PARENTHESES:q,CHAR_LEFT_CURLY_BRACE:F,CHAR_RIGHT_CURLY_BRACE:G,CHAR_LEFT_SQUARE_BRACKET:me,CHAR_RIGHT_SQUARE_BRACKET:L,CHAR_DOUBLE_QUOTE:ue,CHAR_SINGLE_QUOTE:Ne,CHAR_NO_BREAK_SPACE:nt,CHAR_ZERO_WIDTH_NOBREAK_SPACE:We}=V(6611),Ee=s((Ce,Se={})=>{if(typeof Ce!="string")throw new TypeError("Expected a string");let le=Se||{},$=typeof le.maxLength=="number"?Math.min(j,le.maxLength):j;if(Ce.length>$)throw new SyntaxError(`Input length (${Ce.length}), exceeds max characters (${$})`);let Te={type:"root",input:Ce,nodes:[]},ne=[Te],ce=Te,ge=Te,we=0,He=Ce.length,Ge=0,tt=0,ye,Be={};const Ke=s(()=>Ce[Ge++],"advance"),Xe=s(ze=>{if(ze.type==="text"&&ge.type==="dot"&&(ge.type="text"),ge&&ge.type==="text"&&ze.type==="text"){ge.value+=ze.value;return}return ce.nodes.push(ze),ze.parent=ce,ze.prev=ge,ge=ze,ze},"push");for(Xe({type:"bos"});Ge<He;)if(ce=ne[ne.length-1],ye=Ke(),!(ye===We||ye===nt)){if(ye===ie){Xe({type:"text",value:(Se.keepEscaping?ye:"")+Ke()});continue}if(ye===L){Xe({type:"text",value:"\\"+ye});continue}if(ye===me){we++;let ze=!0,Ze;for(;Ge<He&&(Ze=Ke());){if(ye+=Ze,Ze===me){we++;continue}if(Ze===ie){ye+=Ke();continue}if(Ze===L&&(we--,we===0))break}Xe({type:"text",value:ye});continue}if(ye===W){ce=Xe({type:"paren",nodes:[]}),ne.push(ce),Xe({type:"text",value:ye});continue}if(ye===q){if(ce.type!=="paren"){Xe({type:"text",value:ye});continue}ce=ne.pop(),Xe({type:"text",value:ye}),ce=ne[ne.length-1];continue}if(ye===ue||ye===Ne||ye===pe){let ze=ye,Ze;for(Se.keepQuotes!==!0&&(ye="");Ge<He&&(Ze=Ke());){if(Ze===ie){ye+=Ze+Ke();continue}if(Ze===ze){Se.keepQuotes===!0&&(ye+=Ze);break}ye+=Ze}Xe({type:"text",value:ye});continue}if(ye===F){tt++;let ze=ge.value&&ge.value.slice(-1)==="$"||ce.dollar===!0;ce=Xe({type:"brace",open:!0,close:!1,dollar:ze,depth:tt,commas:0,ranges:0,nodes:[]}),ne.push(ce),Xe({type:"open",value:ye});continue}if(ye===G){if(ce.type!=="brace"){Xe({type:"text",value:ye});continue}let ze="close";ce=ne.pop(),ce.close=!0,Xe({type:ze,value:ye}),tt--,ce=ne[ne.length-1];continue}if(ye===se&&tt>0){if(ce.ranges>0){ce.ranges=0;let ze=ce.nodes.shift();ce.nodes=[ze,{type:"text",value:Q(ce)}]}Xe({type:"comma",value:ye}),ce.commas++;continue}if(ye===de&&tt>0&&ce.commas===0){let ze=ce.nodes;if(tt===0||ze.length===0){Xe({type:"text",value:ye});continue}if(ge.type==="dot"){if(ce.range=[],ge.value+=ye,ge.type="range",ce.nodes.length!==3&&ce.nodes.length!==5){ce.invalid=!0,ce.ranges=0,ge.type="text";continue}ce.ranges++,ce.args=[];continue}if(ge.type==="range"){ze.pop();let Ze=ze[ze.length-1];Ze.value+=ge.value+ye,ge=Ze,ce.ranges--;continue}Xe({type:"dot",value:ye});continue}Xe({type:"text",value:ye})}do if(ce=ne.pop(),ce.type!=="root"){ce.nodes.forEach(Le=>{Le.nodes||(Le.type==="open"&&(Le.isOpen=!0),Le.type==="close"&&(Le.isClose=!0),Le.nodes||(Le.type="text"),Le.invalid=!0)});let ze=ne[ne.length-1],Ze=ze.nodes.indexOf(ce);ze.nodes.splice(Ze,1,...ce.nodes)}while(ne.length>0);return Xe({type:"eos"}),Te},"parse");ae.exports=Ee},3349:(ae,h,V)=>{"use strict";const Q=V(3083);ae.exports=(j,ie={})=>{let pe=s((se,de={})=>{let W=ie.escapeInvalid&&Q.isInvalidBrace(de),q=se.invalid===!0&&ie.escapeInvalid===!0,F="";if(se.value)return(W||q)&&Q.isOpenOrClose(se)?"\\"+se.value:se.value;if(se.value)return se.value;if(se.nodes)for(let G of se.nodes)F+=pe(G);return F},"stringify");return pe(j)}},3083:(ae,h)=>{"use strict";h.isInteger=V=>typeof V=="number"?Number.isInteger(V):typeof V=="string"&&V.trim()!==""?Number.isInteger(Number(V)):!1,h.find=(V,Q)=>V.nodes.find(j=>j.type===Q),h.exceedsLimit=(V,Q,j=1,ie)=>ie===!1||!h.isInteger(V)||!h.isInteger(Q)?!1:(Number(Q)-Number(V))/Number(j)>=ie,h.escapeNode=(V,Q=0,j)=>{let ie=V.nodes[Q];!ie||(j&&ie.type===j||ie.type==="open"||ie.type==="close")&&ie.escaped!==!0&&(ie.value="\\"+ie.value,ie.escaped=!0)},h.encloseBrace=V=>V.type!=="brace"?!1:V.commas>>0+V.ranges>>0==0?(V.invalid=!0,!0):!1,h.isInvalidBrace=V=>V.type!=="brace"?!1:V.invalid===!0||V.dollar?!0:V.commas>>0+V.ranges>>0==0||V.open!==!0||V.close!==!0?(V.invalid=!0,!0):!1,h.isOpenOrClose=V=>V.type==="open"||V.type==="close"?!0:V.open===!0||V.close===!0,h.reduce=V=>V.reduce((Q,j)=>(j.type==="text"&&Q.push(j.value),j.type==="range"&&(j.type="text"),Q),[]),h.flatten=(...V)=>{const Q=[],j=s(ie=>{for(let pe=0;pe<ie.length;pe++){let se=ie[pe];Array.isArray(se)?j(se,Q):se!==void 0&&Q.push(se)}return Q},"flat");return j(V),Q}},6724:()=>{},7185:(ae,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});const V=new WeakMap,Q=new WeakMap;function j(ce){const ge=V.get(ce);return console.assert(ge!=null,"'this' is expected an Event object, but got",ce),ge}s(j,"pd");function ie(ce){if(ce.passiveListener!=null){typeof console!="undefined"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",ce.passiveListener);return}!ce.event.cancelable||(ce.canceled=!0,typeof ce.event.preventDefault=="function"&&ce.event.preventDefault())}s(ie,"setCancelFlag");function pe(ce,ge){V.set(this,{eventTarget:ce,event:ge,eventPhase:2,currentTarget:ce,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:ge.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const we=Object.keys(ge);for(let He=0;He<we.length;++He){const Ge=we[He];Ge in this||Object.defineProperty(this,Ge,se(Ge))}}s(pe,"Event"),pe.prototype={get type(){return j(this).event.type},get target(){return j(this).eventTarget},get currentTarget(){return j(this).currentTarget},composedPath(){const ce=j(this).currentTarget;return ce==null?[]:[ce]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return j(this).eventPhase},stopPropagation(){const ce=j(this);ce.stopped=!0,typeof ce.event.stopPropagation=="function"&&ce.event.stopPropagation()},stopImmediatePropagation(){const ce=j(this);ce.stopped=!0,ce.immediateStopped=!0,typeof ce.event.stopImmediatePropagation=="function"&&ce.event.stopImmediatePropagation()},get bubbles(){return Boolean(j(this).event.bubbles)},get cancelable(){return Boolean(j(this).event.cancelable)},preventDefault(){ie(j(this))},get defaultPrevented(){return j(this).canceled},get composed(){return Boolean(j(this).event.composed)},get timeStamp(){return j(this).timeStamp},get srcElement(){return j(this).eventTarget},get cancelBubble(){return j(this).stopped},set cancelBubble(ce){if(!ce)return;const ge=j(this);ge.stopped=!0,typeof ge.event.cancelBubble=="boolean"&&(ge.event.cancelBubble=!0)},get returnValue(){return!j(this).canceled},set returnValue(ce){ce||ie(j(this))},initEvent(){}},Object.defineProperty(pe.prototype,"constructor",{value:pe,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.Event!="undefined"&&(Object.setPrototypeOf(pe.prototype,window.Event.prototype),Q.set(window.Event.prototype,pe));function se(ce){return{get(){return j(this).event[ce]},set(ge){j(this).event[ce]=ge},configurable:!0,enumerable:!0}}s(se,"defineRedirectDescriptor");function de(ce){return{value(){const ge=j(this).event;return ge[ce].apply(ge,arguments)},configurable:!0,enumerable:!0}}s(de,"defineCallDescriptor");function W(ce,ge){const we=Object.keys(ge);if(we.length===0)return ce;function He(Ge,tt){ce.call(this,Ge,tt)}s(He,"CustomEvent"),He.prototype=Object.create(ce.prototype,{constructor:{value:He,configurable:!0,writable:!0}});for(let Ge=0;Ge<we.length;++Ge){const tt=we[Ge];if(!(tt in ce.prototype)){const Be=typeof Object.getOwnPropertyDescriptor(ge,tt).value=="function";Object.defineProperty(He.prototype,tt,Be?de(tt):se(tt))}}return He}s(W,"defineWrapper");function q(ce){if(ce==null||ce===Object.prototype)return pe;let ge=Q.get(ce);return ge==null&&(ge=W(q(Object.getPrototypeOf(ce)),ce),Q.set(ce,ge)),ge}s(q,"getWrapper");function F(ce,ge){const we=q(Object.getPrototypeOf(ge));return new we(ce,ge)}s(F,"wrapEvent");function G(ce){return j(ce).immediateStopped}s(G,"isStopped");function me(ce,ge){j(ce).eventPhase=ge}s(me,"setEventPhase");function L(ce,ge){j(ce).currentTarget=ge}s(L,"setCurrentTarget");function ue(ce,ge){j(ce).passiveListener=ge}s(ue,"setPassiveListener");const Ne=new WeakMap,nt=1,We=2,Ee=3;function Ce(ce){return ce!==null&&typeof ce=="object"}s(Ce,"isObject");function Se(ce){const ge=Ne.get(ce);if(ge==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return ge}s(Se,"getListeners");function le(ce){return{get(){let we=Se(this).get(ce);for(;we!=null;){if(we.listenerType===Ee)return we.listener;we=we.next}return null},set(ge){typeof ge!="function"&&!Ce(ge)&&(ge=null);const we=Se(this);let He=null,Ge=we.get(ce);for(;Ge!=null;)Ge.listenerType===Ee?He!==null?He.next=Ge.next:Ge.next!==null?we.set(ce,Ge.next):we.delete(ce):He=Ge,Ge=Ge.next;if(ge!==null){const tt={listener:ge,listenerType:Ee,passive:!1,once:!1,next:null};He===null?we.set(ce,tt):He.next=tt}},configurable:!0,enumerable:!0}}s(le,"defineEventAttributeDescriptor");function $(ce,ge){Object.defineProperty(ce,`on${ge}`,le(ge))}s($,"defineEventAttribute");function Te(ce){function ge(){ne.call(this)}s(ge,"CustomEventTarget"),ge.prototype=Object.create(ne.prototype,{constructor:{value:ge,configurable:!0,writable:!0}});for(let we=0;we<ce.length;++we)$(ge.prototype,ce[we]);return ge}s(Te,"defineCustomEventTarget");function ne(){if(this instanceof ne){Ne.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return Te(arguments[0]);if(arguments.length>0){const ce=new Array(arguments.length);for(let ge=0;ge<arguments.length;++ge)ce[ge]=arguments[ge];return Te(ce)}throw new TypeError("Cannot call a class as a function")}s(ne,"EventTarget"),ne.prototype={addEventListener(ce,ge,we){if(ge==null)return;if(typeof ge!="function"&&!Ce(ge))throw new TypeError("'listener' should be a function or an object.");const He=Se(this),Ge=Ce(we),ye=Boolean(Ge?we.capture:we)?nt:We,Be={listener:ge,listenerType:ye,passive:Ge&&Boolean(we.passive),once:Ge&&Boolean(we.once),next:null};let Ke=He.get(ce);if(Ke===void 0){He.set(ce,Be);return}let Xe=null;for(;Ke!=null;){if(Ke.listener===ge&&Ke.listenerType===ye)return;Xe=Ke,Ke=Ke.next}Xe.next=Be},removeEventListener(ce,ge,we){if(ge==null)return;const He=Se(this),tt=(Ce(we)?Boolean(we.capture):Boolean(we))?nt:We;let ye=null,Be=He.get(ce);for(;Be!=null;){if(Be.listener===ge&&Be.listenerType===tt){ye!==null?ye.next=Be.next:Be.next!==null?He.set(ce,Be.next):He.delete(ce);return}ye=Be,Be=Be.next}},dispatchEvent(ce){if(ce==null||typeof ce.type!="string")throw new TypeError('"event.type" should be a string.');const ge=Se(this),we=ce.type;let He=ge.get(we);if(He==null)return!0;const Ge=F(this,ce);let tt=null;for(;He!=null;){if(He.once?tt!==null?tt.next=He.next:He.next!==null?ge.set(we,He.next):ge.delete(we):tt=He,ue(Ge,He.passive?He.listener:null),typeof He.listener=="function")try{He.listener.call(this,Ge)}catch(ye){typeof console!="undefined"&&typeof console.error=="function"&&console.error(ye)}else He.listenerType!==Ee&&typeof He.listener.handleEvent=="function"&&He.listener.handleEvent(Ge);if(G(Ge))break;He=He.next}return ue(Ge,null),me(Ge,0),L(Ge,null),!Ge.defaultPrevented}},Object.defineProperty(ne.prototype,"constructor",{value:ne,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.EventTarget!="undefined"&&Object.setPrototypeOf(ne.prototype,window.EventTarget.prototype),h.defineEventAttribute=$,h.EventTarget=ne,h.default=ne,ae.exports=ne,ae.exports.EventTarget=ae.exports.default=ne,ae.exports.defineEventAttribute=$},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(ae){const h=await strtok3.fromStream(ae);try{return await fromTokenizer(h)}finally{await h.close()}}s(fromStream,"fromStream");async function fromBuffer(ae){if(!(ae instanceof Uint8Array||ae instanceof ArrayBuffer||Buffer.isBuffer(ae)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof ae}\``);const h=ae instanceof Buffer?ae:Buffer.from(ae);if(!(h&&h.length>1))return;const V=strtok3.fromBuffer(h);return fromTokenizer(V)}s(fromBuffer,"fromBuffer");function _check(ae,h,V){V={offset:0,...V};for(const[Q,j]of h.entries())if(V.mask){if(j!==(V.mask[Q]&ae[Q+V.offset]))return!1}else if(j!==ae[Q+V.offset])return!1;return!0}s(_check,"_check");async function fromTokenizer(ae){try{return _fromTokenizer(ae)}catch(h){if(!(h instanceof strtok3.EndOfStreamError))throw h}}s(fromTokenizer,"fromTokenizer");async function _fromTokenizer(ae){let h=Buffer.alloc(minimumBytes);const V=12,Q=s((ie,pe)=>_check(h,ie,pe),"check"),j=s((ie,pe)=>Q(stringToBytes(ie),pe),"checkString");if(ae.fileInfo.size||(ae.fileInfo.size=Number.MAX_SAFE_INTEGER),await ae.peekBuffer(h,{length:V,mayBeLess:!0}),Q([66,77]))return{ext:"bmp",mime:"image/bmp"};if(Q([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(Q([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(Q([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(Q([37,33]))return await ae.peekBuffer(h,{length:24,mayBeLess:!0}),j("PS-Adobe-",{offset:2})&&j(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(Q([31,160])||Q([31,157]))return{ext:"Z",mime:"application/x-compress"};if(Q([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(Q([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(Q([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(Q([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(j("ID3")){await ae.ignore(6);const ie=await ae.readToken(uint32SyncSafeToken);return ae.position+ie>ae.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await ae.ignore(ie),fromTokenizer(ae))}if(j("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((h[0]===67||h[0]===70)&&Q([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(Q([71,73,70]))return{ext:"gif",mime:"image/gif"};if(j("FLIF"))return{ext:"flif",mime:"image/flif"};if(j("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(j("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(j("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(j("FORM"))return{ext:"aif",mime:"audio/aiff"};if(j("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(Q([80,75,3,4])){try{for(;ae.position+30<ae.fileInfo.size;){await ae.readBuffer(h,{length:30});const ie={compressedSize:h.readUInt32LE(18),uncompressedSize:h.readUInt32LE(22),filenameLength:h.readUInt16LE(26),extraFieldLength:h.readUInt16LE(28)};if(ie.filename=await ae.readToken(new Token.StringType(ie.filenameLength,"utf-8")),await ae.ignore(ie.extraFieldLength),ie.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(ie.filename.endsWith(".rels")||ie.filename.endsWith(".xml"))switch(ie.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(ie.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(ie.filename.startsWith("3D/")&&ie.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(ie.filename==="mimetype"&&ie.compressedSize===ie.uncompressedSize)switch(await ae.readToken(new Token.StringType(ie.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(ie.compressedSize===0){let pe=-1;for(;pe<0&&ae.position<ae.fileInfo.size;)await ae.peekBuffer(h,{mayBeLess:!0}),pe=h.indexOf("504B0304",0,"hex"),await ae.ignore(pe>=0?pe:h.length)}else await ae.ignore(ie.compressedSize)}}catch(ie){if(!(ie instanceof strtok3.EndOfStreamError))throw ie}return{ext:"zip",mime:"application/zip"}}if(j("OggS")){await ae.ignore(28);const ie=Buffer.alloc(8);return await ae.readBuffer(ie),_check(ie,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(ie,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(ie,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(ie,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(ie,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(ie,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(Q([80,75])&&(h[2]===3||h[2]===5||h[2]===7)&&(h[3]===4||h[3]===6||h[3]===8))return{ext:"zip",mime:"application/zip"};if(j("ftyp",{offset:4})&&(h[8]&96)!=0){const ie=h.toString("binary",8,12).replace("\0"," ").trim();switch(ie){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return ie.startsWith("3g")?ie.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(j("MThd"))return{ext:"mid",mime:"audio/midi"};if(j("wOFF")&&(Q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(j("wOF2")&&(Q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(Q([212,195,178,161])||Q([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(j("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(j("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(j("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(Q([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(j("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(j("%PDF")){await ae.ignore(1350);const ie=10*1024*1024,pe=Buffer.alloc(Math.min(ie,ae.fileInfo.size));return await ae.readBuffer(pe,{mayBeLess:!0}),pe.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(Q([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(Q([73,73,42,0]))return j("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:Q([28,0,254,0],{offset:8})||Q([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:Q([8,0,0,0],{offset:4})&&(Q([45,0,254,0],{offset:8})||Q([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(h=Buffer.alloc(24),await ae.peekBuffer(h),(Q([16,251,134,1],{offset:4})||Q([8,0,0,0],{offset:4}))&&Q([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(Q([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(j("MAC "))return{ext:"ape",mime:"audio/ape"};if(Q([26,69,223,163])){async function ie(){const q=await ae.peekNumber(Token.UINT8);let F=128,G=0;for(;(q&F)==0;)++G,F>>=1;const me=Buffer.alloc(G+1);return await ae.readBuffer(me),me}s(ie,"readField");async function pe(){const q=await ie(),F=await ie();F[0]^=128>>F.length-1;const G=Math.min(6,F.length);return{id:q.readUIntBE(0,q.length),len:F.readUIntBE(F.length-G,G)}}s(pe,"readElement");async function se(q,F){for(;F>0;){const G=await pe();if(G.id===17026)return ae.readToken(new Token.StringType(G.len,"utf-8"));await ae.ignore(G.len),--F}}s(se,"readChildren");const de=await pe();switch(await se(1,de.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(Q([82,73,70,70])){if(Q([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(Q([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(Q([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(j("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(Q([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(j("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(j("MSCF")||j("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(Q([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(Q([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(Q([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(Q([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(j("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(j("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(Q([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(j("IMPM"))return{ext:"it",mime:"audio/x-it"};if(j("-lh0-",{offset:2})||j("-lh1-",{offset:2})||j("-lh2-",{offset:2})||j("-lh3-",{offset:2})||j("-lh4-",{offset:2})||j("-lh5-",{offset:2})||j("-lh6-",{offset:2})||j("-lh7-",{offset:2})||j("-lzs-",{offset:2})||j("-lz4-",{offset:2})||j("-lz5-",{offset:2})||j("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(Q([0,0,1,186])){if(Q([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(Q([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(j("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(Q([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(j("<?xml "))return{ext:"xml",mime:"application/xml"};if(Q([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(Q([82,97,114,33,26,7])&&(h[6]===0||h[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(j("solid "))return{ext:"stl",mime:"model/stl"};if(j("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(j("!<arch>"))return await ae.ignore(8),await ae.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(Q([137,80,78,71,13,10,26,10])){await ae.ignore(8);async function ie(){return{length:await ae.readToken(Token.INT32_BE),type:await ae.readToken(new Token.StringType(4,"binary"))}}s(ie,"readChunkHeader");do{const pe=await ie();if(pe.length<0)return;switch(pe.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await ae.ignore(pe.length+4)}}while(ae.position+8<ae.fileInfo.size);return{ext:"png",mime:"image/png"}}if(Q([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(Q([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(Q([102,114,101,101],{offset:4})||Q([109,100,97,116],{offset:4})||Q([109,111,111,118],{offset:4})||Q([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(Q([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(j("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(Q([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(Q([48,38,178,117,142,102,207,17,166,217])){async function ie(){const pe=Buffer.alloc(16);return await ae.readBuffer(pe),{id:pe,size:Number(await ae.readToken(Token.UINT64_LE))}}for(s(ie,"readHeader"),await ae.ignore(30);ae.position+24<ae.fileInfo.size;){const pe=await ie();let se=pe.size-24;if(_check(pe.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const de=Buffer.alloc(16);if(se-=await ae.readBuffer(de),_check(de,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(de,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await ae.ignore(se)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(Q([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((Q([126,16,4])||Q([126,24,4]))&&Q([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(Q([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(Q([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await ae.ignore(20),await ae.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(Q([255,10])||Q([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(Q([0,0,1,186])||Q([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(Q([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(Q([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(Q([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(Q([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await ae.peekBuffer(h,{length:Math.min(256,ae.fileInfo.size),mayBeLess:!0}),j("BEGIN:")){if(j("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(j("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(j("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(j("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(j("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(Q([4,0,0,0])&&h.length>=16){const ie=h.readUInt32LE(12);if(ie>12&&h.length>=ie+16)try{const pe=h.slice(16,ie+16).toString();if(JSON.parse(pe).files)return{ext:"asar",mime:"application/x-asar"}}catch(pe){}}if(Q([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(j("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(Q([71],{offset:4})&&(Q([71],{offset:192})||Q([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(Q([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(Q([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(Q([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(Q([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(Q([76,80],{offset:34})&&(Q([0,0,1],{offset:8})||Q([1,0,2],{offset:8})||Q([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(Q([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await ae.peekBuffer(h,{length:Math.min(512,ae.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(h))return{ext:"tar",mime:"application/x-tar"};if(Q([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(j("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(h.length>=2&&Q([255,224],{offset:0,mask:[255,224]})){if(Q([16],{offset:1,mask:[22]}))return Q([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(Q([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(Q([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(Q([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}s(_fromTokenizer,"_fromTokenizer");const stream=s(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const ae=new stream.PassThrough;let h;stream.pipeline?h=stream.pipeline(readableStream,ae,()=>{}):h=readableStream.pipe(ae);const V=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const Q=await fromBuffer(V);ae.fileType=Q}catch(Q){reject(Q)}resolve(h)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(ae,h,V)=>{"use strict";const Q=V(6597),j=V(1);async function ie(se){const de=await Q.fromFile(se);try{return await j.fromTokenizer(de)}finally{await de.close()}}s(ie,"fromFile");const pe={fromFile:ie};Object.assign(pe,j),Object.defineProperty(pe,"extensions",{get(){return j.extensions}}),Object.defineProperty(pe,"mimeTypes",{get(){return j.mimeTypes}}),ae.exports=pe},9898:ae=>{"use strict";ae.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(ae,h)=>{"use strict";h.stringToBytes=V=>[...V].map(Q=>Q.charCodeAt(0)),h.tarHeaderChecksumMatches=(V,Q=0)=>{const j=parseInt(V.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(j))return!1;let ie=8*32;for(let pe=Q;pe<Q+148;pe++)ie+=V[pe];for(let pe=Q+156;pe<Q+512;pe++)ie+=V[pe];return j===ie},h.uint32SyncSafeToken={get:(V,Q)=>V[Q+3]&127|V[Q+2]<<7|V[Q+1]<<14|V[Q]<<21,len:4}},2664:(ae,h,V)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const Q=V(3837),j=V(5702),ie=s(le=>le!==null&&typeof le=="object"&&!Array.isArray(le),"isObject"),pe=s(le=>$=>le===!0?Number($):String($),"transform"),se=s(le=>typeof le=="number"||typeof le=="string"&&le!=="","isValidValue"),de=s(le=>Number.isInteger(+le),"isNumber"),W=s(le=>{let $=`${le}`,Te=-1;if($[0]==="-"&&($=$.slice(1)),$==="0")return!1;for(;$[++Te]==="0";);return Te>0},"zeros"),q=s((le,$,Te)=>typeof le=="string"||typeof $=="string"?!0:Te.stringify===!0,"stringify"),F=s((le,$,Te)=>{if($>0){let ne=le[0]==="-"?"-":"";ne&&(le=le.slice(1)),le=ne+le.padStart(ne?$-1:$,"0")}return Te===!1?String(le):le},"pad"),G=s((le,$)=>{let Te=le[0]==="-"?"-":"";for(Te&&(le=le.slice(1),$--);le.length<$;)le="0"+le;return Te?"-"+le:le},"toMaxLen"),me=s((le,$)=>{le.negatives.sort((we,He)=>we<He?-1:we>He?1:0),le.positives.sort((we,He)=>we<He?-1:we>He?1:0);let Te=$.capture?"":"?:",ne="",ce="",ge;return le.positives.length&&(ne=le.positives.join("|")),le.negatives.length&&(ce=`-(${Te}${le.negatives.join("|")})`),ne&&ce?ge=`${ne}|${ce}`:ge=ne||ce,$.wrap?`(${Te}${ge})`:ge},"toSequence"),L=s((le,$,Te,ne)=>{if(Te)return j(le,$,{wrap:!1,...ne});let ce=String.fromCharCode(le);if(le===$)return ce;let ge=String.fromCharCode($);return`[${ce}-${ge}]`},"toRange"),ue=s((le,$,Te)=>{if(Array.isArray(le)){let ne=Te.wrap===!0,ce=Te.capture?"":"?:";return ne?`(${ce}${le.join("|")})`:le.join("|")}return j(le,$,Te)},"toRegex"),Ne=s((...le)=>new RangeError("Invalid range arguments: "+Q.inspect(...le)),"rangeError"),nt=s((le,$,Te)=>{if(Te.strictRanges===!0)throw Ne([le,$]);return[]},"invalidRange"),We=s((le,$)=>{if($.strictRanges===!0)throw new TypeError(`Expected step "${le}" to be a number`);return[]},"invalidStep"),Ee=s((le,$,Te=1,ne={})=>{let ce=Number(le),ge=Number($);if(!Number.isInteger(ce)||!Number.isInteger(ge)){if(ne.strictRanges===!0)throw Ne([le,$]);return[]}ce===0&&(ce=0),ge===0&&(ge=0);let we=ce>ge,He=String(le),Ge=String($),tt=String(Te);Te=Math.max(Math.abs(Te),1);let ye=W(He)||W(Ge)||W(tt),Be=ye?Math.max(He.length,Ge.length,tt.length):0,Ke=ye===!1&&q(le,$,ne)===!1,Xe=ne.transform||pe(Ke);if(ne.toRegex&&Te===1)return L(G(le,Be),G($,Be),!0,ne);let ze={negatives:[],positives:[]},Ze=s(xe=>ze[xe<0?"negatives":"positives"].push(Math.abs(xe)),"push"),Le=[],St=0;for(;we?ce>=ge:ce<=ge;)ne.toRegex===!0&&Te>1?Ze(ce):Le.push(F(Xe(ce,St),Be,Ke)),ce=we?ce-Te:ce+Te,St++;return ne.toRegex===!0?Te>1?me(ze,ne):ue(Le,null,{wrap:!1,...ne}):Le},"fillNumbers"),Ce=s((le,$,Te=1,ne={})=>{if(!de(le)&&le.length>1||!de($)&&$.length>1)return nt(le,$,ne);let ce=ne.transform||(Ke=>String.fromCharCode(Ke)),ge=`${le}`.charCodeAt(0),we=`${$}`.charCodeAt(0),He=ge>we,Ge=Math.min(ge,we),tt=Math.max(ge,we);if(ne.toRegex&&Te===1)return L(Ge,tt,!1,ne);let ye=[],Be=0;for(;He?ge>=we:ge<=we;)ye.push(ce(ge,Be)),ge=He?ge-Te:ge+Te,Be++;return ne.toRegex===!0?ue(ye,null,{wrap:!1,options:ne}):ye},"fillLetters"),Se=s((le,$,Te,ne={})=>{if($==null&&se(le))return[le];if(!se(le)||!se($))return nt(le,$,ne);if(typeof Te=="function")return Se(le,$,1,{transform:Te});if(ie(Te))return Se(le,$,0,Te);let ce={...ne};return ce.capture===!0&&(ce.wrap=!0),Te=Te||ce.step||1,de(Te)?de(le)&&de($)?Ee(le,$,Te,ce):Ce(le,$,Math.max(Math.abs(Te),1),ce):Te!=null&&!ie(Te)?We(Te,ce):Se(le,$,1,Te)},"fill");ae.exports=Se},7360:function(ae,h){var V,Q,j;(function(ie,pe){Q=[],V=pe,j=typeof V=="function"?V.apply(h,Q):V,j!==void 0&&(ae.exports=j)})(this,s(function(){function pe(Ee){var Ce={single:function(Se,le,$){if(!Se||(Ne(Se)||(Se=Ce.getPreparedSearch(Se)),!le))return null;Ne(le)||(le=Ce.getPrepared(le));var Te=$&&$.allowTypo!==void 0?$.allowTypo:Ee&&Ee.allowTypo!==void 0?Ee.allowTypo:!0,ne=Te?Ce.algorithm:Ce.algorithmNoTypo;return ne(Se,le,Se[0])},go:function(Se,le,$){if(!Se)return q;Se=Ce.prepareSearch(Se);var Te=Se[0],ne=$&&$.threshold||Ee&&Ee.threshold||-9007199254740991,ce=$&&$.limit||Ee&&Ee.limit||9007199254740991,ge=$&&$.allowTypo!==void 0?$.allowTypo:Ee&&Ee.allowTypo!==void 0?Ee.allowTypo:!0,we=ge?Ce.algorithm:Ce.algorithmNoTypo,He=0,Ge=0,tt=le.length;if($&&$.keys)for(var ye=$.scoreFn||L,Be=$.keys,Ke=Be.length,Xe=tt-1;Xe>=0;--Xe){for(var ze=le[Xe],Ze=new Array(Ke),Le=Ke-1;Le>=0;--Le){var St=Be[Le],xe=ue(ze,St);if(!xe){Ze[Le]=null;continue}Ne(xe)||(xe=Ce.getPrepared(xe)),Ze[Le]=we(Se,xe,Te)}Ze.obj=ze;var Dt=ye(Ze);Dt!==null&&(Dt<ne||(Ze.score=Dt,He<ce?(We.add(Ze),++He):(++Ge,Dt>We.peek().score&&We.replaceTop(Ze))))}else if($&&$.key)for(var St=$.key,Xe=tt-1;Xe>=0;--Xe){var ze=le[Xe],xe=ue(ze,St);if(!!xe){Ne(xe)||(xe=Ce.getPrepared(xe));var ct=we(Se,xe,Te);ct!==null&&(ct.score<ne||(ct={target:ct.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:ct.score,indexes:ct.indexes,obj:ze},He<ce?(We.add(ct),++He):(++Ge,ct.score>We.peek().score&&We.replaceTop(ct))))}}else for(var Xe=tt-1;Xe>=0;--Xe){var xe=le[Xe];if(!!xe){Ne(xe)||(xe=Ce.getPrepared(xe));var ct=we(Se,xe,Te);ct!==null&&(ct.score<ne||(He<ce?(We.add(ct),++He):(++Ge,ct.score>We.peek().score&&We.replaceTop(ct))))}}if(He===0)return q;for(var It=new Array(He),Xe=He-1;Xe>=0;--Xe)It[Xe]=We.poll();return It.total=He+Ge,It},goAsync:function(Se,le,$){var Te=!1,ne=new Promise(function(ce,ge){if(!Se)return ce(q);Se=Ce.prepareSearch(Se);var we=Se[0],He=nt(),Ge=le.length-1,tt=$&&$.threshold||Ee&&Ee.threshold||-9007199254740991,ye=$&&$.limit||Ee&&Ee.limit||9007199254740991,Be=$&&$.allowTypo!==void 0?$.allowTypo:Ee&&Ee.allowTypo!==void 0?Ee.allowTypo:!0,Ke=Be?Ce.algorithm:Ce.algorithmNoTypo,Xe=0,ze=0;function Ze(){if(Te)return ge("canceled");var Le=Date.now();if($&&$.keys)for(var St=$.scoreFn||L,xe=$.keys,Dt=xe.length;Ge>=0;--Ge){for(var ct=le[Ge],It=new Array(Dt),$e=Dt-1;$e>=0;--$e){var Me=xe[$e],mt=ue(ct,Me);if(!mt){It[$e]=null;continue}Ne(mt)||(mt=Ce.getPrepared(mt)),It[$e]=Ke(Se,mt,we)}It.obj=ct;var Tt=St(It);if(Tt!==null&&!(Tt<tt)&&(It.score=Tt,Xe<ye?(He.add(It),++Xe):(++ze,Tt>He.peek().score&&He.replaceTop(It)),Ge%1e3==0&&Date.now()-Le>=10)){se?setImmediate(Ze):setTimeout(Ze);return}}else if($&&$.key)for(var Me=$.key;Ge>=0;--Ge){var ct=le[Ge],mt=ue(ct,Me);if(!!mt){Ne(mt)||(mt=Ce.getPrepared(mt));var Ut=Ke(Se,mt,we);if(Ut!==null&&!(Ut.score<tt)&&(Ut={target:Ut.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ut.score,indexes:Ut.indexes,obj:ct},Xe<ye?(He.add(Ut),++Xe):(++ze,Ut.score>He.peek().score&&He.replaceTop(Ut)),Ge%1e3==0&&Date.now()-Le>=10)){se?setImmediate(Ze):setTimeout(Ze);return}}}else for(;Ge>=0;--Ge){var mt=le[Ge];if(!!mt){Ne(mt)||(mt=Ce.getPrepared(mt));var Ut=Ke(Se,mt,we);if(Ut!==null&&!(Ut.score<tt)&&(Xe<ye?(He.add(Ut),++Xe):(++ze,Ut.score>He.peek().score&&He.replaceTop(Ut)),Ge%1e3==0&&Date.now()-Le>=10)){se?setImmediate(Ze):setTimeout(Ze);return}}}if(Xe===0)return ce(q);for(var gr=new Array(Xe),Jt=Xe-1;Jt>=0;--Jt)gr[Jt]=He.poll();gr.total=Xe+ze,ce(gr)}s(Ze,"step"),se?setImmediate(Ze):Ze()});return ne.cancel=function(){Te=!0},ne},highlight:function(Se,le,$){if(Se===null)return null;le===void 0&&(le="<b>"),$===void 0&&($="</b>");for(var Te="",ne=0,ce=!1,ge=Se.target,we=ge.length,He=Se.indexes,Ge=0;Ge<we;++Ge){var tt=ge[Ge];if(He[ne]===Ge){if(++ne,ce||(ce=!0,Te+=le),ne===He.length){Te+=tt+$+ge.substr(Ge+1);break}}else ce&&(ce=!1,Te+=$);Te+=tt}return Te},prepare:function(Se){if(!!Se)return{target:Se,_targetLowerCodes:Ce.prepareLowerCodes(Se),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(Se){if(!!Se)return{target:Se,_targetLowerCodes:Ce.prepareLowerCodes(Se),_nextBeginningIndexes:Ce.prepareNextBeginningIndexes(Se),score:null,indexes:null,obj:null}},prepareSearch:function(Se){if(!!Se)return Ce.prepareLowerCodes(Se)},getPrepared:function(Se){if(Se.length>999)return Ce.prepare(Se);var le=de.get(Se);return le!==void 0||(le=Ce.prepare(Se),de.set(Se,le)),le},getPreparedSearch:function(Se){if(Se.length>999)return Ce.prepareSearch(Se);var le=W.get(Se);return le!==void 0||(le=Ce.prepareSearch(Se),W.set(Se,le)),le},algorithm:function(Se,le,$){for(var Te=le._targetLowerCodes,ne=Se.length,ce=Te.length,ge=0,we=0,He=0,Ge=0;;){var tt=$===Te[we];if(tt){if(F[Ge++]=we,++ge,ge===ne)break;$=Se[He===0?ge:He===ge?ge+1:He===ge-1?ge-1:ge]}if(++we,we>=ce)for(;;){if(ge<=1)return null;if(He===0){--ge;var ye=Se[ge];if($===ye)continue;He=ge}else{if(He===1)return null;--He,ge=He,$=Se[ge+1];var ye=Se[ge];if($===ye)continue}Ge=ge,we=F[Ge-1]+1;break}}var ge=0,Be=0,Ke=!1,Xe=0,ze=le._nextBeginningIndexes;ze===null&&(ze=le._nextBeginningIndexes=Ce.prepareNextBeginningIndexes(le.target));var Ze=we=F[0]===0?0:ze[F[0]-1];if(we!==ce)for(;;)if(we>=ce){if(ge<=0){if(++Be,Be>ne-2)break;if(Se[Be]===Se[Be+1])continue;we=Ze;continue}--ge;var Le=G[--Xe];we=ze[Le]}else{var tt=Se[Be===0?ge:Be===ge?ge+1:Be===ge-1?ge-1:ge]===Te[we];if(tt){if(G[Xe++]=we,++ge,ge===ne){Ke=!0;break}++we}else we=ze[we]}{if(Ke)var St=G,xe=Xe;else var St=F,xe=Ge;for(var Dt=0,ct=-1,It=0;It<ne;++It){var we=St[It];ct!==we-1&&(Dt-=we),ct=we}Ke?Be!==0&&(Dt+=-20):(Dt*=1e3,He!==0&&(Dt+=-20)),Dt-=ce-ne,le.score=Dt,le.indexes=new Array(xe);for(var It=xe-1;It>=0;--It)le.indexes[It]=St[It];return le}},algorithmNoTypo:function(Se,le,$){for(var Te=le._targetLowerCodes,ne=Se.length,ce=Te.length,ge=0,we=0,He=0;;){var Ge=$===Te[we];if(Ge){if(F[He++]=we,++ge,ge===ne)break;$=Se[ge]}if(++we,we>=ce)return null}var ge=0,tt=!1,ye=0,Be=le._nextBeginningIndexes;Be===null&&(Be=le._nextBeginningIndexes=Ce.prepareNextBeginningIndexes(le.target));var Ke=we=F[0]===0?0:Be[F[0]-1];if(we!==ce)for(;;)if(we>=ce){if(ge<=0)break;--ge;var Xe=G[--ye];we=Be[Xe]}else{var Ge=Se[ge]===Te[we];if(Ge){if(G[ye++]=we,++ge,ge===ne){tt=!0;break}++we}else we=Be[we]}{if(tt)var ze=G,Ze=ye;else var ze=F,Ze=He;for(var Le=0,St=-1,xe=0;xe<ne;++xe){var we=ze[xe];St!==we-1&&(Le-=we),St=we}tt||(Le*=1e3),Le-=ce-ne,le.score=Le,le.indexes=new Array(Ze);for(var xe=Ze-1;xe>=0;--xe)le.indexes[xe]=ze[xe];return le}},prepareLowerCodes:function(Se){for(var le=Se.length,$=[],Te=Se.toLowerCase(),ne=0;ne<le;++ne)$[ne]=Te.charCodeAt(ne);return $},prepareBeginningIndexes:function(Se){for(var le=Se.length,$=[],Te=0,ne=!1,ce=!1,ge=0;ge<le;++ge){var we=Se.charCodeAt(ge),He=we>=65&&we<=90,Ge=He||we>=97&&we<=122||we>=48&&we<=57,tt=He&&!ne||!ce||!Ge;ne=He,ce=Ge,tt&&($[Te++]=ge)}return $},prepareNextBeginningIndexes:function(Se){for(var le=Se.length,$=Ce.prepareBeginningIndexes(Se),Te=[],ne=$[0],ce=0,ge=0;ge<le;++ge)ne>ge?Te[ge]=ne:(ne=$[++ce],Te[ge]=ne===void 0?le:ne);return Te},cleanup:me,new:pe};return Ce}s(pe,"fuzzysortNew");var se=typeof window=="undefined",de=new Map,W=new Map,q=[];q.total=0;var F=[],G=[];function me(){de.clear(),W.clear(),F=[],G=[]}s(me,"cleanup");function L(Ee){for(var Ce=-9007199254740991,Se=Ee.length-1;Se>=0;--Se){var le=Ee[Se];if(le!==null){var $=le.score;$>Ce&&(Ce=$)}}return Ce===-9007199254740991?null:Ce}s(L,"defaultScoreFn");function ue(Ee,Ce){var Se=Ee[Ce];if(Se!==void 0)return Se;var le=Ce;Array.isArray(Ce)||(le=Ce.split("."));for(var $=le.length,Te=-1;Ee&&++Te<$;)Ee=Ee[le[Te]];return Ee}s(ue,"getValue");function Ne(Ee){return typeof Ee=="object"}s(Ne,"isObj");var nt=s(function(){var Ee=[],Ce=0,Se={};function le(){for(var $=0,Te=Ee[$],ne=1;ne<Ce;){var ce=ne+1;$=ne,ce<Ce&&Ee[ce].score<Ee[ne].score&&($=ce),Ee[$-1>>1]=Ee[$],ne=1+($<<1)}for(var ge=$-1>>1;$>0&&Te.score<Ee[ge].score;ge=($=ge)-1>>1)Ee[$]=Ee[ge];Ee[$]=Te}return s(le,"n"),Se.add=function($){var Te=Ce;Ee[Ce++]=$;for(var ne=Te-1>>1;Te>0&&$.score<Ee[ne].score;ne=(Te=ne)-1>>1)Ee[Te]=Ee[ne];Ee[Te]=$},Se.poll=function(){if(Ce!==0){var $=Ee[0];return Ee[0]=Ee[--Ce],le(),$}},Se.peek=function($){if(Ce!==0)return Ee[0]},Se.replaceTop=function($){Ee[0]=$,le()},Se},"fastpriorityqueue"),We=nt();return pe()},"UMD"))},645:(ae,h)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */h.read=function(V,Q,j,ie,pe){var se,de,W=pe*8-ie-1,q=(1<<W)-1,F=q>>1,G=-7,me=j?pe-1:0,L=j?-1:1,ue=V[Q+me];for(me+=L,se=ue&(1<<-G)-1,ue>>=-G,G+=W;G>0;se=se*256+V[Q+me],me+=L,G-=8);for(de=se&(1<<-G)-1,se>>=-G,G+=ie;G>0;de=de*256+V[Q+me],me+=L,G-=8);if(se===0)se=1-F;else{if(se===q)return de?NaN:(ue?-1:1)*(1/0);de=de+Math.pow(2,ie),se=se-F}return(ue?-1:1)*de*Math.pow(2,se-ie)},h.write=function(V,Q,j,ie,pe,se){var de,W,q,F=se*8-pe-1,G=(1<<F)-1,me=G>>1,L=pe===23?Math.pow(2,-24)-Math.pow(2,-77):0,ue=ie?0:se-1,Ne=ie?1:-1,nt=Q<0||Q===0&&1/Q<0?1:0;for(Q=Math.abs(Q),isNaN(Q)||Q===1/0?(W=isNaN(Q)?1:0,de=G):(de=Math.floor(Math.log(Q)/Math.LN2),Q*(q=Math.pow(2,-de))<1&&(de--,q*=2),de+me>=1?Q+=L/q:Q+=L*Math.pow(2,1-me),Q*q>=2&&(de++,q/=2),de+me>=G?(W=0,de=G):de+me>=1?(W=(Q*q-1)*Math.pow(2,pe),de=de+me):(W=Q*Math.pow(2,me-1)*Math.pow(2,pe),de=0));pe>=8;V[j+ue]=W&255,ue+=Ne,W/=256,pe-=8);for(de=de<<pe|W,F+=pe;F>0;V[j+ue]=de&255,ue+=Ne,de/=256,F-=8);V[j+ue-Ne]|=nt*128}},9924:ae=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */ae.exports=function(h){return typeof h=="number"?h-h==0:typeof h=="string"&&h.trim()!==""?Number.isFinite?Number.isFinite(+h):isFinite(+h):!1}},2307:(ae,h,V)=>{ae=V.nmd(ae);var Q=200,j="__lodash_hash_undefined__",ie=1,pe=2,se=9007199254740991,de="[object Arguments]",W="[object Array]",q="[object AsyncFunction]",F="[object Boolean]",G="[object Date]",me="[object Error]",L="[object Function]",ue="[object GeneratorFunction]",Ne="[object Map]",nt="[object Number]",We="[object Null]",Ee="[object Object]",Ce="[object Promise]",Se="[object Proxy]",le="[object RegExp]",$="[object Set]",Te="[object String]",ne="[object Symbol]",ce="[object Undefined]",ge="[object WeakMap]",we="[object ArrayBuffer]",He="[object DataView]",Ge="[object Float32Array]",tt="[object Float64Array]",ye="[object Int8Array]",Be="[object Int16Array]",Ke="[object Int32Array]",Xe="[object Uint8Array]",ze="[object Uint8ClampedArray]",Ze="[object Uint16Array]",Le="[object Uint32Array]",St=/[\\^$.*+?()[\]{}|]/g,xe=/^\[object .+?Constructor\]$/,Dt=/^(?:0|[1-9]\d*)$/,ct={};ct[Ge]=ct[tt]=ct[ye]=ct[Be]=ct[Ke]=ct[Xe]=ct[ze]=ct[Ze]=ct[Le]=!0,ct[de]=ct[W]=ct[we]=ct[F]=ct[He]=ct[G]=ct[me]=ct[L]=ct[Ne]=ct[nt]=ct[Ee]=ct[le]=ct[$]=ct[Te]=ct[ge]=!1;var It=typeof global=="object"&&global&&global.Object===Object&&global,$e=typeof self=="object"&&self&&self.Object===Object&&self,Me=It||$e||Function("return this")(),mt=h&&!h.nodeType&&h,Tt=mt&&!0&&ae&&!ae.nodeType&&ae,Ut=Tt&&Tt.exports===mt,gr=Ut&&It.process,Jt=function(){try{return gr&&gr.binding&&gr.binding("util")}catch(ee){}}(),er=Jt&&Jt.isTypedArray;function pi(ee,J){for(var Ve=-1,pt=ee==null?0:ee.length,zt=0,kt=[];++Ve<pt;){var vr=ee[Ve];J(vr,Ve,ee)&&(kt[zt++]=vr)}return kt}s(pi,"arrayFilter");function mr(ee,J){for(var Ve=-1,pt=J.length,zt=ee.length;++Ve<pt;)ee[zt+Ve]=J[Ve];return ee}s(mr,"arrayPush");function Nr(ee,J){for(var Ve=-1,pt=ee==null?0:ee.length;++Ve<pt;)if(J(ee[Ve],Ve,ee))return!0;return!1}s(Nr,"arraySome");function Rt(ee,J){for(var Ve=-1,pt=Array(ee);++Ve<ee;)pt[Ve]=J(Ve);return pt}s(Rt,"baseTimes");function qt(ee){return function(J){return ee(J)}}s(qt,"baseUnary");function ht(ee,J){return ee.has(J)}s(ht,"cacheHas");function ft(ee,J){return ee==null?void 0:ee[J]}s(ft,"getValue");function Pt(ee){var J=-1,Ve=Array(ee.size);return ee.forEach(function(pt,zt){Ve[++J]=[zt,pt]}),Ve}s(Pt,"mapToArray");function et(ee,J){return function(Ve){return ee(J(Ve))}}s(et,"overArg");function Ot(ee){var J=-1,Ve=Array(ee.size);return ee.forEach(function(pt){Ve[++J]=pt}),Ve}s(Ot,"setToArray");var wt=Array.prototype,Er=Function.prototype,Gt=Object.prototype,$r=Me["__core-js_shared__"],Yn=Er.toString,kn=Gt.hasOwnProperty,eo=function(){var ee=/[^.]+$/.exec($r&&$r.keys&&$r.keys.IE_PROTO||"");return ee?"Symbol(src)_1."+ee:""}(),ja=Gt.toString,qs=RegExp("^"+Yn.call(kn).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rr=Ut?Me.Buffer:void 0,to=Me.Symbol,ra=Me.Uint8Array,na=Gt.propertyIsEnumerable,zs=wt.splice,gi=to?to.toStringTag:void 0,fn=Object.getOwnPropertySymbols,Ii=rr?rr.isBuffer:void 0,So=et(Object.keys,Object),Co=so(Me,"DataView"),Cn=so(Me,"Map"),lt=so(Me,"Promise"),Di=so(Me,"Set"),ro=so(Me,"WeakMap"),Zn=so(Object,"create"),pl=Gn(Co),Ws=Gn(Cn),Gs=Gn(lt),Vs=Gn(Di),Mr=Gn(ro),yr=to?to.prototype:void 0,tr=yr?yr.valueOf:void 0;function jr(ee){var J=-1,Ve=ee==null?0:ee.length;for(this.clear();++J<Ve;){var pt=ee[J];this.set(pt[0],pt[1])}}s(jr,"Hash");function qa(){this.__data__=Zn?Zn(null):{},this.size=0}s(qa,"hashClear");function Ks(ee){var J=this.has(ee)&&delete this.__data__[ee];return this.size-=J?1:0,J}s(Ks,"hashDelete");function Qs(ee){var J=this.__data__;if(Zn){var Ve=J[ee];return Ve===j?void 0:Ve}return kn.call(J,ee)?J[ee]:void 0}s(Qs,"hashGet");function gl(ee){var J=this.__data__;return Zn?J[ee]!==void 0:kn.call(J,ee)}s(gl,"hashHas");function za(ee,J){var Ve=this.__data__;return this.size+=this.has(ee)?0:1,Ve[ee]=Zn&&J===void 0?j:J,this}s(za,"hashSet"),jr.prototype.clear=qa,jr.prototype.delete=Ks,jr.prototype.get=Qs,jr.prototype.has=gl,jr.prototype.set=za;function Nn(ee){var J=-1,Ve=ee==null?0:ee.length;for(this.clear();++J<Ve;){var pt=ee[J];this.set(pt[0],pt[1])}}s(Nn,"ListCache");function ia(){this.__data__=[],this.size=0}s(ia,"listCacheClear");function xo(ee){var J=this.__data__,Ve=Oi(J,ee);if(Ve<0)return!1;var pt=J.length-1;return Ve==pt?J.pop():zs.call(J,Ve,1),--this.size,!0}s(xo,"listCacheDelete");function ml(ee){var J=this.__data__,Ve=Oi(J,ee);return Ve<0?void 0:J[Ve][1]}s(ml,"listCacheGet");function vl(ee){return Oi(this.__data__,ee)>-1}s(vl,"listCacheHas");function no(ee,J){var Ve=this.__data__,pt=Oi(Ve,ee);return pt<0?(++this.size,Ve.push([ee,J])):Ve[pt][1]=J,this}s(no,"listCacheSet"),Nn.prototype.clear=ia,Nn.prototype.delete=xo,Nn.prototype.get=ml,Nn.prototype.has=vl,Nn.prototype.set=no;function Jn(ee){var J=-1,Ve=ee==null?0:ee.length;for(this.clear();++J<Ve;){var pt=ee[J];this.set(pt[0],pt[1])}}s(Jn,"MapCache");function yl(){this.size=0,this.__data__={hash:new jr,map:new(Cn||Nn),string:new jr}}s(yl,"mapCacheClear");function Wa(ee){var J=Ao(this,ee).delete(ee);return this.size-=J?1:0,J}s(Wa,"mapCacheDelete");function _l(ee){return Ao(this,ee).get(ee)}s(_l,"mapCacheGet");function Ga(ee){return Ao(this,ee).has(ee)}s(Ga,"mapCacheHas");function Mn(ee,J){var Ve=Ao(this,ee),pt=Ve.size;return Ve.set(ee,J),this.size+=Ve.size==pt?0:1,this}s(Mn,"mapCacheSet"),Jn.prototype.clear=yl,Jn.prototype.delete=Wa,Jn.prototype.get=_l,Jn.prototype.has=Ga,Jn.prototype.set=Mn;function mi(ee){var J=-1,Ve=ee==null?0:ee.length;for(this.__data__=new Jn;++J<Ve;)this.add(ee[J])}s(mi,"SetCache");function Fn(ee){return this.__data__.set(ee,j),this}s(Fn,"setCacheAdd");function Va(ee){return this.__data__.has(ee)}s(Va,"setCacheHas"),mi.prototype.add=mi.prototype.push=Fn,mi.prototype.has=Va;function ei(ee){var J=this.__data__=new Nn(ee);this.size=J.size}s(ei,"Stack");function Xs(){this.__data__=new Nn,this.size=0}s(Xs,"stackClear");function oa(ee){var J=this.__data__,Ve=J.delete(ee);return this.size=J.size,Ve}s(oa,"stackDelete");function Ys(ee){return this.__data__.get(ee)}s(Ys,"stackGet");function Zs(ee){return this.__data__.has(ee)}s(Zs,"stackHas");function Pi(ee,J){var Ve=this.__data__;if(Ve instanceof Nn){var pt=Ve.__data__;if(!Cn||pt.length<Q-1)return pt.push([ee,J]),this.size=++Ve.size,this;Ve=this.__data__=new Jn(pt)}return Ve.set(ee,J),this.size=Ve.size,this}s(Pi,"stackSet"),ei.prototype.clear=Xs,ei.prototype.delete=oa,ei.prototype.get=Ys,ei.prototype.has=Zs,ei.prototype.set=Pi;function wl(ee,J){var Ve=Ln(ee),pt=!Ve&&es(ee),zt=!Ve&&!pt&&Ro(ee),kt=!Ve&&!pt&&!zt&&la(ee),vr=Ve||pt||zt||kt,Sr=vr?Rt(ee.length,String):[],Pr=Sr.length;for(var dr in ee)(J||kn.call(ee,dr))&&!(vr&&(dr=="length"||zt&&(dr=="offset"||dr=="parent")||kt&&(dr=="buffer"||dr=="byteLength"||dr=="byteOffset")||Za(dr,Pr)))&&Sr.push(dr);return Sr}s(wl,"arrayLikeKeys");function Oi(ee,J){for(var Ve=ee.length;Ve--;)if(ca(ee[Ve][0],J))return Ve;return-1}s(Oi,"assocIndexOf");function io(ee,J,Ve){var pt=J(ee);return Ln(ee)?pt:mr(pt,Ve(ee))}s(io,"baseGetAllKeys");function oo(ee){return ee==null?ee===void 0?ce:We:gi&&gi in Object(ee)?Xa(ee):sa(ee)}s(oo,"baseGetTag");function ki(ee){return co(ee)&&oo(ee)==de}s(ki,"baseIsArguments");function Ka(ee,J,Ve,pt,zt){return ee===J?!0:ee==null||J==null||!co(ee)&&!co(J)?ee!==ee&&J!==J:To(ee,J,Ve,pt,Ka,zt)}s(Ka,"baseIsEqual");function To(ee,J,Ve,pt,zt,kt){var vr=Ln(ee),Sr=Ln(J),Pr=vr?W:xn(ee),dr=Sr?W:xn(J);Pr=Pr==de?Ee:Pr,dr=dr==de?Ee:dr;var gn=Pr==Ee,mn=dr==Ee,Or=Pr==dr;if(Or&&Ro(ee)){if(!Ro(J))return!1;vr=!0,gn=!1}if(Or&&!gn)return kt||(kt=new ei),vr||la(ee)?Qa(ee,J,Ve,pt,zt,kt):ec(ee,J,Pr,Ve,pt,zt,kt);if(!(Ve&ie)){var Tn=gn&&kn.call(ee,"__wrapped__"),vn=mn&&kn.call(J,"__wrapped__");if(Tn||vn){var vi=Tn?ee.value():ee,ti=vn?J.value():J;return kt||(kt=new ei),zt(vi,ti,Ve,pt,kt)}}return Or?(kt||(kt=new ei),tc(ee,J,Ve,pt,zt,kt)):!1}s(To,"baseIsEqualDeep");function bl(ee){if(!ac(ee)||rc(ee))return!1;var J=Io(ee)?qs:xe;return J.test(Gn(ee))}s(bl,"baseIsNative");function aa(ee){return co(ee)&&oc(ee.length)&&!!ct[oo(ee)]}s(aa,"baseIsTypedArray");function Js(ee){if(!nc(ee))return So(ee);var J=[];for(var Ve in Object(ee))kn.call(ee,Ve)&&Ve!="constructor"&&J.push(Ve);return J}s(Js,"baseKeys");function Qa(ee,J,Ve,pt,zt,kt){var vr=Ve&ie,Sr=ee.length,Pr=J.length;if(Sr!=Pr&&!(vr&&Pr>Sr))return!1;var dr=kt.get(ee);if(dr&&kt.get(J))return dr==J;var gn=-1,mn=!0,Or=Ve&pe?new mi:void 0;for(kt.set(ee,J),kt.set(J,ee);++gn<Sr;){var Tn=ee[gn],vn=J[gn];if(pt)var vi=vr?pt(vn,Tn,gn,J,ee,kt):pt(Tn,vn,gn,ee,J,kt);if(vi!==void 0){if(vi)continue;mn=!1;break}if(Or){if(!Nr(J,function(ti,Mi){if(!ht(Or,Mi)&&(Tn===ti||zt(Tn,ti,Ve,pt,kt)))return Or.push(Mi)})){mn=!1;break}}else if(!(Tn===vn||zt(Tn,vn,Ve,pt,kt))){mn=!1;break}}return kt.delete(ee),kt.delete(J),mn}s(Qa,"equalArrays");function ec(ee,J,Ve,pt,zt,kt,vr){switch(Ve){case He:if(ee.byteLength!=J.byteLength||ee.byteOffset!=J.byteOffset)return!1;ee=ee.buffer,J=J.buffer;case we:return!(ee.byteLength!=J.byteLength||!kt(new ra(ee),new ra(J)));case F:case G:case nt:return ca(+ee,+J);case me:return ee.name==J.name&&ee.message==J.message;case le:case Te:return ee==J+"";case Ne:var Sr=Pt;case $:var Pr=pt&ie;if(Sr||(Sr=Ot),ee.size!=J.size&&!Pr)return!1;var dr=vr.get(ee);if(dr)return dr==J;pt|=pe,vr.set(ee,J);var gn=Qa(Sr(ee),Sr(J),pt,zt,kt,vr);return vr.delete(ee),gn;case ne:if(tr)return tr.call(ee)==tr.call(J)}return!1}s(ec,"equalByTag");function tc(ee,J,Ve,pt,zt,kt){var vr=Ve&ie,Sr=ao(ee),Pr=Sr.length,dr=ao(J),gn=dr.length;if(Pr!=gn&&!vr)return!1;for(var mn=Pr;mn--;){var Or=Sr[mn];if(!(vr?Or in J:kn.call(J,Or)))return!1}var Tn=kt.get(ee);if(Tn&&kt.get(J))return Tn==J;var vn=!0;kt.set(ee,J),kt.set(J,ee);for(var vi=vr;++mn<Pr;){Or=Sr[mn];var ti=ee[Or],Mi=J[Or];if(pt)var sc=vr?pt(Mi,ti,Or,J,ee,kt):pt(ti,Mi,Or,ee,J,kt);if(!(sc===void 0?ti===Mi||zt(ti,Mi,Ve,pt,kt):sc)){vn=!1;break}vi||(vi=Or=="constructor")}if(vn&&!vi){var Fi=ee.constructor,Li=J.constructor;Fi!=Li&&"constructor"in ee&&"constructor"in J&&!(typeof Fi=="function"&&Fi instanceof Fi&&typeof Li=="function"&&Li instanceof Li)&&(vn=!1)}return kt.delete(ee),kt.delete(J),vn}s(tc,"equalObjects");function ao(ee){return io(ee,Do,Ya)}s(ao,"getAllKeys");function Ao(ee,J){var Ve=ee.__data__;return Ja(J)?Ve[typeof J=="string"?"string":"hash"]:Ve.map}s(Ao,"getMapData");function so(ee,J){var Ve=ft(ee,J);return bl(Ve)?Ve:void 0}s(so,"getNative");function Xa(ee){var J=kn.call(ee,gi),Ve=ee[gi];try{ee[gi]=void 0;var pt=!0}catch(kt){}var zt=ja.call(ee);return pt&&(J?ee[gi]=Ve:delete ee[gi]),zt}s(Xa,"getRawTag");var Ya=fn?function(ee){return ee==null?[]:(ee=Object(ee),pi(fn(ee),function(J){return na.call(ee,J)}))}:Ni,xn=oo;(Co&&xn(new Co(new ArrayBuffer(1)))!=He||Cn&&xn(new Cn)!=Ne||lt&&xn(lt.resolve())!=Ce||Di&&xn(new Di)!=$||ro&&xn(new ro)!=ge)&&(xn=s(function(ee){var J=oo(ee),Ve=J==Ee?ee.constructor:void 0,pt=Ve?Gn(Ve):"";if(pt)switch(pt){case pl:return He;case Ws:return Ne;case Gs:return Ce;case Vs:return $;case Mr:return ge}return J},"getTag"));function Za(ee,J){return J=J==null?se:J,!!J&&(typeof ee=="number"||Dt.test(ee))&&ee>-1&&ee%1==0&&ee<J}s(Za,"isIndex");function Ja(ee){var J=typeof ee;return J=="string"||J=="number"||J=="symbol"||J=="boolean"?ee!=="__proto__":ee===null}s(Ja,"isKeyable");function rc(ee){return!!eo&&eo in ee}s(rc,"isMasked");function nc(ee){var J=ee&&ee.constructor,Ve=typeof J=="function"&&J.prototype||Gt;return ee===Ve}s(nc,"isPrototype");function sa(ee){return ja.call(ee)}s(sa,"objectToString");function Gn(ee){if(ee!=null){try{return Yn.call(ee)}catch(J){}try{return ee+""}catch(J){}}return""}s(Gn,"toSource");function ca(ee,J){return ee===J||ee!==ee&&J!==J}s(ca,"eq");var es=ki(function(){return arguments}())?ki:function(ee){return co(ee)&&kn.call(ee,"callee")&&!na.call(ee,"callee")},Ln=Array.isArray;function ic(ee){return ee!=null&&oc(ee.length)&&!Io(ee)}s(ic,"isArrayLike");var Ro=Ii||pn;function ts(ee,J){return Ka(ee,J)}s(ts,"isEqual");function Io(ee){if(!ac(ee))return!1;var J=oo(ee);return J==L||J==ue||J==q||J==Se}s(Io,"isFunction");function oc(ee){return typeof ee=="number"&&ee>-1&&ee%1==0&&ee<=se}s(oc,"isLength");function ac(ee){var J=typeof ee;return ee!=null&&(J=="object"||J=="function")}s(ac,"isObject");function co(ee){return ee!=null&&typeof ee=="object"}s(co,"isObjectLike");var la=er?qt(er):aa;function Do(ee){return ic(ee)?wl(ee):Js(ee)}s(Do,"keys");function Ni(){return[]}s(Ni,"stubArray");function pn(){return!1}s(pn,"stubFalse"),ae.exports=ts},850:(ae,h,V)=>{"use strict";const Q=V(3837),j=V(6744),ie=V(9444),pe=V(8702),se=s(W=>W===""||W==="./","isEmptyString"),de=s((W,q,F)=>{q=[].concat(q),W=[].concat(W);let G=new Set,me=new Set,L=new Set,ue=0,Ne=s(Ee=>{L.add(Ee.output),F&&F.onResult&&F.onResult(Ee)},"onResult");for(let Ee=0;Ee<q.length;Ee++){let Ce=ie(String(q[Ee]),{...F,onResult:Ne},!0),Se=Ce.state.negated||Ce.state.negatedExtglob;Se&&ue++;for(let le of W){let $=Ce(le,!0);!(Se?!$.isMatch:$.isMatch)||(Se?G.add($.output):(G.delete($.output),me.add($.output)))}}let We=(ue===q.length?[...L]:[...me]).filter(Ee=>!G.has(Ee));if(F&&We.length===0){if(F.failglob===!0)throw new Error(`No matches found for "${q.join(", ")}"`);if(F.nonull===!0||F.nullglob===!0)return F.unescape?q.map(Ee=>Ee.replace(/\\/g,"")):q}return We},"micromatch");de.match=de,de.matcher=(W,q)=>ie(W,q),de.isMatch=(W,q,F)=>ie(q,F)(W),de.any=de.isMatch,de.not=(W,q,F={})=>{q=[].concat(q).map(String);let G=new Set,me=[],ue=de(W,q,{...F,onResult:s(Ne=>{F.onResult&&F.onResult(Ne),me.push(Ne.output)},"onResult")});for(let Ne of me)ue.includes(Ne)||G.add(Ne);return[...G]},de.contains=(W,q,F)=>{if(typeof W!="string")throw new TypeError(`Expected a string: "${Q.inspect(W)}"`);if(Array.isArray(q))return q.some(G=>de.contains(W,G,F));if(typeof q=="string"){if(se(W)||se(q))return!1;if(W.includes(q)||W.startsWith("./")&&W.slice(2).includes(q))return!0}return de.isMatch(W,q,{...F,contains:!0})},de.matchKeys=(W,q,F)=>{if(!pe.isObject(W))throw new TypeError("Expected the first argument to be an object");let G=de(Object.keys(W),q,F),me={};for(let L of G)me[L]=W[L];return me},de.some=(W,q,F)=>{let G=[].concat(W);for(let me of[].concat(q)){let L=ie(String(me),F);if(G.some(ue=>L(ue)))return!0}return!1},de.every=(W,q,F)=>{let G=[].concat(W);for(let me of[].concat(q)){let L=ie(String(me),F);if(!G.every(ue=>L(ue)))return!1}return!0},de.all=(W,q,F)=>{if(typeof W!="string")throw new TypeError(`Expected a string: "${Q.inspect(W)}"`);return[].concat(q).every(G=>ie(G,F)(W))},de.capture=(W,q,F)=>{let G=pe.isWindows(F),L=ie.makeRe(String(W),{...F,capture:!0}).exec(G?pe.toPosixSlashes(q):q);if(L)return L.slice(1).map(ue=>ue===void 0?"":ue)},de.makeRe=(...W)=>ie.makeRe(...W),de.scan=(...W)=>ie.scan(...W),de.parse=(W,q)=>{let F=[];for(let G of[].concat(W||[]))for(let me of j(String(G),q))F.push(ie.parse(me,q));return F},de.braces=(W,q)=>{if(typeof W!="string")throw new TypeError("Expected a string");return q&&q.nobrace===!0||!/\{.*\}/.test(W)?[W]:j(W,q)},de.braceExpand=(W,q)=>{if(typeof W!="string")throw new TypeError("Expected a string");return de.braces(W,{...q,expand:!0})},ae.exports=de},447:(ae,h,V)=>{var Q=V(2479);ae.exports=Q(j),ae.exports.strict=Q(ie),j.proto=j(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return j(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return ie(this)},configurable:!0})});function j(pe){var se=s(function(){return se.called?se.value:(se.called=!0,se.value=pe.apply(this,arguments))},"f");return se.called=!1,se}s(j,"once");function ie(pe){var se=s(function(){if(se.called)throw new Error(se.onceError);return se.called=!0,se.value=pe.apply(this,arguments)},"f"),de=pe.name||"Function wrapped with `once`";return se.onceError=de+" shouldn't be called more than once",se.called=!1,se}s(ie,"onceStrict")},7279:(ae,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.EndOfStreamError=h.defaultMessages=void 0,h.defaultMessages="End-Of-Stream";class V extends Error{constructor(){super(h.defaultMessages)}}s(V,"EndOfStreamError"),h.EndOfStreamError=V},5167:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.StreamReader=h.EndOfStreamError=void 0;const Q=V(7279);var j=V(7279);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return j.EndOfStreamError}});class ie{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((W,q)=>{this.reject=q,this.resolve=W})}}s(ie,"Deferred");const pe=1*1024*1024;class se{constructor(W){if(this.s=W,this.request=null,this.endOfStream=!1,this.peekQueue=[],!W.read||!W.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new Q.EndOfStreamError)),this.s.once("error",q=>this.reject(q)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(W,q,F){const G=await this.read(W,q,F);return this.peekQueue.push(W.subarray(q,q+G)),G}async read(W,q,F){if(F===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new Q.EndOfStreamError;let G=F,me=0;for(;this.peekQueue.length>0&&G>0;){const L=this.peekQueue.pop();if(!L)throw new Error("peekData should be defined");const ue=Math.min(L.length,G);W.set(L.subarray(0,ue),q+me),me+=ue,G-=ue,ue<L.length&&this.peekQueue.push(L.subarray(ue))}for(;G>0&&!this.endOfStream;){const L=Math.min(G,pe),ue=await this._read(W,q+me,L);if(me+=ue,ue<L)break;G-=ue}return me}async _read(W,q,F){if(this.request)throw new Error("Concurrent read operation?");const G=this.s.read(F);return G?(W.set(G,q),G.length):(this.request={buffer:W,offset:q,length:F,deferred:new ie},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const W=this.s.read(this.request.length);W?(this.request.buffer.set(W,this.request.offset),this.request.deferred.resolve(W.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(W){this.endOfStream=!0,this.request&&(this.request.deferred.reject(W),this.request=null)}}s(se,"StreamReader"),h.StreamReader=se},9444:(ae,h,V)=>{"use strict";ae.exports=V(6087)},1006:(ae,h,V)=>{"use strict";const Q=V(1017),j="\\\\/",ie=`[^${j}]`,pe="\\.",se="\\+",de="\\?",W="\\/",q="(?=.)",F="[^/]",G=`(?:${W}|$)`,me=`(?:^|${W})`,L=`${pe}{1,2}${G}`,ue=`(?!${pe})`,Ne=`(?!${me}${L})`,nt=`(?!${pe}{0,1}${G})`,We=`(?!${L})`,Ee=`[^.${W}]`,Ce=`${F}*?`,Se={DOT_LITERAL:pe,PLUS_LITERAL:se,QMARK_LITERAL:de,SLASH_LITERAL:W,ONE_CHAR:q,QMARK:F,END_ANCHOR:G,DOTS_SLASH:L,NO_DOT:ue,NO_DOTS:Ne,NO_DOT_SLASH:nt,NO_DOTS_SLASH:We,QMARK_NO_DOT:Ee,STAR:Ce,START_ANCHOR:me},le={...Se,SLASH_LITERAL:`[${j}]`,QMARK:ie,STAR:`${ie}*?`,DOTS_SLASH:`${pe}{1,2}(?:[${j}]|$)`,NO_DOT:`(?!${pe})`,NO_DOTS:`(?!(?:^|[${j}])${pe}{1,2}(?:[${j}]|$))`,NO_DOT_SLASH:`(?!${pe}{0,1}(?:[${j}]|$))`,NO_DOTS_SLASH:`(?!${pe}{1,2}(?:[${j}]|$))`,QMARK_NO_DOT:`[^.${j}]`,START_ANCHOR:`(?:^|[${j}])`,END_ANCHOR:`(?:[${j}]|$)`},$={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};ae.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:$,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Q.sep,extglobChars(Te){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${Te.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(Te){return Te===!0?le:Se}}},3376:(ae,h,V)=>{"use strict";const Q=V(1006),j=V(8702),{MAX_LENGTH:ie,POSIX_REGEX_SOURCE:pe,REGEX_NON_SPECIAL_CHARS:se,REGEX_SPECIAL_CHARS_BACKREF:de,REPLACEMENTS:W}=Q,q=s((me,L)=>{if(typeof L.expandRange=="function")return L.expandRange(...me,L);me.sort();const ue=`[${me.join("-")}]`;try{new RegExp(ue)}catch(Ne){return me.map(nt=>j.escapeRegex(nt)).join("..")}return ue},"expandRange"),F=s((me,L)=>`Missing ${me}: "${L}" - use "\\\\${L}" to match literal characters`,"syntaxError"),G=s((me,L)=>{if(typeof me!="string")throw new TypeError("Expected a string");me=W[me]||me;const ue={...L},Ne=typeof ue.maxLength=="number"?Math.min(ie,ue.maxLength):ie;let nt=me.length;if(nt>Ne)throw new SyntaxError(`Input length: ${nt}, exceeds maximum allowed length: ${Ne}`);const We={type:"bos",value:"",output:ue.prepend||""},Ee=[We],Ce=ue.capture?"":"?:",Se=j.isWindows(L),le=Q.globChars(Se),$=Q.extglobChars(le),{DOT_LITERAL:Te,PLUS_LITERAL:ne,SLASH_LITERAL:ce,ONE_CHAR:ge,DOTS_SLASH:we,NO_DOT:He,NO_DOT_SLASH:Ge,NO_DOTS_SLASH:tt,QMARK:ye,QMARK_NO_DOT:Be,STAR:Ke,START_ANCHOR:Xe}=le,ze=s(ft=>`(${Ce}(?:(?!${Xe}${ft.dot?we:Te}).)*?)`,"globstar"),Ze=ue.dot?"":He,Le=ue.dot?ye:Be;let St=ue.bash===!0?ze(ue):Ke;ue.capture&&(St=`(${St})`),typeof ue.noext=="boolean"&&(ue.noextglob=ue.noext);const xe={input:me,index:-1,start:0,dot:ue.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:Ee};me=j.removePrefix(me,xe),nt=me.length;const Dt=[],ct=[],It=[];let $e=We,Me;const mt=s(()=>xe.index===nt-1,"eos"),Tt=xe.peek=(ft=1)=>me[xe.index+ft],Ut=xe.advance=()=>me[++xe.index]||"",gr=s(()=>me.slice(xe.index+1),"remaining"),Jt=s((ft="",Pt=0)=>{xe.consumed+=ft,xe.index+=Pt},"consume"),er=s(ft=>{xe.output+=ft.output!=null?ft.output:ft.value,Jt(ft.value)},"append"),pi=s(()=>{let ft=1;for(;Tt()==="!"&&(Tt(2)!=="("||Tt(3)==="?");)Ut(),xe.start++,ft++;return ft%2==0?!1:(xe.negated=!0,xe.start++,!0)},"negate"),mr=s(ft=>{xe[ft]++,It.push(ft)},"increment"),Nr=s(ft=>{xe[ft]--,It.pop()},"decrement"),Rt=s(ft=>{if($e.type==="globstar"){const Pt=xe.braces>0&&(ft.type==="comma"||ft.type==="brace"),et=ft.extglob===!0||Dt.length&&(ft.type==="pipe"||ft.type==="paren");ft.type!=="slash"&&ft.type!=="paren"&&!Pt&&!et&&(xe.output=xe.output.slice(0,-$e.output.length),$e.type="star",$e.value="*",$e.output=St,xe.output+=$e.output)}if(Dt.length&&ft.type!=="paren"&&(Dt[Dt.length-1].inner+=ft.value),(ft.value||ft.output)&&er(ft),$e&&$e.type==="text"&&ft.type==="text"){$e.value+=ft.value,$e.output=($e.output||"")+ft.value;return}ft.prev=$e,Ee.push(ft),$e=ft},"push"),qt=s((ft,Pt)=>{const et={...$[Pt],conditions:1,inner:""};et.prev=$e,et.parens=xe.parens,et.output=xe.output;const Ot=(ue.capture?"(":"")+et.open;mr("parens"),Rt({type:ft,value:Pt,output:xe.output?"":ge}),Rt({type:"paren",extglob:!0,value:Ut(),output:Ot}),Dt.push(et)},"extglobOpen"),ht=s(ft=>{let Pt=ft.close+(ue.capture?")":""),et;if(ft.type==="negate"){let Ot=St;ft.inner&&ft.inner.length>1&&ft.inner.includes("/")&&(Ot=ze(ue)),(Ot!==St||mt()||/^\)+$/.test(gr()))&&(Pt=ft.close=`)$))${Ot}`),ft.inner.includes("*")&&(et=gr())&&/^\.[^\\/.]+$/.test(et)&&(Pt=ft.close=`)${et})${Ot})`),ft.prev.type==="bos"&&(xe.negatedExtglob=!0)}Rt({type:"paren",extglob:!0,value:Me,output:Pt}),Nr("parens")},"extglobClose");if(ue.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(me)){let ft=!1,Pt=me.replace(de,(et,Ot,wt,Er,Gt,$r)=>Er==="\\"?(ft=!0,et):Er==="?"?Ot?Ot+Er+(Gt?ye.repeat(Gt.length):""):$r===0?Le+(Gt?ye.repeat(Gt.length):""):ye.repeat(wt.length):Er==="."?Te.repeat(wt.length):Er==="*"?Ot?Ot+Er+(Gt?St:""):St:Ot?et:`\\${et}`);return ft===!0&&(ue.unescape===!0?Pt=Pt.replace(/\\/g,""):Pt=Pt.replace(/\\+/g,et=>et.length%2==0?"\\\\":et?"\\":"")),Pt===me&&ue.contains===!0?(xe.output=me,xe):(xe.output=j.wrapOutput(Pt,xe,L),xe)}for(;!mt();){if(Me=Ut(),Me==="\0")continue;if(Me==="\\"){const et=Tt();if(et==="/"&&ue.bash!==!0||et==="."||et===";")continue;if(!et){Me+="\\",Rt({type:"text",value:Me});continue}const Ot=/^\\+/.exec(gr());let wt=0;if(Ot&&Ot[0].length>2&&(wt=Ot[0].length,xe.index+=wt,wt%2!=0&&(Me+="\\")),ue.unescape===!0?Me=Ut():Me+=Ut(),xe.brackets===0){Rt({type:"text",value:Me});continue}}if(xe.brackets>0&&(Me!=="]"||$e.value==="["||$e.value==="[^")){if(ue.posix!==!1&&Me===":"){const et=$e.value.slice(1);if(et.includes("[")&&($e.posix=!0,et.includes(":"))){const Ot=$e.value.lastIndexOf("["),wt=$e.value.slice(0,Ot),Er=$e.value.slice(Ot+2),Gt=pe[Er];if(Gt){$e.value=wt+Gt,xe.backtrack=!0,Ut(),!We.output&&Ee.indexOf($e)===1&&(We.output=ge);continue}}}(Me==="["&&Tt()!==":"||Me==="-"&&Tt()==="]")&&(Me=`\\${Me}`),Me==="]"&&($e.value==="["||$e.value==="[^")&&(Me=`\\${Me}`),ue.posix===!0&&Me==="!"&&$e.value==="["&&(Me="^"),$e.value+=Me,er({value:Me});continue}if(xe.quotes===1&&Me!=='"'){Me=j.escapeRegex(Me),$e.value+=Me,er({value:Me});continue}if(Me==='"'){xe.quotes=xe.quotes===1?0:1,ue.keepQuotes===!0&&Rt({type:"text",value:Me});continue}if(Me==="("){mr("parens"),Rt({type:"paren",value:Me});continue}if(Me===")"){if(xe.parens===0&&ue.strictBrackets===!0)throw new SyntaxError(F("opening","("));const et=Dt[Dt.length-1];if(et&&xe.parens===et.parens+1){ht(Dt.pop());continue}Rt({type:"paren",value:Me,output:xe.parens?")":"\\)"}),Nr("parens");continue}if(Me==="["){if(ue.nobracket===!0||!gr().includes("]")){if(ue.nobracket!==!0&&ue.strictBrackets===!0)throw new SyntaxError(F("closing","]"));Me=`\\${Me}`}else mr("brackets");Rt({type:"bracket",value:Me});continue}if(Me==="]"){if(ue.nobracket===!0||$e&&$e.type==="bracket"&&$e.value.length===1){Rt({type:"text",value:Me,output:`\\${Me}`});continue}if(xe.brackets===0){if(ue.strictBrackets===!0)throw new SyntaxError(F("opening","["));Rt({type:"text",value:Me,output:`\\${Me}`});continue}Nr("brackets");const et=$e.value.slice(1);if($e.posix!==!0&&et[0]==="^"&&!et.includes("/")&&(Me=`/${Me}`),$e.value+=Me,er({value:Me}),ue.literalBrackets===!1||j.hasRegexChars(et))continue;const Ot=j.escapeRegex($e.value);if(xe.output=xe.output.slice(0,-$e.value.length),ue.literalBrackets===!0){xe.output+=Ot,$e.value=Ot;continue}$e.value=`(${Ce}${Ot}|${$e.value})`,xe.output+=$e.value;continue}if(Me==="{"&&ue.nobrace!==!0){mr("braces");const et={type:"brace",value:Me,output:"(",outputIndex:xe.output.length,tokensIndex:xe.tokens.length};ct.push(et),Rt(et);continue}if(Me==="}"){const et=ct[ct.length-1];if(ue.nobrace===!0||!et){Rt({type:"text",value:Me,output:Me});continue}let Ot=")";if(et.dots===!0){const wt=Ee.slice(),Er=[];for(let Gt=wt.length-1;Gt>=0&&(Ee.pop(),wt[Gt].type!=="brace");Gt--)wt[Gt].type!=="dots"&&Er.unshift(wt[Gt].value);Ot=q(Er,ue),xe.backtrack=!0}if(et.comma!==!0&&et.dots!==!0){const wt=xe.output.slice(0,et.outputIndex),Er=xe.tokens.slice(et.tokensIndex);et.value=et.output="\\{",Me=Ot="\\}",xe.output=wt;for(const Gt of Er)xe.output+=Gt.output||Gt.value}Rt({type:"brace",value:Me,output:Ot}),Nr("braces"),ct.pop();continue}if(Me==="|"){Dt.length>0&&Dt[Dt.length-1].conditions++,Rt({type:"text",value:Me});continue}if(Me===","){let et=Me;const Ot=ct[ct.length-1];Ot&&It[It.length-1]==="braces"&&(Ot.comma=!0,et="|"),Rt({type:"comma",value:Me,output:et});continue}if(Me==="/"){if($e.type==="dot"&&xe.index===xe.start+1){xe.start=xe.index+1,xe.consumed="",xe.output="",Ee.pop(),$e=We;continue}Rt({type:"slash",value:Me,output:ce});continue}if(Me==="."){if(xe.braces>0&&$e.type==="dot"){$e.value==="."&&($e.output=Te);const et=ct[ct.length-1];$e.type="dots",$e.output+=Me,$e.value+=Me,et.dots=!0;continue}if(xe.braces+xe.parens===0&&$e.type!=="bos"&&$e.type!=="slash"){Rt({type:"text",value:Me,output:Te});continue}Rt({type:"dot",value:Me,output:Te});continue}if(Me==="?"){if(!($e&&$e.value==="(")&&ue.noextglob!==!0&&Tt()==="("&&Tt(2)!=="?"){qt("qmark",Me);continue}if($e&&$e.type==="paren"){const Ot=Tt();let wt=Me;if(Ot==="<"&&!j.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");($e.value==="("&&!/[!=<:]/.test(Ot)||Ot==="<"&&!/<([!=]|\w+>)/.test(gr()))&&(wt=`\\${Me}`),Rt({type:"text",value:Me,output:wt});continue}if(ue.dot!==!0&&($e.type==="slash"||$e.type==="bos")){Rt({type:"qmark",value:Me,output:Be});continue}Rt({type:"qmark",value:Me,output:ye});continue}if(Me==="!"){if(ue.noextglob!==!0&&Tt()==="("&&(Tt(2)!=="?"||!/[!=<:]/.test(Tt(3)))){qt("negate",Me);continue}if(ue.nonegate!==!0&&xe.index===0){pi();continue}}if(Me==="+"){if(ue.noextglob!==!0&&Tt()==="("&&Tt(2)!=="?"){qt("plus",Me);continue}if($e&&$e.value==="("||ue.regex===!1){Rt({type:"plus",value:Me,output:ne});continue}if($e&&($e.type==="bracket"||$e.type==="paren"||$e.type==="brace")||xe.parens>0){Rt({type:"plus",value:Me});continue}Rt({type:"plus",value:ne});continue}if(Me==="@"){if(ue.noextglob!==!0&&Tt()==="("&&Tt(2)!=="?"){Rt({type:"at",extglob:!0,value:Me,output:""});continue}Rt({type:"text",value:Me});continue}if(Me!=="*"){(Me==="$"||Me==="^")&&(Me=`\\${Me}`);const et=se.exec(gr());et&&(Me+=et[0],xe.index+=et[0].length),Rt({type:"text",value:Me});continue}if($e&&($e.type==="globstar"||$e.star===!0)){$e.type="star",$e.star=!0,$e.value+=Me,$e.output=St,xe.backtrack=!0,xe.globstar=!0,Jt(Me);continue}let ft=gr();if(ue.noextglob!==!0&&/^\([^?]/.test(ft)){qt("star",Me);continue}if($e.type==="star"){if(ue.noglobstar===!0){Jt(Me);continue}const et=$e.prev,Ot=et.prev,wt=et.type==="slash"||et.type==="bos",Er=Ot&&(Ot.type==="star"||Ot.type==="globstar");if(ue.bash===!0&&(!wt||ft[0]&&ft[0]!=="/")){Rt({type:"star",value:Me,output:""});continue}const Gt=xe.braces>0&&(et.type==="comma"||et.type==="brace"),$r=Dt.length&&(et.type==="pipe"||et.type==="paren");if(!wt&&et.type!=="paren"&&!Gt&&!$r){Rt({type:"star",value:Me,output:""});continue}for(;ft.slice(0,3)==="/**";){const Yn=me[xe.index+4];if(Yn&&Yn!=="/")break;ft=ft.slice(3),Jt("/**",3)}if(et.type==="bos"&&mt()){$e.type="globstar",$e.value+=Me,$e.output=ze(ue),xe.output=$e.output,xe.globstar=!0,Jt(Me);continue}if(et.type==="slash"&&et.prev.type!=="bos"&&!Er&&mt()){xe.output=xe.output.slice(0,-(et.output+$e.output).length),et.output=`(?:${et.output}`,$e.type="globstar",$e.output=ze(ue)+(ue.strictSlashes?")":"|$)"),$e.value+=Me,xe.globstar=!0,xe.output+=et.output+$e.output,Jt(Me);continue}if(et.type==="slash"&&et.prev.type!=="bos"&&ft[0]==="/"){const Yn=ft[1]!==void 0?"|$":"";xe.output=xe.output.slice(0,-(et.output+$e.output).length),et.output=`(?:${et.output}`,$e.type="globstar",$e.output=`${ze(ue)}${ce}|${ce}${Yn})`,$e.value+=Me,xe.output+=et.output+$e.output,xe.globstar=!0,Jt(Me+Ut()),Rt({type:"slash",value:"/",output:""});continue}if(et.type==="bos"&&ft[0]==="/"){$e.type="globstar",$e.value+=Me,$e.output=`(?:^|${ce}|${ze(ue)}${ce})`,xe.output=$e.output,xe.globstar=!0,Jt(Me+Ut()),Rt({type:"slash",value:"/",output:""});continue}xe.output=xe.output.slice(0,-$e.output.length),$e.type="globstar",$e.output=ze(ue),$e.value+=Me,xe.output+=$e.output,xe.globstar=!0,Jt(Me);continue}const Pt={type:"star",value:Me,output:St};if(ue.bash===!0){Pt.output=".*?",($e.type==="bos"||$e.type==="slash")&&(Pt.output=Ze+Pt.output),Rt(Pt);continue}if($e&&($e.type==="bracket"||$e.type==="paren")&&ue.regex===!0){Pt.output=Me,Rt(Pt);continue}(xe.index===xe.start||$e.type==="slash"||$e.type==="dot")&&($e.type==="dot"?(xe.output+=Ge,$e.output+=Ge):ue.dot===!0?(xe.output+=tt,$e.output+=tt):(xe.output+=Ze,$e.output+=Ze),Tt()!=="*"&&(xe.output+=ge,$e.output+=ge)),Rt(Pt)}for(;xe.brackets>0;){if(ue.strictBrackets===!0)throw new SyntaxError(F("closing","]"));xe.output=j.escapeLast(xe.output,"["),Nr("brackets")}for(;xe.parens>0;){if(ue.strictBrackets===!0)throw new SyntaxError(F("closing",")"));xe.output=j.escapeLast(xe.output,"("),Nr("parens")}for(;xe.braces>0;){if(ue.strictBrackets===!0)throw new SyntaxError(F("closing","}"));xe.output=j.escapeLast(xe.output,"{"),Nr("braces")}if(ue.strictSlashes!==!0&&($e.type==="star"||$e.type==="bracket")&&Rt({type:"maybe_slash",value:"",output:`${ce}?`}),xe.backtrack===!0){xe.output="";for(const ft of xe.tokens)xe.output+=ft.output!=null?ft.output:ft.value,ft.suffix&&(xe.output+=ft.suffix)}return xe},"parse");G.fastpaths=(me,L)=>{const ue={...L},Ne=typeof ue.maxLength=="number"?Math.min(ie,ue.maxLength):ie,nt=me.length;if(nt>Ne)throw new SyntaxError(`Input length: ${nt}, exceeds maximum allowed length: ${Ne}`);me=W[me]||me;const We=j.isWindows(L),{DOT_LITERAL:Ee,SLASH_LITERAL:Ce,ONE_CHAR:Se,DOTS_SLASH:le,NO_DOT:$,NO_DOTS:Te,NO_DOTS_SLASH:ne,STAR:ce,START_ANCHOR:ge}=Q.globChars(We),we=ue.dot?Te:$,He=ue.dot?ne:$,Ge=ue.capture?"":"?:",tt={negated:!1,prefix:""};let ye=ue.bash===!0?".*?":ce;ue.capture&&(ye=`(${ye})`);const Be=s(Ze=>Ze.noglobstar===!0?ye:`(${Ge}(?:(?!${ge}${Ze.dot?le:Ee}).)*?)`,"globstar"),Ke=s(Ze=>{switch(Ze){case"*":return`${we}${Se}${ye}`;case".*":return`${Ee}${Se}${ye}`;case"*.*":return`${we}${ye}${Ee}${Se}${ye}`;case"*/*":return`${we}${ye}${Ce}${Se}${He}${ye}`;case"**":return we+Be(ue);case"**/*":return`(?:${we}${Be(ue)}${Ce})?${He}${Se}${ye}`;case"**/*.*":return`(?:${we}${Be(ue)}${Ce})?${He}${ye}${Ee}${Se}${ye}`;case"**/.*":return`(?:${we}${Be(ue)}${Ce})?${Ee}${Se}${ye}`;default:{const Le=/^(.*?)\.(\w+)$/.exec(Ze);if(!Le)return;const St=Ke(Le[1]);return St?St+Ee+Le[2]:void 0}}},"create"),Xe=j.removePrefix(me,tt);let ze=Ke(Xe);return ze&&ue.strictSlashes!==!0&&(ze+=`${Ce}?`),ze},ae.exports=G},6087:(ae,h,V)=>{"use strict";const Q=V(1017),j=V(3921),ie=V(3376),pe=V(8702),se=V(1006),de=s(q=>q&&typeof q=="object"&&!Array.isArray(q),"isObject"),W=s((q,F,G=!1)=>{if(Array.isArray(q)){const Ce=q.map(le=>W(le,F,G));return s(le=>{for(const $ of Ce){const Te=$(le);if(Te)return Te}return!1},"arrayMatcher")}const me=de(q)&&q.tokens&&q.input;if(q===""||typeof q!="string"&&!me)throw new TypeError("Expected pattern to be a non-empty string");const L=F||{},ue=pe.isWindows(F),Ne=me?W.compileRe(q,F):W.makeRe(q,F,!1,!0),nt=Ne.state;delete Ne.state;let We=s(()=>!1,"isIgnored");if(L.ignore){const Ce={...F,ignore:null,onMatch:null,onResult:null};We=W(L.ignore,Ce,G)}const Ee=s((Ce,Se=!1)=>{const{isMatch:le,match:$,output:Te}=W.test(Ce,Ne,F,{glob:q,posix:ue}),ne={glob:q,state:nt,regex:Ne,posix:ue,input:Ce,output:Te,match:$,isMatch:le};return typeof L.onResult=="function"&&L.onResult(ne),le===!1?(ne.isMatch=!1,Se?ne:!1):We(Ce)?(typeof L.onIgnore=="function"&&L.onIgnore(ne),ne.isMatch=!1,Se?ne:!1):(typeof L.onMatch=="function"&&L.onMatch(ne),Se?ne:!0)},"matcher");return G&&(Ee.state=nt),Ee},"picomatch");W.test=(q,F,G,{glob:me,posix:L}={})=>{if(typeof q!="string")throw new TypeError("Expected input to be a string");if(q==="")return{isMatch:!1,output:""};const ue=G||{},Ne=ue.format||(L?pe.toPosixSlashes:null);let nt=q===me,We=nt&&Ne?Ne(q):q;return nt===!1&&(We=Ne?Ne(q):q,nt=We===me),(nt===!1||ue.capture===!0)&&(ue.matchBase===!0||ue.basename===!0?nt=W.matchBase(q,F,G,L):nt=F.exec(We)),{isMatch:Boolean(nt),match:nt,output:We}},W.matchBase=(q,F,G,me=pe.isWindows(G))=>(F instanceof RegExp?F:W.makeRe(F,G)).test(Q.basename(q)),W.isMatch=(q,F,G)=>W(F,G)(q),W.parse=(q,F)=>Array.isArray(q)?q.map(G=>W.parse(G,F)):ie(q,{...F,fastpaths:!1}),W.scan=(q,F)=>j(q,F),W.compileRe=(q,F,G=!1,me=!1)=>{if(G===!0)return q.output;const L=F||{},ue=L.contains?"":"^",Ne=L.contains?"":"$";let nt=`${ue}(?:${q.output})${Ne}`;q&&q.negated===!0&&(nt=`^(?!${nt}).*$`);const We=W.toRegex(nt,F);return me===!0&&(We.state=q),We},W.makeRe=(q,F={},G=!1,me=!1)=>{if(!q||typeof q!="string")throw new TypeError("Expected a non-empty string");let L={negated:!1,fastpaths:!0};return F.fastpaths!==!1&&(q[0]==="."||q[0]==="*")&&(L.output=ie.fastpaths(q,F)),L.output||(L=ie(q,F)),W.compileRe(L,F,G,me)},W.toRegex=(q,F)=>{try{const G=F||{};return new RegExp(q,G.flags||(G.nocase?"i":""))}catch(G){if(F&&F.debug===!0)throw G;return/$^/}},W.constants=se,ae.exports=W},3921:(ae,h,V)=>{"use strict";const Q=V(8702),{CHAR_ASTERISK:j,CHAR_AT:ie,CHAR_BACKWARD_SLASH:pe,CHAR_COMMA:se,CHAR_DOT:de,CHAR_EXCLAMATION_MARK:W,CHAR_FORWARD_SLASH:q,CHAR_LEFT_CURLY_BRACE:F,CHAR_LEFT_PARENTHESES:G,CHAR_LEFT_SQUARE_BRACKET:me,CHAR_PLUS:L,CHAR_QUESTION_MARK:ue,CHAR_RIGHT_CURLY_BRACE:Ne,CHAR_RIGHT_PARENTHESES:nt,CHAR_RIGHT_SQUARE_BRACKET:We}=V(1006),Ee=s(le=>le===q||le===pe,"isPathSeparator"),Ce=s(le=>{le.isPrefix!==!0&&(le.depth=le.isGlobstar?1/0:1)},"depth"),Se=s((le,$)=>{const Te=$||{},ne=le.length-1,ce=Te.parts===!0||Te.scanToEnd===!0,ge=[],we=[],He=[];let Ge=le,tt=-1,ye=0,Be=0,Ke=!1,Xe=!1,ze=!1,Ze=!1,Le=!1,St=!1,xe=!1,Dt=!1,ct=!1,It=!1,$e=0,Me,mt,Tt={value:"",depth:0,isGlob:!1};const Ut=s(()=>tt>=ne,"eos"),gr=s(()=>Ge.charCodeAt(tt+1),"peek"),Jt=s(()=>(Me=mt,Ge.charCodeAt(++tt)),"advance");for(;tt<ne;){mt=Jt();let Rt;if(mt===pe){xe=Tt.backslashes=!0,mt=Jt(),mt===F&&(St=!0);continue}if(St===!0||mt===F){for($e++;Ut()!==!0&&(mt=Jt());){if(mt===pe){xe=Tt.backslashes=!0,Jt();continue}if(mt===F){$e++;continue}if(St!==!0&&mt===de&&(mt=Jt())===de){if(Ke=Tt.isBrace=!0,ze=Tt.isGlob=!0,It=!0,ce===!0)continue;break}if(St!==!0&&mt===se){if(Ke=Tt.isBrace=!0,ze=Tt.isGlob=!0,It=!0,ce===!0)continue;break}if(mt===Ne&&($e--,$e===0)){St=!1,Ke=Tt.isBrace=!0,It=!0;break}}if(ce===!0)continue;break}if(mt===q){if(ge.push(tt),we.push(Tt),Tt={value:"",depth:0,isGlob:!1},It===!0)continue;if(Me===de&&tt===ye+1){ye+=2;continue}Be=tt+1;continue}if(Te.noext!==!0&&(mt===L||mt===ie||mt===j||mt===ue||mt===W)===!0&&gr()===G){if(ze=Tt.isGlob=!0,Ze=Tt.isExtglob=!0,It=!0,mt===W&&tt===ye&&(ct=!0),ce===!0){for(;Ut()!==!0&&(mt=Jt());){if(mt===pe){xe=Tt.backslashes=!0,mt=Jt();continue}if(mt===nt){ze=Tt.isGlob=!0,It=!0;break}}continue}break}if(mt===j){if(Me===j&&(Le=Tt.isGlobstar=!0),ze=Tt.isGlob=!0,It=!0,ce===!0)continue;break}if(mt===ue){if(ze=Tt.isGlob=!0,It=!0,ce===!0)continue;break}if(mt===me){for(;Ut()!==!0&&(Rt=Jt());){if(Rt===pe){xe=Tt.backslashes=!0,Jt();continue}if(Rt===We){Xe=Tt.isBracket=!0,ze=Tt.isGlob=!0,It=!0;break}}if(ce===!0)continue;break}if(Te.nonegate!==!0&&mt===W&&tt===ye){Dt=Tt.negated=!0,ye++;continue}if(Te.noparen!==!0&&mt===G){if(ze=Tt.isGlob=!0,ce===!0){for(;Ut()!==!0&&(mt=Jt());){if(mt===G){xe=Tt.backslashes=!0,mt=Jt();continue}if(mt===nt){It=!0;break}}continue}break}if(ze===!0){if(It=!0,ce===!0)continue;break}}Te.noext===!0&&(Ze=!1,ze=!1);let er=Ge,pi="",mr="";ye>0&&(pi=Ge.slice(0,ye),Ge=Ge.slice(ye),Be-=ye),er&&ze===!0&&Be>0?(er=Ge.slice(0,Be),mr=Ge.slice(Be)):ze===!0?(er="",mr=Ge):er=Ge,er&&er!==""&&er!=="/"&&er!==Ge&&Ee(er.charCodeAt(er.length-1))&&(er=er.slice(0,-1)),Te.unescape===!0&&(mr&&(mr=Q.removeBackslashes(mr)),er&&xe===!0&&(er=Q.removeBackslashes(er)));const Nr={prefix:pi,input:le,start:ye,base:er,glob:mr,isBrace:Ke,isBracket:Xe,isGlob:ze,isExtglob:Ze,isGlobstar:Le,negated:Dt,negatedExtglob:ct};if(Te.tokens===!0&&(Nr.maxDepth=0,Ee(mt)||we.push(Tt),Nr.tokens=we),Te.parts===!0||Te.tokens===!0){let Rt;for(let qt=0;qt<ge.length;qt++){const ht=Rt?Rt+1:ye,ft=ge[qt],Pt=le.slice(ht,ft);Te.tokens&&(qt===0&&ye!==0?(we[qt].isPrefix=!0,we[qt].value=pi):we[qt].value=Pt,Ce(we[qt]),Nr.maxDepth+=we[qt].depth),(qt!==0||Pt!=="")&&He.push(Pt),Rt=ft}if(Rt&&Rt+1<le.length){const qt=le.slice(Rt+1);He.push(qt),Te.tokens&&(we[we.length-1].value=qt,Ce(we[we.length-1]),Nr.maxDepth+=we[we.length-1].depth)}Nr.slashes=ge,Nr.parts=He}return Nr},"scan");ae.exports=Se},8702:(ae,h,V)=>{"use strict";const Q=V(1017),j=process.platform==="win32",{REGEX_BACKSLASH:ie,REGEX_REMOVE_BACKSLASH:pe,REGEX_SPECIAL_CHARS:se,REGEX_SPECIAL_CHARS_GLOBAL:de}=V(1006);h.isObject=W=>W!==null&&typeof W=="object"&&!Array.isArray(W),h.hasRegexChars=W=>se.test(W),h.isRegexChar=W=>W.length===1&&h.hasRegexChars(W),h.escapeRegex=W=>W.replace(de,"\\$1"),h.toPosixSlashes=W=>W.replace(ie,"/"),h.removeBackslashes=W=>W.replace(pe,q=>q==="\\"?"":q),h.supportsLookbehinds=()=>{const W=process.version.slice(1).split(".").map(Number);return W.length===3&&W[0]>=9||W[0]===8&&W[1]>=10},h.isWindows=W=>W&&typeof W.windows=="boolean"?W.windows:j===!0||Q.sep==="\\",h.escapeLast=(W,q,F)=>{const G=W.lastIndexOf(q,F);return G===-1?W:W[G-1]==="\\"?h.escapeLast(W,q,G-1):`${W.slice(0,G)}\\${W.slice(G)}`},h.removePrefix=(W,q={})=>{let F=W;return F.startsWith("./")&&(F=F.slice(2),q.prefix="./"),F},h.wrapOutput=(W,q={},F={})=>{const G=F.contains?"":"^",me=F.contains?"":"$";let L=`${G}(?:${W})${me}`;return q.negated===!0&&(L=`(?:^(?!${L}).*$)`),L}},842:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.AbstractTokenizer=void 0;const Q=V(5167);class j{constructor(pe){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=pe||{}}async readToken(pe,se=this.position){const de=Buffer.alloc(pe.len);if(await this.readBuffer(de,{position:se})<pe.len)throw new Q.EndOfStreamError;return pe.get(de,0)}async peekToken(pe,se=this.position){const de=Buffer.alloc(pe.len);if(await this.peekBuffer(de,{position:se})<pe.len)throw new Q.EndOfStreamError;return pe.get(de,0)}async readNumber(pe){if(await this.readBuffer(this.numBuffer,{length:pe.len})<pe.len)throw new Q.EndOfStreamError;return pe.get(this.numBuffer,0)}async peekNumber(pe){if(await this.peekBuffer(this.numBuffer,{length:pe.len})<pe.len)throw new Q.EndOfStreamError;return pe.get(this.numBuffer,0)}async ignore(pe){if(this.fileInfo.size!==void 0){const se=this.fileInfo.size-this.position;if(pe>se)return this.position+=se,se}return this.position+=pe,pe}async close(){}normalizeOptions(pe,se){if(se&&se.position!==void 0&&se.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return se?{mayBeLess:se.mayBeLess===!0,offset:se.offset?se.offset:0,length:se.length?se.length:pe.length-(se.offset?se.offset:0),position:se.position?se.position:this.position}:{mayBeLess:!1,offset:0,length:pe.length,position:this.position}}}s(j,"AbstractTokenizer"),h.AbstractTokenizer=j},778:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.BufferTokenizer=void 0;const Q=V(5167),j=V(842);class ie extends j.AbstractTokenizer{constructor(se,de){super(de);this.uint8Array=se,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:se.length}async readBuffer(se,de){if(de&&de.position){if(de.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=de.position}const W=await this.peekBuffer(se,de);return this.position+=W,W}async peekBuffer(se,de){const W=this.normalizeOptions(se,de),q=Math.min(this.uint8Array.length-W.position,W.length);if(!W.mayBeLess&&q<W.length)throw new Q.EndOfStreamError;return se.set(this.uint8Array.subarray(W.position,W.position+q),W.offset),q}async close(){}}s(ie,"BufferTokenizer"),h.BufferTokenizer=ie},7859:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromFile=h.FileTokenizer=void 0;const Q=V(842),j=V(5167),ie=V(7209);class pe extends Q.AbstractTokenizer{constructor(W,q){super(q);this.fd=W}async readBuffer(W,q){const F=this.normalizeOptions(W,q);this.position=F.position;const G=await ie.read(this.fd,W,F.offset,F.length,F.position);if(this.position+=G.bytesRead,G.bytesRead<F.length&&(!q||!q.mayBeLess))throw new j.EndOfStreamError;return G.bytesRead}async peekBuffer(W,q){const F=this.normalizeOptions(W,q),G=await ie.read(this.fd,W,F.offset,F.length,F.position);if(!F.mayBeLess&&G.bytesRead<F.length)throw new j.EndOfStreamError;return G.bytesRead}async close(){return ie.close(this.fd)}}s(pe,"FileTokenizer"),h.FileTokenizer=pe;async function se(de){const W=await ie.stat(de);if(!W.isFile)throw new Error(`File not a file: ${de}`);const q=await ie.open(de,"r");return new pe(q,{path:de,size:W.size})}s(se,"fromFile"),h.fromFile=se},7209:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.readFile=h.writeFileSync=h.writeFile=h.read=h.open=h.close=h.stat=h.createReadStream=h.pathExists=void 0;const Q=V(7147);h.pathExists=Q.existsSync,h.createReadStream=Q.createReadStream;async function j(F){return new Promise((G,me)=>{Q.stat(F,(L,ue)=>{L?me(L):G(ue)})})}s(j,"stat"),h.stat=j;async function ie(F){return new Promise((G,me)=>{Q.close(F,L=>{L?me(L):G()})})}s(ie,"close"),h.close=ie;async function pe(F,G){return new Promise((me,L)=>{Q.open(F,G,(ue,Ne)=>{ue?L(ue):me(Ne)})})}s(pe,"open"),h.open=pe;async function se(F,G,me,L,ue){return new Promise((Ne,nt)=>{Q.read(F,G,me,L,ue,(We,Ee,Ce)=>{We?nt(We):Ne({bytesRead:Ee,buffer:Ce})})})}s(se,"read"),h.read=se;async function de(F,G){return new Promise((me,L)=>{Q.writeFile(F,G,ue=>{ue?L(ue):me()})})}s(de,"writeFile"),h.writeFile=de;function W(F,G){Q.writeFileSync(F,G)}s(W,"writeFileSync"),h.writeFileSync=W;async function q(F){return new Promise((G,me)=>{Q.readFile(F,(L,ue)=>{L?me(L):G(ue)})})}s(q,"readFile"),h.readFile=q},599:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ReadStreamTokenizer=void 0;const Q=V(842),j=V(5167),ie=256e3;class pe extends Q.AbstractTokenizer{constructor(de,W){super(W);this.streamReader=new j.StreamReader(de)}async getFileInfo(){return this.fileInfo}async readBuffer(de,W){const q=this.normalizeOptions(de,W),F=q.position-this.position;if(F>0)return await this.ignore(F),this.readBuffer(de,W);if(F<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(q.length===0)return 0;const G=await this.streamReader.read(de,q.offset,q.length);if(this.position+=G,(!W||!W.mayBeLess)&&G<q.length)throw new j.EndOfStreamError;return G}async peekBuffer(de,W){const q=this.normalizeOptions(de,W);let F=0;if(q.position){const G=q.position-this.position;if(G>0){const me=new Uint8Array(q.length+G);return F=await this.peekBuffer(me,{mayBeLess:q.mayBeLess}),de.set(me.subarray(G),q.offset),F-G}else if(G<0)throw new Error("Cannot peek from a negative offset in a stream")}if(q.length>0){try{F=await this.streamReader.peek(de,q.offset,q.length)}catch(G){if(W&&W.mayBeLess&&G instanceof j.EndOfStreamError)return 0;throw G}if(!q.mayBeLess&&F<q.length)throw new j.EndOfStreamError}return F}async ignore(de){const W=Math.min(ie,de),q=new Uint8Array(W);let F=0;for(;F<de;){const G=de-F,me=await this.readBuffer(q,{length:Math.min(W,G)});if(me<0)return me;F+=me}return F}}s(pe,"ReadStreamTokenizer"),h.ReadStreamTokenizer=pe},5849:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromBuffer=h.fromStream=h.EndOfStreamError=void 0;const Q=V(599),j=V(778);var ie=V(5167);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return ie.EndOfStreamError}});function pe(de,W){return W=W||{},new Q.ReadStreamTokenizer(de,W)}s(pe,"fromStream"),h.fromStream=pe;function se(de,W){return new j.BufferTokenizer(de,W)}s(se,"fromBuffer"),h.fromBuffer=se},6597:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromStream=h.fromBuffer=h.EndOfStreamError=h.fromFile=void 0;const Q=V(7209),j=V(5849);var ie=V(7859);Object.defineProperty(h,"fromFile",{enumerable:!0,get:function(){return ie.fromFile}});var pe=V(5849);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return pe.EndOfStreamError}}),Object.defineProperty(h,"fromBuffer",{enumerable:!0,get:function(){return pe.fromBuffer}});async function se(de,W){if(W=W||{},de.path){const q=await Q.stat(de.path);W.path=de.path,W.size=q.size}return j.fromStream(de,W)}s(se,"fromStream"),h.fromStream=se},5702:(ae,h,V)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const Q=V(9924),j=s((Ee,Ce,Se)=>{if(Q(Ee)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(Ce===void 0||Ee===Ce)return String(Ee);if(Q(Ce)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let le={relaxZeros:!0,...Se};typeof le.strictZeros=="boolean"&&(le.relaxZeros=le.strictZeros===!1);let $=String(le.relaxZeros),Te=String(le.shorthand),ne=String(le.capture),ce=String(le.wrap),ge=Ee+":"+Ce+"="+$+Te+ne+ce;if(j.cache.hasOwnProperty(ge))return j.cache[ge].result;let we=Math.min(Ee,Ce),He=Math.max(Ee,Ce);if(Math.abs(we-He)===1){let Ke=Ee+"|"+Ce;return le.capture?`(${Ke})`:le.wrap===!1?Ke:`(?:${Ke})`}let Ge=nt(Ee)||nt(Ce),tt={min:Ee,max:Ce,a:we,b:He},ye=[],Be=[];if(Ge&&(tt.isPadded=Ge,tt.maxLen=String(tt.max).length),we<0){let Ke=He<0?Math.abs(He):1;Be=de(Ke,Math.abs(we),tt,le),we=tt.a=0}return He>=0&&(ye=de(we,He,tt,le)),tt.negatives=Be,tt.positives=ye,tt.result=ie(Be,ye,le),le.capture===!0?tt.result=`(${tt.result})`:le.wrap!==!1&&ye.length+Be.length>1&&(tt.result=`(?:${tt.result})`),j.cache[ge]=tt,tt.result},"toRegexRange");function ie(Ee,Ce,Se){let le=W(Ee,Ce,"-",!1,Se)||[],$=W(Ce,Ee,"",!1,Se)||[],Te=W(Ee,Ce,"-?",!0,Se)||[];return le.concat(Te).concat($).join("|")}s(ie,"collatePatterns");function pe(Ee,Ce){let Se=1,le=1,$=me(Ee,Se),Te=new Set([Ce]);for(;Ee<=$&&$<=Ce;)Te.add($),Se+=1,$=me(Ee,Se);for($=L(Ce+1,le)-1;Ee<$&&$<=Ce;)Te.add($),le+=1,$=L(Ce+1,le)-1;return Te=[...Te],Te.sort(F),Te}s(pe,"splitToRanges");function se(Ee,Ce,Se){if(Ee===Ce)return{pattern:Ee,count:[],digits:0};let le=q(Ee,Ce),$=le.length,Te="",ne=0;for(let ce=0;ce<$;ce++){let[ge,we]=le[ce];ge===we?Te+=ge:ge!=="0"||we!=="9"?Te+=Ne(ge,we,Se):ne++}return ne&&(Te+=Se.shorthand===!0?"\\d":"[0-9]"),{pattern:Te,count:[ne],digits:$}}s(se,"rangeToPattern");function de(Ee,Ce,Se,le){let $=pe(Ee,Ce),Te=[],ne=Ee,ce;for(let ge=0;ge<$.length;ge++){let we=$[ge],He=se(String(ne),String(we),le),Ge="";if(!Se.isPadded&&ce&&ce.pattern===He.pattern){ce.count.length>1&&ce.count.pop(),ce.count.push(He.count[0]),ce.string=ce.pattern+ue(ce.count),ne=we+1;continue}Se.isPadded&&(Ge=We(we,Se,le)),He.string=Ge+He.pattern+ue(He.count),Te.push(He),ne=we+1,ce=He}return Te}s(de,"splitToPatterns");function W(Ee,Ce,Se,le,$){let Te=[];for(let ne of Ee){let{string:ce}=ne;!le&&!G(Ce,"string",ce)&&Te.push(Se+ce),le&&G(Ce,"string",ce)&&Te.push(Se+ce)}return Te}s(W,"filterPatterns");function q(Ee,Ce){let Se=[];for(let le=0;le<Ee.length;le++)Se.push([Ee[le],Ce[le]]);return Se}s(q,"zip");function F(Ee,Ce){return Ee>Ce?1:Ce>Ee?-1:0}s(F,"compare");function G(Ee,Ce,Se){return Ee.some(le=>le[Ce]===Se)}s(G,"contains");function me(Ee,Ce){return Number(String(Ee).slice(0,-Ce)+"9".repeat(Ce))}s(me,"countNines");function L(Ee,Ce){return Ee-Ee%Math.pow(10,Ce)}s(L,"countZeros");function ue(Ee){let[Ce=0,Se=""]=Ee;return Se||Ce>1?`{${Ce+(Se?","+Se:"")}}`:""}s(ue,"toQuantifier");function Ne(Ee,Ce,Se){return`[${Ee}${Ce-Ee==1?"":"-"}${Ce}]`}s(Ne,"toCharacterClass");function nt(Ee){return/^-?(0+)\d/.test(Ee)}s(nt,"hasPadding");function We(Ee,Ce,Se){if(!Ce.isPadded)return Ee;let le=Math.abs(Ce.maxLen-String(Ee).length),$=Se.relaxZeros!==!1;switch(le){case 0:return"";case 1:return $?"0?":"0";case 2:return $?"0{0,2}":"00";default:return $?`0{0,${le}}`:`0{${le}}`}}s(We,"padZeros"),j.cache={},j.clearCache=()=>j.cache={},ae.exports=j},3416:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.AnsiStringType=h.StringType=h.BufferType=h.Uint8ArrayType=h.IgnoreType=h.Float80_LE=h.Float80_BE=h.Float64_LE=h.Float64_BE=h.Float32_LE=h.Float32_BE=h.Float16_LE=h.Float16_BE=h.INT64_BE=h.UINT64_BE=h.INT64_LE=h.UINT64_LE=h.INT32_LE=h.INT32_BE=h.INT24_BE=h.INT24_LE=h.INT16_LE=h.INT16_BE=h.INT8=h.UINT32_BE=h.UINT32_LE=h.UINT24_BE=h.UINT24_LE=h.UINT16_BE=h.UINT16_LE=h.UINT8=void 0;const Q=V(645);function j(q){return new DataView(q.buffer,q.byteOffset)}s(j,"dv"),h.UINT8={len:1,get(q,F){return j(q).getUint8(F)},put(q,F,G){return j(q).setUint8(F,G),F+1}},h.UINT16_LE={len:2,get(q,F){return j(q).getUint16(F,!0)},put(q,F,G){return j(q).setUint16(F,G,!0),F+2}},h.UINT16_BE={len:2,get(q,F){return j(q).getUint16(F)},put(q,F,G){return j(q).setUint16(F,G),F+2}},h.UINT24_LE={len:3,get(q,F){const G=j(q);return G.getUint8(F)+(G.getUint16(F+1,!0)<<8)},put(q,F,G){const me=j(q);return me.setUint8(F,G&255),me.setUint16(F+1,G>>8,!0),F+3}},h.UINT24_BE={len:3,get(q,F){const G=j(q);return(G.getUint16(F)<<8)+G.getUint8(F+2)},put(q,F,G){const me=j(q);return me.setUint16(F,G>>8),me.setUint8(F+2,G&255),F+3}},h.UINT32_LE={len:4,get(q,F){return j(q).getUint32(F,!0)},put(q,F,G){return j(q).setUint32(F,G,!0),F+4}},h.UINT32_BE={len:4,get(q,F){return j(q).getUint32(F)},put(q,F,G){return j(q).setUint32(F,G),F+4}},h.INT8={len:1,get(q,F){return j(q).getInt8(F)},put(q,F,G){return j(q).setInt8(F,G),F+2}},h.INT16_BE={len:2,get(q,F){return j(q).getInt16(F)},put(q,F,G){return j(q).setInt16(F,G),F+2}},h.INT16_LE={len:2,get(q,F){return j(q).getInt16(F,!0)},put(q,F,G){return j(q).setInt16(F,G,!0),F+2}},h.INT24_LE={len:3,get(q,F){const G=h.UINT24_LE.get(q,F);return G>8388607?G-16777216:G},put(q,F,G){const me=j(q);return me.setUint8(F,G&255),me.setUint16(F+1,G>>8,!0),F+3}},h.INT24_BE={len:3,get(q,F){const G=h.UINT24_BE.get(q,F);return G>8388607?G-16777216:G},put(q,F,G){const me=j(q);return me.setUint16(F,G>>8),me.setUint8(F+2,G&255),F+3}},h.INT32_BE={len:4,get(q,F){return j(q).getInt32(F)},put(q,F,G){return j(q).setInt32(F,G),F+4}},h.INT32_LE={len:4,get(q,F){return j(q).getInt32(F,!0)},put(q,F,G){return j(q).setInt32(F,G,!0),F+4}},h.UINT64_LE={len:8,get(q,F){return j(q).getBigUint64(F,!0)},put(q,F,G){return j(q).setBigUint64(F,G,!0),F+8}},h.INT64_LE={len:8,get(q,F){return j(q).getBigInt64(F,!0)},put(q,F,G){return j(q).setBigInt64(F,G,!0),F+8}},h.UINT64_BE={len:8,get(q,F){return j(q).getBigUint64(F)},put(q,F,G){return j(q).setBigUint64(F,G),F+8}},h.INT64_BE={len:8,get(q,F){return j(q).getBigInt64(F)},put(q,F,G){return j(q).setBigInt64(F,G),F+8}},h.Float16_BE={len:2,get(q,F){return Q.read(q,F,!1,10,this.len)},put(q,F,G){return Q.write(q,G,F,!1,10,this.len),F+this.len}},h.Float16_LE={len:2,get(q,F){return Q.read(q,F,!0,10,this.len)},put(q,F,G){return Q.write(q,G,F,!0,10,this.len),F+this.len}},h.Float32_BE={len:4,get(q,F){return j(q).getFloat32(F)},put(q,F,G){return j(q).setFloat32(F,G),F+4}},h.Float32_LE={len:4,get(q,F){return j(q).getFloat32(F,!0)},put(q,F,G){return j(q).setFloat32(F,G,!0),F+4}},h.Float64_BE={len:8,get(q,F){return j(q).getFloat64(F)},put(q,F,G){return j(q).setFloat64(F,G),F+8}},h.Float64_LE={len:8,get(q,F){return j(q).getFloat64(F,!0)},put(q,F,G){return j(q).setFloat64(F,G,!0),F+8}},h.Float80_BE={len:10,get(q,F){return Q.read(q,F,!1,63,this.len)},put(q,F,G){return Q.write(q,G,F,!1,63,this.len),F+this.len}},h.Float80_LE={len:10,get(q,F){return Q.read(q,F,!0,63,this.len)},put(q,F,G){return Q.write(q,G,F,!0,63,this.len),F+this.len}};class ie{constructor(F){this.len=F}get(F,G){}}s(ie,"IgnoreType"),h.IgnoreType=ie;class pe{constructor(F){this.len=F}get(F,G){return F.subarray(G,G+this.len)}}s(pe,"Uint8ArrayType"),h.Uint8ArrayType=pe;class se{constructor(F){this.len=F}get(F,G){return F.slice(G,G+this.len)}}s(se,"BufferType"),h.BufferType=se;class de{constructor(F,G){this.len=F,this.encoding=G}get(F,G){return Buffer.from(F).toString(this.encoding,G,G+this.len)}}s(de,"StringType"),h.StringType=de;class W{constructor(F){this.len=F}static decode(F,G,me){let L="";for(let ue=G;ue<me;++ue)L+=W.codePointToString(W.singleByteDecoder(F[ue]));return L}static inRange(F,G,me){return G<=F&&F<=me}static codePointToString(F){return F<=65535?String.fromCharCode(F):(F-=65536,String.fromCharCode((F>>10)+55296,(F&1023)+56320))}static singleByteDecoder(F){if(W.inRange(F,0,127))return F;const G=W.windows1252[F-128];if(G===null)throw Error("invaliding encoding");return G}get(F,G=0){return W.decode(F,G,G+this.len)}}s(W,"AnsiStringType"),h.AnsiStringType=W,W.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},8361:(ae,h,V)=>{var Q=Object.create,j=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,pe=Object.getOwnPropertyNames,se=Object.getOwnPropertySymbols,de=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,F=s((c,I,p)=>I in c?j(c,I,{enumerable:!0,configurable:!0,writable:!0,value:p}):c[I]=p,"ml"),G=s((c,I)=>{for(var p in I||(I={}))W.call(I,p)&&F(c,p,I[p]);if(se)for(var p of se(I))q.call(I,p)&&F(c,p,I[p]);return c},"zt"),me=s(c=>j(c,"__esModule",{value:!0}),"El"),L=s((c,I)=>()=>(I||c((I={exports:{}}).exports,I),I.exports),"l"),ue=s((c,I)=>{me(c);for(var p in I)j(c,p,{get:I[p],enumerable:!0})},"jE"),Ne=s((c,I,p)=>{if(I&&typeof I=="object"||typeof I=="function")for(let b of pe(I))!W.call(c,b)&&b!=="default"&&j(c,b,{get:()=>I[b],enumerable:!(p=ie(I,b))||p.enumerable});return c},"HE"),nt=s(c=>Ne(me(j(c!=null?Q(de(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c),"jn"),We=L((c,I)=>{"use strict";var p=function(){function b(){}return s(b,"e"),b.info=function(C){for(var g=[],f=1;f<arguments.length;f++)g[f-1]=arguments[f];b.enableDebug&&console.info(b.TAG+C,g)},b.warn=function(C){for(var g=[],f=1;f<arguments.length;f++)g[f-1]=arguments[f];b.disableWarnings||console.warn(b.TAG+C,g)},b.enableDebug=!1,b.disableWarnings=!1,b.disableErrors=!1,b.TAG="ApplicationInsights:",b}();I.exports=p}),Ee=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(g){for(var f,m=1,v=arguments.length;m<v;m++){f=arguments[m];for(var w in f)Object.prototype.hasOwnProperty.call(f,w)&&(g[w]=f[w])}return g},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.AsyncScopeManager=c.OpenTelemetryScopeManagerWrapper=void 0;var p=yn(),b=V(2361),C=function(){function g(){}return s(g,"e"),g.prototype.active=function(){var f=this,m=p.CorrelationContextManager.getCurrentContext();return I(I({},m),{getValue:function(v){return f._activeSymbol?v===f._activeSymbol?m:!1:(f._activeSymbol=v,m)},setValue:function(){}})},g.prototype.with=function(f,m){var v=f.parentSpanId,w=f.name,E=g._spanToContext(f,v,w);return p.CorrelationContextManager.runWithContext(E,m)()},g.prototype.bind=function(f){return typeof f=="function"?p.CorrelationContextManager.wrapCallback(f):(f instanceof b.EventEmitter&&p.CorrelationContextManager.wrapEmitter(f),f)},g.prototype.enable=function(){return p.CorrelationContextManager.enable(),this},g.prototype.disable=function(){return p.CorrelationContextManager.disable(),this},g._spanToContext=function(f,m,v){var w=m?"|"+f.spanContext().traceId+"."+m+".":f.spanContext().traceId,E=I(I({},f.spanContext()),{traceFlags:f.spanContext().traceFlags}),y=p.CorrelationContextManager.spanToContextObject(E,w,v);return y},g}();c.OpenTelemetryScopeManagerWrapper=C,c.AsyncScopeManager=new C}),Ce=L((c,I)=>{c=I.exports=Vt;var p;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?p=s(function(){var Z=Array.prototype.slice.call(arguments,0);Z.unshift("SEMVER"),console.log.apply(console,Z)},"N"):p=s(function(){},"N"),c.SEMVER_SPEC_VERSION="2.0.0";var b=256,C=Number.MAX_SAFE_INTEGER||9007199254740991,g=16,f=c.re=[],m=c.src=[],v=0,w=v++;m[w]="0|[1-9]\\d*";var E=v++;m[E]="[0-9]+";var y=v++;m[y]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var S=v++;m[S]="("+m[w]+")\\.("+m[w]+")\\.("+m[w]+")";var x=v++;m[x]="("+m[E]+")\\.("+m[E]+")\\.("+m[E]+")";var T=v++;m[T]="(?:"+m[w]+"|"+m[y]+")";var D=v++;m[D]="(?:"+m[E]+"|"+m[y]+")";var O=v++;m[O]="(?:-("+m[T]+"(?:\\."+m[T]+")*))";var N=v++;m[N]="(?:-?("+m[D]+"(?:\\."+m[D]+")*))";var z=v++;m[z]="[0-9A-Za-z-]+";var X=v++;m[X]="(?:\\+("+m[z]+"(?:\\."+m[z]+")*))";var K=v++,fe="v?"+m[S]+m[O]+"?"+m[X]+"?";m[K]="^"+fe+"$";var be="[v=\\s]*"+m[x]+m[N]+"?"+m[X]+"?",Fe=v++;m[Fe]="^"+be+"$";var ke=v++;m[ke]="((?:<|>)?=?)";var Qe=v++;m[Qe]=m[E]+"|x|X|\\*";var it=v++;m[it]=m[w]+"|x|X|\\*";var gt=v++;m[gt]="[v=\\s]*("+m[it]+")(?:\\.("+m[it]+")(?:\\.("+m[it]+")(?:"+m[O]+")?"+m[X]+"?)?)?";var xt=v++;m[xt]="[v=\\s]*("+m[Qe]+")(?:\\.("+m[Qe]+")(?:\\.("+m[Qe]+")(?:"+m[N]+")?"+m[X]+"?)?)?";var Ht=v++;m[Ht]="^"+m[ke]+"\\s*"+m[gt]+"$";var jt=v++;m[jt]="^"+m[ke]+"\\s*"+m[xt]+"$";var cr=v++;m[cr]="(?:^|[^\\d])(\\d{1,"+g+"})(?:\\.(\\d{1,"+g+"}))?(?:\\.(\\d{1,"+g+"}))?(?:$|[^\\d])";var Xt=v++;m[Xt]="(?:~>?)";var Je=v++;m[Je]="(\\s*)"+m[Xt]+"\\s+",f[Je]=new RegExp(m[Je],"g");var dt="$1~",ut=v++;m[ut]="^"+m[Xt]+m[gt]+"$";var yt=v++;m[yt]="^"+m[Xt]+m[xt]+"$";var Lt=v++;m[Lt]="(?:\\^)";var Yt=v++;m[Yt]="(\\s*)"+m[Lt]+"\\s+",f[Yt]=new RegExp(m[Yt],"g");var At="$1^",Zt=v++;m[Zt]="^"+m[Lt]+m[gt]+"$";var Ir=v++;m[Ir]="^"+m[Lt]+m[xt]+"$";var Dr=v++;m[Dr]="^"+m[ke]+"\\s*("+be+")$|^$";var _r=v++;m[_r]="^"+m[ke]+"\\s*("+fe+")$|^$";var ur=v++;m[ur]="(\\s*)"+m[ke]+"\\s*("+be+"|"+m[gt]+")",f[ur]=new RegExp(m[ur],"g");var Wr="$1$2$3",Gr=v++;m[Gr]="^\\s*("+m[gt]+")\\s+-\\s+("+m[gt]+")\\s*$";var Ft=v++;m[Ft]="^\\s*("+m[xt]+")\\s+-\\s+("+m[xt]+")\\s*$";var Ct=v++;for(m[Ct]="(<|>)?=?\\s*\\*",ar=0;ar<v;ar++)p(ar,m[ar]),f[ar]||(f[ar]=new RegExp(m[ar]));var ar;c.parse=kr;function kr(Z,ve){if((!ve||typeof ve!="object")&&(ve={loose:!!ve,includePrerelease:!1}),Z instanceof Vt)return Z;if(typeof Z!="string"||Z.length>b)return null;var Re=ve.loose?f[Fe]:f[K];if(!Re.test(Z))return null;try{return new Vt(Z,ve)}catch(ot){return null}}s(kr,"Qt"),c.valid=ss;function ss(Z,ve){var Re=kr(Z,ve);return Re?Re.version:null}s(ss,"$E"),c.clean=uo;function uo(Z,ve){var Re=kr(Z.trim().replace(/^[=v]+/,""),ve);return Re?Re.version:null}s(uo,"zE"),c.SemVer=Vt;function Vt(Z,ve){if((!ve||typeof ve!="object")&&(ve={loose:!!ve,includePrerelease:!1}),Z instanceof Vt){if(Z.loose===ve.loose)return Z;Z=Z.version}else if(typeof Z!="string")throw new TypeError("Invalid Version: "+Z);if(Z.length>b)throw new TypeError("version is longer than "+b+" characters");if(!(this instanceof Vt))return new Vt(Z,ve);p("SemVer",Z,ve),this.options=ve,this.loose=!!ve.loose;var Re=Z.trim().match(ve.loose?f[Fe]:f[K]);if(!Re)throw new TypeError("Invalid Version: "+Z);if(this.raw=Z,this.major=+Re[1],this.minor=+Re[2],this.patch=+Re[3],this.major>C||this.major<0)throw new TypeError("Invalid major version");if(this.minor>C||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>C||this.patch<0)throw new TypeError("Invalid patch version");Re[4]?this.prerelease=Re[4].split(".").map(function(ot){if(/^[0-9]+$/.test(ot)){var st=+ot;if(st>=0&&st<C)return st}return ot}):this.prerelease=[],this.build=Re[5]?Re[5].split("."):[],this.format()}s(Vt,"b"),Vt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Vt.prototype.toString=function(){return this.version},Vt.prototype.compare=function(Z){return p("SemVer.compare",this.version,this.options,Z),Z instanceof Vt||(Z=new Vt(Z,this.options)),this.compareMain(Z)||this.comparePre(Z)},Vt.prototype.compareMain=function(Z){return Z instanceof Vt||(Z=new Vt(Z,this.options)),ii(this.major,Z.major)||ii(this.minor,Z.minor)||ii(this.patch,Z.patch)},Vt.prototype.comparePre=function(Z){if(Z instanceof Vt||(Z=new Vt(Z,this.options)),this.prerelease.length&&!Z.prerelease.length)return-1;if(!this.prerelease.length&&Z.prerelease.length)return 1;if(!this.prerelease.length&&!Z.prerelease.length)return 0;var ve=0;do{var Re=this.prerelease[ve],ot=Z.prerelease[ve];if(p("prerelease compare",ve,Re,ot),Re===void 0&&ot===void 0)return 0;if(ot===void 0)return 1;if(Re===void 0)return-1;if(Re!==ot)return ii(Re,ot)}while(++ve)},Vt.prototype.inc=function(Z,ve){switch(Z){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",ve);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",ve);break;case"prepatch":this.prerelease.length=0,this.inc("patch",ve),this.inc("pre",ve);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",ve),this.inc("pre",ve);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var Re=this.prerelease.length;--Re>=0;)typeof this.prerelease[Re]=="number"&&(this.prerelease[Re]++,Re=-2);Re===-1&&this.prerelease.push(0)}ve&&(this.prerelease[0]===ve?isNaN(this.prerelease[1])&&(this.prerelease=[ve,0]):this.prerelease=[ve,0]);break;default:throw new Error("invalid increment argument: "+Z)}return this.format(),this.raw=this.version,this},c.inc=cs;function cs(Z,ve,Re,ot){typeof Re=="string"&&(ot=Re,Re=void 0);try{return new Vt(Z,Re).inc(ve,ot).version}catch(st){return null}}s(cs,"KE"),c.diff=wi;function wi(Z,ve){if(oi(Z,ve))return null;var Re=kr(Z),ot=kr(ve),st="";if(Re.prerelease.length||ot.prerelease.length){st="pre";var vt="prerelease"}for(var bt in Re)if((bt==="major"||bt==="minor"||bt==="patch")&&Re[bt]!==ot[bt])return st+bt;return vt}s(wi,"XE"),c.compareIdentifiers=ii;var Hn=/^[0-9]+$/;function ii(Z,ve){var Re=Hn.test(Z),ot=Hn.test(ve);return Re&&ot&&(Z=+Z,ve=+ve),Z===ve?0:Re&&!ot?-1:ot&&!Re?1:Z<ve?-1:1}s(ii,"Lr"),c.rcompareIdentifiers=$i;function $i(Z,ve){return ii(ve,Z)}s($i,"YE"),c.major=An;function An(Z,ve){return new Vt(Z,ve).major}s(An,"QE"),c.minor=ls;function ls(Z,ve){return new Vt(Z,ve).minor}s(ls,"WE"),c.patch=us;function us(Z,ve){return new Vt(Z,ve).patch}s(us,"ZE"),c.compare=Rn;function Rn(Z,ve,Re){return new Vt(Z,Re).compare(new Vt(ve,Re))}s(Rn,"at"),c.compareLoose=wc;function wc(Z,ve){return Rn(Z,ve,!0)}s(wc,"JE"),c.rcompare=Fo;function Fo(Z,ve,Re){return Rn(ve,Z,Re)}s(Fo,"ey"),c.sort=ds;function ds(Z,ve){return Z.sort(function(Re,ot){return c.compare(Re,ot,ve)})}s(ds,"ty"),c.rsort=Bi;function Bi(Z,ve){return Z.sort(function(Re,ot){return c.rcompare(Re,ot,ve)})}s(Bi,"ry"),c.gt=bi;function bi(Z,ve,Re){return Rn(Z,ve,Re)>0}s(bi,"Gn"),c.lt=nn;function nn(Z,ve,Re){return Rn(Z,ve,Re)<0}s(nn,"Wi"),c.eq=oi;function oi(Z,ve,Re){return Rn(Z,ve,Re)===0}s(oi,"To"),c.neq=ya;function ya(Z,ve,Re){return Rn(Z,ve,Re)!==0}s(ya,"ql"),c.gte=_a;function _a(Z,ve,Re){return Rn(Z,ve,Re)>=0}s(_a,"So"),c.lte=wn;function wn(Z,ve,Re){return Rn(Z,ve,Re)<=0}s(wn,"Ao"),c.cmp=Ei;function Ei(Z,ve,Re,ot){switch(ve){case"===":return typeof Z=="object"&&(Z=Z.version),typeof Re=="object"&&(Re=Re.version),Z===Re;case"!==":return typeof Z=="object"&&(Z=Z.version),typeof Re=="object"&&(Re=Re.version),Z!==Re;case"":case"=":case"==":return oi(Z,Re,ot);case"!=":return ya(Z,Re,ot);case">":return bi(Z,Re,ot);case">=":return _a(Z,Re,ot);case"<":return nn(Z,Re,ot);case"<=":return wn(Z,Re,ot);default:throw new TypeError("Invalid operator: "+ve)}}s(Ei,"Zi"),c.Comparator=bn;function bn(Z,ve){if((!ve||typeof ve!="object")&&(ve={loose:!!ve,includePrerelease:!1}),Z instanceof bn){if(Z.loose===!!ve.loose)return Z;Z=Z.value}if(!(this instanceof bn))return new bn(Z,ve);p("comparator",Z,ve),this.options=ve,this.loose=!!ve.loose,this.parse(Z),this.semver===Ui?this.value="":this.value=this.operator+this.semver.version,p("comp",this)}s(bn,"Ne");var Ui={};bn.prototype.parse=function(Z){var ve=this.options.loose?f[Dr]:f[_r],Re=Z.match(ve);if(!Re)throw new TypeError("Invalid comparator: "+Z);this.operator=Re[1],this.operator==="="&&(this.operator=""),Re[2]?this.semver=new Vt(Re[2],this.options.loose):this.semver=Ui},bn.prototype.toString=function(){return this.value},bn.prototype.test=function(Z){return p("Comparator.test",Z,this.options.loose),this.semver===Ui?!0:(typeof Z=="string"&&(Z=new Vt(Z,this.options)),Ei(Z,this.operator,this.semver,this.options))},bn.prototype.intersects=function(Z,ve){if(!(Z instanceof bn))throw new TypeError("a Comparator is required");(!ve||typeof ve!="object")&&(ve={loose:!!ve,includePrerelease:!1});var Re;if(this.operator==="")return Re=new fr(Z.value,ve),Et(this.value,Re,ve);if(Z.operator==="")return Re=new fr(this.value,ve),Et(Z.semver,Re,ve);var ot=(this.operator===">="||this.operator===">")&&(Z.operator===">="||Z.operator===">"),st=(this.operator==="<="||this.operator==="<")&&(Z.operator==="<="||Z.operator==="<"),vt=this.semver.version===Z.semver.version,bt=(this.operator===">="||this.operator==="<=")&&(Z.operator===">="||Z.operator==="<="),$t=Ei(this.semver,"<",Z.semver,ve)&&(this.operator===">="||this.operator===">")&&(Z.operator==="<="||Z.operator==="<"),Bt=Ei(this.semver,">",Z.semver,ve)&&(this.operator==="<="||this.operator==="<")&&(Z.operator===">="||Z.operator===">");return ot||st||vt&&bt||$t||Bt},c.Range=fr;function fr(Z,ve){if((!ve||typeof ve!="object")&&(ve={loose:!!ve,includePrerelease:!1}),Z instanceof fr)return Z.loose===!!ve.loose&&Z.includePrerelease===!!ve.includePrerelease?Z:new fr(Z.raw,ve);if(Z instanceof bn)return new fr(Z.value,ve);if(!(this instanceof fr))return new fr(Z,ve);if(this.options=ve,this.loose=!!ve.loose,this.includePrerelease=!!ve.includePrerelease,this.raw=Z,this.set=Z.split(/\s*\|\|\s*/).map(function(Re){return this.parseRange(Re.trim())},this).filter(function(Re){return Re.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+Z);this.format()}s(fr,"U"),fr.prototype.format=function(){return this.range=this.set.map(function(Z){return Z.join(" ").trim()}).join("||").trim(),this.range},fr.prototype.toString=function(){return this.range},fr.prototype.parseRange=function(Z){var ve=this.options.loose;Z=Z.trim();var Re=ve?f[Ft]:f[Gr];Z=Z.replace(Re,ps),p("hyphen replace",Z),Z=Z.replace(f[ur],Wr),p("comparator trim",Z,f[ur]),Z=Z.replace(f[Je],dt),Z=Z.replace(f[Yt],At),Z=Z.split(/\s+/).join(" ");var ot=ve?f[Dr]:f[_r],st=Z.split(" ").map(function(vt){return Hi(vt,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(st=st.filter(function(vt){return!!vt.match(ot)})),st=st.map(function(vt){return new bn(vt,this.options)},this),st},fr.prototype.intersects=function(Z,ve){if(!(Z instanceof fr))throw new TypeError("a Range is required");return this.set.some(function(Re){return Re.every(function(ot){return Z.set.some(function(st){return st.every(function(vt){return ot.intersects(vt,ve)})})})})},c.toComparators=wa;function wa(Z,ve){return new fr(Z,ve).set.map(function(Re){return Re.map(function(ot){return ot.value}).join(" ").trim().split(" ")})}s(wa,"ny");function Hi(Z,ve){return p("comp",Z,ve),Z=ba(Z,ve),p("caret",Z),Z=un(Z,ve),p("tildes",Z),Z=Ea(Z,ve),p("xrange",Z),Z=En(Z,ve),p("stars",Z),Z}s(Hi,"iy");function Ur(Z){return!Z||Z.toLowerCase()==="x"||Z==="*"}s(Ur,"ge");function un(Z,ve){return Z.trim().split(/\s+/).map(function(Re){return bc(Re,ve)}).join(" ")}s(un,"ay");function bc(Z,ve){var Re=ve.loose?f[yt]:f[ut];return Z.replace(Re,function(ot,st,vt,bt,$t){p("tilde",Z,ot,st,vt,bt,$t);var Bt;return Ur(st)?Bt="":Ur(vt)?Bt=">="+st+".0.0 <"+(+st+1)+".0.0":Ur(bt)?Bt=">="+st+"."+vt+".0 <"+st+"."+(+vt+1)+".0":$t?(p("replaceTilde pr",$t),Bt=">="+st+"."+vt+"."+bt+"-"+$t+" <"+st+"."+(+vt+1)+".0"):Bt=">="+st+"."+vt+"."+bt+" <"+st+"."+(+vt+1)+".0",p("tilde return",Bt),Bt})}s(bc,"sy");function ba(Z,ve){return Z.trim().split(/\s+/).map(function(Re){return hs(Re,ve)}).join(" ")}s(ba,"oy");function hs(Z,ve){p("caret",Z,ve);var Re=ve.loose?f[Ir]:f[Zt];return Z.replace(Re,function(ot,st,vt,bt,$t){p("caret",Z,ot,st,vt,bt,$t);var Bt;return Ur(st)?Bt="":Ur(vt)?Bt=">="+st+".0.0 <"+(+st+1)+".0.0":Ur(bt)?st==="0"?Bt=">="+st+"."+vt+".0 <"+st+"."+(+vt+1)+".0":Bt=">="+st+"."+vt+".0 <"+(+st+1)+".0.0":$t?(p("replaceCaret pr",$t),st==="0"?vt==="0"?Bt=">="+st+"."+vt+"."+bt+"-"+$t+" <"+st+"."+vt+"."+(+bt+1):Bt=">="+st+"."+vt+"."+bt+"-"+$t+" <"+st+"."+(+vt+1)+".0":Bt=">="+st+"."+vt+"."+bt+"-"+$t+" <"+(+st+1)+".0.0"):(p("no pr"),st==="0"?vt==="0"?Bt=">="+st+"."+vt+"."+bt+" <"+st+"."+vt+"."+(+bt+1):Bt=">="+st+"."+vt+"."+bt+" <"+st+"."+(+vt+1)+".0":Bt=">="+st+"."+vt+"."+bt+" <"+(+st+1)+".0.0"),p("caret return",Bt),Bt})}s(hs,"uy");function Ea(Z,ve){return p("replaceXRanges",Z,ve),Z.split(/\s+/).map(function(Re){return fs(Re,ve)}).join(" ")}s(Ea,"cy");function fs(Z,ve){Z=Z.trim();var Re=ve.loose?f[jt]:f[Ht];return Z.replace(Re,function(ot,st,vt,bt,$t,Bt){p("xRange",Z,ot,st,vt,bt,$t,Bt);var In=Ur(vt),Vr=In||Ur(bt),Tr=Vr||Ur($t),Kr=Tr;return st==="="&&Kr&&(st=""),In?st===">"||st==="<"?ot="<0.0.0":ot="*":st&&Kr?(Vr&&(bt=0),$t=0,st===">"?(st=">=",Vr?(vt=+vt+1,bt=0,$t=0):(bt=+bt+1,$t=0)):st==="<="&&(st="<",Vr?vt=+vt+1:bt=+bt+1),ot=st+vt+"."+bt+"."+$t):Vr?ot=">="+vt+".0.0 <"+(+vt+1)+".0.0":Tr&&(ot=">="+vt+"."+bt+".0 <"+vt+"."+(+bt+1)+".0"),p("xRange return",ot),ot})}s(fs,"ly");function En(Z,ve){return p("replaceStars",Z,ve),Z.trim().replace(f[Ct],"")}s(En,"py");function ps(Z,ve,Re,ot,st,vt,bt,$t,Bt,In,Vr,Tr,Kr){return Ur(Re)?ve="":Ur(ot)?ve=">="+Re+".0.0":Ur(st)?ve=">="+Re+"."+ot+".0":ve=">="+ve,Ur(Bt)?$t="":Ur(In)?$t="<"+(+Bt+1)+".0.0":Ur(Vr)?$t="<"+Bt+"."+(+In+1)+".0":Tr?$t="<="+Bt+"."+In+"."+Vr+"-"+Tr:$t="<="+$t,(ve+" "+$t).trim()}s(ps,"fy"),fr.prototype.test=function(Z){if(!Z)return!1;typeof Z=="string"&&(Z=new Vt(Z,this.options));for(var ve=0;ve<this.set.length;ve++)if(Ec(this.set[ve],Z,this.options))return!0;return!1};function Ec(Z,ve,Re){for(var ot=0;ot<Z.length;ot++)if(!Z[ot].test(ve))return!1;if(ve.prerelease.length&&!Re.includePrerelease){for(ot=0;ot<Z.length;ot++)if(p(Z[ot].semver),Z[ot].semver!==Ui&&Z[ot].semver.prerelease.length>0){var st=Z[ot].semver;if(st.major===ve.major&&st.minor===ve.minor&&st.patch===ve.patch)return!0}return!1}return!0}s(Ec,"dy"),c.satisfies=Et;function Et(Z,ve,Re){try{ve=new fr(ve,Re)}catch(ot){return!1}return ve.test(Z)}s(Et,"Ji"),c.maxSatisfying=Sa;function Sa(Z,ve,Re){var ot=null,st=null;try{var vt=new fr(ve,Re)}catch(bt){return null}return Z.forEach(function(bt){vt.test(bt)&&(!ot||st.compare(bt)===-1)&&(ot=bt,st=new Vt(ot,Re))}),ot}s(Sa,"hy"),c.minSatisfying=Ca;function Ca(Z,ve,Re){var ot=null,st=null;try{var vt=new fr(ve,Re)}catch(bt){return null}return Z.forEach(function(bt){vt.test(bt)&&(!ot||st.compare(bt)===1)&&(ot=bt,st=new Vt(ot,Re))}),ot}s(Ca,"_y"),c.minVersion=jn;function jn(Z,ve){Z=new fr(Z,ve);var Re=new Vt("0.0.0");if(Z.test(Re)||(Re=new Vt("0.0.0-0"),Z.test(Re)))return Re;Re=null;for(var ot=0;ot<Z.set.length;++ot){var st=Z.set[ot];st.forEach(function(vt){var bt=new Vt(vt.semver.version);switch(vt.operator){case">":bt.prerelease.length===0?bt.patch++:bt.prerelease.push(0),bt.raw=bt.format();case"":case">=":(!Re||bi(Re,bt))&&(Re=bt);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+vt.operator)}})}return Re&&Z.test(Re)?Re:null}s(jn,"gy"),c.validRange=gs;function gs(Z,ve){try{return new fr(Z,ve).range||"*"}catch(Re){return null}}s(gs,"vy"),c.ltr=ms;function ms(Z,ve,Re){return Si(Z,ve,"<",Re)}s(ms,"my"),c.gtr=vs;function vs(Z,ve,Re){return Si(Z,ve,">",Re)}s(vs,"Ey"),c.outside=Si;function Si(Z,ve,Re,ot){Z=new Vt(Z,ot),ve=new fr(ve,ot);var st,vt,bt,$t,Bt;switch(Re){case">":st=bi,vt=wn,bt=nn,$t=">",Bt=">=";break;case"<":st=nn,vt=_a,bt=bi,$t="<",Bt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Et(Z,ve,ot))return!1;for(var In=0;In<ve.set.length;++In){var Vr=ve.set[In],Tr=null,Kr=null;if(Vr.forEach(function(Qn){Qn.semver===Ui&&(Qn=new bn(">=0.0.0")),Tr=Tr||Qn,Kr=Kr||Qn,st(Qn.semver,Tr.semver,ot)?Tr=Qn:bt(Qn.semver,Kr.semver,ot)&&(Kr=Qn)}),Tr.operator===$t||Tr.operator===Bt||(!Kr.operator||Kr.operator===$t)&&vt(Z,Kr.semver)||Kr.operator===Bt&&bt(Z,Kr.semver))return!1}return!0}s(Si,"bo"),c.prerelease=ys;function ys(Z,ve){var Re=kr(Z,ve);return Re&&Re.prerelease.length?Re.prerelease:null}s(ys,"yy"),c.intersects=wr;function wr(Z,ve,Re){return Z=new fr(Z,Re),ve=new fr(ve,Re),Z.intersects(ve)}s(wr,"Ty"),c.coerce=_s;function _s(Z){if(Z instanceof Vt)return Z;if(typeof Z!="string")return null;var ve=Z.match(f[cr]);return ve==null?null:kr(ve[1]+"."+(ve[2]||"0")+"."+(ve[3]||"0"))}s(_s,"Sy")}),Se=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.makePatchingRequire=void 0;var I=V(1017),p=Ce(),b=V(8188),C=Object.keys(process.binding("natives")),g=b.prototype.require;function f(m){var v={};return function(w){var E=g.apply(this,arguments);if(m[w]){var y=b._resolveFilename(w,this);if(v.hasOwnProperty(y))return v[y];var S=void 0;if(C.indexOf(w)<0)try{S=g.call(this,I.join(w,"package.json")).version}catch(z){return E}else S=process.version.substring(1);var x=S.indexOf("-");x>=0&&(S=S.substring(0,x));for(var T=E,D=0,O=m[w];D<O.length;D++){var N=O[D];p.satisfies(S,N.versionSpecifier)&&(T=N.patch(T,y))}return v[y]=T}return E}}s(f,"Cy"),c.makePatchingRequire=f}),le=L((c,I)=>{I.exports={name:"diagnostic-channel",version:"1.0.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}}),$=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.channel=c.makePatchingRequire=void 0;var I=Se(),p=Se();Object.defineProperty(c,"makePatchingRequire",{enumerable:!0,get:function(){return p.makePatchingRequire}});var b=s(function(f){return!0},"Bl"),C=function(){function f(){this.version=le().version,this.subscribers={},this.contextPreservationFunction=function(m){return m},this.knownPatches={},this.currentlyPublishing=!1}return s(f,"e"),f.prototype.shouldPublish=function(m){var v=this.subscribers[m];return v?v.some(function(w){var E=w.filter;return!E||E(!1)}):!1},f.prototype.publish=function(m,v){if(!this.currentlyPublishing){var w=this.subscribers[m];if(w){var E={timestamp:Date.now(),data:v};this.currentlyPublishing=!0,w.forEach(function(y){var S=y.listener,x=y.filter;try{x&&x(!0)&&S(E)}catch(T){}}),this.currentlyPublishing=!1}}},f.prototype.subscribe=function(m,v,w){w===void 0&&(w=b),this.subscribers[m]||(this.subscribers[m]=[]),this.subscribers[m].push({listener:v,filter:w})},f.prototype.unsubscribe=function(m,v,w){w===void 0&&(w=b);var E=this.subscribers[m];if(E){for(var y=0;y<E.length;++y)if(E[y].listener===v&&E[y].filter===w)return E.splice(y,1),!0}return!1},f.prototype.reset=function(){var m=this;this.subscribers={},this.contextPreservationFunction=function(v){return v},Object.getOwnPropertyNames(this.knownPatches).forEach(function(v){return delete m.knownPatches[v]})},f.prototype.bindToContext=function(m){return this.contextPreservationFunction(m)},f.prototype.addContextPreservation=function(m){var v=this.contextPreservationFunction;this.contextPreservationFunction=function(w){return m(v(w))}},f.prototype.registerMonkeyPatch=function(m,v){this.knownPatches[m]||(this.knownPatches[m]=[]),this.knownPatches[m].push(v)},f.prototype.getPatchesObject=function(){return this.knownPatches},f}();global.diagnosticsSource||(global.diagnosticsSource=new C,g=V(8188),g.prototype.require=I.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var g;c.channel=global.diagnosticsSource}),Te=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),ne=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BaggageImpl=void 0;var I=function(){function p(b){this._entries=b?new Map(b):new Map}return s(p,"e"),p.prototype.getEntry=function(b){var C=this._entries.get(b);if(C)return Object.assign({},C)},p.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(b){var C=b[0],g=b[1];return[C,g]})},p.prototype.setEntry=function(b,C){var g=new p(this._entries);return g._entries.set(b,C),g},p.prototype.removeEntry=function(b){var C=new p(this._entries);return C._entries.delete(b),C},p.prototype.removeEntries=function(){for(var b=[],C=0;C<arguments.length;C++)b[C]=arguments[C];for(var g=new p(this._entries),f=0,m=b;f<m.length;f++){var v=m[f];g._entries.delete(v)}return g},p.prototype.clear=function(){return new p},p}();c.BaggageImpl=I}),ce=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.baggageEntryMetadataSymbol=void 0,c.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")}),ge=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.baggageEntryMetadataFromString=c.createBaggage=void 0;var I=rr(),p=ne(),b=ce();function C(f){return f===void 0&&(f={}),new p.BaggageImpl(new Map(Object.entries(f)))}s(C,"Ly"),c.createBaggage=C;function g(f){return typeof f!="string"&&(I.diag.error("Cannot create baggage metadata from unknown type: "+typeof f),f=""),{__TYPE__:b.baggageEntryMetadataSymbol,toString:function(){return f}}}s(g,"qy"),c.baggageEntryMetadataFromString=g}),we=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),He=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ge=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DiagConsoleLogger=void 0;var I=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],p=function(){function b(){function C(f){return function(){var m=arguments;if(console){var v=console[f];if(typeof v!="function"&&(v=console.log),typeof v=="function")return v.apply(console,m)}}}s(C,"t");for(var g=0;g<I.length;g++)this[I[g].n]=C(I[g].c)}return s(b,"e"),b}();c.DiagConsoleLogger=p}),tt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DiagLogLevel=void 0;var I;(function(p){p[p.NONE=0]="NONE",p[p.ERROR=30]="ERROR",p[p.WARN=50]="WARN",p[p.INFO=60]="INFO",p[p.DEBUG=70]="DEBUG",p[p.VERBOSE=80]="VERBOSE",p[p.ALL=9999]="ALL"})(I=c.DiagLogLevel||(c.DiagLogLevel={}))}),ye=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Ge(),c),p(tt(),c)}),Be=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.defaultTextMapSetter=c.defaultTextMapGetter=void 0,c.defaultTextMapGetter={get:function(I,p){if(I!=null)return I[p]},keys:function(I){return I==null?[]:Object.keys(I)}},c.defaultTextMapSetter={set:function(I,p,b){I!=null&&(I[p]=b)}}}),Ke=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Xe=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),ze=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ROOT_CONTEXT=c.createContextKey=void 0;function I(b){return Symbol.for(b)}s(I,"Uy"),c.createContextKey=I;var p=function(){function b(C){var g=this;g._currentContext=C?new Map(C):new Map,g.getValue=function(f){return g._currentContext.get(f)},g.setValue=function(f,m){var v=new b(g._currentContext);return v._currentContext.set(f,m),v},g.deleteValue=function(f){var m=new b(g._currentContext);return m._currentContext.delete(f),m}}return s(b,"e"),b}();c.ROOT_CONTEXT=new p}),Ze=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TraceFlags=void 0;var I;(function(p){p[p.NONE=0]="NONE",p[p.SAMPLED=1]="SAMPLED"})(I=c.TraceFlags||(c.TraceFlags={}))}),Le=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.wrapSpanContext=c.isSpanContextValid=c.isValidSpanId=c.isValidTraceId=c.INVALID_SPAN_CONTEXT=c.INVALID_TRACEID=c.INVALID_SPANID=void 0;var I=St(),p=Ze(),b=/^([0-9a-f]{32})$/i,C=/^[0-9a-f]{16}$/i;c.INVALID_SPANID="0000000000000000",c.INVALID_TRACEID="00000000000000000000000000000000",c.INVALID_SPAN_CONTEXT={traceId:c.INVALID_TRACEID,spanId:c.INVALID_SPANID,traceFlags:p.TraceFlags.NONE};function g(w){return b.test(w)&&w!==c.INVALID_TRACEID}s(g,"ip"),c.isValidTraceId=g;function f(w){return C.test(w)&&w!==c.INVALID_SPANID}s(f,"ap"),c.isValidSpanId=f;function m(w){return g(w.traceId)&&f(w.spanId)}s(m,"Ky"),c.isSpanContextValid=m;function v(w){return new I.NonRecordingSpan(w)}s(v,"Xy"),c.wrapSpanContext=v}),St=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NonRecordingSpan=void 0;var I=Le(),p=function(){function b(C){C===void 0&&(C=I.INVALID_SPAN_CONTEXT),this._spanContext=C}return s(b,"e"),b.prototype.spanContext=function(){return this._spanContext},b.prototype.setAttribute=function(C,g){return this},b.prototype.setAttributes=function(C){return this},b.prototype.addEvent=function(C,g){return this},b.prototype.setStatus=function(C){return this},b.prototype.updateName=function(C){return this},b.prototype.end=function(C){},b.prototype.isRecording=function(){return!1},b.prototype.recordException=function(C,g){},b}();c.NonRecordingSpan=p}),xe=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getSpanContext=c.setSpanContext=c.deleteSpan=c.setSpan=c.getSpan=void 0;var I=ze(),p=St(),b=I.createContextKey("OpenTelemetry Context Key SPAN");function C(w){return w.getValue(b)||void 0}s(C,"sp"),c.getSpan=C;function g(w,E){return w.setValue(b,E)}s(g,"op"),c.setSpan=g;function f(w){return w.deleteValue(b)}s(f,"Jy"),c.deleteSpan=f;function m(w,E){return g(w,new p.NonRecordingSpan(E))}s(m,"eT"),c.setSpanContext=m;function v(w){var E;return(E=C(w))===null||E===void 0?void 0:E.spanContext()}s(v,"tT"),c.getSpanContext=v}),Dt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NoopTracer=void 0;var I=rr(),p=xe(),b=St(),C=Le(),g=function(){function m(){}return s(m,"e"),m.prototype.startSpan=function(v,w,E){var y=Boolean(w==null?void 0:w.root);if(y)return new b.NonRecordingSpan;var S=E&&p.getSpanContext(E);return f(S)&&C.isSpanContextValid(S)?new b.NonRecordingSpan(S):new b.NonRecordingSpan},m.prototype.startActiveSpan=function(v,w,E,y){var S,x,T;if(!(arguments.length<2)){arguments.length===2?T=w:arguments.length===3?(S=w,T=E):(S=w,x=E,T=y);var D=x!=null?x:I.context.active(),O=this.startSpan(v,S,D),N=p.setSpan(D,O);return I.context.with(N,T,void 0,O)}},m}();c.NoopTracer=g;function f(m){return typeof m=="object"&&typeof m.spanId=="string"&&typeof m.traceId=="string"&&typeof m.traceFlags=="number"}s(f,"iT")}),ct=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ProxyTracer=void 0;var I=Dt(),p=function(){function b(C,g,f){this._provider=C,this.name=g,this.version=f}return s(b,"e"),b.prototype.startSpan=function(C,g,f){return this._getTracer().startSpan(C,g,f)},b.prototype.startActiveSpan=function(C,g,f,m){var v=this._getTracer();return Reflect.apply(v.startActiveSpan,v,arguments)},b.prototype._getTracer=function(){if(this._delegate)return this._delegate;var C=this._provider.getDelegateTracer(this.name,this.version);return C?(this._delegate=C,this._delegate):new I.NoopTracer},b}();c.ProxyTracer=p}),It=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NoopTracerProvider=void 0;var I=Dt(),p=function(){function b(){}return s(b,"e"),b.prototype.getTracer=function(C,g){return new I.NoopTracer},b}();c.NoopTracerProvider=p}),$e=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ProxyTracerProvider=void 0;var I=ct(),p=It(),b=new p.NoopTracerProvider,C=function(){function g(){}return s(g,"e"),g.prototype.getTracer=function(f,m){var v;return(v=this.getDelegateTracer(f,m))!==null&&v!==void 0?v:new I.ProxyTracer(this,f,m)},g.prototype.getDelegate=function(){var f;return(f=this._delegate)!==null&&f!==void 0?f:b},g.prototype.setDelegate=function(f){this._delegate=f},g.prototype.getDelegateTracer=function(f,m){var v;return(v=this._delegate)===null||v===void 0?void 0:v.getTracer(f,m)},g}();c.ProxyTracerProvider=C}),Me=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),mt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SamplingDecision=void 0;var I;(function(p){p[p.NOT_RECORD=0]="NOT_RECORD",p[p.RECORD=1]="RECORD",p[p.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(I=c.SamplingDecision||(c.SamplingDecision={}))}),Tt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ut=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpanKind=void 0;var I;(function(p){p[p.INTERNAL=0]="INTERNAL",p[p.SERVER=1]="SERVER",p[p.CLIENT=2]="CLIENT",p[p.PRODUCER=3]="PRODUCER",p[p.CONSUMER=4]="CONSUMER"})(I=c.SpanKind||(c.SpanKind={}))}),gr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Jt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),er=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SpanStatusCode=void 0;var I;(function(p){p[p.UNSET=0]="UNSET",p[p.OK=1]="OK",p[p.ERROR=2]="ERROR"})(I=c.SpanStatusCode||(c.SpanStatusCode={}))}),pi=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),mr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Nr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Rt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),qt=L(c=>{"use strict";var I=c&&c.__spreadArray||function(C,g){for(var f=0,m=g.length,v=C.length;f<m;f++,v++)C[v]=g[f];return C};Object.defineProperty(c,"__esModule",{value:!0}),c.NoopContextManager=void 0;var p=ze(),b=function(){function C(){}return s(C,"e"),C.prototype.active=function(){return p.ROOT_CONTEXT},C.prototype.with=function(g,f,m){for(var v=[],w=3;w<arguments.length;w++)v[w-3]=arguments[w];return f.call.apply(f,I([m],v))},C.prototype.bind=function(g,f){return f},C.prototype.enable=function(){return this},C.prototype.disable=function(){return this},C}();c.NoopContextManager=b}),ht=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c._globalThis=void 0,c._globalThis=typeof globalThis=="object"?globalThis:global}),ft=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(ht(),c)}),Pt=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(ft(),c)}),et=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.VERSION=void 0,c.VERSION="1.0.1"}),Ot=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isCompatible=c._makeCompatibilityCheck=void 0;var I=et(),p=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function b(C){var g=new Set([C]),f=new Set,m=C.match(p);if(!m)return function(){return!1};var v={major:+m[1],minor:+m[2],patch:+m[3]};function w(y){return f.add(y),!1}s(w,"a");function E(y){return g.add(y),!0}return s(E,"s"),function(y){if(g.has(y))return!0;if(f.has(y))return!1;var S=y.match(p);if(!S)return w(y);var x={major:+S[1],minor:+S[2],patch:+S[3]};return v.major!==x.major?w(y):v.major===0?v.minor===x.minor&&v.patch<=x.patch?E(y):w(y):v.minor<=x.minor?E(y):w(y)}}s(b,"Lp"),c._makeCompatibilityCheck=b,c.isCompatible=b(I.VERSION)}),wt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unregisterGlobal=c.getGlobal=c.registerGlobal=void 0;var I=Pt(),p=et(),b=Ot(),C=p.VERSION.split(".")[0],g=Symbol.for("opentelemetry.js.api."+C),f=I._globalThis;function m(E,y,S,x){var T;x===void 0&&(x=!1);var D=f[g]=(T=f[g])!==null&&T!==void 0?T:{version:p.VERSION};if(!x&&D[E]){var O=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+E);return S.error(O.stack||O.message),!1}if(D.version!==p.VERSION){var O=new Error("@opentelemetry/api: All API registration versions must match");return S.error(O.stack||O.message),!1}return D[E]=y,S.debug("@opentelemetry/api: Registered a global for "+E+" v"+p.VERSION+"."),!0}s(m,"OT"),c.registerGlobal=m;function v(E){var y,S,x=(y=f[g])===null||y===void 0?void 0:y.version;if(!(!x||!b.isCompatible(x)))return(S=f[g])===null||S===void 0?void 0:S[E]}s(v,"PT"),c.getGlobal=v;function w(E,y){y.debug("@opentelemetry/api: Unregistering a global for "+E+" v"+p.VERSION+".");var S=f[g];S&&delete S[E]}s(w,"RT"),c.unregisterGlobal=w}),Er=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DiagComponentLogger=void 0;var I=wt(),p=function(){function C(g){this._namespace=g.namespace||"DiagComponentLogger"}return s(C,"e"),C.prototype.debug=function(){for(var g=[],f=0;f<arguments.length;f++)g[f]=arguments[f];return b("debug",this._namespace,g)},C.prototype.error=function(){for(var g=[],f=0;f<arguments.length;f++)g[f]=arguments[f];return b("error",this._namespace,g)},C.prototype.info=function(){for(var g=[],f=0;f<arguments.length;f++)g[f]=arguments[f];return b("info",this._namespace,g)},C.prototype.warn=function(){for(var g=[],f=0;f<arguments.length;f++)g[f]=arguments[f];return b("warn",this._namespace,g)},C.prototype.verbose=function(){for(var g=[],f=0;f<arguments.length;f++)g[f]=arguments[f];return b("verbose",this._namespace,g)},C}();c.DiagComponentLogger=p;function b(C,g,f){var m=I.getGlobal("diag");if(m)return f.unshift(g),m[C].apply(m,f)}s(b,"ei")}),Gt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createLogLevelDiagLogger=void 0;var I=tt();function p(b,C){b<I.DiagLogLevel.NONE?b=I.DiagLogLevel.NONE:b>I.DiagLogLevel.ALL&&(b=I.DiagLogLevel.ALL),C=C||{};function g(f,m){var v=C[f];return typeof v=="function"&&b>=m?v.bind(C):function(){}}return s(g,"r"),{error:g("error",I.DiagLogLevel.ERROR),warn:g("warn",I.DiagLogLevel.WARN),info:g("info",I.DiagLogLevel.INFO),debug:g("debug",I.DiagLogLevel.DEBUG),verbose:g("verbose",I.DiagLogLevel.VERBOSE)}}s(p,"wT"),c.createLogLevelDiagLogger=p}),$r=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DiagAPI=void 0;var I=Er(),p=Gt(),b=tt(),C=wt(),g="diag",f=function(){function m(){function v(E){return function(){var y=C.getGlobal("diag");if(y)return y[E].apply(y,arguments)}}s(v,"t");var w=this;w.setLogger=function(E,y){var S,x;if(y===void 0&&(y=b.DiagLogLevel.INFO),E===w){var T=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return w.error((S=T.stack)!==null&&S!==void 0?S:T.message),!1}var D=C.getGlobal("diag"),O=p.createLogLevelDiagLogger(y,E);if(D){var N=(x=new Error().stack)!==null&&x!==void 0?x:"<failed to generate stacktrace>";D.warn("Current logger will be overwritten from "+N),O.warn("Current logger will overwrite one already registered from "+N)}return C.registerGlobal("diag",O,w,!0)},w.disable=function(){C.unregisterGlobal(g,w)},w.createComponentLogger=function(E){return new I.DiagComponentLogger(E)},w.verbose=v("verbose"),w.debug=v("debug"),w.info=v("info"),w.warn=v("warn"),w.error=v("error")}return s(m,"e"),m.instance=function(){return this._instance||(this._instance=new m),this._instance},m}();c.DiagAPI=f}),Yn=L(c=>{"use strict";var I=c&&c.__spreadArray||function(v,w){for(var E=0,y=w.length,S=v.length;E<y;E++,S++)v[S]=w[E];return v};Object.defineProperty(c,"__esModule",{value:!0}),c.ContextAPI=void 0;var p=qt(),b=wt(),C=$r(),g="context",f=new p.NoopContextManager,m=function(){function v(){}return s(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalContextManager=function(w){return b.registerGlobal(g,w,C.DiagAPI.instance())},v.prototype.active=function(){return this._getContextManager().active()},v.prototype.with=function(w,E,y){for(var S,x=[],T=3;T<arguments.length;T++)x[T-3]=arguments[T];return(S=this._getContextManager()).with.apply(S,I([w,E,y],x))},v.prototype.bind=function(w,E){return this._getContextManager().bind(w,E)},v.prototype._getContextManager=function(){return b.getGlobal(g)||f},v.prototype.disable=function(){this._getContextManager().disable(),b.unregisterGlobal(g,C.DiagAPI.instance())},v}();c.ContextAPI=m}),kn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TraceAPI=void 0;var I=wt(),p=$e(),b=Le(),C=xe(),g=$r(),f="trace",m=function(){function v(){this._proxyTracerProvider=new p.ProxyTracerProvider,this.wrapSpanContext=b.wrapSpanContext,this.isSpanContextValid=b.isSpanContextValid,this.deleteSpan=C.deleteSpan,this.getSpan=C.getSpan,this.getSpanContext=C.getSpanContext,this.setSpan=C.setSpan,this.setSpanContext=C.setSpanContext}return s(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalTracerProvider=function(w){return this._proxyTracerProvider.setDelegate(w),I.registerGlobal(f,this._proxyTracerProvider,g.DiagAPI.instance())},v.prototype.getTracerProvider=function(){return I.getGlobal(f)||this._proxyTracerProvider},v.prototype.getTracer=function(w,E){return this.getTracerProvider().getTracer(w,E)},v.prototype.disable=function(){I.unregisterGlobal(f,g.DiagAPI.instance()),this._proxyTracerProvider=new p.ProxyTracerProvider},v}();c.TraceAPI=m}),eo=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NoopTextMapPropagator=void 0;var I=function(){function p(){}return s(p,"e"),p.prototype.inject=function(b,C){},p.prototype.extract=function(b,C){return b},p.prototype.fields=function(){return[]},p}();c.NoopTextMapPropagator=I}),ja=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.deleteBaggage=c.setBaggage=c.getBaggage=void 0;var I=ze(),p=I.createContextKey("OpenTelemetry Baggage Key");function b(f){return f.getValue(p)||void 0}s(b,"$T"),c.getBaggage=b;function C(f,m){return f.setValue(p,m)}s(C,"zT"),c.setBaggage=C;function g(f){return f.deleteValue(p)}s(g,"KT"),c.deleteBaggage=g}),qs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PropagationAPI=void 0;var I=wt(),p=eo(),b=Be(),C=ja(),g=ge(),f=$r(),m="propagation",v=new p.NoopTextMapPropagator,w=function(){function E(){this.createBaggage=g.createBaggage,this.getBaggage=C.getBaggage,this.setBaggage=C.setBaggage,this.deleteBaggage=C.deleteBaggage}return s(E,"e"),E.getInstance=function(){return this._instance||(this._instance=new E),this._instance},E.prototype.setGlobalPropagator=function(y){return I.registerGlobal(m,y,f.DiagAPI.instance())},E.prototype.inject=function(y,S,x){return x===void 0&&(x=b.defaultTextMapSetter),this._getGlobalPropagator().inject(y,S,x)},E.prototype.extract=function(y,S,x){return x===void 0&&(x=b.defaultTextMapGetter),this._getGlobalPropagator().extract(y,S,x)},E.prototype.fields=function(){return this._getGlobalPropagator().fields()},E.prototype.disable=function(){I.unregisterGlobal(m,f.DiagAPI.instance())},E.prototype._getGlobalPropagator=function(){return I.getGlobal(m)||v},E}();c.PropagationAPI=w}),rr=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(w,E,y,S){S===void 0&&(S=y),Object.defineProperty(w,S,{enumerable:!0,get:function(){return E[y]}})}:function(w,E,y,S){S===void 0&&(S=y),w[S]=E[y]}),p=c&&c.__exportStar||function(w,E){for(var y in w)y!=="default"&&!Object.prototype.hasOwnProperty.call(E,y)&&I(E,w,y)};Object.defineProperty(c,"__esModule",{value:!0}),c.diag=c.propagation=c.trace=c.context=c.isValidSpanId=c.isValidTraceId=c.isSpanContextValid=c.INVALID_SPAN_CONTEXT=c.INVALID_TRACEID=c.INVALID_SPANID=c.baggageEntryMetadataFromString=void 0,p(Te(),c);var b=ge();Object.defineProperty(c,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return b.baggageEntryMetadataFromString}}),p(we(),c),p(He(),c),p(ye(),c),p(Be(),c),p(Ke(),c),p(Xe(),c),p(ct(),c),p($e(),c),p(Me(),c),p(mt(),c),p(Tt(),c),p(Ut(),c),p(gr(),c),p(Jt(),c),p(er(),c),p(Ze(),c),p(pi(),c),p(mr(),c),p(Nr(),c);var C=Le();Object.defineProperty(c,"INVALID_SPANID",{enumerable:!0,get:function(){return C.INVALID_SPANID}}),Object.defineProperty(c,"INVALID_TRACEID",{enumerable:!0,get:function(){return C.INVALID_TRACEID}}),Object.defineProperty(c,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return C.INVALID_SPAN_CONTEXT}}),Object.defineProperty(c,"isSpanContextValid",{enumerable:!0,get:function(){return C.isSpanContextValid}}),Object.defineProperty(c,"isValidTraceId",{enumerable:!0,get:function(){return C.isValidTraceId}}),Object.defineProperty(c,"isValidSpanId",{enumerable:!0,get:function(){return C.isValidSpanId}}),p(ze(),c),p(Rt(),c);var g=Yn();c.context=g.ContextAPI.getInstance();var f=kn();c.trace=f.TraceAPI.getInstance();var m=qs();c.propagation=m.PropagationAPI.getInstance();var v=$r();c.diag=v.DiagAPI.instance(),c.default={trace:c.trace,context:c.context,propagation:c.propagation,diag:c.diag}}),to=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isTracingSuppressed=c.unsuppressTracing=c.suppressTracing=void 0;var I=rr(),p=I.createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function b(f){return f.setValue(p,!0)}s(b,"aS"),c.suppressTracing=b;function C(f){return f.deleteValue(p)}s(C,"sS"),c.unsuppressTracing=C;function g(f){return f.getValue(p)===!0}s(g,"oS"),c.isTracingSuppressed=g}),ra=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BAGGAGE_MAX_TOTAL_LENGTH=c.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=c.BAGGAGE_MAX_NAME_VALUE_PAIRS=c.BAGGAGE_HEADER=c.BAGGAGE_ITEMS_SEPARATOR=c.BAGGAGE_PROPERTIES_SEPARATOR=c.BAGGAGE_KEY_PAIR_SEPARATOR=void 0,c.BAGGAGE_KEY_PAIR_SEPARATOR="=",c.BAGGAGE_PROPERTIES_SEPARATOR=";",c.BAGGAGE_ITEMS_SEPARATOR=",",c.BAGGAGE_HEADER="baggage",c.BAGGAGE_MAX_NAME_VALUE_PAIRS=180,c.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096,c.BAGGAGE_MAX_TOTAL_LENGTH=8192}),na=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.parseKeyPairsIntoRecord=c.parsePairKeyValue=c.getKeyPairs=c.serializeKeyPairs=void 0;var I=rr(),p=ra(),b=s(m=>m.reduce((v,w)=>{let E=`${v}${v!==""?p.BAGGAGE_ITEMS_SEPARATOR:""}${w}`;return E.length>p.BAGGAGE_MAX_TOTAL_LENGTH?v:E},""),"cS");c.serializeKeyPairs=b;var C=s(m=>m.getAllEntries().map(([v,w])=>`${encodeURIComponent(v)}=${encodeURIComponent(w.value)}`),"lS");c.getKeyPairs=C;var g=s(m=>{let v=m.split(p.BAGGAGE_PROPERTIES_SEPARATOR);if(v.length<=0)return;let w=v.shift();if(!w)return;let E=w.split(p.BAGGAGE_KEY_PAIR_SEPARATOR);if(E.length!==2)return;let y=decodeURIComponent(E[0].trim()),S=decodeURIComponent(E[1].trim()),x;return v.length>0&&(x=I.baggageEntryMetadataFromString(v.join(p.BAGGAGE_PROPERTIES_SEPARATOR))),{key:y,value:S,metadata:x}},"pS");c.parsePairKeyValue=g;var f=s(m=>typeof m!="string"||m.length===0?{}:m.split(p.BAGGAGE_ITEMS_SEPARATOR).map(v=>c.parsePairKeyValue(v)).filter(v=>v!==void 0&&v.value.length>0).reduce((v,w)=>(v[w.key]=w.value,v),{}),"fS");c.parseKeyPairsIntoRecord=f}),zs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.HttpBaggagePropagator=void 0;var I=rr(),p=to(),b=ra(),C=na(),g=s(class{inject(f,m,v){let w=I.propagation.getBaggage(f);if(!w||p.isTracingSuppressed(f))return;let E=C.getKeyPairs(w).filter(S=>S.length<=b.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS).slice(0,b.BAGGAGE_MAX_NAME_VALUE_PAIRS),y=C.serializeKeyPairs(E);y.length>0&&v.set(m,b.BAGGAGE_HEADER,y)}extract(f,m,v){let w=v.get(m,b.BAGGAGE_HEADER);if(!w)return f;let E={};return w.length===0||(w.split(b.BAGGAGE_ITEMS_SEPARATOR).forEach(y=>{let S=C.parsePairKeyValue(y);if(S){let x={value:S.value};S.metadata&&(x.metadata=S.metadata),E[S.key]=x}}),Object.entries(E).length===0)?f:I.propagation.setBaggage(f,I.propagation.createBaggage(E))}fields(){return[b.BAGGAGE_HEADER]}},"Qp");c.HttpBaggagePropagator=g}),gi=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isAttributeValue=c.sanitizeAttributes=void 0;function I(g){let f={};if(g==null||typeof g!="object")return f;for(let[m,v]of Object.entries(g))p(v)&&(Array.isArray(v)?f[m]=v.slice():f[m]=v);return f}s(I,"hS"),c.sanitizeAttributes=I;function p(g){return g==null?!0:Array.isArray(g)?b(g):C(g)}s(p,"Zp"),c.isAttributeValue=p;function b(g){let f;for(let m of g)if(m!=null){if(!f){if(C(m)){f=typeof m;continue}return!1}if(typeof m!==f)return!1}return!0}s(b,"_S");function C(g){switch(typeof g){case"number":return!0;case"boolean":return!0;case"string":return!0}return!1}s(C,"Jp")}),fn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.loggingErrorHandler=void 0;var I=rr();function p(){return g=>{I.diag.error(b(g))}}s(p,"vS"),c.loggingErrorHandler=p;function b(g){return typeof g=="string"?g:JSON.stringify(C(g))}s(b,"mS");function C(g){let f={},m=g;for(;m!==null;)Object.getOwnPropertyNames(m).forEach(v=>{if(f[v])return;let w=m[v];w&&(f[v]=String(w))}),m=Object.getPrototypeOf(m);return f}s(C,"ES")}),Ii=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.globalErrorHandler=c.setGlobalErrorHandler=void 0;var I=fn(),p=I.loggingErrorHandler();function b(g){p=g}s(b,"TS"),c.setGlobalErrorHandler=b;var C=s(g=>{try{p(g)}catch(f){}},"SS");c.globalErrorHandler=C}),So=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TracesSamplerValues=void 0;var I;(function(p){p.AlwaysOff="always_off",p.AlwaysOn="always_on",p.ParentBasedAlwaysOff="parentbased_always_off",p.ParentBasedAlwaysOn="parentbased_always_on",p.ParentBasedTraceIdRatio="parentbased_traceidratio",p.TraceIdRatio="traceidratio"})(I=c.TracesSamplerValues||(c.TracesSamplerValues={}))}),Co=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.parseEnvironment=c.DEFAULT_ENVIRONMENT=void 0;var I=rr(),p=So(),b=",",C=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function g(x){return C.indexOf(x)>-1}s(g,"OS");var f=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function m(x){return f.indexOf(x)>-1}s(m,"RS"),c.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:I.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:p.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};function v(x,T,D,O=-1/0,N=1/0){if(typeof D[x]!="undefined"){let z=Number(D[x]);isNaN(z)||(z<O?T[x]=O:z>N?T[x]=N:T[x]=z)}}s(v,"NS");function w(x,T,D,O=b){let N=D[x];typeof N=="string"&&(T[x]=N.split(O).map(z=>z.trim()))}s(w,"DS");var E={ALL:I.DiagLogLevel.ALL,VERBOSE:I.DiagLogLevel.VERBOSE,DEBUG:I.DiagLogLevel.DEBUG,INFO:I.DiagLogLevel.INFO,WARN:I.DiagLogLevel.WARN,ERROR:I.DiagLogLevel.ERROR,NONE:I.DiagLogLevel.NONE};function y(x,T,D){let O=D[x];if(typeof O=="string"){let N=E[O.toUpperCase()];N!=null&&(T[x]=N)}}s(y,"MS");function S(x){let T={};for(let D in c.DEFAULT_ENVIRONMENT){let O=D;switch(O){case"OTEL_LOG_LEVEL":y(O,T,x);break;default:if(g(O))v(O,T,x);else if(m(O))w(O,T,x);else{let N=x[O];typeof N!="undefined"&&N!==null&&(T[O]=String(N))}}}return T}s(S,"xS"),c.parseEnvironment=S}),Cn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getEnv=void 0;var I=V(2037),p=Co();function b(){let C=p.parseEnvironment(process.env);return Object.assign({HOSTNAME:I.hostname()},p.DEFAULT_ENVIRONMENT,C)}s(b,"qS"),c.getEnv=b}),lt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.hexToBase64=void 0;function I(p){let b=p.length,C="";for(let g=0;g<b;g+=2){let f=p.substring(g,g+2),m=parseInt(f,16);C+=String.fromCharCode(m)}return Buffer.from(C,"ascii").toString("base64")}s(I,"kS"),c.hexToBase64=I}),Di=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.RandomIdGenerator=void 0;var I=8,p=16,b=s(class{constructor(){this.generateTraceId=g(p),this.generateSpanId=g(I)}},"of");c.RandomIdGenerator=b;var C=Buffer.allocUnsafe(p);function g(f){return function(){for(let m=0;m<f/4;m++)C.writeUInt32BE(Math.random()*2**32>>>0,m*4);for(let m=0;m<f&&!(C[m]>0);m++)m===f-1&&(C[f-1]=1);return C.toString("hex",0,f)}}s(g,"uf")}),ro=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.otperformance=void 0;var I=V(4074);c.otperformance=I.performance}),Zn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.VERSION=void 0,c.VERSION="0.23.0"}),pl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.RpcGrpcStatusCodeValues=c.MessagingOperationValues=c.MessagingDestinationKindValues=c.HttpFlavorValues=c.NetTransportValues=c.FaasInvokedProviderValues=c.FaasDocumentOperationValues=c.FaasTriggerValues=c.DbCassandraConsistencyLevelValues=c.DbSystemValues=c.SemanticAttributes=void 0,c.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"};var I;(function(y){y.OTHER_SQL="other_sql",y.MSSQL="mssql",y.MYSQL="mysql",y.ORACLE="oracle",y.DB2="db2",y.POSTGRESQL="postgresql",y.REDSHIFT="redshift",y.HIVE="hive",y.CLOUDSCAPE="cloudscape",y.HSQLDB="hsqldb",y.PROGRESS="progress",y.MAXDB="maxdb",y.HANADB="hanadb",y.INGRES="ingres",y.FIRSTSQL="firstsql",y.EDB="edb",y.CACHE="cache",y.ADABAS="adabas",y.FIREBIRD="firebird",y.DERBY="derby",y.FILEMAKER="filemaker",y.INFORMIX="informix",y.INSTANTDB="instantdb",y.INTERBASE="interbase",y.MARIADB="mariadb",y.NETEZZA="netezza",y.PERVASIVE="pervasive",y.POINTBASE="pointbase",y.SQLITE="sqlite",y.SYBASE="sybase",y.TERADATA="teradata",y.VERTICA="vertica",y.H2="h2",y.COLDFUSION="coldfusion",y.CASSANDRA="cassandra",y.HBASE="hbase",y.MONGODB="mongodb",y.REDIS="redis",y.COUCHBASE="couchbase",y.COUCHDB="couchdb",y.COSMOSDB="cosmosdb",y.DYNAMODB="dynamodb",y.NEO4J="neo4j",y.GEODE="geode",y.ELASTICSEARCH="elasticsearch",y.MEMCACHED="memcached",y.COCKROACHDB="cockroachdb"})(I=c.DbSystemValues||(c.DbSystemValues={}));var p;(function(y){y.ALL="all",y.EACH_QUORUM="each_quorum",y.QUORUM="quorum",y.LOCAL_QUORUM="local_quorum",y.ONE="one",y.TWO="two",y.THREE="three",y.LOCAL_ONE="local_one",y.ANY="any",y.SERIAL="serial",y.LOCAL_SERIAL="local_serial"})(p=c.DbCassandraConsistencyLevelValues||(c.DbCassandraConsistencyLevelValues={}));var b;(function(y){y.DATASOURCE="datasource",y.HTTP="http",y.PUBSUB="pubsub",y.TIMER="timer",y.OTHER="other"})(b=c.FaasTriggerValues||(c.FaasTriggerValues={}));var C;(function(y){y.INSERT="insert",y.EDIT="edit",y.DELETE="delete"})(C=c.FaasDocumentOperationValues||(c.FaasDocumentOperationValues={}));var g;(function(y){y.AWS="aws",y.AZURE="azure",y.GCP="gcp"})(g=c.FaasInvokedProviderValues||(c.FaasInvokedProviderValues={}));var f;(function(y){y.IP_TCP="ip_tcp",y.IP_UDP="ip_udp",y.IP="ip",y.UNIX="unix",y.PIPE="pipe",y.INPROC="inproc",y.OTHER="other"})(f=c.NetTransportValues||(c.NetTransportValues={}));var m;(function(y){y.HTTP_1_0="1.0",y.HTTP_1_1="1.1",y.HTTP_2_0="2.0",y.SPDY="SPDY",y.QUIC="QUIC"})(m=c.HttpFlavorValues||(c.HttpFlavorValues={}));var v;(function(y){y.QUEUE="queue",y.TOPIC="topic"})(v=c.MessagingDestinationKindValues||(c.MessagingDestinationKindValues={}));var w;(function(y){y.RECEIVE="receive",y.PROCESS="process"})(w=c.MessagingOperationValues||(c.MessagingOperationValues={}));var E;(function(y){y[y.OK=0]="OK",y[y.CANCELLED=1]="CANCELLED",y[y.UNKNOWN=2]="UNKNOWN",y[y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",y[y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",y[y.NOT_FOUND=5]="NOT_FOUND",y[y.ALREADY_EXISTS=6]="ALREADY_EXISTS",y[y.PERMISSION_DENIED=7]="PERMISSION_DENIED",y[y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",y[y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",y[y.ABORTED=10]="ABORTED",y[y.OUT_OF_RANGE=11]="OUT_OF_RANGE",y[y.UNIMPLEMENTED=12]="UNIMPLEMENTED",y[y.INTERNAL=13]="INTERNAL",y[y.UNAVAILABLE=14]="UNAVAILABLE",y[y.DATA_LOSS=15]="DATA_LOSS",y[y.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(E=c.RpcGrpcStatusCodeValues||(c.RpcGrpcStatusCodeValues={}))}),Ws=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(pl(),c)}),Gs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TelemetrySdkLanguageValues=c.OsTypeValues=c.HostArchValues=c.AwsEcsLaunchtypeValues=c.CloudPlatformValues=c.CloudProviderValues=c.ResourceAttributes=void 0,c.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"};var I;(function(m){m.AWS="aws",m.AZURE="azure",m.GCP="gcp"})(I=c.CloudProviderValues||(c.CloudProviderValues={}));var p;(function(m){m.AWS_EC2="aws_ec2",m.AWS_ECS="aws_ecs",m.AWS_EKS="aws_eks",m.AWS_LAMBDA="aws_lambda",m.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",m.AZURE_VM="azure_vm",m.AZURE_CONTAINER_INSTANCES="azure_container_instances",m.AZURE_AKS="azure_aks",m.AZURE_FUNCTIONS="azure_functions",m.AZURE_APP_SERVICE="azure_app_service",m.GCP_COMPUTE_ENGINE="gcp_compute_engine",m.GCP_CLOUD_RUN="gcp_cloud_run",m.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",m.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",m.GCP_APP_ENGINE="gcp_app_engine"})(p=c.CloudPlatformValues||(c.CloudPlatformValues={}));var b;(function(m){m.EC2="ec2",m.FARGATE="fargate"})(b=c.AwsEcsLaunchtypeValues||(c.AwsEcsLaunchtypeValues={}));var C;(function(m){m.AMD64="amd64",m.ARM32="arm32",m.ARM64="arm64",m.IA64="ia64",m.PPC32="ppc32",m.PPC64="ppc64",m.X86="x86"})(C=c.HostArchValues||(c.HostArchValues={}));var g;(function(m){m.WINDOWS="windows",m.LINUX="linux",m.DARWIN="darwin",m.FREEBSD="freebsd",m.NETBSD="netbsd",m.OPENBSD="openbsd",m.DRAGONFLYBSD="dragonflybsd",m.HPUX="hpux",m.AIX="aix",m.SOLARIS="solaris",m.Z_OS="z_os"})(g=c.OsTypeValues||(c.OsTypeValues={}));var f;(function(m){m.CPP="cpp",m.DOTNET="dotnet",m.ERLANG="erlang",m.GO="go",m.JAVA="java",m.NODEJS="nodejs",m.PHP="php",m.PYTHON="python",m.RUBY="ruby",m.WEBJS="webjs"})(f=c.TelemetrySdkLanguageValues||(c.TelemetrySdkLanguageValues={}))}),Vs=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Gs(),c)}),Mr=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Ws(),c),p(Vs(),c)}),yr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SDK_INFO=void 0;var I=Zn(),p=Mr();c.SDK_INFO={[p.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[p.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[p.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:p.TelemetrySdkLanguageValues.NODEJS,[p.ResourceAttributes.TELEMETRY_SDK_VERSION]:I.VERSION}}),tr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.unrefTimer=void 0;function I(p){p.unref()}s(I,"uA"),c.unrefTimer=I}),jr=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Cn(),c),p(lt(),c),p(Di(),c),p(ro(),c),p(yr(),c),p(tr(),c)}),qa=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(jr(),c)}),Ks=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isTimeInput=c.isTimeInputHrTime=c.hrTimeToMicroseconds=c.hrTimeToMilliseconds=c.hrTimeToNanoseconds=c.hrTimeToTimeStamp=c.hrTimeDuration=c.timeInputToHrTime=c.hrTime=void 0;var I=qa(),p=9,b=Math.pow(10,p);function C(D){let O=D/1e3,N=Math.trunc(O),z=Number((O-N).toFixed(p))*b;return[N,z]}s(C,"Ma");function g(){let D=I.otperformance.timeOrigin;if(typeof D!="number"){let O=I.otperformance;D=O.timing&&O.timing.fetchStart}return D}s(g,"Ef");function f(D){let O=C(g()),N=C(typeof D=="number"?D:I.otperformance.now()),z=O[0]+N[0],X=O[1]+N[1];return X>b&&(X-=b,z+=1),[z,X]}s(f,"yf"),c.hrTime=f;function m(D){if(x(D))return D;if(typeof D=="number")return D<g()?f(D):C(D);if(D instanceof Date)return C(D.getTime());throw TypeError("Invalid input type")}s(m,"fA"),c.timeInputToHrTime=m;function v(D,O){let N=O[0]-D[0],z=O[1]-D[1];return z<0&&(N-=1,z+=b),[N,z]}s(v,"dA"),c.hrTimeDuration=v;function w(D){let O=p,N=`${"0".repeat(O)}${D[1]}Z`,z=N.substr(N.length-O-1);return new Date(D[0]*1e3).toISOString().replace("000Z",z)}s(w,"hA"),c.hrTimeToTimeStamp=w;function E(D){return D[0]*b+D[1]}s(E,"_A"),c.hrTimeToNanoseconds=E;function y(D){return Math.round(D[0]*1e3+D[1]/1e6)}s(y,"gA"),c.hrTimeToMilliseconds=y;function S(D){return Math.round(D[0]*1e6+D[1]/1e3)}s(S,"vA"),c.hrTimeToMicroseconds=S;function x(D){return Array.isArray(D)&&D.length===2&&typeof D[0]=="number"&&typeof D[1]=="number"}s(x,"nu"),c.isTimeInputHrTime=x;function T(D){return x(D)||typeof D=="number"||D instanceof Date}s(T,"mA"),c.isTimeInput=T}),Qs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),gl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExportResultCode=void 0;var I;(function(p){p[p.SUCCESS=0]="SUCCESS",p[p.FAILED=1]="FAILED"})(I=c.ExportResultCode||(c.ExportResultCode={}))}),za=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CompositePropagator=void 0;var I=rr(),p=s(class{constructor(b={}){var C;this._propagators=(C=b.propagators)!==null&&C!==void 0?C:[],this._fields=Array.from(new Set(this._propagators.map(g=>typeof g.fields=="function"?g.fields():[]).reduce((g,f)=>g.concat(f),[])))}inject(b,C,g){for(let f of this._propagators)try{f.inject(b,C,g)}catch(m){I.diag.warn(`Failed to inject with ${f.constructor.name}. Err: ${m.message}`)}}extract(b,C,g){return this._propagators.reduce((f,m)=>{try{return m.extract(f,C,g)}catch(v){I.diag.warn(`Failed to inject with ${m.constructor.name}. Err: ${v.message}`)}return f},b)}fields(){return this._fields.slice()}},"Cf");c.CompositePropagator=p}),Nn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.validateValue=c.validateKey=void 0;var I="[_0-9a-z-*/]",p=`[a-z]${I}{0,255}`,b=`[a-z0-9]${I}{0,240}@[a-z]${I}{0,13}`,C=new RegExp(`^(?:${p}|${b})$`),g=/^[ -~]{0,255}[!-~]$/,f=/,|=/;function m(w){return C.test(w)}s(m,"IA"),c.validateKey=m;function v(w){return g.test(w)&&!f.test(w)}s(v,"CA"),c.validateValue=v}),ia=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TraceState=void 0;var I=Nn(),p=32,b=512,C=",",g="=",f=s(class{constructor(m){this._internalState=new Map,m&&this._parse(m)}set(m,v){let w=this._clone();return w._internalState.has(m)&&w._internalState.delete(m),w._internalState.set(m,v),w}unset(m){let v=this._clone();return v._internalState.delete(m),v}get(m){return this._internalState.get(m)}serialize(){return this._keys().reduce((m,v)=>(m.push(v+g+this.get(v)),m),[]).join(C)}_parse(m){m.length>b||(this._internalState=m.split(C).reverse().reduce((v,w)=>{let E=w.trim(),y=E.indexOf(g);if(y!==-1){let S=E.slice(0,y),x=E.slice(y+1,w.length);I.validateKey(S)&&I.validateValue(x)&&v.set(S,x)}return v},new Map),this._internalState.size>p&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,p))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let m=new f;return m._internalState=new Map(this._internalState),m}},"La");c.TraceState=f}),xo=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.HttpTraceContextPropagator=c.parseTraceParent=c.TRACE_STATE_HEADER=c.TRACE_PARENT_HEADER=void 0;var I=rr(),p=to(),b=ia();c.TRACE_PARENT_HEADER="traceparent",c.TRACE_STATE_HEADER="tracestate";var C="00",g="(?!ff)[\\da-f]{2}",f="(?![0]{32})[\\da-f]{32}",m="(?![0]{16})[\\da-f]{16}",v="[\\da-f]{2}",w=new RegExp(`^\\s?(${g})-(${f})-(${m})-(${v})(-.*)?\\s?$`);function E(S){let x=w.exec(S);return!x||x[1]==="00"&&x[5]?null:{traceId:x[2],spanId:x[3],traceFlags:parseInt(x[4],16)}}s(E,"Mf"),c.parseTraceParent=E;var y=s(class{inject(S,x,T){let D=I.trace.getSpanContext(S);if(!D||p.isTracingSuppressed(S)||!I.isSpanContextValid(D))return;let O=`${C}-${D.traceId}-${D.spanId}-0${Number(D.traceFlags||I.TraceFlags.NONE).toString(16)}`;T.set(x,c.TRACE_PARENT_HEADER,O),D.traceState&&T.set(x,c.TRACE_STATE_HEADER,D.traceState.serialize())}extract(S,x,T){let D=T.get(x,c.TRACE_PARENT_HEADER);if(!D)return S;let O=Array.isArray(D)?D[0]:D;if(typeof O!="string")return S;let N=E(O);if(!N)return S;N.isRemote=!0;let z=T.get(x,c.TRACE_STATE_HEADER);if(z){let X=Array.isArray(z)?z.join(","):z;N.traceState=new b.TraceState(typeof X=="string"?X:void 0)}return I.trace.setSpanContext(S,N)}fields(){return[c.TRACE_PARENT_HEADER,c.TRACE_STATE_HEADER]}},"xf");c.HttpTraceContextPropagator=y}),ml=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),vl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getRPCMetadata=c.deleteRPCMetadata=c.setRPCMetadata=c.RPCType=void 0;var I=rr(),p=I.createContextKey("OpenTelemetry SDK Context Key RPC_METADATA"),b;(function(m){m.HTTP="http"})(b=c.RPCType||(c.RPCType={}));function C(m,v){return m.setValue(p,v)}s(C,"jA"),c.setRPCMetadata=C;function g(m){return m.deleteValue(p)}s(g,"HA"),c.deleteRPCMetadata=g;function f(m){return m.getValue(p)}s(f,"UA"),c.getRPCMetadata=f}),no=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AlwaysOffSampler=void 0;var I=rr(),p=s(class{shouldSample(){return{decision:I.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}},"Hf");c.AlwaysOffSampler=p}),Jn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AlwaysOnSampler=void 0;var I=rr(),p=s(class{shouldSample(){return{decision:I.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}},"Uf");c.AlwaysOnSampler=p}),yl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ParentBasedSampler=void 0;var I=rr(),p=Ii(),b=no(),C=Jn(),g=s(class{constructor(f){var m,v,w,E;this._root=f.root,this._root||(p.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new C.AlwaysOnSampler),this._remoteParentSampled=(m=f.remoteParentSampled)!==null&&m!==void 0?m:new C.AlwaysOnSampler,this._remoteParentNotSampled=(v=f.remoteParentNotSampled)!==null&&v!==void 0?v:new b.AlwaysOffSampler,this._localParentSampled=(w=f.localParentSampled)!==null&&w!==void 0?w:new C.AlwaysOnSampler,this._localParentNotSampled=(E=f.localParentNotSampled)!==null&&E!==void 0?E:new b.AlwaysOffSampler}shouldSample(f,m,v,w,E,y){let S=I.trace.getSpanContext(f);return!S||!I.isSpanContextValid(S)?this._root.shouldSample(f,m,v,w,E,y):S.isRemote?S.traceFlags&I.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(f,m,v,w,E,y):this._remoteParentNotSampled.shouldSample(f,m,v,w,E,y):S.traceFlags&I.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(f,m,v,w,E,y):this._localParentNotSampled.shouldSample(f,m,v,w,E,y)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}},"Gf");c.ParentBasedSampler=g}),Wa=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TraceIdRatioBasedSampler=void 0;var I=rr(),p=s(class{constructor(b=0){this._ratio=b,this._ratio=this._normalize(b),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(b,C){return{decision:I.isValidTraceId(C)&&this._accumulate(C)<this._upperBound?I.SamplingDecision.RECORD_AND_SAMPLED:I.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(b){return typeof b!="number"||isNaN(b)?0:b>=1?1:b<=0?0:b}_accumulate(b){let C=0;for(let g=0;g<b.length/8;g++){let f=g*8,m=parseInt(b.slice(f,f+8),16);C=(C^m)>>>0}return C}},"Vf");c.TraceIdRatioBasedSampler=p}),_l=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isUrlIgnored=c.urlMatches=void 0;function I(b,C){return typeof C=="string"?b===C:C.test(b)}s(I,"zf"),c.urlMatches=I;function p(b,C){if(!C)return!1;for(let g of C)if(I(b,g))return!0;return!1}s(p,"VA"),c.isUrlIgnored=p}),Ga=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.isWrapped=void 0;function I(p){return typeof p=="function"&&typeof p.__original=="function"&&typeof p.__unwrap=="function"&&p.__wrapped===!0}s(I,"$A"),c.isWrapped=I}),Mn=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),c.baggageUtils=void 0,p(zs(),c),p(gi(),c),p(Ii(),c),p(fn(),c),p(Ks(),c),p(Qs(),c),p(gl(),c),p(Zn(),c),c.baggageUtils=na(),p(qa(),c),p(za(),c),p(xo(),c),p(ml(),c),p(vl(),c),p(no(),c),p(Jn(),c),p(yl(),c),p(Wa(),c),p(to(),c),p(ia(),c),p(Co(),c),p(So(),c),p(_l(),c),p(Ga(),c),p(Zn(),c)}),mi=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExceptionEventName=void 0,c.ExceptionEventName="exception"}),Fn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Span=void 0;var I=rr(),p=Mn(),b=Mr(),C=mi(),g=s(class{constructor(f,m,v,w,E,y,S=[],x=p.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:I.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=v,this._spanContext=w,this.parentSpanId=y,this.kind=E,this.links=S,this.startTime=p.timeInputToHrTime(x),this.resource=f.resource,this.instrumentationLibrary=f.instrumentationLibrary,this._spanLimits=f.getSpanLimits(),this._spanProcessor=f.getActiveSpanProcessor(),this._spanProcessor.onStart(this,m)}spanContext(){return this._spanContext}setAttribute(f,m){return m==null||this._isSpanEnded()?this:f.length===0?(I.diag.warn(`Invalid attribute key: ${f}`),this):p.isAttributeValue(m)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,f)?this:(this.attributes[f]=m,this):(I.diag.warn(`Invalid attribute value set for key: ${f}`),this)}setAttributes(f){for(let[m,v]of Object.entries(f))this.setAttribute(m,v);return this}addEvent(f,m,v){return this._isSpanEnded()?this:(this.events.length>=this._spanLimits.eventCountLimit&&(I.diag.warn("Dropping extra events."),this.events.shift()),p.isTimeInput(m)&&(typeof v=="undefined"&&(v=m),m=void 0),typeof v=="undefined"&&(v=p.hrTime()),this.events.push({name:f,attributes:m,time:p.timeInputToHrTime(v)}),this)}setStatus(f){return this._isSpanEnded()?this:(this.status=f,this)}updateName(f){return this._isSpanEnded()?this:(this.name=f,this)}end(f=p.hrTime()){if(this._isSpanEnded()){I.diag.error("You can only call end() on a span once.");return}this._ended=!0,this.endTime=p.timeInputToHrTime(f),this._duration=p.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&I.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this)}isRecording(){return this._ended===!1}recordException(f,m=p.hrTime()){let v={};typeof f=="string"?v[b.SemanticAttributes.EXCEPTION_MESSAGE]=f:f&&(f.code?v[b.SemanticAttributes.EXCEPTION_TYPE]=f.code.toString():f.name&&(v[b.SemanticAttributes.EXCEPTION_TYPE]=f.name),f.message&&(v[b.SemanticAttributes.EXCEPTION_MESSAGE]=f.message),f.stack&&(v[b.SemanticAttributes.EXCEPTION_STACKTRACE]=f.stack)),v[b.SemanticAttributes.EXCEPTION_TYPE]||v[b.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(C.ExceptionEventName,v,m):I.diag.warn(`Failed to record an exception ${f}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&I.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}},"Qf");c.Span=g}),Va=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.buildSamplerFromEnv=c.DEFAULT_CONFIG=void 0;var I=rr(),p=Mn(),b=p.getEnv(),C=p.TracesSamplerValues.AlwaysOn;c.DEFAULT_CONFIG={sampler:g(b),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:p.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:p.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:p.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}};function g(v=p.getEnv()){switch(v.OTEL_TRACES_SAMPLER){case p.TracesSamplerValues.AlwaysOn:return new p.AlwaysOnSampler;case p.TracesSamplerValues.AlwaysOff:return new p.AlwaysOffSampler;case p.TracesSamplerValues.ParentBasedAlwaysOn:return new p.ParentBasedSampler({root:new p.AlwaysOnSampler});case p.TracesSamplerValues.ParentBasedAlwaysOff:return new p.ParentBasedSampler({root:new p.AlwaysOffSampler});case p.TracesSamplerValues.TraceIdRatio:return new p.TraceIdRatioBasedSampler(m(v));case p.TracesSamplerValues.ParentBasedTraceIdRatio:return new p.ParentBasedSampler({root:new p.TraceIdRatioBasedSampler(m(v))});default:return I.diag.error(`OTEL_TRACES_SAMPLER value "${v.OTEL_TRACES_SAMPLER} invalid, defaulting to ${C}".`),new p.AlwaysOnSampler}}s(g,"Wf"),c.buildSamplerFromEnv=g;var f=1;function m(v){if(v.OTEL_TRACES_SAMPLER_ARG===void 0||v.OTEL_TRACES_SAMPLER_ARG==="")return I.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${f}.`),f;let w=Number(v.OTEL_TRACES_SAMPLER_ARG);return isNaN(w)?(I.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${f}.`),f):w<0||w>1?(I.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${f}.`),f):w}s(m,"Zf")}),ei=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.mergeConfig=void 0;var I=Va();function p(b){let C={sampler:I.buildSamplerFromEnv()},g=Object.assign({},I.DEFAULT_CONFIG,C,b);return g.spanLimits=Object.assign({},I.DEFAULT_CONFIG.spanLimits,b.spanLimits||{}),g}s(p,"QA"),c.mergeConfig=p}),Xs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Tracer=void 0;var I=rr(),p=Mn(),b=Fn(),C=ei(),g=s(class{constructor(m,v,w){this._tracerProvider=w;let E=C.mergeConfig(v);this._sampler=E.sampler,this._spanLimits=E.spanLimits,this._idGenerator=v.idGenerator||new p.RandomIdGenerator,this.resource=w.resource,this.instrumentationLibrary=m}startSpan(m,v={},w=I.context.active()){var E,y;if(p.isTracingSuppressed(w))return I.diag.debug("Instrumentation suppressed, returning Noop Span"),I.trace.wrapSpanContext(I.INVALID_SPAN_CONTEXT);let S=f(v,w),x=this._idGenerator.generateSpanId(),T,D,O;!S||!I.trace.isSpanContextValid(S)?T=this._idGenerator.generateTraceId():(T=S.traceId,D=S.traceState,O=S.spanId);let N=(E=v.kind)!==null&&E!==void 0?E:I.SpanKind.INTERNAL,z=(y=v.links)!==null&&y!==void 0?y:[],X=p.sanitizeAttributes(v.attributes),K=this._sampler.shouldSample(v.root?I.trace.setSpanContext(w,I.INVALID_SPAN_CONTEXT):w,T,m,N,X,z),fe=K.decision===I.SamplingDecision.RECORD_AND_SAMPLED?I.TraceFlags.SAMPLED:I.TraceFlags.NONE,be={traceId:T,spanId:x,traceFlags:fe,traceState:D};if(K.decision===I.SamplingDecision.NOT_RECORD)return I.diag.debug("Recording is off, propagating context in a non-recording span"),I.trace.wrapSpanContext(be);let Fe=new b.Span(this,w,m,be,N,O,z,v.startTime);return Fe.setAttributes(Object.assign(X,K.attributes)),Fe}startActiveSpan(m,v,w,E){let y,S,x;if(arguments.length<2)return;arguments.length===2?x=v:arguments.length===3?(y=v,x=w):(y=v,S=w,x=E);let T=S!=null?S:I.context.active(),D=this.startSpan(m,y,T),O=I.trace.setSpan(T,D);return I.context.with(O,x,void 0,D)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}},"ed");c.Tracer=g;function f(m,v){if(!m.root)return I.trace.getSpanContext(v)}s(f,"JA")}),oa=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.defaultServiceName=void 0;function I(){return`unknown_service:${process.argv0}`}s(I,"eb"),c.defaultServiceName=I}),Ys=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.detectResources=void 0;var I=oo(),p=rr(),b=V(3837),C=s(async(f={})=>{let m=Object.assign(f),v=await Promise.all((m.detectors||[]).map(async w=>{try{let E=await w.detect(m);return p.diag.debug(`${w.constructor.name} found resource.`,E),E}catch(E){return p.diag.debug(`${w.constructor.name} failed: ${E.message}`),I.Resource.empty()}}));return g(v),v.reduce((w,E)=>w.merge(E),I.Resource.empty())},"rb");c.detectResources=C;var g=s(f=>{f.forEach(m=>{if(Object.keys(m.attributes).length>0){let v=b.inspect(m.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});p.diag.verbose(v)}})},"nb")}),Zs=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.envDetector=void 0;var I=rr(),p=Mn(),b=Mr(),C=To(),g=s(class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(f){let m={},v=p.getEnv(),w=v.OTEL_RESOURCE_ATTRIBUTES,E=v.OTEL_SERVICE_NAME;if(w)try{let y=this._parseResourceAttributes(w);Object.assign(m,y)}catch(y){I.diag.debug(`EnvDetector failed: ${y.message}`)}return E&&(m[b.ResourceAttributes.SERVICE_NAME]=E),new C.Resource(m)}_parseResourceAttributes(f){if(!f)return{};let m={},v=f.split(this._COMMA_SEPARATOR,-1);for(let w of v){let E=w.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(E.length!==2)continue;let[y,S]=E;if(y=y.trim(),S=S.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(y))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(S))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);m[y]=S}return m}_isValid(f){return f.length<=this._MAX_LENGTH&&this._isPrintableString(f)}_isPrintableString(f){for(let m=0;m<f.length;m++){let v=f.charAt(m);if(v<=" "||v>="~")return!1}return!0}_isValidAndNotEmpty(f){return f.length>0&&this._isValid(f)}},"ad");c.envDetector=new g}),Pi=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.processDetector=void 0;var I=rr(),p=Mr(),b=To(),C=s(class{async detect(g){let f={[p.ResourceAttributes.PROCESS_PID]:process.pid,[p.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[p.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[p.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(f,g)}_getResourceAttributes(g,f){return g[p.ResourceAttributes.PROCESS_EXECUTABLE_NAME]===""||g[p.ResourceAttributes.PROCESS_EXECUTABLE_PATH]===""||g[p.ResourceAttributes.PROCESS_COMMAND]===""||g[p.ResourceAttributes.PROCESS_COMMAND_LINE]===""?(I.diag.debug("ProcessDetector failed: Unable to find required process resources. "),b.Resource.empty()):new b.Resource(Object.assign({},g))}},"ud");c.processDetector=new C}),wl=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Zs(),c),p(Pi(),c)}),Oi=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(oa(),c),p(Ys(),c),p(wl(),c)}),io=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Oi(),c)}),oo=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Resource=void 0;var I=Mr(),p=Mn(),b=io(),C=s(class{constructor(g){this.attributes=g}static empty(){return C.EMPTY}static default(){return new C({[I.ResourceAttributes.SERVICE_NAME]:b.defaultServiceName(),[I.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:p.SDK_INFO[I.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[I.ResourceAttributes.TELEMETRY_SDK_NAME]:p.SDK_INFO[I.ResourceAttributes.TELEMETRY_SDK_NAME],[I.ResourceAttributes.TELEMETRY_SDK_VERSION]:p.SDK_INFO[I.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(g){if(!g||!Object.keys(g.attributes).length)return this;let f=Object.assign({},this.attributes,g.attributes);return new C(f)}},"wt");c.Resource=C,C.EMPTY=new C({})}),ki=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ka=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),To=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(oo(),c),p(io(),c),p(ki(),c),p(Ka(),c)}),bl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.MultiSpanProcessor=void 0;var I=Mn(),p=s(class{constructor(b){this._spanProcessors=b}forceFlush(){let b=[];for(let C of this._spanProcessors)b.push(C.forceFlush());return new Promise(C=>{Promise.all(b).then(()=>{C()}).catch(g=>{I.globalErrorHandler(g||new Error("MultiSpanProcessor: forceFlush failed")),C()})})}onStart(b,C){for(let g of this._spanProcessors)g.onStart(b,C)}onEnd(b){for(let C of this._spanProcessors)C.onEnd(b)}shutdown(){let b=[];for(let C of this._spanProcessors)b.push(C.shutdown());return new Promise((C,g)=>{Promise.all(b).then(()=>{C()},g)})}},"vd");c.MultiSpanProcessor=p}),aa=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NoopSpanProcessor=void 0;var I=s(class{onStart(p,b){}onEnd(p){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}},"Ed");c.NoopSpanProcessor=I}),Js=L((c,I)=>{var p=200,b="__lodash_hash_undefined__",C=800,g=16,f=9007199254740991,m="[object Arguments]",v="[object Array]",w="[object AsyncFunction]",E="[object Boolean]",y="[object Date]",S="[object Error]",x="[object Function]",T="[object GeneratorFunction]",D="[object Map]",O="[object Number]",N="[object Null]",z="[object Object]",X="[object Proxy]",K="[object RegExp]",fe="[object Set]",be="[object String]",Fe="[object Undefined]",ke="[object WeakMap]",Qe="[object ArrayBuffer]",it="[object DataView]",gt="[object Float32Array]",xt="[object Float64Array]",Ht="[object Int8Array]",jt="[object Int16Array]",cr="[object Int32Array]",Xt="[object Uint8Array]",Je="[object Uint8ClampedArray]",dt="[object Uint16Array]",ut="[object Uint32Array]",yt=/[\\^$.*+?()[\]{}|]/g,Lt=/^\[object .+?Constructor\]$/,Yt=/^(?:0|[1-9]\d*)$/,At={};At[gt]=At[xt]=At[Ht]=At[jt]=At[cr]=At[Xt]=At[Je]=At[dt]=At[ut]=!0,At[m]=At[v]=At[Qe]=At[E]=At[it]=At[y]=At[S]=At[x]=At[D]=At[O]=At[z]=At[K]=At[fe]=At[be]=At[ke]=!1;var Zt=typeof global=="object"&&global&&global.Object===Object&&global,Ir=typeof self=="object"&&self&&self.Object===Object&&self,Dr=Zt||Ir||Function("return this")(),_r=typeof c=="object"&&c&&!c.nodeType&&c,ur=_r&&typeof I=="object"&&I&&!I.nodeType&&I,Wr=ur&&ur.exports===_r,Gr=Wr&&Zt.process,Ft=function(){try{var te=ur&&ur.require&&ur.require("util").types;return te||Gr&&Gr.binding&&Gr.binding("util")}catch(_e){}}(),Ct=Ft&&Ft.isTypedArray;function ar(te,_e,Oe){switch(Oe.length){case 0:return te.call(_e);case 1:return te.call(_e,Oe[0]);case 2:return te.call(_e,Oe[0],Oe[1]);case 3:return te.call(_e,Oe[0],Oe[1],Oe[2])}return te.apply(_e,Oe)}s(ar,"Yb");function kr(te,_e){for(var Oe=-1,_t=Array(te);++Oe<te;)_t[Oe]=_e(Oe);return _t}s(kr,"Qb");function ss(te){return function(_e){return te(_e)}}s(ss,"Wb");function uo(te,_e){return te==null?void 0:te[_e]}s(uo,"Zb");function Vt(te,_e){return function(Oe){return te(_e(Oe))}}s(Vt,"Jb");var cs=Array.prototype,wi=Function.prototype,Hn=Object.prototype,ii=Dr["__core-js_shared__"],$i=wi.toString,An=Hn.hasOwnProperty,ls=function(){var te=/[^.]+$/.exec(ii&&ii.keys&&ii.keys.IE_PROTO||"");return te?"Symbol(src)_1."+te:""}(),us=Hn.toString,Rn=$i.call(Object),wc=RegExp("^"+$i.call(An).replace(yt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fo=Wr?Dr.Buffer:void 0,ds=Dr.Symbol,Bi=Dr.Uint8Array,bi=Fo?Fo.allocUnsafe:void 0,nn=Vt(Object.getPrototypeOf,Object),oi=Object.create,ya=Hn.propertyIsEnumerable,_a=cs.splice,wn=ds?ds.toStringTag:void 0,Ei=function(){try{var te=ho(Object,"defineProperty");return te({},"",{}),te}catch(_e){}}(),bn=Fo?Fo.isBuffer:void 0,Ui=Math.max,fr=Date.now,wa=ho(Dr,"Map"),Hi=ho(Object,"create"),Ur=function(){function te(){}return s(te,"e"),function(_e){if(!qi(_e))return{};if(oi)return oi(_e);te.prototype=_e;var Oe=new te;return te.prototype=void 0,Oe}}();function un(te){var _e=-1,Oe=te==null?0:te.length;for(this.clear();++_e<Oe;){var _t=te[_e];this.set(_t[0],_t[1])}}s(un,"or");function bc(){this.__data__=Hi?Hi(null):{},this.size=0}s(bc,"cI");function ba(te){var _e=this.has(te)&&delete this.__data__[te];return this.size-=_e?1:0,_e}s(ba,"lI");function hs(te){var _e=this.__data__;if(Hi){var Oe=_e[te];return Oe===b?void 0:Oe}return An.call(_e,te)?_e[te]:void 0}s(hs,"pI");function Ea(te){var _e=this.__data__;return Hi?_e[te]!==void 0:An.call(_e,te)}s(Ea,"fI");function fs(te,_e){var Oe=this.__data__;return this.size+=this.has(te)?0:1,Oe[te]=Hi&&_e===void 0?b:_e,this}s(fs,"dI"),un.prototype.clear=bc,un.prototype.delete=ba,un.prototype.get=hs,un.prototype.has=Ea,un.prototype.set=fs;function En(te){var _e=-1,Oe=te==null?0:te.length;for(this.clear();++_e<Oe;){var _t=te[_e];this.set(_t[0],_t[1])}}s(En,"ct");function ps(){this.__data__=[],this.size=0}s(ps,"hI");function Ec(te){var _e=this.__data__,Oe=$t(_e,te);if(Oe<0)return!1;var _t=_e.length-1;return Oe==_t?_e.pop():_a.call(_e,Oe,1),--this.size,!0}s(Ec,"_I");function Et(te){var _e=this.__data__,Oe=$t(_e,te);return Oe<0?void 0:_e[Oe][1]}s(Et,"gI");function Sa(te){return $t(this.__data__,te)>-1}s(Sa,"vI");function Ca(te,_e){var Oe=this.__data__,_t=$t(Oe,te);return _t<0?(++this.size,Oe.push([te,_e])):Oe[_t][1]=_e,this}s(Ca,"mI"),En.prototype.clear=ps,En.prototype.delete=Ec,En.prototype.get=Et,En.prototype.has=Sa,En.prototype.set=Ca;function jn(te){var _e=-1,Oe=te==null?0:te.length;for(this.clear();++_e<Oe;){var _t=te[_e];this.set(_t[0],_t[1])}}s(jn,"tn");function gs(){this.size=0,this.__data__={hash:new un,map:new(wa||En),string:new un}}s(gs,"EI");function ms(te){var _e=xa(this,te).delete(te);return this.size-=_e?1:0,_e}s(ms,"yI");function vs(te){return xa(this,te).get(te)}s(vs,"TI");function Si(te){return xa(this,te).has(te)}s(Si,"SI");function ys(te,_e){var Oe=xa(this,te),_t=Oe.size;return Oe.set(te,_e),this.size+=Oe.size==_t?0:1,this}s(ys,"AI"),jn.prototype.clear=gs,jn.prototype.delete=ms,jn.prototype.get=vs,jn.prototype.has=Si,jn.prototype.set=ys;function wr(te){var _e=this.__data__=new En(te);this.size=_e.size}s(wr,"rn");function _s(){this.__data__=new En,this.size=0}s(_s,"bI");function Z(te){var _e=this.__data__,Oe=_e.delete(te);return this.size=_e.size,Oe}s(Z,"II");function ve(te){return this.__data__.get(te)}s(ve,"CI");function Re(te){return this.__data__.has(te)}s(Re,"OI");function ot(te,_e){var Oe=this.__data__;if(Oe instanceof En){var _t=Oe.__data__;if(!wa||_t.length<p-1)return _t.push([te,_e]),this.size=++Oe.size,this;Oe=this.__data__=new jn(_t)}return Oe.set(te,_e),this.size=Oe.size,this}s(ot,"PI"),wr.prototype.clear=_s,wr.prototype.delete=Z,wr.prototype.get=ve,wr.prototype.has=Re,wr.prototype.set=ot;function st(te,_e){var Oe=jo(te),_t=!Oe&&Aa(te),Kt=!Oe&&!_t&&Rc(te),lr=!Oe&&!_t&&!Kt&&Dc(te),hr=Oe||_t||Kt||lr,Qt=hr?kr(te.length,String):[],pr=Qt.length;for(var Pn in te)(_e||An.call(te,Pn))&&!(hr&&(Pn=="length"||Kt&&(Pn=="offset"||Pn=="parent")||lr&&(Pn=="buffer"||Pn=="byteLength"||Pn=="byteOffset")||fo(Pn,pr)))&&Qt.push(Pn);return Qt}s(st,"RI");function vt(te,_e,Oe){(Oe!==void 0&&!Ci(te[_e],Oe)||Oe===void 0&&!(_e in te))&&Bt(te,_e,Oe)}s(vt,"Au");function bt(te,_e,Oe){var _t=te[_e];(!(An.call(te,_e)&&Ci(_t,Oe))||Oe===void 0&&!(_e in te))&&Bt(te,_e,Oe)}s(bt,"NI");function $t(te,_e){for(var Oe=te.length;Oe--;)if(Ci(te[Oe][0],_e))return Oe;return-1}s($t,"us");function Bt(te,_e,Oe){_e=="__proto__"&&Ei?Ei(te,_e,{configurable:!0,enumerable:!0,value:Oe,writable:!0}):te[_e]=Oe}s(Bt,"bu");var In=Fl();function Vr(te){return te==null?te===void 0?Fe:N:wn&&wn in Object(te)?Ll(te):Bo(te)}s(Vr,"cs");function Tr(te){return Dn(te)&&Vr(te)==m}s(Tr,"Hd");function Kr(te){if(!qi(te)||Ss(te))return!1;var _e=xs(te)?wc:Lt;return _e.test(Ho(te))}s(Kr,"wI");function Qn(te){return Dn(te)&&Ra(te.length)&&!!At[Vr(te)]}s(Qn,"MI");function kl(te){if(!qi(te))return ji(te);var _e=$o(te),Oe=[];for(var _t in te)_t=="constructor"&&(_e||!An.call(te,_t))||Oe.push(_t);return Oe}s(kl,"xI");function Sc(te,_e,Oe,_t,Kt){te!==_e&&In(_e,function(lr,hr){if(Kt||(Kt=new wr),qi(lr))Nl(te,_e,hr,Oe,Sc,_t,Kt);else{var Qt=_t?_t(si(te,hr),lr,hr+"",te,_e,Kt):void 0;Qt===void 0&&(Qt=lr),vt(te,hr,Qt)}},Pc)}s(Sc,"Ud");function Nl(te,_e,Oe,_t,Kt,lr,hr){var Qt=si(te,Oe),pr=si(_e,Oe),Pn=hr.get(pr);if(Pn){vt(te,Oe,Pn);return}var Ar=lr?lr(Qt,pr,Oe+"",te,_e,hr):void 0,qo=Ar===void 0;if(qo){var Ts=jo(pr),As=!Ts&&Rc(pr),kc=!Ts&&!As&&Dc(pr);Ar=pr,Ts||As||kc?jo(Qt)?Ar=Qt:yh(Qt)?Ar=Cc(Qt):As?(qo=!1,Ar=ws(pr,!0)):kc?(qo=!1,Ar=Qr(pr,!0)):Ar=[]:Ic(pr)||Aa(pr)?(Ar=Qt,Aa(Qt)?Ar=$l(Qt):(!qi(Qt)||xs(Qt))&&(Ar=Tc(pr))):qo=!1}qo&&(hr.set(pr,Ar),Kt(Ar,pr,_t,lr,hr),hr.delete(pr)),vt(te,Oe,Ar)}s(Nl,"LI");function Lo(te,_e){return Ta(on(te,_e,Oc),te+"")}s(Lo,"qI");var Ml=Ei?function(te,_e){return Ei(te,"toString",{configurable:!0,enumerable:!1,value:Ul(_e),writable:!0})}:Oc;function ws(te,_e){if(_e)return te.slice();var Oe=te.length,_t=bi?bi(Oe):new te.constructor(Oe);return te.copy(_t),_t}s(ws,"jI");function ai(te){var _e=new te.constructor(te.byteLength);return new Bi(_e).set(new Bi(te)),_e}s(ai,"HI");function Qr(te,_e){var Oe=_e?ai(te.buffer):te.buffer;return new te.constructor(Oe,te.byteOffset,te.length)}s(Qr,"UI");function Cc(te,_e){var Oe=-1,_t=te.length;for(_e||(_e=Array(_t));++Oe<_t;)_e[Oe]=te[Oe];return _e}s(Cc,"BI");function bs(te,_e,Oe,_t){var Kt=!Oe;Oe||(Oe={});for(var lr=-1,hr=_e.length;++lr<hr;){var Qt=_e[lr],pr=_t?_t(Oe[Qt],te[Qt],Qt,Oe,te):void 0;pr===void 0&&(pr=te[Qt]),Kt?Bt(Oe,Qt,pr):bt(Oe,Qt,pr)}return Oe}s(bs,"GI");function xc(te){return Lo(function(_e,Oe){var _t=-1,Kt=Oe.length,lr=Kt>1?Oe[Kt-1]:void 0,hr=Kt>2?Oe[2]:void 0;for(lr=te.length>3&&typeof lr=="function"?(Kt--,lr):void 0,hr&&Es(Oe[0],Oe[1],hr)&&(lr=Kt<3?void 0:lr,Kt=1),_e=Object(_e);++_t<Kt;){var Qt=Oe[_t];Qt&&te(_e,Qt,_t,lr)}return _e})}s(xc,"FI");function Fl(te){return function(_e,Oe,_t){for(var Kt=-1,lr=Object(_e),hr=_t(_e),Qt=hr.length;Qt--;){var pr=hr[te?Qt:++Kt];if(Oe(lr[pr],pr,lr)===!1)break}return _e}}s(Fl,"VI");function xa(te,_e){var Oe=te.__data__;return Ac(_e)?Oe[typeof _e=="string"?"string":"hash"]:Oe.map}s(xa,"ls");function ho(te,_e){var Oe=uo(te,_e);return Kr(Oe)?Oe:void 0}s(ho,"Iu");function Ll(te){var _e=An.call(te,wn),Oe=te[wn];try{te[wn]=void 0;var _t=!0}catch(lr){}var Kt=us.call(te);return _t&&(_e?te[wn]=Oe:delete te[wn]),Kt}s(Ll,"$I");function Tc(te){return typeof te.constructor=="function"&&!$o(te)?Ur(nn(te)):{}}s(Tc,"zI");function fo(te,_e){var Oe=typeof te;return _e=_e==null?f:_e,!!_e&&(Oe=="number"||Oe!="symbol"&&Yt.test(te))&&te>-1&&te%1==0&&te<_e}s(fo,"Bd");function Es(te,_e,Oe){if(!qi(Oe))return!1;var _t=typeof _e;return(_t=="number"?Cs(Oe)&&fo(_e,Oe.length):_t=="string"&&_e in Oe)?Ci(Oe[_e],te):!1}s(Es,"KI");function Ac(te){var _e=typeof te;return _e=="string"||_e=="number"||_e=="symbol"||_e=="boolean"?te!=="__proto__":te===null}s(Ac,"XI");function Ss(te){return!!ls&&ls in te}s(Ss,"YI");function $o(te){var _e=te&&te.constructor,Oe=typeof _e=="function"&&_e.prototype||Hn;return te===Oe}s($o,"Gd");function ji(te){var _e=[];if(te!=null)for(var Oe in Object(te))_e.push(Oe);return _e}s(ji,"QI");function Bo(te){return us.call(te)}s(Bo,"WI");function on(te,_e,Oe){return _e=Ui(_e===void 0?te.length-1:_e,0),function(){for(var _t=arguments,Kt=-1,lr=Ui(_t.length-_e,0),hr=Array(lr);++Kt<lr;)hr[Kt]=_t[_e+Kt];Kt=-1;for(var Qt=Array(_e+1);++Kt<_e;)Qt[Kt]=_t[Kt];return Qt[_e]=Oe(hr),ar(te,this,Qt)}}s(on,"ZI");function si(te,_e){if(!(_e==="constructor"&&typeof te[_e]=="function")&&_e!="__proto__")return te[_e]}s(si,"Cu");var Ta=Uo(Ml);function Uo(te){var _e=0,Oe=0;return function(){var _t=fr(),Kt=g-(_t-Oe);if(Oe=_t,Kt>0){if(++_e>=C)return arguments[0]}else _e=0;return te.apply(void 0,arguments)}}s(Uo,"eC");function Ho(te){if(te!=null){try{return $i.call(te)}catch(_e){}try{return te+""}catch(_e){}}return""}s(Ho,"tC");function Ci(te,_e){return te===_e||te!==te&&_e!==_e}s(Ci,"ps");var Aa=Tr(function(){return arguments}())?Tr:function(te){return Dn(te)&&An.call(te,"callee")&&!ya.call(te,"callee")},jo=Array.isArray;function Cs(te){return te!=null&&Ra(te.length)&&!xs(te)}s(Cs,"Ru");function yh(te){return Dn(te)&&Cs(te)}s(yh,"rC");var Rc=bn||Hl;function xs(te){if(!qi(te))return!1;var _e=Vr(te);return _e==x||_e==T||_e==w||_e==X}s(xs,"Nu");function Ra(te){return typeof te=="number"&&te>-1&&te%1==0&&te<=f}s(Ra,"Vd");function qi(te){var _e=typeof te;return te!=null&&(_e=="object"||_e=="function")}s(qi,"ur");function Dn(te){return te!=null&&typeof te=="object"}s(Dn,"li");function Ic(te){if(!Dn(te)||Vr(te)!=z)return!1;var _e=nn(te);if(_e===null)return!0;var Oe=An.call(_e,"constructor")&&_e.constructor;return typeof Oe=="function"&&Oe instanceof Oe&&$i.call(Oe)==Rn}s(Ic,"nC");var Dc=Ct?ss(Ct):Qn;function $l(te){return bs(te,Pc(te))}s($l,"iC");function Pc(te){return Cs(te)?st(te,!0):kl(te)}s(Pc,"zd");var Bl=xc(function(te,_e,Oe){Sc(te,_e,Oe)});function Ul(te){return function(){return te}}s(Ul,"sC");function Oc(te){return te}s(Oc,"Kd");function Hl(){return!1}s(Hl,"oC"),I.exports=Bl}),Qa=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BatchSpanProcessorBase=void 0;var I=rr(),p=Mn(),b=s(class{constructor(C,g){this._exporter=C,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let f=p.getEnv();this._maxExportBatchSize=typeof(g==null?void 0:g.maxExportBatchSize)=="number"?g.maxExportBatchSize:f.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(g==null?void 0:g.maxQueueSize)=="number"?g.maxQueueSize:f.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(g==null?void 0:g.scheduledDelayMillis)=="number"?g.scheduledDelayMillis:f.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(g==null?void 0:g.exportTimeoutMillis)=="number"?g.exportTimeoutMillis:f.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(C){}onEnd(C){this._isShutdown||this._addToBuffer(C)}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((C,g)=>{Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown()).then(C).catch(f=>{g(f)})}),this._shuttingDownPromise)}_addToBuffer(C){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(C),this._maybeStartTimer())}_flushAll(){return new Promise((C,g)=>{let f=[],m=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let v=0,w=m;v<w;v++)f.push(this._flushOneBatch());Promise.all(f).then(()=>{C()}).catch(g)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((C,g)=>{let f=setTimeout(()=>{g(new Error("Timeout"))},this._exportTimeoutMillis);I.context.with(p.suppressTracing(I.context.active()),()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),m=>{var v;clearTimeout(f),m.code===p.ExportResultCode.SUCCESS?C():g((v=m.error)!==null&&v!==void 0?v:new Error("BatchSpanProcessor: span export failed"))})})})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(C=>{p.globalErrorHandler(C)})},this._scheduledDelayMillis),p.unrefTimer(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}},"Qd");c.BatchSpanProcessorBase=b}),ec=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BatchSpanProcessor=void 0;var I=Qa(),p=s(class extends I.BatchSpanProcessorBase{onShutdown(){}},"Zd");c.BatchSpanProcessor=p}),tc=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(ec(),c)}),ao=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(tc(),c)}),Ao=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BasicTracerProvider=c.ForceFlushState=void 0;var I=rr(),p=Mn(),b=To(),C=sa(),g=Va(),f=bl(),m=aa(),v=Js(),w=ao(),E;(function(S){S[S.resolved=0]="resolved",S[S.timeout=1]="timeout",S[S.error=2]="error",S[S.unresolved=3]="unresolved"})(E=c.ForceFlushState||(c.ForceFlushState={}));var y=s(class{constructor(S={}){var x;this._registeredSpanProcessors=[],this._tracers=new Map;let T=v({},g.DEFAULT_CONFIG,S);this.resource=(x=T.resource)!==null&&x!==void 0?x:b.Resource.empty(),this.resource=b.Resource.default().merge(this.resource),this._config=Object.assign({},T,{resource:this.resource});let D=this._buildExporterFromEnv();if(D!==void 0){let O=new w.BatchSpanProcessor(D);this.activeSpanProcessor=O}else this.activeSpanProcessor=new m.NoopSpanProcessor}getTracer(S,x){let T=`${S}@${x||""}`;return this._tracers.has(T)||this._tracers.set(T,new C.Tracer({name:S,version:x},this._config,this)),this._tracers.get(T)}addSpanProcessor(S){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(x=>I.diag.error("Error while trying to shutdown current span processor",x)),this._registeredSpanProcessors.push(S),this.activeSpanProcessor=new f.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(S={}){I.trace.setGlobalTracerProvider(this),S.propagator===void 0&&(S.propagator=this._buildPropagatorFromEnv()),S.contextManager&&I.context.setGlobalContextManager(S.contextManager),S.propagator&&I.propagation.setGlobalPropagator(S.propagator)}forceFlush(){let S=this._config.forceFlushTimeoutMillis,x=this._registeredSpanProcessors.map(T=>new Promise(D=>{let O,N=setTimeout(()=>{D(new Error(`Span processor did not completed within timeout period of ${S} ms`)),O=E.timeout},S);T.forceFlush().then(()=>{clearTimeout(N),O!==E.timeout&&(O=E.resolved,D(O))}).catch(z=>{clearTimeout(N),O=E.error,D(z)})}));return new Promise((T,D)=>{Promise.all(x).then(O=>{let N=O.filter(z=>z!==E.resolved);N.length>0?D(N):T()}).catch(O=>D([O]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(S){var x;return(x=y._registeredPropagators.get(S))===null||x===void 0?void 0:x()}_getSpanExporter(S){var x;return(x=y._registeredExporters.get(S))===null||x===void 0?void 0:x()}_buildPropagatorFromEnv(){let S=Array.from(new Set(p.getEnv().OTEL_PROPAGATORS)),x=S.map(T=>{let D=this._getPropagator(T);return D||I.diag.warn(`Propagator "${T}" requested through environment variable is unavailable.`),D}).reduce((T,D)=>(D&&T.push(D),T),[]);if(x.length!==0)return S.length===1?x[0]:new p.CompositePropagator({propagators:x})}_buildExporterFromEnv(){let S=p.getEnv().OTEL_TRACES_EXPORTER;if(S==="none")return;let x=this._getSpanExporter(S);return x||I.diag.error(`Exporter "${S}" requested through environment variable is unavailable.`),x}},"pr");c.BasicTracerProvider=y,y._registeredPropagators=new Map([["tracecontext",()=>new p.HttpTraceContextPropagator],["baggage",()=>new p.HttpBaggagePropagator]]),y._registeredExporters=new Map}),so=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ConsoleSpanExporter=void 0;var I=Mn(),p=s(class{export(b,C){return this._sendSpans(b,C)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(b){return{traceId:b.spanContext().traceId,parentId:b.parentSpanId,name:b.name,id:b.spanContext().spanId,kind:b.kind,timestamp:I.hrTimeToMicroseconds(b.startTime),duration:I.hrTimeToMicroseconds(b.duration),attributes:b.attributes,status:b.status,events:b.events}}_sendSpans(b,C){for(let g of b)console.log(this._exportInfo(g));if(C)return C({code:I.ExportResultCode.SUCCESS})}},"nh");c.ConsoleSpanExporter=p}),Xa=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InMemorySpanExporter=void 0;var I=Mn(),p=s(class{constructor(){this._finishedSpans=[],this._stopped=!1}export(b,C){if(this._stopped)return C({code:I.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...b),setTimeout(()=>C({code:I.ExportResultCode.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}},"sh");c.InMemorySpanExporter=p}),Ya=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),xn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.SimpleSpanProcessor=void 0;var I=rr(),p=Mn(),b=s(class{constructor(C){this._exporter=C,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(C){}onEnd(C){this._isShutdown||I.context.with(p.suppressTracing(I.context.active()),()=>{this._exporter.export([C],g=>{var f;g.code!==p.ExportResultCode.SUCCESS&&p.globalErrorHandler((f=g.error)!==null&&f!==void 0?f:new Error(`SimpleSpanProcessor: span export failed (status ${g})`))})})}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((C,g)=>{Promise.resolve().then(()=>this._exporter.shutdown()).then(C).catch(f=>{g(f)})}),this._shuttingDownPromise)}},"ph");c.SimpleSpanProcessor=b}),Za=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ja=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),rc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),nc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),sa=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Xs(),c),p(Ao(),c),p(ao(),c),p(so(),c),p(Xa(),c),p(Ya(),c),p(xn(),c),p(Za(),c),p(aa(),c),p(Fn(),c),p(Ja(),c),p(rc(),c),p(nc(),c)}),Gn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.azureCoreTracing=c.AzureMonitorSymbol=void 0;var I=$();c.AzureMonitorSymbol="Azure_Monitor_Tracer";var p=!1,b=s(function(g){if(p)return g;try{var f=sa(),m=rr(),v=new f.BasicTracerProvider,w=v.getTracer("applicationinsights tracer"),E=g.setTracer;g.setTracer=function(y){var S=y.startSpan;y.startSpan=function(x,T,D){var O=S.call(this,x,T,D),N=O.end;return O.end=function(){var z=N.apply(this,arguments);return I.channel.publish("azure-coretracing",O),z},O},y[c.AzureMonitorSymbol]=!0,E.call(this,y)},m.trace.getSpan(m.context.active()),g.setTracer(w),p=!0}catch(y){}return g},"yC");c.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:b};function C(){I.channel.registerMonkeyPatch("@azure/core-tracing",c.azureCoreTracing)}s(C,"TC"),c.enable=C}),ca=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.bunyan=void 0;var I=$(),p=s(function(C){var g=C.prototype._emit;return C.prototype._emit=function(f,m){var v=g.apply(this,arguments);if(!m){var w=v;w||(w=g.call(this,f,!0)),I.channel.publish("bunyan",{level:f.level,result:w})}return v},C},"SC");c.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:p};function b(){I.channel.registerMonkeyPatch("bunyan",c.bunyan)}s(b,"AC"),c.enable=b}),es=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.console=void 0;var I=$(),p=V(2781),b=s(function(g){var f=new p.Writable,m=new p.Writable;f.write=function(T){if(!T)return!0;var D=T.toString();return I.channel.publish("console",{message:D}),!0},m.write=function(T){if(!T)return!0;var D=T.toString();return I.channel.publish("console",{message:D,stderr:!0}),!0};for(var v=new g.Console(f,m),w=["log","info","warn","error","dir","time","timeEnd","trace","assert"],E=function(T){var D=g[T];D&&(g[T]=function(){if(v[T])try{v[T].apply(v,arguments)}catch(O){}return D.apply(g,arguments)})},y=0,S=w;y<S.length;y++){var x=S[y];E(x)}return g},"bC");c.console={versionSpecifier:">= 4.0.0",patch:b};function C(){I.channel.registerMonkeyPatch("console",c.console),V(6206)}s(C,"IC"),c.enable=C}),Ln=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.mongoCore=void 0;var I=$(),p=s(function(C){var g=C.Server.prototype.connect;return C.Server.prototype.connect=function(){var f=g.apply(this,arguments),m=this.s.pool.write;this.s.pool.write=function(){var w=typeof arguments[1]=="function"?1:2;return typeof arguments[w]=="function"&&(arguments[w]=I.channel.bindToContext(arguments[w])),m.apply(this,arguments)};var v=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=I.channel.bindToContext(arguments[1])),v.apply(this,arguments)},f},C},"CC");c.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:p};function b(){I.channel.registerMonkeyPatch("mongodb-core",c.mongoCore)}s(b,"OC"),c.enable=b}),ic=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(v){for(var w,E=1,y=arguments.length;E<y;E++){w=arguments[E];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(v[S]=w[S])}return v},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.mongo330=c.mongo3=c.mongo2=void 0;var p=$(),b=s(function(v){var w=v.instrument({operationIdGenerator:{next:function(){return p.channel.bindToContext(function(y){return y()})}}}),E={};return w.on("started",function(y){E[y.requestId]||(E[y.requestId]=I(I({},y),{time:new Date}))}),w.on("succeeded",function(y){var S=E[y.requestId];S&&delete E[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return p.channel.publish("mongodb",{startedData:S,event:y,succeeded:!0})}):p.channel.publish("mongodb",{startedData:S,event:y,succeeded:!0})}),w.on("failed",function(y){var S=E[y.requestId];S&&delete E[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return p.channel.publish("mongodb",{startedData:S,event:y,succeeded:!1})}):p.channel.publish("mongodb",{startedData:S,event:y,succeeded:!1})}),v},"PC"),C=s(function(v){var w=v.instrument(),E={},y={};return w.on("started",function(S){E[S.requestId]||(y[S.requestId]=p.channel.bindToContext(function(x){return x()}),E[S.requestId]=I(I({},S),{time:new Date}))}),w.on("succeeded",function(S){var x=E[S.requestId];x&&delete E[S.requestId],typeof S=="object"&&typeof y[S.requestId]=="function"&&(y[S.requestId](function(){return p.channel.publish("mongodb",{startedData:x,event:S,succeeded:!0})}),delete y[S.requestId])}),w.on("failed",function(S){var x=E[S.requestId];x&&delete E[S.requestId],typeof S=="object"&&typeof y[S.requestId]=="function"&&(y[S.requestId](function(){return p.channel.publish("mongodb",{startedData:x,event:S,succeeded:!1})}),delete y[S.requestId])}),v},"RC"),g=s(function(v){var w=v.Server.prototype.connect;return v.Server.prototype.connect=function(){var E=w.apply(this,arguments),y=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var x=typeof arguments[1]=="function"?1:2;return typeof arguments[x]=="function"&&(arguments[x]=p.channel.bindToContext(arguments[x])),y.apply(this,arguments)};var S=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=p.channel.bindToContext(arguments[1])),S.apply(this,arguments)},E},v},"NC"),f=s(function(v){g(v);var w=v.instrument(),E={},y={};return w.on("started",function(S){E[S.requestId]||(y[S.requestId]=p.channel.bindToContext(function(x){return x()}),E[S.requestId]=S)}),w.on("succeeded",function(S){var x=E[S.requestId];x&&delete E[S.requestId],typeof S=="object"&&typeof y[S.requestId]=="function"&&(y[S.requestId](function(){return p.channel.publish("mongodb",{startedData:x,event:S,succeeded:!0})}),delete y[S.requestId])}),w.on("failed",function(S){var x=E[S.requestId];x&&delete E[S.requestId],typeof S=="object"&&typeof y[S.requestId]=="function"&&(y[S.requestId](function(){return p.channel.publish("mongodb",{startedData:x,event:S,succeeded:!1})}),delete y[S.requestId])}),v},"DC");c.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:b},c.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:C},c.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:f};function m(){p.channel.registerMonkeyPatch("mongodb",c.mongo2),p.channel.registerMonkeyPatch("mongodb",c.mongo3),p.channel.registerMonkeyPatch("mongodb",c.mongo330)}s(m,"wC"),c.enable=m}),Ro=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.mysql=void 0;var I=$(),p=V(1017),b=s(function(g,f){var m=s(function(x,T){return function(D,O){var N=x[D];N&&(x[D]=function(){for(var z=arguments.length-1,X=arguments.length-1;X>=0;--X)if(typeof arguments[X]=="function"){z=X;break}else if(typeof arguments[X]!="undefined")break;var K=arguments[z],fe={result:null,startTime:null,startDate:null};typeof K=="function"&&(O?(fe.startTime=process.hrtime(),fe.startDate=new Date,arguments[z]=I.channel.bindToContext(O(fe,K))):arguments[z]=I.channel.bindToContext(K));var be=N.apply(this,arguments);return fe.result=be,be})}},"r"),v=s(function(x,T){return m(x.prototype,T+".prototype")},"n"),w=["connect","changeUser","ping","statistics","end"],E=V(3255)(p.dirname(f)+"/lib/Connection");w.forEach(function(x){return v(E,"Connection")(x)}),m(E,"Connection")("createQuery",function(x,T){return function(D){var O=process.hrtime(x.startTime),N=O[0]*1e3+O[1]/1e6|0;I.channel.publish("mysql",{query:x.result,callbackArgs:arguments,err:D,duration:N,time:x.startDate}),T.apply(this,arguments)}});var y=["_enqueueCallback"],S=V(9118)(p.dirname(f)+"/lib/Pool");return y.forEach(function(x){return v(S,"Pool")(x)}),g},"MC");c.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:b};function C(){I.channel.registerMonkeyPatch("mysql",c.mysql)}s(C,"xC"),c.enable=C}),ts=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.postgresPool1=void 0;var I=$();function p(C){var g=C.prototype.connect;return C.prototype.connect=function(f){return f&&(arguments[0]=I.channel.bindToContext(f)),g.apply(this,arguments)},C}s(p,"LC"),c.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:p};function b(){I.channel.registerMonkeyPatch("pg-pool",c.postgresPool1)}s(b,"qC"),c.enable=b}),Io=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.postgres7=c.postgres6=void 0;var I=$(),p=V(2361);function b(f,m){var v=f.Client.prototype.query,w="__diagnosticOriginalFunc";return f.Client.prototype.query=function(E,y,S){var x={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},T=process.hrtime(),D;function O(N){N&&N[w]&&(N=N[w]);var z=I.channel.bindToContext(function(X,K){var fe=process.hrtime(T);if(x.result=K&&{rowCount:K.rowCount,command:K.command},x.error=X,x.duration=Math.ceil(fe[0]*1e3+fe[1]/1e6),I.channel.publish("postgres",x),X){if(N)return N.apply(this,arguments);D&&D instanceof p.EventEmitter&&D.emit("error",X)}else N&&N.apply(this,arguments)});try{return Object.defineProperty(z,w,{value:N}),z}catch(X){return N}}s(O,"f");try{typeof E=="string"?y instanceof Array?(x.query.preparable={text:E,args:y},S=O(S)):(x.query.text=E,S?S=O(S):y=O(y)):(typeof E.name=="string"?x.query.plan=E.name:E.values instanceof Array?x.query.preparable={text:E.text,args:E.values}:x.query.text=E.text,S?S=O(S):y?y=O(y):E.callback=O(E.callback))}catch(N){return v.apply(this,arguments)}return arguments[0]=E,arguments[1]=y,arguments[2]=S,arguments.length=arguments.length>3?arguments.length:3,D=v.apply(this,arguments),D},f}s(b,"kC");function C(f,m){var v=f.Client.prototype.query,w="__diagnosticOriginalFunc";return f.Client.prototype.query=function(E,y,S){var x=this,T=!!S,D={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},O=process.hrtime(),N;function z(X){X&&X[w]&&(X=X[w]);var K=I.channel.bindToContext(function(fe,be){var Fe=process.hrtime(O);if(D.result=be&&{rowCount:be.rowCount,command:be.command},D.error=fe,D.duration=Math.ceil(Fe[0]*1e3+Fe[1]/1e6),I.channel.publish("postgres",D),fe){if(X)return X.apply(this,arguments);N&&N instanceof p.EventEmitter&&N.emit("error",fe)}else X&&X.apply(this,arguments)});try{return Object.defineProperty(K,w,{value:X}),K}catch(fe){return X}}s(z,"_");try{typeof E=="string"?y instanceof Array?(D.query.preparable={text:E,args:y},T=typeof S=="function",S=T?z(S):S):(D.query.text=E,S?(T=typeof S=="function",S=T?z(S):S):(T=typeof y=="function",y=T?z(y):y)):(typeof E.name=="string"?D.query.plan=E.name:E.values instanceof Array?D.query.preparable={text:E.text,args:E.values}:D.query.text=E.text,S?(T=typeof S=="function",S=z(S)):y?(T=typeof y=="function",y=T?z(y):y):(T=typeof E.callback=="function",E.callback=T?z(E.callback):E.callback))}catch(X){return v.apply(this,arguments)}return arguments[0]=E,arguments[1]=y,arguments[2]=S,arguments.length=arguments.length>3?arguments.length:3,N=v.apply(this,arguments),T?N:N.then(function(X){return z()(void 0,X),new x._Promise(function(K,fe){K(X)})}).catch(function(X){return z()(X,void 0),new x._Promise(function(K,fe){fe(X)})})},f}s(C,"jC"),c.postgres6={versionSpecifier:"6.*",patch:b},c.postgres7={versionSpecifier:">=7.* <=8.*",patch:C};function g(){I.channel.registerMonkeyPatch("pg",c.postgres6),I.channel.registerMonkeyPatch("pg",c.postgres7)}s(g,"HC"),c.enable=g}),oc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.redis=void 0;var I=$(),p=s(function(C){var g=C.RedisClient.prototype.internal_send_command;return C.RedisClient.prototype.internal_send_command=function(f){if(f){var m=f.callback;if(!m||!m.pubsubBound){var v=this.address,w=process.hrtime(),E=new Date;f.callback=I.channel.bindToContext(function(y,S){var x=process.hrtime(w),T=x[0]*1e3+x[1]/1e6|0;I.channel.publish("redis",{duration:T,address:v,commandObj:f,err:y,result:S,time:E}),typeof m=="function"&&m.apply(this,arguments)}),f.callback.pubsubBound=!0}}return g.call(this,f)},C},"UC");c.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:p};function b(){I.channel.registerMonkeyPatch("redis",c.redis)}s(b,"BC"),c.enable=b}),ac=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(g){for(var f,m=1,v=arguments.length;m<v;m++){f=arguments[m];for(var w in f)Object.prototype.hasOwnProperty.call(f,w)&&(g[w]=f[w])}return g},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.tedious=void 0;var p=$(),b=s(function(g){var f=g.Connection.prototype.makeRequest;return g.Connection.prototype.makeRequest=function(){function m(w){var E=process.hrtime(),y={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return p.channel.bindToContext(function(S,x,T){var D=process.hrtime(E);y=I(I({},y),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!S&&{rowCount:x,rows:T},query:{text:this.parametersByName.statement.value},error:S,duration:Math.ceil(D[0]*1e3+D[1]/1e6)}),p.channel.publish("tedious",y),w.call(this,S,x,T)})}s(m,"n");var v=arguments[0];arguments[0].callback=m(v.callback),f.apply(this,arguments)},g},"GC");c.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:b};function C(){p.channel.registerMonkeyPatch("tedious",c.tedious)}s(C,"FC"),c.enable=C}),co=L(c=>{"use strict";var I=c&&c.__extends||function(){var m=s(function(v,w){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,y){E.__proto__=y}||function(E,y){for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&(E[S]=y[S])},m(v,w)},"e");return function(v,w){m(v,w);function E(){this.constructor=v}s(E,"n"),v.prototype=w===null?Object.create(w):(E.prototype=w.prototype,new E)}}(),p=c&&c.__rest||function(m,v){var w={};for(var E in m)Object.prototype.hasOwnProperty.call(m,E)&&v.indexOf(E)<0&&(w[E]=m[E]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,E=Object.getOwnPropertySymbols(m);y<E.length;y++)v.indexOf(E[y])<0&&Object.prototype.propertyIsEnumerable.call(m,E[y])&&(w[E[y]]=m[E[y]]);return w};Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.winston2=c.winston3=void 0;var b=$(),C=s(function(m){var v=m.Logger.prototype.log,w,E=s(function(y,S,x){var T;return w===m.config.npm.levels?T="npm":w===m.config.syslog.levels?T="syslog":T="unknown",b.channel.publish("winston",{level:y,message:S,meta:x,levelKind:T}),S},"n");return m.Logger.prototype.log=function(){return w=this.levels,!this.filters||this.filters.length===0?this.filters=[E]:this.filters[this.filters.length-1]!==E&&(this.filters=this.filters.filter(function(y){return y!==E}),this.filters.push(E)),v.apply(this,arguments)},m},"zC"),g=s(function(m){var v=s(function(x,T){var D;return x.config.npm.levels[T]!=null?D="npm":x.config.syslog.levels[T]!=null?D="syslog":D="unknown",D},"t"),w=function(x){I(T,x);function T(D,O){var N=x.call(this,O)||this;return N.winston=D,N}return s(T,"o"),T.prototype.log=function(D,O){var N=D.message,z=D.level,X=D.meta,K=p(D,["message","level","meta"]);z=typeof Symbol.for=="function"?D[Symbol.for("level")]:z,N=D instanceof Error?D:N;var fe=v(this.winston,z);X=X||{};for(var be in K)K.hasOwnProperty(be)&&(X[be]=K[be]);b.channel.publish("winston",{message:N,level:z,levelKind:fe,meta:X}),O()},T}(m.Transport);function E(){var x=arguments[0].levels||m.config.npm.levels,T;for(var D in x)x.hasOwnProperty(D)&&(T=T===void 0||x[D]>x[T]?D:T);this.add(new w(m,{level:T}))}s(E,"n");var y=m.createLogger;m.createLogger=function(){var x=arguments[0].levels||m.config.npm.levels,T;for(var D in x)x.hasOwnProperty(D)&&(T=T===void 0||x[D]>x[T]?D:T);var O=y.apply(this,arguments);O.add(new w(m,{level:T}));var N=O.configure;return O.configure=function(){N.apply(this,arguments),E.apply(this,arguments)},O};var S=m.configure;return m.configure=function(){S.apply(this,arguments),E.apply(this,arguments)},m.add(new w(m)),m},"KC");c.winston3={versionSpecifier:"3.x",patch:g},c.winston2={versionSpecifier:"2.x",patch:C};function f(){b.channel.registerMonkeyPatch("winston",c.winston2),b.channel.registerMonkeyPatch("winston",c.winston3)}s(f,"XC"),c.enable=f}),la=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.tedious=c.pgPool=c.pg=c.winston=c.redis=c.mysql=c.mongodb=c.mongodbCore=c.console=c.bunyan=c.azuresdk=void 0;var I=Gn();c.azuresdk=I;var p=ca();c.bunyan=p;var b=es();c.console=b;var C=Ln();c.mongodbCore=C;var g=ic();c.mongodb=g;var f=Ro();c.mysql=f;var m=ts();c.pgPool=m;var v=Io();c.pg=v;var w=oc();c.redis=w;var E=ac();c.tedious=E;var y=co();c.winston=y;function S(){p.enable(),b.enable(),C.enable(),g.enable(),f.enable(),v.enable(),m.enable(),w.enable(),y.enable(),I.enable(),E.enable()}s(S,"YC"),c.enable=S}),Do=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.registerContextPreservation=c.IsInitialized=void 0;var I=Ee(),p=We();c.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var b="DiagnosticChannel";if(c.IsInitialized){C=la(),g=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",f=g.split(","),m={bunyan:C.bunyan,console:C.console,mongodb:C.mongodb,mongodbCore:C.mongodbCore,mysql:C.mysql,redis:C.redis,pg:C.pg,pgPool:C.pgPool,winston:C.winston,azuresdk:C.azuresdk};for(v in m)f.indexOf(v)===-1&&(m[v].enable(),p.info(b,"Subscribed to "+v+" events"));f.length>0&&p.info(b,"Some modules will not be patched",f)}else p.info(b,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var C,g,f,m,v;function w(E){if(c.IsInitialized){var y=$();y.channel.addContextPreservation(E),y.channel.spanContextPropagator=I.AsyncScopeManager}}s(w,"WC"),c.registerContextPreservation=w}),Ni=L((c,I)=>{"use strict";I.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}}),pn=L((c,I)=>{"use strict";var p=c&&c.__assign||function(){return p=Object.assign||function(E){for(var y,S=1,x=arguments.length;S<x;S++){y=arguments[S];for(var T in y)Object.prototype.hasOwnProperty.call(y,T)&&(E[T]=y[T])}return E},p.apply(this,arguments)},b=V(3685),C=V(5687),g=V(7310),f=V(2057),m=We(),v=Ni(),w=function(){function E(){}return s(E,"e"),E.getCookie=function(y,S){var x="";if(y&&y.length&&typeof S=="string")for(var T=y+"=",D=S.split(";"),O=0;O<D.length;O++){var S=D[O];if(S=E.trim(S),S&&S.indexOf(T)===0){x=S.substring(T.length,D[O].length);break}}return x},E.trim=function(y){return typeof y=="string"?y.replace(/^\s+|\s+$/g,""):""},E.int32ArrayToBase64=function(y){var S=s(function(N,z){return String.fromCharCode(N>>z&255)},"r"),x=s(function(N){return S(N,24)+S(N,16)+S(N,8)+S(N,0)},"n"),T=y.map(x).join(""),D=Buffer.from?Buffer.from(T,"binary"):new Buffer(T,"binary"),O=D.toString("base64");return O.substr(0,O.indexOf("="))},E.random32=function(){return 4294967296*Math.random()|0},E.randomu32=function(){return E.random32()+2147483648},E.w3cTraceId=function(){for(var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],S="",x,T=0;T<4;T++)x=E.random32(),S+=y[x&15]+y[x>>4&15]+y[x>>8&15]+y[x>>12&15]+y[x>>16&15]+y[x>>20&15]+y[x>>24&15]+y[x>>28&15];var D=y[8+Math.random()*4|0];return S.substr(0,8)+S.substr(9,4)+"4"+S.substr(13,3)+D+S.substr(16,3)+S.substr(19,12)},E.w3cSpanId=function(){return E.w3cTraceId().substring(16)},E.isValidW3CId=function(y){return y.length===32&&y!=="00000000000000000000000000000000"},E.isArray=function(y){return Object.prototype.toString.call(y)==="[object Array]"},E.isError=function(y){return y instanceof Error},E.isPrimitive=function(y){var S=typeof y;return S==="string"||S==="number"||S==="boolean"},E.isDate=function(y){return Object.prototype.toString.call(y)==="[object Date]"},E.msToTimeSpan=function(y){(isNaN(y)||y<0)&&(y=0);var S=(y/1e3%60).toFixed(7).replace(/0{0,4}$/,""),x=""+Math.floor(y/(1e3*60))%60,T=""+Math.floor(y/(1e3*60*60))%24,D=Math.floor(y/(1e3*60*60*24));S=S.indexOf(".")<2?"0"+S:S,x=x.length<2?"0"+x:x,T=T.length<2?"0"+T:T;var O=D>0?D+".":"";return O+T+":"+x+":"+S},E.extractError=function(y){var S=y;return{message:y.message,code:S.code||S.id||""}},E.extractObject=function(y){return y instanceof Error?E.extractError(y):typeof y.toJSON=="function"?y.toJSON():y},E.validateStringMap=function(y){if(typeof y!="object"){m.info("Invalid properties dropped from payload");return}var S={};for(var x in y){var T="",D=y[x],O=typeof D;if(E.isPrimitive(D))T=D.toString();else if(D===null||O==="undefined")T="";else if(O==="function"){m.info("key: "+x+" was function; will not serialize");continue}else{var N=E.isArray(D)?D:E.extractObject(D);try{E.isPrimitive(N)?T=N:T=JSON.stringify(N)}catch(z){T=D.constructor.name.toString()+" (Error: "+z.message+")",m.info("key: "+x+", could not be serialized")}}S[x]=T.substring(0,E.MAX_PROPERTY_LENGTH)}return S},E.canIncludeCorrelationHeader=function(y,S){var x=y&&y.config&&y.config.correlationHeaderExcludedDomains;if(!x||x.length==0||!S)return!0;for(var T=0;T<x.length;T++){var D=new RegExp(x[T].replace(/\./g,".").replace(/\*/g,".*"));if(D.test(g.parse(S).hostname))return!1}return!0},E.getCorrelationContextTarget=function(y,S){var x=y.headers&&y.headers[v.requestContextHeader];if(x)for(var T=x.split(","),D=0;D<T.length;++D){var O=T[D].split("=");if(O.length==2&&O[0]==S)return O[1]}},E.makeRequest=function(y,S,x,T){S&&S.indexOf("//")===0&&(S="https:"+S);var D=g.parse(S),O=p(p({},x),{host:D.hostname,port:D.port,path:D.pathname}),N=void 0;if(D.protocol==="https:"&&(N=y.proxyHttpsUrl||void 0),D.protocol==="http:"&&(N=y.proxyHttpUrl||void 0),N){N.indexOf("//")===0&&(N="http:"+N);var z=g.parse(N);z.protocol==="https:"?(m.info("Proxies that use HTTPS are not supported"),N=void 0):O=p(p({},O),{host:z.hostname,port:z.port||"80",path:S,headers:p(p({},O.headers),{Host:D.hostname})})}var X=D.protocol==="https:"&&!N;return X&&y.httpsAgent!==void 0?O.agent=y.httpsAgent:!X&&y.httpAgent!==void 0?O.agent=y.httpAgent:X&&(O.agent=E.tlsRestrictedAgent),X?C.request(O,T):b.request(O,T)},E.safeIncludeCorrelationHeader=function(y,S,x){var T;if(typeof x=="string")T=x;else if(x instanceof Array)T=x.join(",");else if(x&&typeof x.toString=="function")try{T=x.toString()}catch(D){m.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",D,x)}T?E.addCorrelationIdHeaderFromString(y,S,T):S.setHeader(v.requestContextHeader,v.requestContextSourceKey+"="+y.config.correlationId)},E.dumpObj=function(y){var S=Object.prototype.toString.call(y),x="";return S==="[object Error]"?x="{ stack: '"+y.stack+"', message: '"+y.message+"', name: '"+y.name+"'":x=JSON.stringify(y),S+x},E.addCorrelationIdHeaderFromString=function(y,S,x){var T=x.split(","),D=v.requestContextSourceKey+"=",O=T.some(function(N){return N.substring(0,D.length)===D});O||S.setHeader(v.requestContextHeader,x+","+v.requestContextSourceKey+"="+y.config.correlationId)},E.MAX_PROPERTY_LENGTH=8192,E.tlsRestrictedAgent=new C.Agent({keepAlive:!0,maxSockets:25,secureOptions:f.SSL_OP_NO_SSLv2|f.SSL_OP_NO_SSLv3|f.SSL_OP_NO_TLSv1|f.SSL_OP_NO_TLSv1_1}),E}();I.exports=w}),ee=L((c,I)=>{"use strict";var p=pn(),b=We(),C=function(){function g(){}return s(g,"e"),g.queryCorrelationId=function(f,m){var v=f.profileQueryEndpoint+"/api/profiles/"+f.instrumentationKey+"/appId";if(g.completedLookups.hasOwnProperty(v)){m(g.completedLookups[v]);return}else if(g.pendingLookups[v]){g.pendingLookups[v].push(m);return}g.pendingLookups[v]=[m];var w=s(function(){if(g.pendingLookups[v]){var E={method:"GET",disableAppInsightsAutoCollection:!0};b.info(g.TAG,E);var y=p.makeRequest(f,v,E,function(S){if(S.statusCode===200){var x="";S.setEncoding("utf-8"),S.on("data",function(T){x+=T}),S.on("end",function(){b.info(g.TAG,x);var T=g.correlationIdPrefix+x;g.completedLookups[v]=T,g.pendingLookups[v]&&g.pendingLookups[v].forEach(function(D){return D(T)}),delete g.pendingLookups[v]})}else S.statusCode>=400&&S.statusCode<500?(g.completedLookups[v]=void 0,delete g.pendingLookups[v]):setTimeout(w,f.correlationIdRetryIntervalMs)});y&&(y.on("error",function(S){b.warn(g.TAG,S)}),y.end())}},"i");setTimeout(w,0)},g.cancelCorrelationIdQuery=function(f,m){var v=f.profileQueryEndpoint+"/api/profiles/"+f.instrumentationKey+"/appId",w=g.pendingLookups[v];w&&(g.pendingLookups[v]=w.filter(function(E){return E!=m}),g.pendingLookups[v].length==0&&delete g.pendingLookups[v])},g.generateRequestId=function(f){if(f){f=f[0]=="|"?f:"|"+f,f[f.length-1]!=="."&&(f+=".");var m=(g.currentRootId++).toString(16);return g.appendSuffix(f,m,"_")}else return g.generateRootId()},g.getRootId=function(f){var m=f.indexOf(".");m<0&&(m=f.length);var v=f[0]==="|"?1:0;return f.substring(v,m)},g.generateRootId=function(){return"|"+p.w3cTraceId()+"."},g.appendSuffix=function(f,m,v){if(f.length+m.length<g.requestIdMaxLength)return f+m+v;var w=g.requestIdMaxLength-9;if(f.length>w)for(;w>1;--w){var E=f[w-1];if(E==="."||E==="_")break}if(w<=1)return g.generateRootId();for(m=p.randomu32().toString(16);m.length<8;)m="0"+m;return f.substring(0,w)+m+"#"},g.TAG="CorrelationIdManager",g.correlationIdPrefix="cid-v1:",g.w3cEnabled=!0,g.pendingLookups={},g.completedLookups={},g.requestIdMaxLength=1024,g.currentRootId=p.randomu32(),g}();I.exports=C}),J=L((c,I)=>{"use strict";var p=pn(),b=ee(),C=function(){function g(f,m){if(this.traceFlag=g.DEFAULT_TRACE_FLAG,this.version=g.DEFAULT_VERSION,f&&typeof f=="string")if(f.split(",").length>1)this.traceId=p.w3cTraceId(),this.spanId=p.w3cTraceId().substr(0,16);else{var v=f.trim().split("-"),w=v.length;w>=4?(this.version=v[0],this.traceId=v[1],this.spanId=v[2],this.traceFlag=v[3]):(this.traceId=p.w3cTraceId(),this.spanId=p.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=g.DEFAULT_VERSION,this.traceId=p.w3cTraceId()),this.version==="00"&&w!==4&&(this.traceId=p.w3cTraceId(),this.spanId=p.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=g.DEFAULT_VERSION,this.traceId=p.w3cTraceId(),this.spanId=p.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=g.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=g.DEFAULT_TRACE_FLAG,this.traceId=p.w3cTraceId()),g.isValidTraceId(this.traceId)||(this.traceId=p.w3cTraceId()),g.isValidSpanId(this.spanId)||(this.spanId=p.w3cTraceId().substr(0,16),this.traceId=p.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(m){this.parentId=m.slice();var E=b.getRootId(m);g.isValidTraceId(E)||(this.legacyRootId=E,E=p.w3cTraceId()),m.indexOf("|")!==-1&&(m=m.substring(1+m.substring(0,m.length-1).lastIndexOf("."),m.length-1)),this.traceId=E,this.spanId=m}else this.traceId=p.w3cTraceId(),this.spanId=p.w3cTraceId().substr(0,16)}return s(g,"e"),g.isValidTraceId=function(f){return f.match(/^[0-9a-f]{32}$/)&&f!=="00000000000000000000000000000000"},g.isValidSpanId=function(f){return f.match(/^[0-9a-f]{16}$/)&&f!=="0000000000000000"},g.formatOpenTelemetryTraceFlags=function(f){var m="0"+f.toString(16);return m.substring(m.length-2)},g.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},g.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},g.prototype.updateSpanId=function(){this.spanId=p.w3cTraceId().substr(0,16)},g.DEFAULT_TRACE_FLAG="01",g.DEFAULT_VERSION="00",g}();I.exports=C}),Ve=L((c,I)=>{"use strict";var p=function(){function b(C){this.fieldmap=[],!!C&&(this.fieldmap=this.parseHeader(C))}return s(b,"e"),b.prototype.toString=function(){var C=this.fieldmap;return!C||C.length==0?null:C.join(", ")},b.validateKeyChars=function(C){var g=C.split("@");if(g.length==2){var f=g[0].trim(),m=g[1].trim(),v=Boolean(f.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),w=Boolean(m.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return v&&w}else if(g.length==1)return Boolean(C.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},b.prototype.parseHeader=function(C){var g=[],f={},m=C.split(",");if(m.length>32)return null;for(var v=0,w=m;v<w.length;v++){var E=w[v],y=E.trim();if(y.length!==0){var S=y.split("=");if(S.length!==2||!b.validateKeyChars(S[0])||f[S[0]])return null;f[S[0]]=!0,g.push(y)}}return g},b.strict=!0,b}();I.exports=p}),pt=L((c,I)=>{"use strict";var p=function(){function b(){}return s(b,"e"),b}();I.exports=p}),zt=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),kt=L((c,I)=>{"use strict";var p=function(){function b(){}return s(b,"e"),b}();I.exports=p}),vr=L((c,I)=>{"use strict";var p=function(){function b(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return s(b,"e"),b}();I.exports=p}),Sr=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=kt(),C=function(g){p(f,g);function f(){return g.call(this)||this}return s(f,"t"),f}(b);I.exports=C}),Pr=L((c,I)=>{"use strict";var p;(function(b){b[b.Measurement=0]="Measurement",b[b.Aggregation=1]="Aggregation"})(p||(p={})),I.exports=p}),dr=L((c,I)=>{"use strict";var p=Pr(),b=function(){function C(){this.kind=p.Measurement}return s(C,"e"),C}();I.exports=b}),gn=L((c,I)=>{"use strict";var p=function(){function b(){this.ver=1,this.sampleRate=100,this.tags={}}return s(b,"e"),b}();I.exports=p}),mn=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),Or=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.exceptions=[],m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),Tn=L((c,I)=>{"use strict";var p=function(){function b(){this.hasFullStack=!0,this.parsedStack=[]}return s(b,"e"),b}();I.exports=p}),vn=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.properties={},m}return s(f,"t"),f}(b);I.exports=C}),vi=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.metrics=[],m.properties={},m}return s(f,"t"),f}(b);I.exports=C}),ti=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=mn(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),Mi=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.success=!0,m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),sc=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var g=s(function(f,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,w){v.__proto__=w}||function(v,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(v[E]=w[E])},g(f,m)},"e");return function(f,m){g(f,m);function v(){this.constructor=f}s(v,"n"),f.prototype=m===null?Object.create(m):(v.prototype=m.prototype,new v)}}(),b=pt(),C=function(g){p(f,g);function f(){var m=g.call(this)||this;return m.ver=2,m.properties={},m.measurements={},m}return s(f,"t"),f}(b);I.exports=C}),Fi=L((c,I)=>{"use strict";var p;(function(b){b[b.Verbose=0]="Verbose",b[b.Information=1]="Information",b[b.Warning=2]="Warning",b[b.Error=3]="Error",b[b.Critical=4]="Critical"})(p||(p={})),I.exports=p}),Li=L((c,I)=>{"use strict";var p=function(){function b(){}return s(b,"e"),b}();I.exports=p}),cc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AvailabilityData=zt(),c.Base=kt(),c.ContextTagKeys=vr(),c.Data=Sr(),c.DataPoint=dr(),c.DataPointType=Pr(),c.Domain=pt(),c.Envelope=gn(),c.EventData=mn(),c.ExceptionData=Or(),c.ExceptionDetails=Tn(),c.MessageData=vn(),c.MetricData=vi(),c.PageViewData=ti(),c.RemoteDependencyData=Mi(),c.RequestData=sc(),c.SeverityLevel=Fi(),c.StackFrame=Li()}),Tu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.domainSupportsProperties=c.RemoteDependencyDataConstants=void 0;var I=cc(),p=function(){function C(){}return s(C,"e"),C.TYPE_HTTP="Http",C.TYPE_AI="Http (tracked component)",C}();c.RemoteDependencyDataConstants=p;function b(C){return"properties"in C||C instanceof I.EventData||C instanceof I.ExceptionData||C instanceof I.MessageData||C instanceof I.MetricData||C instanceof I.PageViewData||C instanceof I.RemoteDependencyData||C instanceof I.RequestData}s(b,"UO"),c.domainSupportsProperties=b}),El=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Au=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ru=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Iu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),qr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),lc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Du=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Sl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),ua=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Cl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),da=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Pu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Ou=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.TelemetryType=c.TelemetryTypeString=c.baseTypeToTelemetryType=c.telemetryTypeToBaseType=void 0;function I(C){switch(C){case b.Event:return"EventData";case b.Exception:return"ExceptionData";case b.Trace:return"MessageData";case b.Metric:return"MetricData";case b.Request:return"RequestData";case b.Dependency:return"RemoteDependencyData";case b.Availability:return"AvailabilityData";case b.PageView:return"PageViewData"}}s(I,"BO"),c.telemetryTypeToBaseType=I;function p(C){switch(C){case"EventData":return b.Event;case"ExceptionData":return b.Exception;case"MessageData":return b.Trace;case"MetricData":return b.Metric;case"RequestData":return b.Request;case"RemoteDependencyData":return b.Dependency;case"AvailabilityData":return b.Availability;case"PageViewData":return b.PageView}}s(p,"GO"),c.baseTypeToTelemetryType=p,c.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var b;(function(C){C[C.Event=0]="Event",C[C.Exception=1]="Exception",C[C.Trace=2]="Trace",C[C.Metric=3]="Metric",C[C.Request=4]="Request",C[C.Dependency=5]="Dependency",C[C.Availability=6]="Availability",C[C.PageView=7]="PageView"})(b=c.TelemetryType||(c.TelemetryType={}))}),ku=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(El(),c),p(Au(),c),p(Ru(),c),p(Iu(),c),p(qr(),c),p(lc(),c),p(Du(),c),p(Sl(),c),p(ua(),c),p(Cl(),c),p(da(),c),p(Pu(),c),p(Ou(),c)}),$n=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Nu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),xl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),ri=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Mu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Mt=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Fu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),ha=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Po=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p($n(),c),p(Nu(),c),p(xl(),c),p(ri(),c),p(Mu(),c),p(Mt(),c),p(Fu(),c),p(ha(),c)}),Br=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Tu(),c),p(cc(),c),p(ku(),c),p(Po(),c)}),uc=L((c,I)=>{"use strict";var p=function(){function b(){}return s(b,"e"),b.prototype.getUrl=function(){return this.url},b.prototype.RequestParser=function(){this.startTime=+new Date},b.prototype._setStatus=function(C,g){var f=+new Date;this.duration=f-this.startTime,this.statusCode=C;var m=this.properties||{};if(g){if(typeof g=="string")m.error=g;else if(g instanceof Error)m.error=g.message;else if(typeof g=="object")for(var v in g)m[v]=g[v]&&g[v].toString&&g[v].toString()}this.properties=m},b.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},b}();I.exports=p}),Tl=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var S=s(function(x,T){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,O){D.__proto__=O}||function(D,O){for(var N in O)Object.prototype.hasOwnProperty.call(O,N)&&(D[N]=O[N])},S(x,T)},"e");return function(x,T){S(x,T);function D(){this.constructor=x}s(D,"n"),x.prototype=T===null?Object.create(T):(D.prototype=T.prototype,new D)}}(),b=V(7310),C=Br(),g=pn(),f=Ni(),m=uc(),v=ee(),w=Ve(),E=J(),y=function(S){p(x,S);function x(T,D){var O=S.call(this)||this;return T&&(O.method=T.method,O.url=O._getAbsoluteUrl(T),O.startTime=+new Date,O.socketRemoteAddress=T.socket&&T.socket.remoteAddress,O.parseHeaders(T,D),T.connection&&(O.connectionRemoteAddress=T.connection.remoteAddress,O.legacySocketRemoteAddress=T.connection.socket&&T.connection.socket.remoteAddress)),O}return s(x,"t"),x.prototype.onError=function(T,D){this._setStatus(void 0,T),D&&(this.duration=D)},x.prototype.onResponse=function(T,D){this._setStatus(T.statusCode,void 0),D&&(this.duration=D)},x.prototype.getRequestTelemetry=function(T){var D={id:this.requestId,name:this.method+" "+b.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(T&&T.time?D.time=T.time:this.startTime&&(D.time=new Date(this.startTime)),T){for(var O in T)D[O]||(D[O]=T[O]);if(T.properties)for(var O in T.properties)D.properties[O]=T.properties[O]}return D},x.prototype.getRequestTags=function(T){var D={};for(var O in T)D[O]=T[O];return D[x.keys.locationIp]=T[x.keys.locationIp]||this._getIp(),D[x.keys.sessionId]=T[x.keys.sessionId]||this._getId("ai_session"),D[x.keys.userId]=T[x.keys.userId]||this._getId("ai_user"),D[x.keys.userAuthUserId]=T[x.keys.userAuthUserId]||this._getId("ai_authUser"),D[x.keys.operationName]=this.getOperationName(T),D[x.keys.operationParentId]=this.getOperationParentId(T),D[x.keys.operationId]=this.getOperationId(T),D},x.prototype.getOperationId=function(T){return T[x.keys.operationId]||this.operationId},x.prototype.getOperationParentId=function(T){return T[x.keys.operationParentId]||this.parentId||this.getOperationId(T)},x.prototype.getOperationName=function(T){return T[x.keys.operationName]||this.method+" "+b.parse(this.url).pathname},x.prototype.getRequestId=function(){return this.requestId},x.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},x.prototype.getTraceparent=function(){return this.traceparent},x.prototype.getTracestate=function(){return this.tracestate},x.prototype.getLegacyRootId=function(){return this.legacyRootId},x.prototype._getAbsoluteUrl=function(T){if(!T.headers)return T.url;var D=T.connection?T.connection.encrypted:null,O=b.parse(T.url),N=O.pathname,z=O.search,X=D||T.headers["x-forwarded-proto"]=="https"?"https":"http",K=b.format({protocol:X,host:T.headers.host,pathname:N,search:z});return K},x.prototype._getIp=function(){var T=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,D=s(function(N){var z=T.exec(N);if(z)return z[0]},"n"),O=D(this.rawHeaders["x-forwarded-for"])||D(this.rawHeaders["x-client-ip"])||D(this.rawHeaders["x-real-ip"])||D(this.connectionRemoteAddress)||D(this.socketRemoteAddress)||D(this.legacySocketRemoteAddress);return!O&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(O="127.0.0.1"),O},x.prototype._getId=function(T){var D=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",O=x.parseId(g.getCookie(T,D));return O},x.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},x.prototype.parseHeaders=function(T,D){if(this.rawHeaders=T.headers||T.rawHeaders,this.userAgent=T.headers&&T.headers["user-agent"],this.sourceCorrelationId=g.getCorrelationContextTarget(T,f.requestContextSourceKey),T.headers){var O=T.headers[f.traceStateHeader]?T.headers[f.traceStateHeader].toString():null,N=T.headers[f.traceparentHeader]?T.headers[f.traceparentHeader].toString():null,z=T.headers[f.requestIdHeader]?T.headers[f.requestIdHeader].toString():null,X=T.headers[f.parentIdHeader]?T.headers[f.parentIdHeader].toString():null,K=T.headers[f.rootIdHeader]?T.headers[f.rootIdHeader].toString():null;this.correlationContextHeader=T.headers[f.correlationContextHeader]?T.headers[f.correlationContextHeader].toString():null,v.w3cEnabled&&(N||O)?(this.traceparent=new E(N?N.toString():null),this.tracestate=N&&O&&new w(O?O.toString():null),this.setBackCompatFromThisTraceContext()):z?v.w3cEnabled?(this.traceparent=new E(null,z),this.setBackCompatFromThisTraceContext()):(this.parentId=z,this.requestId=v.generateRequestId(this.parentId),this.operationId=v.getRootId(this.requestId)):v.w3cEnabled?(this.traceparent=new E,this.traceparent.parentId=X,this.traceparent.legacyRootId=K||X,this.setBackCompatFromThisTraceContext()):(this.parentId=X,this.requestId=v.generateRequestId(K||this.parentId),this.correlationContextHeader=null,this.operationId=v.getRootId(this.requestId)),D&&(this.requestId=D,this.operationId=v.getRootId(this.requestId))}},x.parseId=function(T){var D=T.split("|");return D.length>0?D[0]:""},x.keys=new C.ContextTagKeys,x}(m);I.exports=y}),dc=L((c,I)=>{"use strict";function p(E){return typeof E=="function"}s(p,"pc");var b=console.error.bind(console);function C(E,y,S){var x=!!E[y]&&E.propertyIsEnumerable(y);Object.defineProperty(E,y,{configurable:!0,enumerable:x,writable:!0,value:S})}s(C,"gi");function g(E){E&&E.logger&&(p(E.logger)?b=E.logger:b("new logger isn't a function, not replacing"))}s(g,"vi");function f(E,y,S){if(!E||!E[y]){b("no original function "+y+" to wrap");return}if(!S){b("no wrapper function"),b(new Error().stack);return}if(!p(E[y])||!p(S)){b("original object and wrapper must be functions");return}var x=E[y],T=S(x,y);return C(T,"__original",x),C(T,"__unwrap",function(){E[y]===T&&C(E,y,x)}),C(T,"__wrapped",!0),C(E,y,T),T}s(f,"Rg");function m(E,y,S){if(E)Array.isArray(E)||(E=[E]);else{b("must provide one or more modules to patch"),b(new Error().stack);return}if(!(y&&Array.isArray(y))){b("must provide one or more functions to wrap on modules");return}E.forEach(function(x){y.forEach(function(T){f(x,T,S)})})}s(m,"ZO");function v(E,y){if(!E||!E[y]){b("no function to unwrap."),b(new Error().stack);return}if(!E[y].__unwrap)b("no original to unwrap to -- has "+y+" already been unwrapped?");else return E[y].__unwrap()}s(v,"Ng");function w(E,y){if(E)Array.isArray(E)||(E=[E]);else{b("must provide one or more modules to patch"),b(new Error().stack);return}if(!(y&&Array.isArray(y))){b("must provide one or more functions to unwrap on modules");return}E.forEach(function(S){y.forEach(function(x){v(S,x)})})}s(w,"JO"),g.wrap=f,g.massWrap=m,g.unwrap=v,g.massUnwrap=w,I.exports=g}),hc=L((c,I)=>{"use strict";var p=dc(),b=p.wrap,C=p.unwrap,g="wrap@before";function f(y,S,x){var T=!!y[S]&&y.propertyIsEnumerable(S);Object.defineProperty(y,S,{configurable:!0,enumerable:T,writable:!0,value:x})}s(f,"Rs");function m(y,S){for(var x=S.length,T=0;T<x;T++){var D=S[T],O=y[g];if(typeof O=="function")O(D);else if(Array.isArray(O))for(var N=O.length,z=0;z<N;z++)O[z](D)}}s(m,"eP");function v(y,S){var x;return x=y._events&&y._events[S],Array.isArray(x)||(x?x=[x]:x=[]),x}s(v,"Mg");function w(y,S,x){var T=v(y,S),D=T.filter(function(O){return x.indexOf(O)===-1});D.length>0&&m(y,D)}s(w,"tP");function E(y,S){if(y){var x=y;if(typeof y=="function")x=S(y);else if(Array.isArray(y)){x=[];for(var T=0;T<y.length;T++)x[T]=S(y[T])}return x}}s(E,"xg"),I.exports=function(y,S,x){if(!y||!y.on||!y.addListener||!y.removeListener||!y.emit)throw new Error("can only wrap real EEs");if(!S)throw new Error("must have function to run on listener addition");if(!x)throw new Error("must have function to wrap listeners when emitting");function T(O){return function(N,z){var X=v(this,N).slice();try{var K=O.call(this,N,z);return w(this,N,X),K}finally{this.on.__wrapped||b(this,"on",T),this.addListener.__wrapped||b(this,"addListener",T)}}}s(T,"i");function D(O){return function(N){if(!this._events||!this._events[N])return O.apply(this,arguments);var z=this._events[N];function X(K){return function(){this._events[N]=z;try{return K.apply(this,arguments)}finally{z=this._events[N],this._events[N]=E(z,x)}}}s(X,"p"),b(this,"removeListener",X);try{return this._events[N]=E(z,x),O.apply(this,arguments)}finally{C(this,"removeListener"),this._events[N]=z}}}s(D,"a"),y[g]?typeof y[g]=="function"?f(y,g,[y[g],S]):Array.isArray(y[g])&&y[g].push(S):f(y,g,S),y.__wrapped||(b(y,"addListener",T),b(y,"on",T),b(y,"emit",D),f(y,"__unwrap",function(){C(y,"addListener"),C(y,"on"),C(y,"emit"),delete y[g],delete y.__wrapped}),f(y,"__wrapped",!0))}}),Lu=L((c,I)=>{"use strict";var p=V(3837),b=V(9491),C=hc(),g=V(852),f="cls@contexts",m="error@context",v=process.env.DEBUG_CLS_HOOKED,w=-1;I.exports={getNamespace:y,createNamespace:S,destroyNamespace:x,reset:T,ERROR_SYMBOL:m};function E(O){this.name=O,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}s(E,"xe"),E.prototype.set=function(O,N){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[O]=N,v){let z=" ".repeat(this._indent<0?0:this._indent);D(z+"CONTEXT-SET KEY:"+O+"="+N+" in ns:"+this.name+" currentUid:"+w+" active:"+p.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return N},E.prototype.get=function(O){if(!this.active){if(v){let N=g.currentId(),z=g.triggerAsyncId(),X=" ".repeat(this._indent<0?0:this._indent);D(`${X}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${O}=undefined currentUid:${w} asyncHooksCurrentId:${N} triggerId:${z} len:${this._set.length}`)}return}if(v){let N=g.executionAsyncId(),z=g.triggerAsyncId(),X=" ".repeat(this._indent<0?0:this._indent);D(X+"CONTEXT-GETTING KEY:"+O+"="+this.active[O]+" ("+this.name+") currentUid:"+w+" active:"+p.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),D(`${X}CONTEXT-GETTING KEY: (${this.name}) ${O}=${this.active[O]} currentUid:${w} asyncHooksCurrentId:${N} triggerId:${z} len:${this._set.length} active:${p.inspect(this.active)}`)}return this.active[O]},E.prototype.createContext=function(){let O=Object.create(this.active?this.active:Object.prototype);if(O._ns_name=this.name,O.id=w,v){let N=g.executionAsyncId(),z=g.triggerAsyncId(),X=" ".repeat(this._indent<0?0:this._indent);D(`${X}CONTEXT-CREATED Context: (${this.name}) currentUid:${w} asyncHooksCurrentId:${N} triggerId:${z} len:${this._set.length} context:${p.inspect(O,{showHidden:!0,depth:2,colors:!0})}`)}return O},E.prototype.run=function(O){let N=this.createContext();this.enter(N);try{if(v){let z=g.triggerAsyncId(),X=g.executionAsyncId(),K=" ".repeat(this._indent<0?0:this._indent);D(`${K}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${w} triggerId:${z} asyncHooksCurrentId:${X} len:${this._set.length} context:${p.inspect(N)}`)}return O(N),N}catch(z){throw z&&(z[m]=N),z}finally{if(v){let z=g.triggerAsyncId(),X=g.executionAsyncId(),K=" ".repeat(this._indent<0?0:this._indent);D(`${K}CONTEXT-RUN END: (${this.name}) currentUid:${w} triggerId:${z} asyncHooksCurrentId:${X} len:${this._set.length} ${p.inspect(N)}`)}this.exit(N)}},E.prototype.runAndReturn=function(O){let N;return this.run(function(z){N=O(z)}),N},E.prototype.runPromise=function(O){let N=this.createContext();this.enter(N);let z=O(N);if(!z||!z.then||!z.catch)throw new Error("fn must return a promise.");return v&&D("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+p.inspect(N)),z.then(X=>(v&&D("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+p.inspect(N)),this.exit(N),X)).catch(X=>{throw X[m]=N,v&&D("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+w+" len:"+this._set.length+" "+p.inspect(N)),this.exit(N),X})},E.prototype.bind=function(O,N){N||(this.active?N=this.active:N=this.createContext());let z=this;return function(){z.enter(N);try{return O.apply(this,arguments)}catch(X){throw X&&(X[m]=N),X}finally{z.exit(N)}}},E.prototype.enter=function(O){if(b.ok(O,"context must be provided for entering"),v){let N=g.executionAsyncId(),z=g.triggerAsyncId(),X=" ".repeat(this._indent<0?0:this._indent);D(`${X}CONTEXT-ENTER: (${this.name}) currentUid:${w} triggerId:${z} asyncHooksCurrentId:${N} len:${this._set.length} ${p.inspect(O)}`)}this._set.push(this.active),this.active=O},E.prototype.exit=function(O){if(b.ok(O,"context must be provided for exiting"),v){let z=g.executionAsyncId(),X=g.triggerAsyncId(),K=" ".repeat(this._indent<0?0:this._indent);D(`${K}CONTEXT-EXIT: (${this.name}) currentUid:${w} triggerId:${X} asyncHooksCurrentId:${z} len:${this._set.length} ${p.inspect(O)}`)}if(this.active===O){b.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let N=this._set.lastIndexOf(O);N<0?(v&&D("??ERROR?? context exiting but not entered - ignoring: "+p.inspect(O)),b.ok(N>=0,`context not currently entered; can't exit. 
`+p.inspect(this)+`
`+p.inspect(O))):(b.ok(N,"can't remove top context"),this._set.splice(N,1))},E.prototype.bindEmitter=function(O){b.ok(O.on&&O.addListener&&O.emit,"can only bind real EEs");let N=this,z="context@"+this.name;function X(fe){!fe||(fe[f]||(fe[f]=Object.create(null)),fe[f][z]={namespace:N,context:N.active})}s(X,"i");function K(fe){if(!(fe&&fe[f]))return fe;let be=fe,Fe=fe[f];return Object.keys(Fe).forEach(function(ke){let Qe=Fe[ke];be=Qe.namespace.bind(be,Qe.context)}),be}s(K,"a"),C(O,X,K)},E.prototype.fromException=function(O){return O[m]};function y(O){return process.namespaces[O]}s(y,"qg");function S(O){b.ok(O,"namespace must be given a name."),v&&D(`NS-CREATING NAMESPACE (${O})`);let N=new E(O);return N.id=w,g.createHook({init(z,X,K,fe){if(w=g.executionAsyncId(),N.active){if(N._contexts.set(z,N.active),v){let be=" ".repeat(N._indent<0?0:N._indent);D(`${be}INIT [${X}] (${O}) asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(w===0){let be=g.triggerAsyncId(),Fe=N._contexts.get(be);if(Fe){if(N._contexts.set(z,Fe),v){let ke=" ".repeat(N._indent<0?0:N._indent);D(`${ke}INIT USING CONTEXT FROM TRIGGERID [${X}] (${O}) asyncId:${z} currentUid:${w} triggerId:${be} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(v){let ke=" ".repeat(N._indent<0?0:N._indent);D(`${ke}INIT MISSING CONTEXT [${X}] (${O}) asyncId:${z} currentUid:${w} triggerId:${be} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}if(v&&X==="PROMISE"){D(p.inspect(fe,{showHidden:!0}));let be=fe.parentId,Fe=" ".repeat(N._indent<0?0:N._indent);D(`${Fe}INIT RESOURCE-PROMISE [${X}] (${O}) parentId:${be} asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}},before(z){w=g.executionAsyncId();let X;if(X=N._contexts.get(z)||N._contexts.get(w),X){if(v){let K=g.triggerAsyncId(),fe=" ".repeat(N._indent<0?0:N._indent);D(`${fe}BEFORE (${O}) asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} context:${p.inspect(X)}`),N._indent+=2}N.enter(X)}else if(v){let K=g.triggerAsyncId(),fe=" ".repeat(N._indent<0?0:N._indent);D(`${fe}BEFORE MISSING CONTEXT (${O}) asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${p.inspect(N._contexts,{showHidden:!0,depth:2,colors:!0})}`),N._indent+=2}},after(z){w=g.executionAsyncId();let X;if(X=N._contexts.get(z)||N._contexts.get(w),X){if(v){let K=g.triggerAsyncId();N._indent-=2;let fe=" ".repeat(N._indent<0?0:N._indent);D(`${fe}AFTER (${O}) asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} context:${p.inspect(X)}`)}N.exit(X)}else if(v){let K=g.triggerAsyncId();N._indent-=2;let fe=" ".repeat(N._indent<0?0:N._indent);D(`${fe}AFTER MISSING CONTEXT (${O}) asyncId:${z} currentUid:${w} triggerId:${K} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} context:${p.inspect(X)}`)}},destroy(z){if(w=g.executionAsyncId(),v){let X=g.triggerAsyncId(),K=" ".repeat(N._indent<0?0:N._indent);D(`${K}DESTROY (${O}) currentUid:${w} asyncId:${z} triggerId:${X} active:${p.inspect(N.active,{showHidden:!0,depth:2,colors:!0})} context:${p.inspect(N._contexts.get(w))}`)}N._contexts.delete(z)}}).enable(),process.namespaces[O]=N,N}s(S,"nP");function x(O){let N=y(O);b.ok(N,`can't delete nonexistent namespace! "`+O+'"'),b.ok(N.id,"don't assign to process.namespaces directly! "+p.inspect(N)),process.namespaces[O]=null}s(x,"kg");function T(){process.namespaces&&Object.keys(process.namespaces).forEach(function(O){x(O)}),process.namespaces=Object.create(null)}s(T,"iP"),process.namespaces={};function D(...O){v&&process._rawDebug(`${p.format(...O)}`)}s(D,"j")}),fc=L((c,I)=>{"use strict";function p(){}s(p,"aP"),I.exports=function(){let b=this._hooks,C=this._state,g=process.nextTick;process.nextTick=function(){if(!C.enabled)return g.apply(process,arguments);let f=new Array(arguments.length);for(let E=0;E<arguments.length;E++)f[E]=arguments[E];let m=f[0];if(typeof m!="function")throw new TypeError("callback is not a function");let v=new p,w=--C.counter;return b.init.call(v,w,0,null,null),f[0]=function(){b.pre.call(v,w);let E=!0;try{m.apply(this,arguments),E=!1}finally{E&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){b.post.call(v,w,!0),b.destroy.call(null,w)})}b.post.call(v,w,!1),b.destroy.call(null,w)},g.apply(process,f)}}}),fa=L((c,I)=>{"use strict";function p(){}s(p,"sP"),I.exports=function(){let b=this._hooks,C=this._state,g=global.Promise,f=g.prototype.then;g.prototype.then=E;function m(y,S,x,T){return typeof y!="function"?T?v(x):w(x):function(){b.pre.call(S,x);try{return y.apply(this,arguments)}finally{b.post.call(S,x,!1),b.destroy.call(null,x)}}}s(m,"a");function v(y){return function(S){return b.destroy.call(null,y),S}}s(v,"s");function w(y){return function(S){throw b.destroy.call(null,y),S}}s(w,"o");function E(y,S){if(!C.enabled)return f.call(this,y,S);let x=new p,T=--C.counter;return b.init.call(x,T,0,null,null),f.call(this,m(y,x,T,!0),m(S,x,T,!1))}s(E,"u")}}),$u=L((c,I)=>{"use strict";var p=V(9512);function b(){}s(b,"oP");function C(){}s(C,"uP");function g(){}s(g,"cP");var f=new Map,m=new Map,v=new Map,w=null,E=!1;I.exports=function(){y(this._hooks,this._state,"setTimeout","clearTimeout",b,f,!0),y(this._hooks,this._state,"setInterval","clearInterval",C,m,!1),y(this._hooks,this._state,"setImmediate","clearImmediate",g,v,!0),global.setTimeout=p.setTimeout,global.setInterval=p.setInterval,global.setImmediate=p.setImmediate,global.clearTimeout=p.clearTimeout,global.clearInterval=p.clearInterval,global.clearImmediate=p.clearImmediate};function y(S,x,T,D,O,N,z){let X=p[T],K=p[D];p[T]=function(){if(!x.enabled)return X.apply(p,arguments);let fe=new Array(arguments.length);for(let it=0;it<arguments.length;it++)fe[it]=arguments[it];let be=fe[0];if(typeof be!="function")throw new TypeError('"callback" argument must be a function');let Fe=new O,ke=--x.counter,Qe;return S.init.call(Fe,ke,0,null,null),fe[0]=function(){w=Qe,S.pre.call(Fe,ke);let it=!0;try{be.apply(this,arguments),it=!1}finally{it&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){S.post.call(Fe,ke,!0),N.delete(Qe),S.destroy.call(null,ke)})}S.post.call(Fe,ke,!1),w=null,(z||E)&&(E=!1,N.delete(Qe),S.destroy.call(null,ke))},Qe=X.apply(p,fe),N.set(Qe,ke),Qe},p[D]=function(fe){if(w===fe&&fe!==null)E=!0;else if(N.has(fe)){let be=N.get(fe);N.delete(fe),S.destroy.call(null,be)}K.apply(p,arguments)}}s(y,"hc")}),Al=L((c,I)=>{I.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}}),rs=L((c,I)=>{"use strict";var p=process.binding("async_wrap"),b=p.Providers.TIMERWRAP,C={nextTick:fc(),promise:fa(),timers:$u()},g=new Set;function f(){this.enabled=!1,this.counter=0}s(f,"_P");function m(){let E=this.initFns=[],y=this.preFns=[],S=this.postFns=[],x=this.destroyFns=[];this.init=function(T,D,O,N){if(D===b){g.add(T);return}for(let z of E)z(T,this,D,O,N)},this.pre=function(T){if(!g.has(T))for(let D of y)D(T,this)},this.post=function(T,D){if(!g.has(T))for(let O of S)O(T,this,D)},this.destroy=function(T){if(g.has(T)){g.delete(T);return}for(let D of x)D(T)}}s(m,"gc"),m.prototype.add=function(E){E.init&&this.initFns.push(E.init),E.pre&&this.preFns.push(E.pre),E.post&&this.postFns.push(E.post),E.destroy&&this.destroyFns.push(E.destroy)};function v(E,y){let S=E.indexOf(y);S!==-1&&E.splice(S,1)}s(v,"Ds"),m.prototype.remove=function(E){E.init&&v(this.initFns,E.init),E.pre&&v(this.preFns,E.pre),E.post&&v(this.postFns,E.post),E.destroy&&v(this.destroyFns,E.destroy)};function w(){this._state=new f,this._hooks=new m,this.version=Al().version,this.providers=p.Providers;for(let E of Object.keys(C))C[E].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),p.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}s(w,"Si"),I.exports=w,w.prototype.addHooks=function(E){this._hooks.add(E)},w.prototype.removeHooks=function(E){this._hooks.remove(E)},w.prototype.enable=function(){this._state.enabled=!0,p.enable()},w.prototype.disable=function(){this._state.enabled=!1,p.disable()}}),Bn=L((c,I)=>{I.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}}),pc=L((c,I)=>{function p(b){try{return Error.prototype.toString.call(b)}catch(C){try{return"<error: "+C+">"}catch(g){return"<error>"}}}s(p,"vP"),I.exports=function(b,C){var g=[];g.push(p(b));for(var f=0;f<C.length;f++){var m=C[f],v;try{v=m.toString()}catch(w){try{v="<error: "+w+">"}catch(E){v="<error>"}}g.push("    at "+v)}return g.join(`
`)}}),Bu=L((c,I)=>{var p=pc();function b(){this.extend=new f,this.filter=new f,this.format=new m,this.version=Bn().version}s(b,"Wg");var C=!1;b.prototype.callSite=s(function y(S){S||(S={}),C=!0;var x={};Error.captureStackTrace(x,y);var T=x.stack;return C=!1,T=T.slice(S.slice||0),S.extend&&(T=this.extend._modify(x,T)),S.filter&&(T=this.filter._modify(x,T)),T},"e");var g=new b;function f(){this._modifiers=[]}s(f,"Ai"),f.prototype._modify=function(y,S){for(var x=0,T=this._modifiers.length;x<T;x++)S=this._modifiers[x](y,S);return S},f.prototype.attach=function(y){this._modifiers.push(y)},f.prototype.deattach=function(y){var S=this._modifiers.indexOf(y);return S===-1?!1:(this._modifiers.splice(S,1),!0)};function m(){this._formater=p,this._previous=void 0}s(m,"bi"),m.prototype.replace=function(y){y?this._formater=y:this.restore()},m.prototype.restore=function(){this._formater=p,this._previous=void 0},m.prototype._backup=function(){this._previous=this._formater},m.prototype._roolback=function(){this._previous===p?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&g.format.replace(Error.prepareStackTrace);var v=!1;function w(y,S){if(C)return S;if(v)return p(y,S);var x=S.concat();x=g.extend._modify(y,x),x=g.filter._modify(y,x),x=x.slice(0,Error.stackTraceLimit),Object.isExtensible(y)&&Object.getOwnPropertyDescriptor(y,"callSite")===void 0&&(y.callSite={original:S,mutated:x}),v=!0;var T=g.format._formater(y,x);return v=!1,T}s(w,"Zg"),Object.defineProperty(Error,"prepareStackTrace",{get:function(){return w},set:function(y){y===w?g.format._roolback():(g.format._backup(),g.format.replace(y))}});function E(){return this.stack,this.callSite}s(E,"mP"),Object.defineProperty(Error.prototype,"callSite",{get:E,set:function(y){Object.defineProperty(this,"callSite",{value:y,writable:!0,configurable:!0})},configurable:!0}),I.exports=g}),ir=L((c,I)=>{if(global._stackChain)if(global._stackChain.version===Bn().version)I.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else I.exports=global._stackChain=Bu()}),Uu=L((c,I)=>{"use strict";var p=rs();if(global._asyncHook)if(global._asyncHook.version===Al().version)I.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else ir().filter.attach(function(b,C){return C.filter(function(g){let f=g.getFileName();return!(f&&f.slice(0,__dirname.length)===__dirname)})}),I.exports=global._asyncHook=new p}),Hu=L((c,I)=>{"use strict";var p=V(3837),b=V(9491),C=hc(),g=Uu(),f="cls@contexts",m="error@context",v=[];for(let K in g.providers)v[g.providers[K]]=K;var w=process.env.DEBUG_CLS_HOOKED,E=-1;I.exports={getNamespace:S,createNamespace:x,destroyNamespace:T,reset:D,ERROR_SYMBOL:m};function y(K){this.name=K,this.active=null,this._set=[],this.id=null,this._contexts=new Map}s(y,"Le"),y.prototype.set=function(K,fe){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return w&&O("    SETTING KEY:"+K+"="+fe+" in ns:"+this.name+" uid:"+E+" active:"+p.inspect(this.active,!0)),this.active[K]=fe,fe},y.prototype.get=function(K){if(!this.active){w&&O("    GETTING KEY:"+K+"=undefined "+this.name+" uid:"+E+" active:"+p.inspect(this.active,!0));return}return w&&O("    GETTING KEY:"+K+"="+this.active[K]+" "+this.name+" uid:"+E+" active:"+p.inspect(this.active,!0)),this.active[K]},y.prototype.createContext=function(){w&&O("   CREATING Context: "+this.name+" uid:"+E+" len:"+this._set.length+"  active:"+p.inspect(this.active,!0,2,!0));let K=Object.create(this.active?this.active:Object.prototype);return K._ns_name=this.name,K.id=E,w&&O("   CREATED Context: "+this.name+" uid:"+E+" len:"+this._set.length+"  context:"+p.inspect(K,!0,2,!0)),K},y.prototype.run=function(K){let fe=this.createContext();this.enter(fe);try{return w&&O(" BEFORE RUN: "+this.name+" uid:"+E+" len:"+this._set.length+" "+p.inspect(fe)),K(fe),fe}catch(be){throw be&&(be[m]=fe),be}finally{w&&O(" AFTER RUN: "+this.name+" uid:"+E+" len:"+this._set.length+" "+p.inspect(fe)),this.exit(fe)}},y.prototype.runAndReturn=function(K){var fe;return this.run(function(be){fe=K(be)}),fe},y.prototype.runPromise=function(K){let fe=this.createContext();this.enter(fe);let be=K(fe);if(!be||!be.then||!be.catch)throw new Error("fn must return a promise.");return w&&O(" BEFORE runPromise: "+this.name+" uid:"+E+" len:"+this._set.length+" "+p.inspect(fe)),be.then(Fe=>(w&&O(" AFTER runPromise: "+this.name+" uid:"+E+" len:"+this._set.length+" "+p.inspect(fe)),this.exit(fe),Fe)).catch(Fe=>{throw Fe[m]=fe,w&&O(" AFTER runPromise: "+this.name+" uid:"+E+" len:"+this._set.length+" "+p.inspect(fe)),this.exit(fe),Fe})},y.prototype.bind=function(K,fe){fe||(this.active?fe=this.active:fe=this.createContext());let be=this;return function(){be.enter(fe);try{return K.apply(this,arguments)}catch(Fe){throw Fe&&(Fe[m]=fe),Fe}finally{be.exit(fe)}}},y.prototype.enter=function(K){b.ok(K,"context must be provided for entering"),w&&O("  ENTER "+this.name+" uid:"+E+" len:"+this._set.length+" context: "+p.inspect(K)),this._set.push(this.active),this.active=K},y.prototype.exit=function(K){if(b.ok(K,"context must be provided for exiting"),w&&O("  EXIT "+this.name+" uid:"+E+" len:"+this._set.length+" context: "+p.inspect(K)),this.active===K){b.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let fe=this._set.lastIndexOf(K);fe<0?(w&&O("??ERROR?? context exiting but not entered - ignoring: "+p.inspect(K)),b.ok(fe>=0,`context not currently entered; can't exit. 
`+p.inspect(this)+`
`+p.inspect(K))):(b.ok(fe,"can't remove top context"),this._set.splice(fe,1))},y.prototype.bindEmitter=function(K){b.ok(K.on&&K.addListener&&K.emit,"can only bind real EEs");let fe=this,be="context@"+this.name;function Fe(Qe){!Qe||(Qe[f]||(Qe[f]=Object.create(null)),Qe[f][be]={namespace:fe,context:fe.active})}s(Fe,"i");function ke(Qe){if(!(Qe&&Qe[f]))return Qe;let it=Qe,gt=Qe[f];return Object.keys(gt).forEach(function(xt){let Ht=gt[xt];it=Ht.namespace.bind(it,Ht.context)}),it}s(ke,"a"),C(K,Fe,ke)},y.prototype.fromException=function(K){return K[m]};function S(K){return process.namespaces[K]}s(S,"nv");function x(K){b.ok(K,"namespace must be given a name."),w&&O("CREATING NAMESPACE "+K);let fe=new y(K);return fe.id=E,g.addHooks({init(be,Fe,ke,Qe,it){E=be,Qe?(fe._contexts.set(be,fe._contexts.get(Qe)),w&&O("PARENTID: "+K+" uid:"+be+" parent:"+Qe+" provider:"+ke)):fe._contexts.set(E,fe.active),w&&O("INIT "+K+" uid:"+be+" parent:"+Qe+" provider:"+v[ke]+" active:"+p.inspect(fe.active,!0))},pre(be,Fe){E=be;let ke=fe._contexts.get(be);ke?(w&&O(" PRE "+K+" uid:"+be+" handle:"+N(Fe)+" context:"+p.inspect(ke)),fe.enter(ke)):w&&O(" PRE MISSING CONTEXT "+K+" uid:"+be+" handle:"+N(Fe))},post(be,Fe){E=be;let ke=fe._contexts.get(be);ke?(w&&O(" POST "+K+" uid:"+be+" handle:"+N(Fe)+" context:"+p.inspect(ke)),fe.exit(ke)):w&&O(" POST MISSING CONTEXT "+K+" uid:"+be+" handle:"+N(Fe))},destroy(be){E=be,w&&O("DESTROY "+K+" uid:"+be+" context:"+p.inspect(fe._contexts.get(E))+" active:"+p.inspect(fe.active,!0)),fe._contexts.delete(be)}}),process.namespaces[K]=fe,fe}s(x,"TP");function T(K){let fe=S(K);b.ok(fe,`can't delete nonexistent namespace! "`+K+'"'),b.ok(fe.id,"don't assign to process.namespaces directly! "+p.inspect(fe)),process.namespaces[K]=null}s(T,"iv");function D(){process.namespaces&&Object.keys(process.namespaces).forEach(function(K){T(K)}),process.namespaces=Object.create(null)}s(D,"SP"),process.namespaces={},g._state&&!g._state.enabled&&g.enable();function O(K){process.env.DEBUG&&process._rawDebug(K)}s(O,"Q");function N(K){if(!K)return K;if(typeof K=="function")return K.name?K.name:(K.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(K.constructor&&K.constructor.name)return K.constructor.name}if(s(N,"Ms"),w){z=ir();for(X in z.filter._modifiers)z.filter.deattach(X)}var z,X}),Un=L((c,I)=>{"use strict";var p=Ce();process&&p.gte(process.versions.node,"8.0.0")?I.exports=Lu():I.exports=Hu()}),ni=L((c,I)=>{var p=dc().wrap,b=1<<0,C=1<<1,g=1<<2,f=1<<3,m=[],v=0,w=!1,E=[],y,S;function x(Fe,ke){var Qe=Fe.length,it=ke.length,gt=[];if(Qe===0&&it===0)return gt;for(var xt=0;xt<Qe;xt++)gt[xt]=Fe[xt];if(it===0)return gt;for(var Ht=0;Ht<it;Ht++){var jt=!0;for(xt=0;xt<Qe;xt++)if(Fe[xt].uid===ke[Ht].uid){jt=!1;break}jt&&gt.push(ke[Ht])}return gt}s(x,"Rc"),process._fatalException?(T=!1,y=s(function(Fe){var ke=m.length;if(T||ke===0)return!1;var Qe=!1;T=!0;for(var it=0;it<ke;++it){var gt=m[it];if((gt.flags&f)!=0){var xt=D&&D[gt.uid];Qe=gt.error(xt,Fe)||Qe}}return T=!1,E.length>0&&(m=E.pop()),D=void 0,Qe&&!w},"hn"),S=s(function(Fe,ke,Qe){var it=[];w=!0;for(var gt=0;gt<Qe;++gt){var xt=ke[gt];if(it[xt.uid]=xt.data,(xt.flags&b)!=0){var Ht=xt.create(xt.data);Ht!==void 0&&(it[xt.uid]=Ht)}}return w=!1,function(){D=it,E.push(m),m=x(ke,m),w=!0;for(var jt=0;jt<Qe;++jt)(ke[jt].flags&C)>0&&ke[jt].before(this,it[ke[jt].uid]);w=!1;var cr=Fe.apply(this,arguments);for(w=!0,jt=0;jt<Qe;++jt)(ke[jt].flags&g)>0&&ke[jt].after(this,it[ke[jt].uid]);return w=!1,m=E.pop(),D=void 0,cr}},"Pc"),p(process,"_fatalException",function(Fe){return function(ke){return y(ke)||Fe(ke)}})):(O=!1,y=s(function(Fe){if(O)throw Fe;for(var ke=!1,Qe=m.length,it=0;it<Qe;++it){var gt=m[it];(gt.flags&f)!=0&&(ke=gt.error(null,Fe)||ke)}if(!ke&&w)throw Fe},"hn"),S=s(function(Fe,ke,Qe){var it=[];w=!0;for(var gt=0;gt<Qe;++gt){var xt=ke[gt];if(it[xt.uid]=xt.data,(xt.flags&b)!=0){var Ht=xt.create(xt.data);Ht!==void 0&&(it[xt.uid]=Ht)}}return w=!1,function(){var jt=!1,cr=!1;E.push(m),m=x(ke,m),w=!0;for(var Xt=0;Xt<Qe;++Xt)(ke[Xt].flags&C)>0&&ke[Xt].before(this,it[ke[Xt].uid]);w=!1;var Je;try{Je=Fe.apply(this,arguments)}catch(dt){jt=!0;for(var Xt=0;Xt<Qe;++Xt)if((m[Xt].flags&f)!=0)try{cr=m[Xt].error(it[ke[Xt].uid],dt)||cr}catch(yt){throw O=!0,yt}if(!cr)throw process.removeListener("uncaughtException",y),process._originalNextTick(function(){process.addListener("uncaughtException",y)}),dt}finally{if(!jt||cr){for(w=!0,Xt=0;Xt<Qe;++Xt)(ke[Xt].flags&g)>0&&ke[Xt].after(this,it[ke[Xt].uid]);w=!1}m=E.pop()}return Je}},"Pc"),process.addListener("uncaughtException",y));var T,D,O;function N(Fe,ke,Qe){w=!0;for(var it=0;it<Qe;++it){var gt=ke[it];gt.create&&gt.create(gt.data)}return w=!1,function(){E.push(m),m=x(ke,m);var xt=Fe.apply(this,arguments);return m=E.pop(),xt}}s(N,"CP");function z(Fe){var ke=m.length;if(ke===0)return Fe;for(var Qe=m.slice(),it=0;it<ke;++it)if(Qe[it].flags>0)return S(Fe,Qe,ke);return N(Fe,Qe,ke)}s(z,"OP");function X(Fe,ke){typeof Fe.create=="function"&&(this.create=Fe.create,this.flags|=b),typeof Fe.before=="function"&&(this.before=Fe.before,this.flags|=C),typeof Fe.after=="function"&&(this.after=Fe.after,this.flags|=g),typeof Fe.error=="function"&&(this.error=Fe.error,this.flags|=f),this.uid=++v,this.data=ke===void 0?null:ke}s(X,"Ze"),X.prototype.create=void 0,X.prototype.before=void 0,X.prototype.after=void 0,X.prototype.error=void 0,X.prototype.data=void 0,X.prototype.uid=0,X.prototype.flags=0;function K(Fe,ke){if(typeof Fe!="object"||!Fe)throw new TypeError("callbacks argument must be an object");return Fe instanceof X?Fe:new X(Fe,ke)}s(K,"cv");function fe(Fe,ke){var Qe;Fe instanceof X?Qe=Fe:Qe=K(Fe,ke);for(var it=!1,gt=0;gt<m.length;gt++)if(Qe===m[gt]){it=!0;break}return it||m.push(Qe),Qe}s(fe,"PP");function be(Fe){for(var ke=0;ke<m.length;ke++)if(Fe===m[ke]){m.splice(ke,1);break}}s(be,"RP"),process.createAsyncListener=K,process.addAsyncListener=fe,process.removeAsyncListener=be,I.exports=z}),Rl=L((c,I)=>{"use strict";I.exports=(p,b)=>class extends p{constructor(C){var g,f;super(v);var m=this;try{C.apply(g,f)}catch(w){f[1](w)}return m;function v(w,E){g=this,f=[y,S];function y(x){return b(m,!1),w(x)}s(y,"p");function S(x){return b(m,!1),E(x)}s(S,"f")}}}}),Oo=L(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var c=dc(),I=Ce(),p=c.wrap,b=c.massWrap,C=ni(),g=V(3837),f=I.gte(process.version,"6.0.0"),m=I.gte(process.version,"7.0.0"),v=I.gte(process.version,"8.0.0"),w=I.gte(process.version,"11.0.0"),E=V(1808);m&&!E._normalizeArgs?E._normalizeArgs=function(Je){if(Je.length===0)return[{},null];var dt=Je[0],ut={};typeof dt=="object"&&dt!==null?ut=dt:Xt(dt)?ut.path=dt:(ut.port=dt,Je.length>1&&typeof Je[1]=="string"&&(ut.host=Je[1]));var yt=Je[Je.length-1];return typeof yt!="function"?[ut,null]:[ut,yt]}:!m&&!E._normalizeConnectArgs&&(E._normalizeConnectArgs=function(Je){var dt={};function ut(Lt){return(Lt=Number(Lt))>=0?Lt:!1}s(ut,"r"),typeof Je[0]=="object"&&Je[0]!==null?dt=Je[0]:typeof Je[0]=="string"&&ut(Je[0])===!1?dt.path=Je[0]:(dt.port=Je[0],typeof Je[1]=="string"&&(dt.host=Je[1]));var yt=Je[Je.length-1];return typeof yt=="function"?[dt,yt]:[dt]}),"_setUpListenHandle"in E.Server.prototype?p(E.Server.prototype,"_setUpListenHandle",y):p(E.Server.prototype,"_listen2",y);function y(Je){return function(){this.on("connection",function(dt){dt._handle&&(dt._handle.onread=C(dt._handle.onread))});try{return Je.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=C(this._handle.onconnection))}}}s(y,"_v");function S(Je){if(Je&&Je._handle){var dt=Je._handle;dt._originalOnread||(dt._originalOnread=dt.onread),dt.onread=C(dt._originalOnread)}}s(S,"gv"),p(E.Socket.prototype,"connect",function(Je){return function(){var dt;v&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?dt=arguments[0]:dt=m?E._normalizeArgs(arguments):E._normalizeConnectArgs(arguments),dt[1]&&(dt[1]=C(dt[1]));var ut=Je.apply(this,dt);return S(this),ut}});var x=V(3685);p(x.Agent.prototype,"addRequest",function(Je){return function(dt){var ut=dt.onSocket;return dt.onSocket=C(function(yt){return S(yt),ut.apply(this,arguments)}),Je.apply(this,arguments)}});var T=V(2081);function D(Je){Array.isArray(Je.stdio)&&Je.stdio.forEach(function(dt){dt&&dt._handle&&(dt._handle.onread=C(dt._handle.onread),p(dt._handle,"close",jt))}),Je._handle&&(Je._handle.onexit=C(Je._handle.onexit))}s(D,"vv"),T.ChildProcess?p(T.ChildProcess.prototype,"spawn",function(Je){return function(){var dt=Je.apply(this,arguments);return D(this),dt}}):b(T,["execFile","fork","spawn"],function(Je){return function(){var dt=Je.apply(this,arguments);return D(dt),dt}}),process._fatalException||(process._originalNextTick=process.nextTick);var O=[];process._nextDomainTick&&O.push("_nextDomainTick"),process._tickDomainCallback&&O.push("_tickDomainCallback"),b(process,O,Ht),p(process,"nextTick",jt);var N=["setTimeout","setInterval"];global.setImmediate&&N.push("setImmediate");var z=V(9512),X=global.setTimeout===z.setTimeout;b(z,N,jt),X&&b(global,N,jt);var K=V(9523);b(K,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],Ht),K.resolveNaptr&&p(K,"resolveNaptr",Ht);var fe=V(7147);b(fe,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],Ht),fe.lchown&&p(fe,"lchown",Ht),fe.lchmod&&p(fe,"lchmod",Ht),fe.ftruncate&&p(fe,"ftruncate",Ht);var be;try{be=V(9796)}catch(Je){}be&&be.Deflate&&be.Deflate.prototype&&(Fe=Object.getPrototypeOf(be.Deflate.prototype),Fe._transform?p(Fe,"_transform",Ht):Fe.write&&Fe.flush&&Fe.end&&b(Fe,["write","flush","end"],Ht));var Fe,ke;try{ke=V(6113)}catch(Je){}ke&&(Qe=["pbkdf2","randomBytes"],w||Qe.push("pseudoRandomBytes"),b(ke,Qe,Ht));var Qe,it=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";it&&(gt=process.addAsyncListener({create:function(){it=!1}}),global.Promise.resolve(!0).then(function(){it=!1}),process.removeAsyncListener(gt));var gt;it&&xt();function xt(){var Je=global.Promise;function dt(At){if(!(this instanceof dt))return Je(At);if(typeof At!="function")return new Je(At);var Zt,Ir,Dr=new Je(_r);Dr.__proto__=dt.prototype;try{At.apply(Zt,Ir)}catch(ur){Ir[1](ur)}return Dr;function _r(ur,Wr){Zt=this,Ir=[Gr,Ft];function Gr(Ct){return yt(Dr,!1),ur(Ct)}s(Gr,"_");function Ft(Ct){return yt(Dr,!1),Wr(Ct)}s(Ft,"g")}}if(s(dt,"t"),g.inherits(dt,Je),p(Je.prototype,"then",Yt),Je.prototype.chain&&p(Je.prototype,"chain",Yt),f)global.Promise=Rl()(Je,yt);else{var ut=["all","race","reject","resolve","accept","defer"];ut.forEach(function(At){typeof Je[At]=="function"&&(dt[At]=Je[At])}),global.Promise=dt}function yt(At,Zt){(!At.__asl_wrapper||Zt)&&(At.__asl_wrapper=C(Lt))}s(yt,"n");function Lt(At,Zt,Ir,Dr){var _r;try{return _r=Zt.call(At,Ir),{returnVal:_r,error:!1}}catch(ur){return{errorVal:ur,error:!0}}finally{_r instanceof Je?Dr.__asl_wrapper=function(){var ur=_r.__asl_wrapper||Lt;return ur.apply(this,arguments)}:yt(Dr,!0)}}s(Lt,"i");function Yt(At){return function(){var Zt=this,Ir=At.apply(Zt,Array.prototype.map.call(arguments,Dr));return Ir.__asl_wrapper=function(_r,ur,Wr,Gr){return Zt.__asl_wrapper?(Zt.__asl_wrapper(_r,function(){},null,Ir),Ir.__asl_wrapper(_r,ur,Wr,Gr)):Lt(_r,ur,Wr,Gr)},Ir;function Dr(_r){return typeof _r!="function"?_r:C(function(ur){var Wr=(Zt.__asl_wrapper||Lt)(this,_r,ur,Ir);if(Wr.error)throw Wr.errorVal;return Wr.returnVal})}}}s(Yt,"a")}s(xt,"qP");function Ht(Je){var dt=s(function(){var ut,yt=arguments.length-1;if(typeof arguments[yt]=="function"){ut=Array(arguments.length);for(var Lt=0;Lt<arguments.length-1;Lt++)ut[Lt]=arguments[Lt];ut[yt]=C(arguments[yt])}return Je.apply(this,ut||arguments)},"t");switch(Je.length){case 1:return function(ut){return arguments.length!==1?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut))};case 2:return function(ut,yt){return arguments.length!==2?dt.apply(this,arguments):(typeof yt=="function"&&(yt=C(yt)),Je.call(this,ut,yt))};case 3:return function(ut,yt,Lt){return arguments.length!==3?dt.apply(this,arguments):(typeof Lt=="function"&&(Lt=C(Lt)),Je.call(this,ut,yt,Lt))};case 4:return function(ut,yt,Lt,Yt){return arguments.length!==4?dt.apply(this,arguments):(typeof Yt=="function"&&(Yt=C(Yt)),Je.call(this,ut,yt,Lt,Yt))};case 5:return function(ut,yt,Lt,Yt,At){return arguments.length!==5?dt.apply(this,arguments):(typeof At=="function"&&(At=C(At)),Je.call(this,ut,yt,Lt,Yt,At))};case 6:return function(ut,yt,Lt,Yt,At,Zt){return arguments.length!==6?dt.apply(this,arguments):(typeof Zt=="function"&&(Zt=C(Zt)),Je.call(this,ut,yt,Lt,Yt,At,Zt))};default:return dt}}s(Ht,"et");function jt(Je){var dt=s(function(){var ut;if(typeof arguments[0]=="function"){ut=Array(arguments.length),ut[0]=C(arguments[0]);for(var yt=1;yt<arguments.length;yt++)ut[yt]=arguments[yt]}return Je.apply(this,ut||arguments)},"t");switch(Je.length){case 1:return function(ut){return arguments.length!==1?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut))};case 2:return function(ut,yt){return arguments.length!==2?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut,yt))};case 3:return function(ut,yt,Lt){return arguments.length!==3?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut,yt,Lt))};case 4:return function(ut,yt,Lt,Yt){return arguments.length!==4?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut,yt,Lt,Yt))};case 5:return function(ut,yt,Lt,Yt,At){return arguments.length!==5?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut,yt,Lt,Yt,At))};case 6:return function(ut,yt,Lt,Yt,At,Zt){return arguments.length!==6?dt.apply(this,arguments):(typeof ut=="function"&&(ut=C(ut)),Je.call(this,ut,yt,Lt,Yt,At,Zt))};default:return dt}}s(jt,"js");function cr(Je){return(Je=Number(Je))>=0?Je:!1}s(cr,"kP");function Xt(Je){return typeof Je=="string"&&cr(Je)===!1}s(Xt,"jP")}),ko=L((c,I)=>{"use strict";var p=V(9491),b=hc(),C="cls@contexts",g="error@context";process.addAsyncListener||Oo();function f(y){this.name=y,this.active=null,this._set=[],this.id=null}s(f,"Ve"),f.prototype.set=function(y,S){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[y]=S,S},f.prototype.get=function(y){if(this.active)return this.active[y]},f.prototype.createContext=function(){return Object.create(this.active)},f.prototype.run=function(y){var S=this.createContext();this.enter(S);try{return y(S),S}catch(x){throw x&&(x[g]=S),x}finally{this.exit(S)}},f.prototype.runAndReturn=function(y){var S;return this.run(function(x){S=y(x)}),S},f.prototype.bind=function(y,S){S||(this.active?S=this.active:S=this.createContext());var x=this;return function(){x.enter(S);try{return y.apply(this,arguments)}catch(T){throw T&&(T[g]=S),T}finally{x.exit(S)}}},f.prototype.enter=function(y){p.ok(y,"context must be provided for entering"),this._set.push(this.active),this.active=y},f.prototype.exit=function(y){if(p.ok(y,"context must be provided for exiting"),this.active===y){p.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var S=this._set.lastIndexOf(y);p.ok(S>=0,"context not currently entered; can't exit"),p.ok(S,"can't remove top context"),this._set.splice(S,1)},f.prototype.bindEmitter=function(y){p.ok(y.on&&y.addListener&&y.emit,"can only bind real EEs");var S=this,x="context@"+this.name;function T(O){!O||(O[C]||(O[C]=Object.create(null)),O[C][x]={namespace:S,context:S.active})}s(T,"n");function D(O){if(!(O&&O[C]))return O;var N=O,z=O[C];return Object.keys(z).forEach(function(X){var K=z[X];N=K.namespace.bind(N,K.context)}),N}s(D,"i"),b(y,T,D)},f.prototype.fromException=function(y){return y[g]};function m(y){return process.namespaces[y]}s(m,"Tv");function v(y){p.ok(y,"namespace must be given a name!");var S=new f(y);return S.id=process.addAsyncListener({create:function(){return S.active},before:function(x,T){T&&S.enter(T)},after:function(x,T){T&&S.exit(T)},error:function(x){x&&S.exit(x)}}),process.namespaces[y]=S,S}s(v,"UP");function w(y){var S=m(y);p.ok(S,"can't delete nonexistent namespace!"),p.ok(S.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(S.id),process.namespaces[y]=null}s(w,"Sv");function E(){process.namespaces&&Object.keys(process.namespaces).forEach(function(y){w(y)}),process.namespaces=Object.create(null)}s(E,"Av"),process.namespaces||E(),I.exports={getNamespace:m,createNamespace:v,destroyNamespace:w,reset:E}}),yn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CorrelationContextManager=void 0;var I=We(),p=Do(),b=J(),C=Ve(),g=Tl(),f=function(){function v(){}return s(v,"e"),v.getCurrentContext=function(){if(!v.enabled)return null;var w=v.session.get(v.CONTEXT_NAME);return w===void 0?null:w},v.generateContextObject=function(w,E,y,S,x,T){return E=E||w,this.enabled?{operation:{name:y,id:w,parentId:E,traceparent:x,tracestate:T},customProperties:new m(S)}:null},v.spanToContextObject=function(w,E,y){var S=new b;return S.traceId=w.traceId,S.spanId=w.spanId,S.traceFlag=b.formatOpenTelemetryTraceFlags(w.traceFlags)||b.DEFAULT_TRACE_FLAG,S.parentId=E,v.generateContextObject(S.traceId,S.parentId,y,null,S)},v.runWithContext=function(w,E){var y;return v.enabled?v.session.bind(E,(y={},y[v.CONTEXT_NAME]=w,y))():E()},v.wrapEmitter=function(w){v.enabled&&v.session.bindEmitter(w)},v.wrapCallback=function(w,E){var y;return v.enabled?v.session.bind(w,E?(y={},y[v.CONTEXT_NAME]=E,y):void 0):w},v.enable=function(w){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}v.hasEverEnabled||(this.forceClsHooked=w,this.hasEverEnabled=!0,typeof this.cls=="undefined"&&(v.forceClsHooked===!0||v.forceClsHooked===void 0&&v.shouldUseClsHooked()?this.cls=Un():this.cls=ko()),v.session=this.cls.createNamespace("AI-CLS-Session"),p.registerContextPreservation(function(E){return v.session.bind(E)})),this.enabled=!0}},v.startOperation=function(w,E){var y=w&&w.traceContext||null,S=w&&w.traceId?w:null,x=w&&w.headers;if(S){var T=new b("00-"+S.traceId+"-"+S.spanId+"-01"),D=new C(S.traceState?S.traceState.serialize():null),O=v.generateContextObject(S.traceId,"|"+S.traceId+"."+S.spanId+".",typeof E=="string"?E:"",void 0,T,D);return O}if(y){var T=new b(y.traceparent),D=new C(y.tracestate),N=typeof E=="object"?new g(E):null,O=v.generateContextObject(T.traceId,T.parentId,typeof E=="string"?E:N.getOperationName({}),N&&N.getCorrelationContextHeader()||void 0,T,D);return O}if(x){var T=new b(x.traceparent?x.traceparent.toString():null),D=new C(x.tracestate?x.tracestate.toString():null),N=new g(w),O=v.generateContextObject(T.traceId,T.parentId,N.getOperationName({}),N.getCorrelationContextHeader(),T,D);return O}return I.warn("startOperation was called with invalid arguments",arguments),null},v.disable=function(){this.enabled=!1},v.reset=function(){v.hasEverEnabled&&(v.session=null,v.session=this.cls.createNamespace("AI-CLS-Session"))},v.isNodeVersionCompatible=function(){var w=process.versions.node.split(".");return parseInt(w[0])>3||parseInt(w[0])>2&&parseInt(w[1])>2},v.shouldUseClsHooked=function(){var w=process.versions.node.split(".");return parseInt(w[0])>8||parseInt(w[0])>=8&&parseInt(w[1])>=2},v.canUseClsHooked=function(){var w=process.versions.node.split("."),E=parseInt(w[0])>8||parseInt(w[0])>=8&&parseInt(w[1])>=0,y=parseInt(w[0])<8||parseInt(w[0])<=8&&parseInt(w[1])<2,S=parseInt(w[0])>4||parseInt(w[0])>=4&&parseInt(w[1])>=7;return!(E&&y)&&S},v.enabled=!1,v.hasEverEnabled=!1,v.forceClsHooked=void 0,v.CONTEXT_NAME="ApplicationInsights-Context",v}();c.CorrelationContextManager=f;var m=function(){function v(w){this.props=[],this.addHeaderData(w)}return s(v,"e"),v.prototype.addHeaderData=function(w){var E=w?w.split(", "):[];this.props=E.map(function(y){var S=y.split("=");return{key:S[0],value:S[1]}}).concat(this.props)},v.prototype.serializeToHeader=function(){return this.props.map(function(w){return w.key+"="+w.value}).join(", ")},v.prototype.getProperty=function(w){for(var E=0;E<this.props.length;++E){var y=this.props[E];if(y.key===w)return y.value}},v.prototype.setProperty=function(w,E){if(v.bannedCharacters.test(w)||v.bannedCharacters.test(E)){I.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+w+" and value: "+E);return}for(var y=0;y<this.props.length;++y){var S=this.props[y];if(S.key===w){S.value=E;return}}this.props.push({key:w,value:E})},v.bannedCharacters=/[,=]/,v}()}),Il=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.dispose=c.enable=void 0;var I=Br(),p=$(),b=[],C=s(function(m){var v=m.data.message;b.forEach(function(w){v instanceof Error?w.trackException({exception:v}):(v.lastIndexOf(`
`)==v.length-1&&(v=v.substring(0,v.length-1)),w.trackTrace({message:v,severity:m.data.stderr?I.SeverityLevel.Warning:I.SeverityLevel.Information}))})},"Bc");function g(m,v){m?(b.length===0&&p.channel.subscribe("console",C),b.push(v)):(b=b.filter(function(w){return w!=v}),b.length===0&&p.channel.unsubscribe("console",C))}s(g,"VP"),c.enable=g;function f(){p.channel.unsubscribe("console",C),b=[]}s(f,"$P"),c.dispose=f}),gc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.dispose=c.enable=void 0;var I=Br(),p=$(),b=[],C={10:I.SeverityLevel.Verbose,20:I.SeverityLevel.Verbose,30:I.SeverityLevel.Information,40:I.SeverityLevel.Warning,50:I.SeverityLevel.Error,60:I.SeverityLevel.Critical},g=s(function(v){var w=v.data.result;b.forEach(function(E){var y=C[v.data.level];w instanceof Error?E.trackException({exception:w}):E.trackTrace({message:w,severity:y})})},"Fc");function f(v,w){v?(b.length===0&&p.channel.subscribe("bunyan",g),b.push(w)):(b=b.filter(function(E){return E!=w}),b.length===0&&p.channel.unsubscribe("bunyan",g))}s(f,"KP"),c.enable=f;function m(){p.channel.unsubscribe("bunyan",g),b=[]}s(m,"XP"),c.dispose=m}),ju=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.dispose=c.enable=void 0;var I=Br(),p=$(),b=[],C={syslog:function(v){var w={emerg:I.SeverityLevel.Critical,alert:I.SeverityLevel.Critical,crit:I.SeverityLevel.Critical,error:I.SeverityLevel.Error,warning:I.SeverityLevel.Warning,notice:I.SeverityLevel.Information,info:I.SeverityLevel.Information,debug:I.SeverityLevel.Verbose};return w[v]===void 0?I.SeverityLevel.Information:w[v]},npm:function(v){var w={error:I.SeverityLevel.Error,warn:I.SeverityLevel.Warning,info:I.SeverityLevel.Information,verbose:I.SeverityLevel.Verbose,debug:I.SeverityLevel.Verbose,silly:I.SeverityLevel.Verbose};return w[v]===void 0?I.SeverityLevel.Information:w[v]},unknown:function(v){return I.SeverityLevel.Information}},g=s(function(v){var w=v.data.message;b.forEach(function(E){if(w instanceof Error)E.trackException({exception:w,properties:v.data.meta});else{var y=C[v.data.levelKind](v.data.level);E.trackTrace({message:w,severity:y,properties:v.data.meta})}})},"$c");function f(v,w){v?(b.length===0&&p.channel.subscribe("winston",g),b.push(w)):(b=b.filter(function(E){return E!=w}),b.length===0&&p.channel.unsubscribe("winston",g))}s(f,"QP"),c.enable=f;function m(){p.channel.unsubscribe("winston",g),b=[]}s(m,"WP"),c.dispose=m}),qu=L((c,I)=>{"use strict";var p=Do(),b=function(){function C(g){if(C.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=g,C.INSTANCE=this}return s(C,"e"),C.prototype.enable=function(g,f){p.IsInitialized&&(Il().enable(g&&f,this._client),gc().enable(g,this._client),ju().enable(g,this._client))},C.prototype.isInitialized=function(){return this._isInitialized},C.prototype.dispose=function(){C.INSTANCE=null,this.enable(!1,!1)},C._methodNames=["debug","info","log","warn","error"],C}();I.exports=b}),ns=L((c,I)=>{"use strict";var p=function(){function b(C){if(b.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");b.INSTANCE=this,this._client=C;var g=process.versions.node.split(".");b._canUseUncaughtExceptionMonitor=parseInt(g[0])>13||parseInt(g[0])===13&&parseInt(g[1])>=7}return s(b,"e"),b.prototype.isInitialized=function(){return this._isInitialized},b.prototype.enable=function(C){var g=this;if(C){this._isInitialized=!0;var f=this;if(!this._exceptionListenerHandle){var m=s(function(v,w,E){E===void 0&&(E=new Error(b._FALLBACK_ERROR_MESSAGE)),g._client.trackException({exception:E}),g._client.flush({isAppCrashing:!0}),v&&w&&process.listeners(w).length===1&&(console.error(E),process.exit(1))},"i");b._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=m.bind(this,!1,void 0),process.on(b.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=m.bind(this,!0,b.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=m.bind(this,!1,void 0),process.on(b.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(b.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(b._canUseUncaughtExceptionMonitor?process.removeListener(b.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(b.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(b.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},b.prototype.dispose=function(){b.INSTANCE=null,this.enable(!1),this._isInitialized=!1},b.INSTANCE=null,b.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",b.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",b.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",b._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",b._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",b._canUseUncaughtExceptionMonitor=!1,b}();I.exports=p}),Jr=L(c=>{"use strict";var I;Object.defineProperty(c,"__esModule",{value:!0}),c.HeartBeatMetricName=c.DependencyTypeName=c.SpanAttribute=c.TelemetryTypeStringToQuickPulseDocumentType=c.TelemetryTypeStringToQuickPulseType=c.QuickPulseType=c.QuickPulseDocumentType=c.PerformanceToQuickPulseCounter=c.MetricId=c.PerformanceCounter=c.QuickPulseCounter=c.DEFAULT_LIVEMETRICS_HOST=c.DEFAULT_LIVEMETRICS_ENDPOINT=c.DEFAULT_BREEZE_ENDPOINT=void 0,c.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",c.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",c.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var p;(function(g){g.COMMITTED_BYTES="\\Memory\\Committed Bytes",g.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",g.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",g.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",g.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",g.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",g.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",g.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",g.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(p=c.QuickPulseCounter||(c.QuickPulseCounter={}));var b;(function(g){g.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",g.AVAILABLE_BYTES="\\Memory\\Available Bytes",g.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",g.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",g.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",g.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(b=c.PerformanceCounter||(c.PerformanceCounter={}));var C;(function(g){g.REQUESTS_DURATION="requests/duration",g.DEPENDENCIES_DURATION="dependencies/duration",g.EXCEPTIONS_COUNT="exceptions/count",g.TRACES_COUNT="traces/count"})(C=c.MetricId||(c.MetricId={})),c.PerformanceToQuickPulseCounter=(I={},I[b.PROCESSOR_TIME]=p.PROCESSOR_TIME,I[b.REQUEST_RATE]=p.REQUEST_RATE,I[b.REQUEST_DURATION]=p.REQUEST_DURATION,I[p.COMMITTED_BYTES]=p.COMMITTED_BYTES,I[p.REQUEST_FAILURE_RATE]=p.REQUEST_FAILURE_RATE,I[p.DEPENDENCY_RATE]=p.DEPENDENCY_RATE,I[p.DEPENDENCY_FAILURE_RATE]=p.DEPENDENCY_FAILURE_RATE,I[p.DEPENDENCY_DURATION]=p.DEPENDENCY_DURATION,I[p.EXCEPTION_RATE]=p.EXCEPTION_RATE,I),c.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"},c.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"},c.TelemetryTypeStringToQuickPulseType={EventData:c.QuickPulseType.Event,ExceptionData:c.QuickPulseType.Exception,MessageData:c.QuickPulseType.Trace,MetricData:c.QuickPulseType.Metric,RequestData:c.QuickPulseType.Request,RemoteDependencyData:c.QuickPulseType.Dependency,AvailabilityData:c.QuickPulseType.Availability,PageViewData:c.QuickPulseType.PageView},c.TelemetryTypeStringToQuickPulseDocumentType={EventData:c.QuickPulseDocumentType.Event,ExceptionData:c.QuickPulseDocumentType.Exception,MessageData:c.QuickPulseDocumentType.Trace,MetricData:c.QuickPulseDocumentType.Metric,RequestData:c.QuickPulseDocumentType.Request,RemoteDependencyData:c.QuickPulseDocumentType.Dependency,AvailabilityData:c.QuickPulseDocumentType.Availability,PageViewData:c.QuickPulseDocumentType.PageView},c.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"},c.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"},c.HeartBeatMetricName="HeartBeat"}),pa=L((c,I)=>{"use strict";var p=V(2037),b=Jr(),C=function(){function g(f,m,v){m===void 0&&(m=6e4),v===void 0&&(v=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,g.INSTANCE||(g.INSTANCE=this),this._isInitialized=!1,this._client=f,this._collectionInterval=m,this._enableLiveMetricsCounters=v}return s(g,"e"),g.prototype.enable=function(f,m){var v=this;this._isEnabled=f,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),f?this._handle||(this._lastCpus=p.cpus(),this._lastRequests={totalRequestCount:g._totalRequestCount,totalFailedRequestCount:g._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:g._totalDependencyCount,totalFailedDependencyCount:g._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:g._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=m||this._collectionInterval,this._handle=setInterval(function(){return v.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},g.countRequest=function(f,m){var v;if(g.isEnabled()){if(typeof f=="string")v=+new Date("1970-01-01T"+f+"Z");else if(typeof f=="number")v=f;else return;g._intervalRequestExecutionTime+=v,m===!1&&g._totalFailedRequestCount++,g._totalRequestCount++}},g.countException=function(){g._totalExceptionCount++},g.countDependency=function(f,m){var v;if(g.isEnabled()){if(typeof f=="string")v=+new Date("1970-01-01T"+f+"Z");else if(typeof f=="number")v=f;else return;g._intervalDependencyExecutionTime+=v,m===!1&&g._totalFailedDependencyCount++,g._totalDependencyCount++}},g.prototype.isInitialized=function(){return this._isInitialized},g.isEnabled=function(){return g.INSTANCE&&g.INSTANCE._isEnabled},g.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},g.prototype._trackCpu=function(){var f=p.cpus();if(f&&f.length&&this._lastCpus&&f.length===this._lastCpus.length){for(var m=0,v=0,w=0,E=0,y=0,S=0;!!f&&S<f.length;S++){var x=f[S],T=this._lastCpus[S],D="% cpu("+S+") ",O=x.model,N=x.speed,z=x.times,X=T.times,K=z.user-X.user||0;m+=K;var fe=z.sys-X.sys||0;v+=fe;var be=z.nice-X.nice||0;w+=be;var Fe=z.idle-X.idle||0;E+=Fe;var ke=z.irq-X.irq||0;y+=ke}var Qe=void 0;if(typeof process.cpuUsage=="function"){var it=process.cpuUsage(),gt=process.hrtime(),xt=it.user-this._lastAppCpuUsage.user+(it.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime!="undefined"&&this._lastHrtime.length===2){var Ht=(gt[0]-this._lastHrtime[0])*1e6+(gt[1]-this._lastHrtime[1])/1e3||0;Qe=100*xt/(Ht*f.length)}this._lastAppCpuUsage=it,this._lastHrtime=gt}var jt=m+v+w+E+y||1;this._client.trackMetric({name:b.PerformanceCounter.PROCESSOR_TIME,value:(jt-E)/jt*100}),this._client.trackMetric({name:b.PerformanceCounter.PROCESS_TIME,value:Qe||m/jt*100})}this._lastCpus=f},g.prototype._trackMemory=function(){var f=p.freemem(),m=process.memoryUsage().rss,v=p.totalmem()-f;this._client.trackMetric({name:b.PerformanceCounter.PRIVATE_BYTES,value:m}),this._client.trackMetric({name:b.PerformanceCounter.AVAILABLE_BYTES,value:f}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:b.QuickPulseCounter.COMMITTED_BYTES,value:v})},g.prototype._trackNetwork=function(){var f=this._lastRequests,m={totalRequestCount:g._totalRequestCount,totalFailedRequestCount:g._totalFailedRequestCount,time:+new Date},v=m.totalRequestCount-f.totalRequestCount||0,w=m.totalFailedRequestCount-f.totalFailedRequestCount||0,E=m.time-f.time,y=E/1e3,S=(g._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/v||0;if(this._lastIntervalRequestExecutionTime=g._intervalRequestExecutionTime,E>0){var x=v/y,T=w/y;this._client.trackMetric({name:b.PerformanceCounter.REQUEST_RATE,value:x}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:b.PerformanceCounter.REQUEST_DURATION,value:S}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:b.QuickPulseCounter.REQUEST_FAILURE_RATE,value:T})}this._lastRequests=m},g.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var f=this._lastDependencies,m={totalDependencyCount:g._totalDependencyCount,totalFailedDependencyCount:g._totalFailedDependencyCount,time:+new Date},v=m.totalDependencyCount-f.totalDependencyCount||0,w=m.totalFailedDependencyCount-f.totalFailedDependencyCount||0,E=m.time-f.time,y=E/1e3,S=(g._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/v||0;if(this._lastIntervalDependencyExecutionTime=g._intervalDependencyExecutionTime,E>0){var x=v/y,T=w/y;this._client.trackMetric({name:b.QuickPulseCounter.DEPENDENCY_RATE,value:x}),this._client.trackMetric({name:b.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:T}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:b.QuickPulseCounter.DEPENDENCY_DURATION,value:S})}this._lastDependencies=m}},g.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var f=this._lastExceptions,m={totalExceptionCount:g._totalExceptionCount,time:+new Date},v=m.totalExceptionCount-f.totalExceptionCount||0,w=m.time-f.time,E=w/1e3;if(w>0){var y=v/E;this._client.trackMetric({name:b.QuickPulseCounter.EXCEPTION_RATE,value:y})}this._lastExceptions=m}},g.prototype.dispose=function(){g.INSTANCE=null,this.enable(!1),this._isInitialized=!1},g._totalRequestCount=0,g._totalFailedRequestCount=0,g._totalDependencyCount=0,g._totalFailedDependencyCount=0,g._totalExceptionCount=0,g._intervalDependencyExecutionTime=0,g._intervalRequestExecutionTime=0,g}();I.exports=C}),mc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AggregatedMetricCounter=void 0;var I=function(){function p(b){this.dimensions=b,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return s(p,"e"),p}();c.AggregatedMetricCounter=I}),vc=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PreaggregatedMetricPropertyNames=void 0,c.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}}),lo=L((c,I)=>{"use strict";var p=c&&c.__assign||function(){return p=Object.assign||function(m){for(var v,w=1,E=arguments.length;w<E;w++){v=arguments[w];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(m[y]=v[y])}return m},p.apply(this,arguments)},b=Jr(),C=mc(),g=vc(),f=function(){function m(v,w){w===void 0&&(w=6e4),m.INSTANCE||(m.INSTANCE=this),this._isInitialized=!1,m._dependencyCountersCollection=[],m._requestCountersCollection=[],m._exceptionCountersCollection=[],m._traceCountersCollection=[],this._client=v,this._collectionInterval=w}return s(m,"e"),m.prototype.enable=function(v,w){var E=this;this._isEnabled=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),v?this._handle||(this._collectionInterval=w||this._collectionInterval,this._handle=setInterval(function(){return E.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},m.countException=function(v){if(m.isEnabled()){var w=m._getAggregatedCounter(v,this._exceptionCountersCollection);w.totalCount++}},m.countTrace=function(v){if(m.isEnabled()){var w=m._getAggregatedCounter(v,this._traceCountersCollection);w.totalCount++}},m.countRequest=function(v,w){if(m.isEnabled()){var E,y=m._getAggregatedCounter(w,this._requestCountersCollection);if(typeof v=="string")E=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")E=v;else return;y.intervalExecutionTime+=E,y.totalCount++}},m.countDependency=function(v,w){if(m.isEnabled()){var E=m._getAggregatedCounter(w,this._dependencyCountersCollection),y;if(typeof v=="string")y=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")y=v;else return;E.intervalExecutionTime+=y,E.totalCount++}},m.prototype.isInitialized=function(){return this._isInitialized},m.isEnabled=function(){return m.INSTANCE&&m.INSTANCE._isEnabled},m.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},m._getAggregatedCounter=function(v,w){for(var E=!1,y=0;y<w.length;y++){if(v===w[y].dimensions)return w[y];if(Object.keys(v).length===Object.keys(w[y].dimensions).length){for(var S in v)if(v[S]!=w[y].dimensions[S]){E=!0;break}if(!E)return w[y];E=!1}}var x=new C.AggregatedMetricCounter(v);return w.push(x),x},m.prototype._trackRequestMetrics=function(){for(var v=0;v<m._requestCountersCollection.length;v++){var w=m._requestCountersCollection[v];w.time=+new Date;var E=w.totalCount-w.lastTotalCount||0,y=w.time-w.lastTime,S=(w.intervalExecutionTime-w.lastIntervalExecutionTime)/E||0;w.lastIntervalExecutionTime=w.intervalExecutionTime,y>0&&E>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:w.dimensions,value:S,count:E,aggregationInterval:y,metricType:b.MetricId.REQUESTS_DURATION}),w.lastTotalCount=w.totalCount,w.lastTime=w.time}},m.prototype._trackDependencyMetrics=function(){for(var v=0;v<m._dependencyCountersCollection.length;v++){var w=m._dependencyCountersCollection[v];w.time=+new Date;var E=w.totalCount-w.lastTotalCount||0,y=w.time-w.lastTime,S=(w.intervalExecutionTime-w.lastIntervalExecutionTime)/E||0;w.lastIntervalExecutionTime=w.intervalExecutionTime,y>0&&E>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:w.dimensions,value:S,count:E,aggregationInterval:y,metricType:b.MetricId.DEPENDENCIES_DURATION}),w.lastTotalCount=w.totalCount,w.lastTime=w.time}},m.prototype._trackExceptionMetrics=function(){for(var v=0;v<m._exceptionCountersCollection.length;v++){var w=m._exceptionCountersCollection[v],E=w.totalCount-w.lastTotalCount||0,y=w.time-w.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:w.dimensions,value:E,count:E,aggregationInterval:y,metricType:b.MetricId.EXCEPTIONS_COUNT}),w.lastTotalCount=w.totalCount,w.lastTime=w.time}},m.prototype._trackTraceMetrics=function(){for(var v=0;v<m._traceCountersCollection.length;v++){var w=m._traceCountersCollection[v],E=w.totalCount-w.lastTotalCount||0,y=w.time-w.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:w.dimensions,value:E,count:E,aggregationInterval:y,metricType:b.MetricId.TRACES_COUNT}),w.lastTotalCount=w.totalCount,w.lastTime=w.time}},m.prototype._trackPreAggregatedMetric=function(v){var w={};for(var E in v.dimensions)w[g.PreaggregatedMetricPropertyNames[E]]=v.dimensions[E];w=p(p({},w),{"_MS.MetricId":v.metricType,"_MS.AggregationIntervalMs":String(v.aggregationInterval),"_MS.IsAutocollected":"True"});var y={name:v.name,value:v.value,count:v.count,properties:w,kind:"Aggregation"};this._client.trackMetric(y)},m.prototype.dispose=function(){m.INSTANCE=null,this.enable(!1),this._isInitialized=!1},m}();I.exports=f}),_n=L((c,I)=>{"use strict";var p=V(2037),b=V(7147),C=V(1017),g=Br(),f=We(),m=function(){function v(w){this.keys=new g.ContextTagKeys,this.tags={},this._loadApplicationContext(w),this._loadDeviceContext(),this._loadInternalContext()}return s(v,"e"),v.prototype._loadApplicationContext=function(w){if(w=w||C.resolve(__dirname,"../../../../package.json"),!v.appVersion[w]){v.appVersion[w]="unknown";try{var E=JSON.parse(b.readFileSync(w,"utf8"));E&&typeof E.version=="string"&&(v.appVersion[w]=E.version)}catch(y){f.info("unable to read app version: ",y)}}this.tags[this.keys.applicationVersion]=v.appVersion[w]},v.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=p&&p.hostname(),this.tags[this.keys.deviceOSVersion]=p&&p.type()+" "+p.release(),this.tags[this.keys.cloudRole]=v.DefaultRoleName,this.tags["ai.device.osArchitecture"]=p&&p.arch(),this.tags["ai.device.osPlatform"]=p&&p.platform()},v.prototype._loadInternalContext=function(){var w=C.resolve(__dirname,"../../package.json");if(!v.sdkVersion){v.sdkVersion="unknown";try{var E=JSON.parse(b.readFileSync(w,"utf8"));E&&typeof E.version=="string"&&(v.sdkVersion=E.version)}catch(y){f.info("unable to read app version: ",y)}}this.tags[this.keys.internalSdkVersion]="node:"+v.sdkVersion},v.DefaultRoleName="Web",v.appVersion={},v.sdkVersion=null,v}();I.exports=m}),zu=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var E=s(function(y,S){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,T){x.__proto__=T}||function(x,T){for(var D in T)Object.prototype.hasOwnProperty.call(T,D)&&(x[D]=T[D])},E(y,S)},"e");return function(y,S){E(y,S);function x(){this.constructor=y}s(x,"n"),y.prototype=S===null?Object.create(S):(x.prototype=S.prototype,new x)}}(),b=V(7310),C=Br(),g=pn(),f=Ni(),m=uc(),v=ee(),w=function(E){p(y,E);function y(S,x){var T=E.call(this)||this;return x&&x.method&&S&&(T.method=x.method,T.url=y._getUrlFromRequestOptions(S,x),T.startTime=+new Date),T}return s(y,"t"),y.prototype.onError=function(S){this._setStatus(void 0,S)},y.prototype.onResponse=function(S){this._setStatus(S.statusCode,void 0),this.correlationId=g.getCorrelationContextTarget(S,f.requestContextTargetKey)},y.prototype.getDependencyTelemetry=function(S,x){var T=b.parse(this.url);T.search=void 0,T.hash=void 0;var D=this.method.toUpperCase()+" "+T.pathname,O=C.RemoteDependencyDataConstants.TYPE_HTTP,N=T.hostname;T.port&&(N+=":"+T.port),this.correlationId?(O=C.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==v.correlationIdPrefix&&(N+=" | "+this.correlationId)):O=C.RemoteDependencyDataConstants.TYPE_HTTP;var z={id:x,name:D,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:O,target:N};if(S&&S.time?z.time=S.time:this.startTime&&(z.time=new Date(this.startTime)),S){for(var X in S)z[X]||(z[X]=S[X]);if(S.properties)for(var X in S.properties)z.properties[X]=S.properties[X]}return z},y._getUrlFromRequestOptions=function(S,x){if(typeof S=="string")if(S.indexOf("http://")===0||S.indexOf("https://")===0)S=b.parse(S);else{var T=b.parse(S);T.host==="443"?S=b.parse("https://"+S):S=b.parse("http://"+S)}else{if(S&&typeof b.URL=="function"&&S instanceof b.URL)return b.format(S);var D=S;S={},D&&Object.keys(D).forEach(function(z){S[z]=D[z]})}if(S.path){var O=b.parse(S.path);S.pathname=O.pathname,S.search=O.search}if(S.host&&S.port){var N=b.parse("http://"+S.host);!N.port&&S.port&&(S.hostname=S.host,delete S.host)}return S.protocol=S.protocol||x.agent&&x.agent.protocol||x.protocol||void 0,S.hostname=S.hostname||"localhost",b.format(S)},y}(m);I.exports=w}),Wu=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(f){for(var m,v=1,w=arguments.length;v<w;v++){m=arguments[v];for(var E in m)Object.prototype.hasOwnProperty.call(m,E)&&(f[E]=m[E])}return f},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.spanToTelemetryContract=void 0;var p=rr(),b=Jr();function C(f){var m=I({},f);return Object.keys(b.SpanAttribute).forEach(function(v){delete m[v]}),m}s(C,"Qc");function g(f){var m="|"+f.spanContext().traceId+"."+f.spanContext().spanId+".",v=Math.round(f._duration[0]*1e3+f._duration[1]/1e6),w=f.attributes["peer.address"]?f.attributes["peer.address"].toString():"",E=f.attributes.component?f.attributes.component.toString():"",y=E.toUpperCase()===b.DependencyTypeName.Http||!!f.attributes[b.SpanAttribute.HttpUrl],S=E.toLowerCase()===b.DependencyTypeName.Grpc;if(y){var x=f.attributes[b.SpanAttribute.HttpMethod]||"GET",T=new URL(f.attributes[b.SpanAttribute.HttpUrl].toString()),D=f.attributes[b.SpanAttribute.HttpHost]||T.host,O=f.attributes[b.SpanAttribute.HttpPort]||T.port||null,N=T.pathname||"/",z=x+" "+N,X=b.DependencyTypeName.Http,K=O?(D+":"+O).toString():D.toString(),fe=T.toString(),be=f.attributes[b.SpanAttribute.HttpStatusCode]||f.status.code||0,Fe=be<400;return{id:m,name:z,dependencyTypeName:X,target:K,data:fe,success:Fe,duration:v,url:fe,resultCode:String(be),properties:C(f.attributes)}}else if(S){var x=f.attributes[b.SpanAttribute.GrpcMethod]||"rpc",ke=f.attributes[b.SpanAttribute.GrpcService],Qe=ke?x+" "+ke:f.name;return{id:m,duration:v,name:Qe,target:ke.toString(),data:ke.toString()||Qe,url:ke.toString()||Qe,dependencyTypeName:b.DependencyTypeName.Grpc,resultCode:String(f.status.code||0),success:f.status.code===0,properties:C(f.attributes)}}else{var it=f.name,gt=f.links&&f.links.map(function(xt){return{operation_Id:xt.context.traceId,id:xt.context.spanId}});return{id:m,duration:v,name:it,target:w,data:w||it,url:w||it,dependencyTypeName:f.kind===p.SpanKind.INTERNAL?b.DependencyTypeName.InProc:E||f.name,resultCode:String(f.status.code||0),success:f.status.code===0,properties:I(I({},C(f.attributes)),{"_MS.links":gt||void 0})}}}s(g,"gR"),c.spanToTelemetryContract=g}),yi=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.subscriber=void 0;var I=rr(),p=$(),b=J(),C=Wu(),g=Ee(),f=[],m=s(function(w){var E=w.data,y=C.spanToTelemetryContract(E),S=E.spanContext(),x=new b;x.traceId=S.traceId,x.spanId=S.spanId,x.traceFlag=b.formatOpenTelemetryTraceFlags(S.traceFlags),x.parentId=E.parentSpanId?"|"+S.traceId+"."+E.parentSpanId+".":null,g.AsyncScopeManager.with(E,function(){f.forEach(function(T){E.kind===I.SpanKind.SERVER?T.trackRequest(y):(E.kind===I.SpanKind.CLIENT||E.kind===I.SpanKind.INTERNAL)&&T.trackDependency(y)})})},"ER");c.subscriber=m;function v(w,E){w?(f.length===0&&p.channel.subscribe("azure-coretracing",c.subscriber),f.push(E)):(f=f.filter(function(y){return y!=E}),f.length===0&&p.channel.unsubscribe("azure-coretracing",c.subscriber))}s(v,"yR"),c.enable=v}),Cr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.subscriber=void 0;var I=$(),p=[],b=s(function(g){g.data.event.commandName!=="ismaster"&&p.forEach(function(f){var m=g.data.startedData&&g.data.startedData.databaseName||"Unknown database";f.trackDependency({target:m,data:g.data.event.commandName,name:g.data.event.commandName,duration:g.data.event.duration,success:g.data.succeeded,resultCode:g.data.succeeded?"0":"1",time:g.data.startedData.time,dependencyTypeName:"mongodb"})})},"TR");c.subscriber=b;function C(g,f){g?(p.length===0&&I.channel.subscribe("mongodb",c.subscriber),p.push(f)):(p=p.filter(function(m){return m!=f}),p.length===0&&I.channel.unsubscribe("mongodb",c.subscriber))}s(C,"SR"),c.enable=C}),Vn=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.subscriber=void 0;var I=$(),p=[],b=s(function(g){p.forEach(function(f){var m=g.data.query||{},v=m.sql||"Unknown query",w=!g.data.err,E=m._connection||{},y=E.config||{},S=y.socketPath?y.socketPath:(y.host||"localhost")+":"+y.port;f.trackDependency({target:S,data:v,name:v,duration:g.data.duration,success:w,resultCode:w?"0":"1",time:g.data.time,dependencyTypeName:"mysql"})})},"AR");c.subscriber=b;function C(g,f){g?(p.length===0&&I.channel.subscribe("mysql",c.subscriber),p.push(f)):(p=p.filter(function(m){return m!=f}),p.length===0&&I.channel.unsubscribe("mysql",c.subscriber))}s(C,"bR"),c.enable=C}),en=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.subscriber=void 0;var I=$(),p=[],b=s(function(g){p.forEach(function(f){g.data.commandObj.command!=="info"&&f.trackDependency({target:g.data.address,name:g.data.commandObj.command,data:g.data.commandObj.command,duration:g.data.duration,success:!g.data.err,resultCode:g.data.err?"1":"0",time:g.data.time,dependencyTypeName:"redis"})})},"IR");c.subscriber=b;function C(g,f){g?(p.length===0&&I.channel.subscribe("redis",c.subscriber),p.push(f)):(p=p.filter(function(m){return m!=f}),p.length===0&&I.channel.unsubscribe("redis",c.subscriber))}s(C,"CR"),c.enable=C}),Fr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.enable=c.subscriber=void 0;var I=$(),p=[],b=s(function(g){p.forEach(function(f){var m=g.data.query,v=m.preparable&&m.preparable.text||m.plan||m.text||"unknown query",w=!g.data.error,E=g.data.database.host+":"+g.data.database.port;f.trackDependency({target:E,data:v,name:v,duration:g.data.duration,success:w,resultCode:w?"0":"1",time:g.data.time,dependencyTypeName:"postgres"})})},"OR");c.subscriber=b;function C(g,f){g?(p.length===0&&I.channel.subscribe("postgres",c.subscriber),p.push(f)):(p=p.filter(function(m){return m!=f}),p.length===0&&I.channel.unsubscribe("postgres",c.subscriber))}s(C,"PR"),c.enable=C}),ga=L((c,I)=>{"use strict";var p=c&&c.__spreadArrays||function(){for(var T=0,D=0,O=arguments.length;D<O;D++)T+=arguments[D].length;for(var N=Array(T),z=0,D=0;D<O;D++)for(var X=arguments[D],K=0,fe=X.length;K<fe;K++,z++)N[z]=X[K];return N},b=V(3685),C=V(5687),g=We(),f=pn(),m=Ni(),v=zu(),w=yn(),E=ee(),y=J(),S=Do(),x=function(){function T(D){if(T.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");T.INSTANCE=this,this._client=D}return s(T,"e"),T.prototype.enable=function(D){this._isEnabled=D,this._isEnabled&&!this._isInitialized&&this._initialize(),S.IsInitialized&&(yi().enable(!0,this._client),Cr().enable(D,this._client),Vn().enable(D,this._client),en().enable(D,this._client),Fr().enable(D,this._client))},T.prototype.isInitialized=function(){return this._isInitialized},T.prototype._initialize=function(){var D=this;this._isInitialized=!0;var O=b.request,N=C.request,z=s(function(X,K){var fe=!K[T.disableCollectionRequestOption]&&!X[T.alreadyAutoCollectedFlag];K.headers&&K.headers["user-agent"]&&K.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(fe=!1),X[T.alreadyAutoCollectedFlag]=!0,X&&K&&fe&&(w.CorrelationContextManager.wrapEmitter(X),T.trackRequest(D._client,{options:K,request:X}))},"i");b.request=function(X){for(var K=[],fe=1;fe<arguments.length;fe++)K[fe-1]=arguments[fe];var be=O.call.apply(O,p([b,X],K));return z(be,X),be},C.request=function(X){for(var K=[],fe=1;fe<arguments.length;fe++)K[fe-1]=arguments[fe];var be=N.call.apply(N,p([C,X],K));return z(be,X),be},b.get=function(X){for(var K,fe=[],be=1;be<arguments.length;be++)fe[be-1]=arguments[be];var Fe=(K=b.request).call.apply(K,p([b,X],fe));return Fe.end(),Fe},C.get=function(X){for(var K,fe=[],be=1;be<arguments.length;be++)fe[be-1]=arguments[be];var Fe=(K=C.request).call.apply(K,p([C,X],fe));return Fe.end(),Fe}},T.trackRequest=function(D,O){if(!O.options||!O.request||!D){g.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!O.options,!O.request,!D);return}var N=new v(O.options,O.request),z=w.CorrelationContextManager.getCurrentContext(),X,K;if(z&&z.operation&&z.operation.traceparent&&y.isValidTraceId(z.operation.traceparent.traceId))z.operation.traceparent.updateSpanId(),X=z.operation.traceparent.getBackCompatRequestId();else if(E.w3cEnabled){var fe=new y;K=fe.toString(),X=fe.getBackCompatRequestId()}else X=z&&z.operation&&z.operation.parentId+T.requestNumber+++".";if(f.canIncludeCorrelationHeader(D,N.getUrl())&&O.request.getHeader&&O.request.setHeader&&D.config&&D.config.correlationId){var be=O.request.getHeader(m.requestContextHeader);try{f.safeIncludeCorrelationHeader(D,O.request,be)}catch(Qe){g.warn("Request-Context header could not be set. Correlation of requests may be lost",Qe)}if(z&&z.operation)try{if(O.request.setHeader(m.requestIdHeader,X),D.config.ignoreLegacyHeaders||(O.request.setHeader(m.parentIdHeader,z.operation.id),O.request.setHeader(m.rootIdHeader,X)),K||z.operation.traceparent)O.request.setHeader(m.traceparentHeader,K||z.operation.traceparent.toString());else if(E.w3cEnabled){var fe=new y().toString();O.request.setHeader(m.traceparentHeader,fe)}if(z.operation.tracestate){var Fe=z.operation.tracestate.toString();Fe&&O.request.setHeader(m.traceStateHeader,Fe)}var ke=z.customProperties.serializeToHeader();ke&&O.request.setHeader(m.correlationContextHeader,ke)}catch(Qe){g.warn("Correlation headers could not be set. Correlation of requests may be lost.",Qe)}}O.request.on&&(O.request.on("response",function(Qe){N.onResponse(Qe);var it=N.getDependencyTelemetry(O,X);it.contextObjects=it.contextObjects||{},it.contextObjects["http.RequestOptions"]=O.options,it.contextObjects["http.ClientRequest"]=O.request,it.contextObjects["http.ClientResponse"]=Qe,D.trackDependency(it)}),O.request.on("error",function(Qe){N.onError(Qe);var it=N.getDependencyTelemetry(O,X);it.contextObjects=it.contextObjects||{},it.contextObjects["http.RequestOptions"]=O.options,it.contextObjects["http.ClientRequest"]=O.request,it.contextObjects.Error=Qe,D.trackDependency(it)}),O.request.on("abort",function(){N.onError(new Error);var Qe=N.getDependencyTelemetry(O,X);Qe.contextObjects=Qe.contextObjects||{},Qe.contextObjects["http.RequestOptions"]=O.options,Qe.contextObjects["http.ClientRequest"]=O.request,D.trackDependency(Qe)}))},T.prototype.dispose=function(){T.INSTANCE=null,this.enable(!1),this._isInitialized=!1},T.disableCollectionRequestOption="disableAppInsightsAutoCollection",T.requestNumber=1,T.alreadyAutoCollectedFlag="_appInsightsAutoCollected",T}();I.exports=x}),Kn=L((c,I)=>{"use strict";var p=V(2037),b=Jr(),C=pn(),g=_n(),f=ga(),m="http://169.254.169.254/metadata/instance/compute",v="api-version=2017-12-01",w="format=json",E="ENETUNREACH",y=function(){function S(x){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",S.INSTANCE||(S.INSTANCE=this),this._isInitialized=!1,this._client=x}return s(S,"e"),S.prototype.enable=function(x,T){var D=this;this._isEnabled=x,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),x?this._handle||(this._handle=setInterval(function(){return D.trackHeartBeat(T,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},S.prototype.isInitialized=function(){return this._isInitialized},S.isEnabled=function(){return S.INSTANCE&&S.INSTANCE._isEnabled},S.prototype.trackHeartBeat=function(x,T){var D=this,O=!1,N={},z=g.sdkVersion;N.sdk=z,N.osType=p.type(),process.env.WEBSITE_SITE_NAME?(N.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",N.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",N.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?N.azfunction_appId=process.env.WEBSITE_HOSTNAME:x&&(this._isVM===void 0?(O=!0,this._getAzureComputeMetadata(x,function(){D._isVM&&Object.keys(D._vmData).length>0&&(N.azInst_vmId=D._vmData.vmId||"",N.azInst_subscriptionId=D._vmData.subscriptionId||"",N.azInst_osType=D._vmData.osType||"",D._azInst_vmId=D._vmData.vmId||"",D._azInst_subscriptionId=D._vmData.subscriptionId||"",D._azInst_osType=D._vmData.osType||""),D._client.trackMetric({name:b.HeartBeatMetricName,value:0,properties:N}),T()})):this._isVM&&(N.azInst_vmId=this._azInst_vmId,N.azInst_subscriptionId=this._azInst_subscriptionId,N.azInst_osType=this._azInst_osType)),O||(this._client.trackMetric({name:b.HeartBeatMetricName,value:0,properties:N}),T())},S.prototype.dispose=function(){S.INSTANCE=null,this.enable(!1),this._isInitialized=!1},S.prototype._getAzureComputeMetadata=function(x,T){var D,O=this,N=m+"?"+v+"&"+w,z=(D={method:"GET"},D[f.disableCollectionRequestOption]=!0,D.headers={Metadata:"True"},D),X=C.makeRequest(x,N,z,function(K){if(K.statusCode===200){O._isVM=!0;var fe="";K.on("data",function(be){fe+=be}),K.on("end",function(){O._vmData=O._isJSON(fe)?JSON.parse(fe):{},T()})}else T()});X&&(X.on("error",function(K){K&&K.message&&K.message.indexOf(E)>-1&&(O._isVM=!1),T()}),X.end())},S.prototype._isJSON=function(x){try{return JSON.parse(x)&&!!x}catch(T){return!1}},S}();I.exports=y}),is=L((c,I)=>{"use strict";var p=V(3685),b=V(5687),C=We(),g=pn(),f=Ni(),m=Tl(),v=yn(),w=pa(),E=function(){function y(S){if(y.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");y.INSTANCE=this,this._client=S}return s(y,"e"),y.prototype.enable=function(S){this._isEnabled=S,(this._isAutoCorrelating||this._isEnabled||w.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},y.prototype.useAutoCorrelation=function(S,x){S&&!this._isAutoCorrelating?v.CorrelationContextManager.enable(x):!S&&this._isAutoCorrelating&&v.CorrelationContextManager.disable(),this._isAutoCorrelating=S},y.prototype.isInitialized=function(){return this._isInitialized},y.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},y.prototype._generateCorrelationContext=function(S){if(this._isAutoCorrelating)return v.CorrelationContextManager.generateContextObject(S.getOperationId(this._client.context.tags),S.getRequestId(),S.getOperationName(this._client.context.tags),S.getCorrelationContextHeader(),S.getTraceparent(),S.getTracestate())},y.prototype._initialize=function(){var S=this;this._isInitialized=!0;var x=s(function(N){if(N){if(typeof N!="function")throw new Error("onRequest handler must be a function");return function(z,X){v.CorrelationContextManager.wrapEmitter(z),v.CorrelationContextManager.wrapEmitter(X);var K=z&&!z[y.alreadyAutoCollectedFlag];if(z&&K){var fe=new m(z),be=S._generateCorrelationContext(fe);v.CorrelationContextManager.runWithContext(be,function(){S._isEnabled&&(z[y.alreadyAutoCollectedFlag]=!0,y.trackRequest(S._client,{request:z,response:X},fe)),typeof N=="function"&&N(z,X)})}else typeof N=="function"&&N(z,X)}}},"r"),T=s(function(N){var z=N.addListener.bind(N);N.addListener=function(X,K){switch(X){case"request":case"checkContinue":return z(X,x(K));default:return z(X,K)}},N.on=N.addListener},"n"),D=p.createServer;p.createServer=function(N,z){if(z&&typeof z=="function"){var X=D(N,x(z));return T(X),X}else{var X=D(x(N));return T(X),X}};var O=b.createServer;b.createServer=function(N,z){var X=O(N,x(z));return T(X),X}},y.trackRequestSync=function(S,x){if(!x.request||!x.response||!S){C.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!x.request,!x.response,!S);return}y.addResponseCorrelationIdHeader(S,x.response);var T=v.CorrelationContextManager.getCurrentContext(),D=new m(x.request,T&&T.operation.parentId);T&&(T.operation.id=D.getOperationId(S.context.tags)||T.operation.id,T.operation.name=D.getOperationName(S.context.tags)||T.operation.name,T.operation.parentId=D.getRequestId()||T.operation.parentId,T.customProperties.addHeaderData(D.getCorrelationContextHeader())),y.endRequest(S,D,x,x.duration,x.error)},y.trackRequest=function(S,x,T){if(!x.request||!x.response||!S){C.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!x.request,!x.response,!S);return}var D=v.CorrelationContextManager.getCurrentContext(),O=T||new m(x.request,D&&D.operation.parentId);g.canIncludeCorrelationHeader(S,O.getUrl())&&y.addResponseCorrelationIdHeader(S,x.response),D&&!T&&(D.operation.id=O.getOperationId(S.context.tags)||D.operation.id,D.operation.name=O.getOperationName(S.context.tags)||D.operation.name,D.operation.parentId=O.getOperationParentId(S.context.tags)||D.operation.parentId,D.customProperties.addHeaderData(O.getCorrelationContextHeader())),x.response.once&&x.response.once("finish",function(){y.endRequest(S,O,x,null,null)}),x.request.on&&x.request.on("error",function(N){y.endRequest(S,O,x,null,N)}),x.request.on&&x.request.on("aborted",function(){var N="The request has been aborted and the network socket has closed.";y.endRequest(S,O,x,null,N)})},y.addResponseCorrelationIdHeader=function(S,x){if(S.config&&S.config.correlationId&&x.getHeader&&x.setHeader&&!x.headersSent){var T=x.getHeader(f.requestContextHeader);g.safeIncludeCorrelationHeader(S,x,T)}},y.endRequest=function(S,x,T,D,O){O?x.onError(O,D):x.onResponse(T.response,D);var N=x.getRequestTelemetry(T);if(N.tagOverrides=x.getRequestTags(S.context.tags),T.tagOverrides)for(var z in T.tagOverrides)N.tagOverrides[z]=T.tagOverrides[z];var X=x.getLegacyRootId();X&&(N.properties.ai_legacyRootId=X),N.contextObjects=N.contextObjects||{},N.contextObjects["http.ServerRequest"]=T.request,N.contextObjects["http.ServerResponse"]=T.response,S.trackRequest(N)},y.prototype.dispose=function(){y.INSTANCE=null,this.enable(!1),this._isInitialized=!1,v.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},y.alreadyAutoCollectedFlag="_appInsightsAutoCollected",y}();I.exports=E}),Dl=L((c,I)=>{"use strict";var p=c&&c.__assign||function(){return p=Object.assign||function(E){for(var y,S=1,x=arguments.length;S<x;S++){y=arguments[S];for(var T in y)Object.prototype.hasOwnProperty.call(y,T)&&(E[T]=y[T])}return E},p.apply(this,arguments)},b=V(2037),C=Br(),g=Jr(),f=pn(),m=We(),v=f.w3cTraceId(),w=function(){function E(){}return s(E,"e"),E.createQuickPulseEnvelope=function(y,S,x,T){var D=b&&typeof b.hostname=="function"&&b.hostname()||"Unknown",O=T.tags&&T.keys&&T.keys.cloudRoleInstance&&T.tags[T.keys.cloudRoleInstance]||D,N=T.tags&&T.keys&&T.keys.cloudRole&&T.tags[T.keys.cloudRole]||null,z={Documents:S.length>0?S:null,InstrumentationKey:x.instrumentationKey||"",Metrics:y.length>0?y:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:T.tags[T.keys.internalSdkVersion],StreamId:v,MachineName:D,Instance:O,RoleName:N};return z},E.createQuickPulseMetric=function(y){var S;return S={Name:y.name,Value:y.value,Weight:y.count||1},S},E.telemetryEnvelopeToQuickPulseDocument=function(y){switch(y.data.baseType){case C.TelemetryTypeString.Event:return E.createQuickPulseEventDocument(y);case C.TelemetryTypeString.Exception:return E.createQuickPulseExceptionDocument(y);case C.TelemetryTypeString.Trace:return E.createQuickPulseTraceDocument(y);case C.TelemetryTypeString.Dependency:return E.createQuickPulseDependencyDocument(y);case C.TelemetryTypeString.Request:return E.createQuickPulseRequestDocument(y)}return null},E.createQuickPulseEventDocument=function(y){var S=E.createQuickPulseDocument(y),x=y.data.baseData.name,T=p(p({},S),{Name:x});return T},E.createQuickPulseTraceDocument=function(y){var S=E.createQuickPulseDocument(y),x=y.data.baseData.severityLevel||0,T=p(p({},S),{Message:y.data.baseData.message,SeverityLevel:C.SeverityLevel[x]});return T},E.createQuickPulseExceptionDocument=function(y){var S=E.createQuickPulseDocument(y),x=y.data.baseData.exceptions,T="",D="",O="";x&&x.length>0&&(x[0].parsedStack&&x[0].parsedStack.length>0?x[0].parsedStack.forEach(function(z){T+=z.assembly+`
`}):x[0].stack&&x[0].stack.length>0&&(T=x[0].stack),D=x[0].message,O=x[0].typeName);var N=p(p({},S),{Exception:T,ExceptionMessage:D,ExceptionType:O});return N},E.createQuickPulseRequestDocument=function(y){var S=E.createQuickPulseDocument(y),x=y.data.baseData,T=p(p({},S),{Name:x.name,Success:x.success,Duration:x.duration,ResponseCode:x.responseCode,OperationName:x.name});return T},E.createQuickPulseDependencyDocument=function(y){var S=E.createQuickPulseDocument(y),x=y.data.baseData,T=p(p({},S),{Name:x.name,Target:x.target,Success:x.success,Duration:x.duration,ResultCode:x.resultCode,CommandName:x.data,OperationName:S.OperationId,DependencyTypeName:x.type});return T},E.createQuickPulseDocument=function(y){var S,x,T,D;y.data.baseType?(x=g.TelemetryTypeStringToQuickPulseType[y.data.baseType],S=g.TelemetryTypeStringToQuickPulseDocumentType[y.data.baseType]):m.warn("Document type invalid; not sending live metric document",y.data.baseType),T=y.tags[E.keys.operationId],D=E.aggregateProperties(y);var O={DocumentType:S,__type:x,OperationId:T,Version:"1.0",Properties:D};return O},E.aggregateProperties=function(y){var S=[],x=y.data.baseData.measurements||{};for(var T in x)if(x.hasOwnProperty(T)){var D=x[T],O={key:T,value:D};S.push(O)}var N=y.data.baseData.properties||{};for(var T in N)if(N.hasOwnProperty(T)){var D=N[T],O={key:T,value:D};S.push(O)}return S},E.keys=new C.ContextTagKeys,E}();I.exports=w}),Gu=L((c,I)=>{"use strict";var p=s(function(){return(Date.now()+621355968e5)*1e4},"XR");I.exports={getTransmissionTime:p}}),Vu=L((c,I)=>{"use strict";var p=c&&c.__awaiter||function(y,S,x,T){function D(O){return O instanceof x?O:new x(function(N){N(O)})}return s(D,"i"),new(x||(x=Promise))(function(O,N){function z(fe){try{K(T.next(fe))}catch(be){N(be)}}s(z,"o");function X(fe){try{K(T.throw(fe))}catch(be){N(be)}}s(X,"u");function K(fe){fe.done?O(fe.value):D(fe.value).then(z,X)}s(K,"c"),K((T=T.apply(y,S||[])).next())})},b=c&&c.__generator||function(y,S){var x={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},T,D,O,N;return N={next:z(0),throw:z(1),return:z(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function z(K){return function(fe){return X([K,fe])}}function X(K){if(T)throw new TypeError("Generator is already executing.");for(;x;)try{if(T=1,D&&(O=K[0]&2?D.return:K[0]?D.throw||((O=D.return)&&O.call(D),0):D.next)&&!(O=O.call(D,K[1])).done)return O;switch(D=0,O&&(K=[K[0]&2,O.value]),K[0]){case 0:case 1:O=K;break;case 4:return x.label++,{value:K[1],done:!1};case 5:x.label++,D=K[1],K=[0];continue;case 7:K=x.ops.pop(),x.trys.pop();continue;default:if(O=x.trys,!(O=O.length>0&&O[O.length-1])&&(K[0]===6||K[0]===2)){x=0;continue}if(K[0]===3&&(!O||K[1]>O[0]&&K[1]<O[3])){x.label=K[1];break}if(K[0]===6&&x.label<O[1]){x.label=O[1],O=K;break}if(O&&x.label<O[2]){x.label=O[2],x.ops.push(K);break}O[2]&&x.ops.pop(),x.trys.pop();continue}K=S.call(y,x)}catch(fe){K=[6,fe],D=0}finally{T=O=0}if(K[0]&5)throw K[1];return{value:K[0]?K[1]:void 0,done:!0}}},C=V(5687),g=ga(),f=We(),m=Gu(),v=pn(),w={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},E=function(){function y(S){this._config=S,this._consecutiveErrors=0}return s(y,"e"),y.prototype.ping=function(S,x,T){var D=[{name:w.streamId,value:S.StreamId},{name:w.machineName,value:S.MachineName},{name:w.roleName,value:S.RoleName},{name:w.instanceName,value:S.Instance},{name:w.invariantVersion,value:S.InvariantVersion.toString()}];this._submitData(S,x,T,"ping",D)},y.prototype.post=function(S,x,T){return p(this,void 0,void 0,function(){return b(this,function(D){switch(D.label){case 0:return[4,this._submitData([S],x,T,"post")];case 1:return D.sent(),[2]}})})},y.prototype._submitData=function(S,x,T,D,O){return p(this,void 0,void 0,function(){var N,z,X,K,fe,be=this;return b(this,function(Fe){return N=JSON.stringify(S),z=(K={},K[g.disableCollectionRequestOption]=!0,K.host=x&&x.length>0?x:this._config.quickPulseHost,K.method=w.method,K.path="/QuickPulseService.svc/"+D+"?ikey="+this._config.instrumentationKey,K.headers=(fe={Expect:"100-continue"},fe[w.time]=m.getTransmissionTime(),fe["Content-Type"]="application/json",fe["Content-Length"]=Buffer.byteLength(N),fe),K),O&&O.length>0&&O.forEach(function(ke){return z.headers[ke.name]=ke.value}),this._config.httpsAgent?z.agent=this._config.httpsAgent:z.agent=v.tlsRestrictedAgent,X=C.request(z,function(ke){if(ke.statusCode==200){var Qe=ke.headers[w.subscribed]==="true",it=ke.headers[w.endpointRedirect]?ke.headers[w.endpointRedirect].toString():null,gt=ke.headers[w.pollingIntervalHint]?parseInt(ke.headers[w.pollingIntervalHint].toString()):null;be._consecutiveErrors=0,T(Qe,ke,it,gt)}else be._onError("StatusCode:"+ke.statusCode+" StatusMessage:"+ke.statusMessage),T()}),X.on("error",function(ke){be._onError(ke),T()}),X.write(N),X.end(),[2]})})},y.prototype._onError=function(S){this._consecutiveErrors++;var x="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%y.MAX_QPS_FAILURES_BEFORE_WARN==0?(x="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",f.warn(y.TAG,x,S)):f.info(y.TAG,x,S)},y.TAG="QuickPulseSender",y.MAX_QPS_FAILURES_BEFORE_WARN=25,y}();I.exports=E}),Ku=L((c,I)=>{"use strict";var p=c&&c.__awaiter||function(E,y,S,x){function T(D){return D instanceof S?D:new S(function(O){O(D)})}return s(T,"i"),new(S||(S=Promise))(function(D,O){function N(K){try{X(x.next(K))}catch(fe){O(fe)}}s(N,"o");function z(K){try{X(x.throw(K))}catch(fe){O(fe)}}s(z,"u");function X(K){K.done?D(K.value):T(K.value).then(N,z)}s(X,"c"),X((x=x.apply(E,y||[])).next())})},b=c&&c.__generator||function(E,y){var S={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},x,T,D,O;return O={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function N(X){return function(K){return z([X,K])}}function z(X){if(x)throw new TypeError("Generator is already executing.");for(;S;)try{if(x=1,T&&(D=X[0]&2?T.return:X[0]?T.throw||((D=T.return)&&D.call(T),0):T.next)&&!(D=D.call(T,X[1])).done)return D;switch(T=0,D&&(X=[X[0]&2,D.value]),X[0]){case 0:case 1:D=X;break;case 4:return S.label++,{value:X[1],done:!1};case 5:S.label++,T=X[1],X=[0];continue;case 7:X=S.ops.pop(),S.trys.pop();continue;default:if(D=S.trys,!(D=D.length>0&&D[D.length-1])&&(X[0]===6||X[0]===2)){S=0;continue}if(X[0]===3&&(!D||X[1]>D[0]&&X[1]<D[3])){S.label=X[1];break}if(X[0]===6&&S.label<D[1]){S.label=D[1],D=X;break}if(D&&S.label<D[2]){S.label=D[2],S.ops.push(X);break}D[2]&&S.ops.pop(),S.trys.pop();continue}X=y.call(E,S)}catch(K){X=[6,K],T=0}finally{x=D=0}if(X[0]&5)throw X[1];return{value:X[0]?X[1]:void 0,done:!0}}},C=We(),g=Dl(),f=Vu(),m=Jr(),v=_n(),w=function(){function E(y,S){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=y,this.context=S||new v,this._sender=new f(this.config),this._isEnabled=!1}return s(E,"e"),E.prototype.addCollector=function(y){this._collectors.push(y)},E.prototype.trackMetric=function(y){this._addMetric(y)},E.prototype.addDocument=function(y){var S=g.telemetryEnvelopeToQuickPulseDocument(y);S&&this._documents.push(S)},E.prototype.enable=function(y){y&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!y&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},E.prototype.enableCollectors=function(y){this._collectors.forEach(function(S){S.enable(y)})},E.prototype._addMetric=function(y){var S=y.value,x=y.count||1,T=m.PerformanceToQuickPulseCounter[y.name];T&&(this._metrics[T]?(this._metrics[T].Value=(this._metrics[T].Value*this._metrics[T].Weight+S*x)/(this._metrics[T].Weight+x),this._metrics[T].Weight+=x):(this._metrics[T]=g.createQuickPulseMetric(y),this._metrics[T].Name=T,this._metrics[T].Weight=1))},E.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},E.prototype._goQuickPulse=function(){return p(this,void 0,void 0,function(){var y,S,x,T,D=this;return b(this,function(O){switch(O.label){case 0:return y=Object.keys(this._metrics).map(function(N){return D._metrics[N]}),S=g.createQuickPulseEnvelope(y,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(S)]:[3,2];case 1:return O.sent(),[3,3];case 2:this._ping(S),O.label=3;case 3:return x=this._pollingIntervalHint>0?this._pollingIntervalHint:E.PING_INTERVAL,T=this._isCollectingData?E.POST_INTERVAL:x,this._isCollectingData&&Date.now()-this._lastSuccessTime>=E.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,T=E.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=E.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(T=E.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),T),this._handle.unref(),[2]}})})},E.prototype._ping=function(y){this._sender.ping(y,this._redirectedHost,this._quickPulseDone.bind(this))},E.prototype._post=function(y){return p(this,void 0,void 0,function(){return b(this,function(S){switch(S.label){case 0:return[4,this._sender.post(y,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return S.sent(),[2]}})})},E.prototype._quickPulseDone=function(y,S,x,T){y!=null?(this._isCollectingData!==y&&(C.info("Live Metrics sending data",y),this.enableCollectors(y)),this._isCollectingData=y,x&&x.length>0&&(this._redirectedHost=x,C.info("Redirecting endpoint to: ",x)),T&&T>0&&(this._pollingIntervalHint=T),S&&S.statusCode<300&&S.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},E.MAX_POST_WAIT_TIME=2e4,E.MAX_PING_WAIT_TIME=6e4,E.FALLBACK_INTERVAL=6e4,E.PING_INTERVAL=5e3,E.POST_INTERVAL=1e3,E}();I.exports=w}),os=L((c,I)=>{"use strict";var p=Jr(),b=function(){function C(){}return s(C,"e"),C.parse=function(g){if(!g)return{};var f=g.split(C._FIELDS_SEPARATOR),m=f.reduce(function(w,E){var y=E.split(C._FIELD_KEY_VALUE_SEPARATOR);if(y.length===2){var S=y[0].toLowerCase(),x=y[1];w[S]=x}return w},{});if(Object.keys(m).length>0){if(m.endpointsuffix){var v=m.location?m.location+".":"";m.ingestionendpoint=m.ingestionendpoint||"https://"+v+"dc."+m.endpointsuffix,m.liveendpoint=m.liveendpoint||"https://"+v+"live."+m.endpointsuffix}m.ingestionendpoint=m.ingestionendpoint||p.DEFAULT_BREEZE_ENDPOINT,m.liveendpoint=m.liveendpoint||p.DEFAULT_LIVEMETRICS_ENDPOINT}return m},C._FIELDS_SEPARATOR=";",C._FIELD_KEY_VALUE_SEPARATOR="=",C}();I.exports=b}),ma=L((c,I)=>{"use strict";var p=ee(),b=os(),C=We(),g=Jr(),f=V(7310),m=function(){function v(w){var E=this;this.endpointBase=g.DEFAULT_BREEZE_ENDPOINT;var y=process.env[v.ENV_connectionString],S=b.parse(w),x=b.parse(y),T=!S.instrumentationkey&&Object.keys(S).length>0?null:w;this.instrumentationKey=S.instrumentationkey||T||x.instrumentationkey||v._getInstrumentationKey(),v._validateInstrumentationKey(this.instrumentationKey),this.endpointUrl=(S.ingestionendpoint||x.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(D){return E.correlationId=D},this.proxyHttpUrl=process.env[v.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[v.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=S.ingestionendpoint||x.ingestionendpoint||process.env[v.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=S.liveendpoint||x.liveendpoint||process.env[v.ENV_quickPulseHost]||g.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=f.parse(this._quickPulseHost).host)}return s(v,"e"),Object.defineProperty(v.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(w){p.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=w,this.correlationId=p.correlationIdPrefix,p.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(w){this._quickPulseHost=w},enumerable:!1,configurable:!0}),v._getInstrumentationKey=function(){var w=process.env[v.ENV_iKey]||process.env[v.ENV_azurePrefix+v.ENV_iKey]||process.env[v.legacy_ENV_iKey]||process.env[v.ENV_azurePrefix+v.legacy_ENV_iKey];if(!w||w=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return w},v._validateInstrumentationKey=function(w){var E="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",y=new RegExp(E);return y.test(w)},v.ENV_azurePrefix="APPSETTING_",v.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",v.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",v.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",v.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",v.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",v.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",v.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",v.ENV_http_proxy="http_proxy",v.ENV_https_proxy="https_proxy",v}();I.exports=m}),Qu=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(f){for(var m,v=1,w=arguments.length;v<w;v++){m=arguments[v];for(var E in m)Object.prototype.hasOwnProperty.call(m,E)&&(f[E]=m[E])}return f},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.AutoCollectNativePerformance=void 0;var p=ma(),b=_n(),C=We(),g=function(){function f(m){this._disabledMetrics={},f.INSTANCE&&f.INSTANCE.dispose(),f.INSTANCE=this,this._client=m}return s(f,"e"),f.isNodeVersionCompatible=function(){var m=process.versions.node.split(".");return parseInt(m[0])>=6},f.prototype.enable=function(m,v,w){var E=this;if(v===void 0&&(v={}),w===void 0&&(w=6e4),!!f.isNodeVersionCompatible()){if(f._metricsAvailable==null&&m&&!this._isInitialized)try{var y=V(9166);f._emitter=new y,f._metricsAvailable=!0,C.info("Native metrics module successfully loaded!")}catch(S){f._metricsAvailable=!1;return}this._isEnabled=m,this._disabledMetrics=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&f._emitter?(f._emitter.enable(!0,w),this._handle||(this._handle=setInterval(function(){return E._trackNativeMetrics()},w),this._handle.unref())):f._emitter&&(f._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},f.prototype.dispose=function(){this.enable(!1)},f.parseEnabled=function(m){var v=process.env[p.ENV_nativeMetricsDisableAll],w=process.env[p.ENV_nativeMetricsDisablers];if(v)return{isEnabled:!1,disabledMetrics:{}};if(w){var E=w.split(","),y={};if(E.length>0)for(var S=0,x=E;S<x.length;S++){var T=x[S];y[T]=!0}return typeof m=="object"?{isEnabled:!0,disabledMetrics:I(I({},m),y)}:{isEnabled:m,disabledMetrics:y}}return typeof m=="boolean"?{isEnabled:m,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:m}},f.prototype._trackNativeMetrics=function(){var m=!0;typeof this._isEnabled!="object"&&(m=this._isEnabled),m&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},f.prototype._trackGarbageCollection=function(){var m;if(!this._disabledMetrics.gc){var v=f._emitter.getGCData();for(var w in v){var E=v[w].metrics,y=w+" Garbage Collection Duration",S=Math.sqrt(E.sumSquares/E.count-Math.pow(E.total/E.count,2))||0;this._client.trackMetric({name:y,value:E.total,count:E.count,max:E.max,min:E.min,stdDev:S,tagOverrides:(m={},m[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+b.sdkVersion,m)})}}},f.prototype._trackEventLoop=function(){var m;if(!this._disabledMetrics.loop){var v=f._emitter.getLoopData(),w=v.loopUsage;if(w.count!=0){var E="Event Loop CPU Time",y=Math.sqrt(w.sumSquares/w.count-Math.pow(w.total/w.count,2))||0;this._client.trackMetric({name:E,value:w.total,count:w.count,min:w.min,max:w.max,stdDev:y,tagOverrides:(m={},m[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+b.sdkVersion,m)})}}},f.prototype._trackHeapUsage=function(){var m,v,w;if(!this._disabledMetrics.heap){var E=process.memoryUsage(),y=E.heapUsed,S=E.heapTotal,x=E.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:y,count:1,tagOverrides:(m={},m[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+b.sdkVersion,m)}),this._client.trackMetric({name:"Memory Total (Heap)",value:S,count:1,tagOverrides:(v={},v[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+b.sdkVersion,v)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:x-S,count:1,tagOverrides:(w={},w[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+b.sdkVersion,w)})}},f}();c.AutoCollectNativePerformance=g}),Xu=L((c,I)=>{"use strict";var p=We(),b=function(){function C(g,f,m,v){this._buffer=[],this._lastSend=0,this._isDisabled=g,this._getBatchSize=f,this._getBatchIntervalMs=m,this._sender=v}return s(C,"e"),C.prototype.setUseDiskRetryCaching=function(g,f,m){this._sender.setDiskRetryMode(g,f,m)},C.prototype.send=function(g){var f=this;if(!this._isDisabled()){if(!g){p.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(g),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){f._timeoutHandle=null,f.triggerSend(!1)},this._getBatchIntervalMs()))}},C.prototype.triggerSend=function(g,f){var m=this._buffer.length<1;m||(g?(this._sender.saveOnCrash(this._buffer),typeof f=="function"&&f("data saved on crash")):this._sender.send(this._buffer,f)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,m&&typeof f=="function"&&f("no data to send")},C}();I.exports=b}),Yu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.azureRoleEnvironmentTelemetryProcessor=void 0;function I(p,b){process.env.WEBSITE_SITE_NAME&&(p.tags[b.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}s(I,"pN"),c.azureRoleEnvironmentTelemetryProcessor=I}),Zu=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.getSamplingHashCode=c.samplingTelemetryProcessor=void 0;var I=Br();function p(C,g){var f=C.sampleRate,m=!1;return f==null||f>=100||C.data&&I.TelemetryType.Metric===I.baseTypeToTelemetryType(C.data.baseType)?!0:(g.correlationContext&&g.correlationContext.operation?m=b(g.correlationContext.operation.id)<f:m=Math.random()*100<f,m)}s(p,"fN"),c.samplingTelemetryProcessor=p;function b(C){var g=-2147483648,f=2147483647,m=5381;if(!C)return 0;for(;C.length<8;)C=C+C;for(var v=0;v<C.length;v++)m=((m<<5)+m|0)+C.charCodeAt(v)|0;return m=m<=g?f:Math.abs(m),m/f*100}s(b,"Fm"),c.getSamplingHashCode=b}),zr=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.performanceMetricsTelemetryProcessor=void 0;var I=pa(),p=Br();function b(C,g){switch(g&&g.addDocument(C),C.data.baseType){case p.TelemetryTypeString.Exception:I.countException();break;case p.TelemetryTypeString.Request:var f=C.data.baseData;I.countRequest(f.duration,f.success);break;case p.TelemetryTypeString.Dependency:var m=C.data.baseData;I.countDependency(m.duration,m.success);break}return!0}s(b,"dN"),c.performanceMetricsTelemetryProcessor=b}),Ju=L(c=>{"use strict";var I=c&&c.__assign||function(){return I=Object.assign||function(f){for(var m,v=1,w=arguments.length;v<w;v++){m=arguments[v];for(var E in m)Object.prototype.hasOwnProperty.call(m,E)&&(f[E]=m[E])}return f},I.apply(this,arguments)};Object.defineProperty(c,"__esModule",{value:!0}),c.preAggregatedMetricsTelemetryProcessor=void 0;var p=Br(),b=lo(),C=Br();function g(f,m){if(b.isEnabled())switch(f.data.baseType){case C.TelemetryTypeString.Exception:var v=f.data.baseData;v.properties=I(I({},v.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var w={cloudRoleInstance:f.tags[m.keys.cloudRoleInstance],cloudRoleName:f.tags[m.keys.cloudRole]};b.countException(w);break;case C.TelemetryTypeString.Trace:var E=f.data.baseData;E.properties=I(I({},E.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var y={cloudRoleInstance:f.tags[m.keys.cloudRoleInstance],cloudRoleName:f.tags[m.keys.cloudRole],traceSeverityLevel:p.SeverityLevel[E.severity]};b.countTrace(y);break;case C.TelemetryTypeString.Request:var S=f.data.baseData;S.properties=I(I({},S.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var x={cloudRoleInstance:f.tags[m.keys.cloudRoleInstance],cloudRoleName:f.tags[m.keys.cloudRole],operationSynthetic:f.tags[m.keys.operationSyntheticSource],requestSuccess:S.success,requestResultCode:S.responseCode};b.countRequest(S.duration,x);break;case C.TelemetryTypeString.Dependency:var T=f.data.baseData;T.properties=I(I({},T.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var D={cloudRoleInstance:f.tags[m.keys.cloudRoleInstance],cloudRoleName:f.tags[m.keys.cloudRole],operationSynthetic:f.tags[m.keys.operationSyntheticSource],dependencySuccess:T.success,dependencyType:T.type,dependencyTarget:T.target,dependencyResultCode:T.resultCode};b.countDependency(T.duration,D);break}return!0}s(g,"_N"),c.preAggregatedMetricsTelemetryProcessor=g}),ed=L(c=>{"use strict";var I=c&&c.__createBinding||(Object.create?function(b,C,g,f){f===void 0&&(f=g),Object.defineProperty(b,f,{enumerable:!0,get:function(){return C[g]}})}:function(b,C,g,f){f===void 0&&(f=g),b[f]=C[g]}),p=c&&c.__exportStar||function(b,C){for(var g in b)g!=="default"&&!Object.prototype.hasOwnProperty.call(C,g)&&I(C,b,g)};Object.defineProperty(c,"__esModule",{value:!0}),p(Yu(),c),p(Zu(),c),p(zr(),c),p(Ju(),c)}),td=L((c,I)=>{"use strict";var p=c&&c.__awaiter||function(x,T,D,O){function N(z){return z instanceof D?z:new D(function(X){X(z)})}return s(N,"i"),new(D||(D=Promise))(function(z,X){function K(Fe){try{be(O.next(Fe))}catch(ke){X(ke)}}s(K,"o");function fe(Fe){try{be(O.throw(Fe))}catch(ke){X(ke)}}s(fe,"u");function be(Fe){Fe.done?z(Fe.value):N(Fe.value).then(K,fe)}s(be,"c"),be((O=O.apply(x,T||[])).next())})},b=c&&c.__generator||function(x,T){var D={label:0,sent:function(){if(z[0]&1)throw z[1];return z[1]},trys:[],ops:[]},O,N,z,X;return X={next:K(0),throw:K(1),return:K(2)},typeof Symbol=="function"&&(X[Symbol.iterator]=function(){return this}),X;function K(be){return function(Fe){return fe([be,Fe])}}function fe(be){if(O)throw new TypeError("Generator is already executing.");for(;D;)try{if(O=1,N&&(z=be[0]&2?N.return:be[0]?N.throw||((z=N.return)&&z.call(N),0):N.next)&&!(z=z.call(N,be[1])).done)return z;switch(N=0,z&&(be=[be[0]&2,z.value]),be[0]){case 0:case 1:z=be;break;case 4:return D.label++,{value:be[1],done:!1};case 5:D.label++,N=be[1],be=[0];continue;case 7:be=D.ops.pop(),D.trys.pop();continue;default:if(z=D.trys,!(z=z.length>0&&z[z.length-1])&&(be[0]===6||be[0]===2)){D=0;continue}if(be[0]===3&&(!z||be[1]>z[0]&&be[1]<z[3])){D.label=be[1];break}if(be[0]===6&&D.label<z[1]){D.label=z[1],z=be;break}if(z&&D.label<z[2]){D.label=z[2],D.ops.push(be);break}z[2]&&D.ops.pop(),D.trys.pop();continue}be=T.call(x,D)}catch(Fe){be=[6,Fe],N=0}finally{O=z=0}if(be[0]&5)throw be[1];return{value:be[0]?be[1]:void 0,done:!0}}},C=V(7147),g=V(2037),f=V(1017),m=V(9796),v=V(2081),w=We(),E=ga(),y=pn(),S=function(){function x(T,D,O){if(this._redirectedHost=null,this._config=T,this._onSuccess=D,this._onError=O,this._enableDiskRetryMode=!1,this._resendInterval=x.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=x.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=f.join(g.tmpdir(),x.TEMPDIR_PREFIX+this._config.instrumentationKey),!x.OS_PROVIDES_FILE_PROTECTION)if(x.USE_ICACLS){try{x.OS_PROVIDES_FILE_PROTECTION=C.existsSync(x.ICACLS_PATH)}catch(N){}x.OS_PROVIDES_FILE_PROTECTION||w.warn(x.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else x.OS_PROVIDES_FILE_PROTECTION=!0}return s(x,"e"),x.prototype.setDiskRetryMode=function(T,D,O){var N=this;this._enableDiskRetryMode=x.OS_PROVIDES_FILE_PROTECTION&&T,typeof D=="number"&&D>=0&&(this._resendInterval=Math.floor(D)),typeof O=="number"&&O>=0&&(this._maxBytesOnDisk=Math.floor(O)),T&&!x.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,w.warn(x.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){N._fileCleanupTask()},x.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},x.prototype.send=function(T,D){return p(this,void 0,void 0,function(){var O,N,z,X,K=this;return b(this,function(fe){return T&&(O=this._redirectedHost||this._config.endpointUrl,N={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},z="",T.forEach(function(be){var Fe=K._stringify(be);typeof Fe=="string"&&(z+=Fe+`
`)}),z.length>0&&(z=z.substring(0,z.length-1)),X=Buffer.from?Buffer.from(z):new Buffer(z),m.gzip(X,function(be,Fe){var ke=Fe;be?(w.warn(be),ke=X,N.headers["Content-Length"]=X.length.toString()):(N.headers["Content-Encoding"]="gzip",N.headers["Content-Length"]=Fe.length.toString()),w.info(x.TAG,N),N[E.disableCollectionRequestOption]=!0;var Qe=s(function(gt){gt.setEncoding("utf-8");var xt="";gt.on("data",function(Ht){xt+=Ht}),gt.on("end",function(){if(K._numConsecutiveFailures=0,K._enableDiskRetryMode){if(gt.statusCode===200)K._resendTimer||(K._resendTimer=setTimeout(function(){K._resendTimer=null,K._sendFirstFileOnDisk()},K._resendInterval),K._resendTimer.unref());else if(K._isRetriable(gt.statusCode))try{var Ht=JSON.parse(xt),jt=[];Ht.errors.forEach(function(Xt){K._isRetriable(Xt.statusCode)&&jt.push(T[Xt.index])}),jt.length>0&&K._storeToDisk(jt)}catch(Xt){K._storeToDisk(T)}}if(gt.statusCode===307||gt.statusCode===308)if(K._numConsecutiveRedirects++,K._numConsecutiveRedirects<10){var cr=gt.headers.location?gt.headers.location.toString():null;cr&&(K._redirectedHost=cr,K.send(T,D))}else typeof D=="function"&&D("Error sending telemetry because of circular redirects.");else K._numConsecutiveRedirects=0,typeof D=="function"&&D(xt),w.info(x.TAG,xt),typeof K._onSuccess=="function"&&K._onSuccess(xt)})},"d"),it=y.makeRequest(K._config,O,N,Qe);it.on("error",function(gt){if(K._numConsecutiveFailures++,!K._enableDiskRetryMode||K._numConsecutiveFailures>0&&K._numConsecutiveFailures%x.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var xt="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";K._enableDiskRetryMode&&(xt="Ingestion endpoint could not be reached "+K._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),w.warn(x.TAG,xt,y.dumpObj(gt))}else{var xt="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";w.info(x.TAG,xt,y.dumpObj(gt))}K._onErrorHelper(gt),typeof D=="function"&&(gt&&D(y.dumpObj(gt)),D("Error sending telemetry")),K._enableDiskRetryMode&&K._storeToDisk(T)}),it.write(ke),it.end()})),[2]})})},x.prototype.saveOnCrash=function(T){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(T))},x.prototype._isRetriable=function(T){return T===206||T===408||T===429||T===439||T===500||T===503},x.prototype._runICACLS=function(T,D){var O=v.spawn(x.ICACLS_PATH,T,{windowsHide:!0});O.on("error",function(N){return D(N)}),O.on("close",function(N,z){return D(N===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+N+")"))})},x.prototype._runICACLSSync=function(T){if(v.spawnSync){var D=v.spawnSync(x.ICACLS_PATH,T,{windowsHide:!0});if(D.error)throw D.error;if(D.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+D.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},x.prototype._getACLIdentity=function(T){if(x.ACL_IDENTITY)return T(null,x.ACL_IDENTITY);var D=v.spawn(x.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),O="";D.stdout.on("data",function(N){return O+=N}),D.on("error",function(N){return T(N,null)}),D.on("close",function(N,z){return x.ACL_IDENTITY=O&&O.trim(),T(N===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+N+")"),x.ACL_IDENTITY)})},x.prototype._getACLIdentitySync=function(){if(x.ACL_IDENTITY)return x.ACL_IDENTITY;if(v.spawnSync){var T=v.spawnSync(x.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(T.error)throw T.error;if(T.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+T.status+")");return x.ACL_IDENTITY=T.stdout&&T.stdout.toString().trim(),x.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},x.prototype._getACLArguments=function(T,D){return[T,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",D+":(OI)(CI)F","/inheritance:r"]},x.prototype._applyACLRules=function(T,D){var O=this;if(!x.USE_ICACLS)return D(null);if(x.ACLED_DIRECTORIES[T]===void 0)x.ACLED_DIRECTORIES[T]=!1,this._getACLIdentity(function(N,z){if(N)return x.ACLED_DIRECTORIES[T]=!1,D(N);O._runICACLS(O._getACLArguments(T,z),function(X){return x.ACLED_DIRECTORIES[T]=!X,D(X)})});else return D(x.ACLED_DIRECTORIES[T]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},x.prototype._applyACLRulesSync=function(T){if(x.USE_ICACLS){if(x.ACLED_DIRECTORIES[T]===void 0){this._runICACLSSync(this._getACLArguments(T,this._getACLIdentitySync())),x.ACLED_DIRECTORIES[T]=!0;return}else if(!x.ACLED_DIRECTORIES[T])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},x.prototype._confirmDirExists=function(T,D){var O=this;C.lstat(T,function(N,z){N&&N.code==="ENOENT"?C.mkdir(T,function(X){X&&X.code!=="EEXIST"?D(X):O._applyACLRules(T,D)}):!N&&z.isDirectory()?O._applyACLRules(T,D):D(N||new Error("Path existed but was not a directory"))})},x.prototype._getShallowDirectorySize=function(T,D){C.readdir(T,function(O,N){if(O)return D(O,-1);var z=null,X=0,K=0;if(N.length===0){D(null,0);return}for(var fe=0;fe<N.length;fe++)C.stat(f.join(T,N[fe]),function(be,Fe){K++,be?z=be:Fe.isFile()&&(X+=Fe.size),K===N.length&&(z?D(z,-1):D(z,X))})})},x.prototype._getShallowDirectorySizeSync=function(T){for(var D=C.readdirSync(T),O=0,N=0;N<D.length;N++)O+=C.statSync(f.join(T,D[N])).size;return O},x.prototype._storeToDisk=function(T){var D=this;w.info(x.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,function(O){if(O){w.warn(x.TAG,"Error while checking/creating directory: "+(O&&O.message)),D._onErrorHelper(O);return}D._getShallowDirectorySize(D._tempDir,function(N,z){if(N||z<0){w.warn(x.TAG,"Error while checking directory size: "+(N&&N.message)),D._onErrorHelper(N);return}else if(z>D._maxBytesOnDisk){w.warn(x.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+z);return}var X=new Date().getTime()+".ai.json",K=f.join(D._tempDir,X);w.info(x.TAG,"saving data to disk at: "+K),C.writeFile(K,D._stringify(T),{mode:384},function(fe){return D._onErrorHelper(fe)})})})},x.prototype._storeToDiskSync=function(T){try{w.info(x.TAG,"Checking existence of data storage directory: "+this._tempDir),C.existsSync(this._tempDir)||C.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var D=this._getShallowDirectorySizeSync(this._tempDir);if(D>this._maxBytesOnDisk){w.info(x.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+D);return}var O=new Date().getTime()+".ai.json",N=f.join(this._tempDir,O);w.info(x.TAG,"saving data before crash to disk at: "+N),C.writeFileSync(N,T,{mode:384})}catch(z){w.warn(x.TAG,"Error while saving data to disk: "+(z&&z.message)),this._onErrorHelper(z)}},x.prototype._sendFirstFileOnDisk=function(){var T=this;C.exists(this._tempDir,function(D){D&&C.readdir(T._tempDir,function(O,N){if(O)T._onErrorHelper(O);else if(N=N.filter(function(K){return f.basename(K).indexOf(".ai.json")>-1}),N.length>0){var z=N[0],X=f.join(T._tempDir,z);C.readFile(X,function(K,fe){K?T._onErrorHelper(K):C.unlink(X,function(be){if(be)T._onErrorHelper(be);else try{var Fe=JSON.parse(fe.toString());T.send(Fe)}catch(ke){w.warn("Failed to read persisted file",ke)}})})}})})},x.prototype._onErrorHelper=function(T){typeof this._onError=="function"&&this._onError(T)},x.prototype._stringify=function(T){try{return JSON.stringify(T)}catch(D){w.warn("Failed to serialize payload",D,T)}},x.prototype._fileCleanupTask=function(){var T=this;C.exists(this._tempDir,function(D){D&&C.readdir(T._tempDir,function(O,N){O?T._onErrorHelper(O):(N=N.filter(function(z){return f.basename(z).indexOf(".ai.json")>-1}),N.length>0&&N.forEach(function(z){var X=new Date(parseInt(z.split(".ai.json")[0])),K=new Date(+new Date-x.FILE_RETEMPTION_PERIOD)>X;if(K){var fe=f.join(T._tempDir,z);C.unlink(fe,function(be){be&&T._onErrorHelper(be)})}}))})})},x.TAG="Sender",x.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",x.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",x.ACLED_DIRECTORIES={},x.ACL_IDENTITY=null,x.WAIT_BETWEEN_RESEND=60*1e3,x.MAX_BYTES_ON_DISK=50*1024*1024,x.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,x.CLEANUP_TIMEOUT=60*60*1e3,x.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,x.TEMPDIR_PREFIX="appInsights-node",x.OS_PROVIDES_FILE_PROTECTION=!1,x.USE_ICACLS=g.type()==="Windows_NT",x}();I.exports=S}),yc=L((c,I)=>{"use strict";var p=Br(),b=pn(),C=yn(),g=function(){function m(){}return s(m,"e"),m.createEnvelope=function(v,w,E,y,S){var x=null;switch(w){case p.TelemetryType.Trace:x=m.createTraceData(v);break;case p.TelemetryType.Dependency:x=m.createDependencyData(v);break;case p.TelemetryType.Event:x=m.createEventData(v);break;case p.TelemetryType.Exception:x=m.createExceptionData(v);break;case p.TelemetryType.Request:x=m.createRequestData(v);break;case p.TelemetryType.Metric:x=m.createMetricData(v);break;case p.TelemetryType.Availability:x=m.createAvailabilityData(v);break;case p.TelemetryType.PageView:x=m.createPageViewData(v);break}if(E&&p.domainSupportsProperties(x.baseData)){if(x&&x.baseData)if(!x.baseData.properties)x.baseData.properties=E;else for(var T in E)x.baseData.properties[T]||(x.baseData.properties[T]=E[T]);x.baseData.properties=b.validateStringMap(x.baseData.properties)}var D=S&&S.instrumentationKey||"",O=new p.Envelope;return O.data=x,O.iKey=D,O.name="Microsoft.ApplicationInsights."+D.replace(/-/g,"")+"."+x.baseType.substr(0,x.baseType.length-4),O.tags=this.getTags(y,v.tagOverrides),O.time=new Date().toISOString(),O.ver=1,O.sampleRate=S?S.samplingPercentage:100,w===p.TelemetryType.Metric&&(O.sampleRate=100),O},m.createTraceData=function(v){var w=new p.MessageData;w.message=v.message,w.properties=v.properties,isNaN(v.severity)?w.severityLevel=p.SeverityLevel.Information:w.severityLevel=v.severity;var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Trace),E.baseData=w,E},m.createDependencyData=function(v){var w=new p.RemoteDependencyData;typeof v.name=="string"&&(w.name=v.name.length>1024?v.name.slice(0,1021)+"...":v.name),w.data=v.data,w.target=v.target,w.duration=b.msToTimeSpan(v.duration),w.success=v.success,w.type=v.dependencyTypeName,w.properties=v.properties,w.resultCode=v.resultCode?v.resultCode+"":"",v.id?w.id=v.id:w.id=b.w3cTraceId();var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Dependency),E.baseData=w,E},m.createEventData=function(v){var w=new p.EventData;w.name=v.name,w.properties=v.properties,w.measurements=v.measurements;var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Event),E.baseData=w,E},m.createExceptionData=function(v){var w=new p.ExceptionData;w.properties=v.properties,isNaN(v.severity)?w.severityLevel=p.SeverityLevel.Error:w.severityLevel=v.severity,w.measurements=v.measurements,w.exceptions=[];var E=v.exception.stack,y=new p.ExceptionDetails;y.message=v.exception.message,y.typeName=v.exception.name,y.parsedStack=this.parseStack(E),y.hasFullStack=b.isArray(y.parsedStack)&&y.parsedStack.length>0,w.exceptions.push(y);var S=new p.Data;return S.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Exception),S.baseData=w,S},m.createRequestData=function(v){var w=new p.RequestData;v.id?w.id=v.id:w.id=b.w3cTraceId(),w.name=v.name,w.url=v.url,w.source=v.source,w.duration=b.msToTimeSpan(v.duration),w.responseCode=v.resultCode?v.resultCode+"":"",w.success=v.success,w.properties=v.properties;var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Request),E.baseData=w,E},m.createMetricData=function(v){var w=new p.MetricData;w.metrics=[];var E=new p.DataPoint;E.count=isNaN(v.count)?1:v.count,E.kind=p.DataPointType.Aggregation,E.max=isNaN(v.max)?v.value:v.max,E.min=isNaN(v.min)?v.value:v.min,E.name=v.name,E.stdDev=isNaN(v.stdDev)?0:v.stdDev,E.value=v.value,w.metrics.push(E),w.properties=v.properties;var y=new p.Data;return y.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Metric),y.baseData=w,y},m.createAvailabilityData=function(v){var w=new p.AvailabilityData;v.id?w.id=v.id:w.id=b.w3cTraceId(),w.name=v.name,w.duration=b.msToTimeSpan(v.duration),w.success=v.success,w.runLocation=v.runLocation,w.message=v.message,w.measurements=v.measurements,w.properties=v.properties;var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.Availability),E.baseData=w,E},m.createPageViewData=function(v){var w=new p.PageViewData;w.name=v.name,w.duration=b.msToTimeSpan(v.duration),w.url=v.url,w.measurements=v.measurements,w.properties=v.properties;var E=new p.Data;return E.baseType=p.telemetryTypeToBaseType(p.TelemetryType.PageView),E.baseData=w,E},m.getTags=function(v,w){var E=C.CorrelationContextManager.getCurrentContext(),y={};if(v&&v.tags)for(var S in v.tags)y[S]=v.tags[S];if(w)for(var S in w)y[S]=w[S];return E&&(y[v.keys.operationId]=y[v.keys.operationId]||E.operation.id,y[v.keys.operationName]=y[v.keys.operationName]||E.operation.name,y[v.keys.operationParentId]=y[v.keys.operationParentId]||E.operation.parentId),y},m.parseStack=function(v){var w=void 0;if(typeof v=="string"){var E=v.split(`
`);w=[];for(var y=0,S=0,x=0;x<=E.length;x++){var T=E[x];if(f.regex.test(T)){var D=new f(E[x],y++);S+=D.sizeInBytes,w.push(D)}}var O=32*1024;if(S>O)for(var N=0,z=w.length-1,X=0,K=N,fe=z;N<z;){var be=w[N].sizeInBytes,Fe=w[z].sizeInBytes;if(X+=be+Fe,X>O){var ke=fe-K+1;w.splice(K,ke);break}K=N,fe=z,N++,z--}}return w},m}(),f=function(){function m(v,w){this.sizeInBytes=0,this.level=w,this.method="<no_method>",this.assembly=b.trim(v);var E=v.match(m.regex);E&&E.length>=5&&(this.method=b.trim(E[2])||this.method,this.fileName=b.trim(E[4])||"<no_filename>",this.line=parseInt(E[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=m.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return s(m,"e"),m.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,m.baseSize=58,m}();I.exports=g}),xr=L((c,I)=>{"use strict";var p=V(7310),b=ma(),C=_n(),g=Br(),f=Xu(),m=ed(),v=yn(),w=td(),E=pn(),y=We(),S=yc(),x=function(){function T(D){this._telemetryProcessors=[],this._enableAzureProperties=!1;var O=new b(D);this.config=O,this.context=new C,this.commonProperties={};var N=new w(this.config);this.channel=new f(function(){return O.disableAppInsights},function(){return O.maxBatchSize},function(){return O.maxBatchIntervalMs},N)}return s(T,"e"),T.prototype.trackAvailability=function(D){this.track(D,g.TelemetryType.Availability)},T.prototype.trackPageView=function(D){this.track(D,g.TelemetryType.PageView)},T.prototype.trackTrace=function(D){this.track(D,g.TelemetryType.Trace)},T.prototype.trackMetric=function(D){this.track(D,g.TelemetryType.Metric)},T.prototype.trackException=function(D){D&&D.exception&&!E.isError(D.exception)&&(D.exception=new Error(D.exception.toString())),this.track(D,g.TelemetryType.Exception)},T.prototype.trackEvent=function(D){this.track(D,g.TelemetryType.Event)},T.prototype.trackRequest=function(D){this.track(D,g.TelemetryType.Request)},T.prototype.trackDependency=function(D){D&&!D.target&&D.data&&(D.target=p.parse(D.data).host),this.track(D,g.TelemetryType.Dependency)},T.prototype.flush=function(D){this.channel.triggerSend(D?!!D.isAppCrashing:!1,D?D.callback:void 0)},T.prototype.track=function(D,O){if(D&&g.telemetryTypeToBaseType(O)){var N=S.createEnvelope(D,O,this.commonProperties,this.context,this.config);D.time&&(N.time=D.time.toISOString()),this._enableAzureProperties&&m.azureRoleEnvironmentTelemetryProcessor(N,this.context);var z=this.runTelemetryProcessors(N,D.contextObjects);z=z&&m.samplingTelemetryProcessor(N,{correlationContext:v.CorrelationContextManager.getCurrentContext()}),m.preAggregatedMetricsTelemetryProcessor(N,this.context),z&&(m.performanceMetricsTelemetryProcessor(N,this.quickPulseClient),this.channel.send(N))}else y.warn("track() requires telemetry object and telemetryType to be specified.")},T.prototype.setAutoPopulateAzureProperties=function(D){this._enableAzureProperties=D},T.prototype.addTelemetryProcessor=function(D){this._telemetryProcessors.push(D)},T.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},T.prototype.runTelemetryProcessors=function(D,O){var N=!0,z=this._telemetryProcessors.length;if(z===0)return N;O=O||{},O.correlationContext=v.CorrelationContextManager.getCurrentContext();for(var X=0;X<z;++X)try{var K=this._telemetryProcessors[X];if(K&&K.apply(null,[D,O])===!1){N=!1;break}}catch(fe){N=!0,y.warn("One of telemetry processors failed, telemetry item will be sent.",fe,D)}return N&&(D&&D.tags&&(D.tags=E.validateStringMap(D.tags)),D&&D.data&&D.data.baseData&&D.data.baseData.properties&&(D.data.baseData.properties=E.validateStringMap(D.data.baseData.properties))),N},T}();I.exports=x}),as=L((c,I)=>{"use strict";var p=c&&c.__extends||function(){var v=s(function(w,E){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,S){y.__proto__=S}||function(y,S){for(var x in S)Object.prototype.hasOwnProperty.call(S,x)&&(y[x]=S[x])},v(w,E)},"e");return function(w,E){v(w,E);function y(){this.constructor=w}s(y,"n"),w.prototype=E===null?Object.create(E):(y.prototype=E.prototype,new y)}}(),b=xr(),C=is(),g=ga(),f=We(),m=function(v){p(w,v);function w(){return v!==null&&v.apply(this,arguments)||this}return s(w,"t"),w.prototype.trackNodeHttpRequestSync=function(E){E&&E.request&&E.response&&E.duration?C.trackRequestSync(this,E):f.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},w.prototype.trackNodeHttpRequest=function(E){(E.duration||E.error)&&f.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),E&&E.request&&E.response?C.trackRequest(this,E):f.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},w.prototype.trackNodeHttpDependency=function(E){E&&E.request?g.trackRequest(this,E):f.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},w}(b);I.exports=m}),No=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0})}),Pl=L(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.dispose=c.Configuration=c.wrapWithCorrelationContext=c.startOperation=c.getCorrelationContext=c.start=c.setup=c.liveMetricsClient=c.defaultClient=c.DistributedTracingModes=void 0;var I=yn(),p=qu(),b=ns(),C=pa(),g=lo(),f=Kn(),m=ga(),v=is(),w=ee(),E=We(),y=Ku(),S=Qu();c.TelemetryClient=as(),c.Contracts=Br(),c.azureFunctionsTypes=No();var x;(function(Ft){Ft[Ft.AI=0]="AI",Ft[Ft.AI_AND_W3C=1]="AI_AND_W3C"})(x=c.DistributedTracingModes||(c.DistributedTracingModes={}));var T=!0,D=!1,O=!0,N=!0,z=!0,X=!1,K=!0,fe=!0,be=!0,Fe=!0,ke,Qe=!1,it=!0,gt,xt=void 0,Ht=void 0,jt,cr,Xt,Je,dt,ut,yt,Lt,Yt=!1,At;function Zt(Ft){return c.defaultClient?E.info("The default client is already setup"):(c.defaultClient=new c.TelemetryClient(Ft),jt=new p(c.defaultClient),cr=new b(c.defaultClient),Xt=new C(c.defaultClient),Je=new g(c.defaultClient),dt=new f(c.defaultClient),yt=new v(c.defaultClient),Lt=new m(c.defaultClient),ut||(ut=new S.AutoCollectNativePerformance(c.defaultClient))),c.defaultClient&&c.defaultClient.channel&&c.defaultClient.channel.setUseDiskRetryCaching(be,xt,Ht),Wr}s(Zt,"GN"),c.setup=Zt;function Ir(){return c.defaultClient?(Yt=!0,jt.enable(T,D),cr.enable(O),Xt.enable(N),Je.enable(z),dt.enable(X,c.defaultClient.config),ut.enable(it,gt),yt.useAutoCorrelation(Fe,ke),yt.enable(K),Lt.enable(fe),c.liveMetricsClient&&Qe&&c.liveMetricsClient.enable(Qe)):E.warn("Start cannot be called before setup"),Wr}s(Ir,"PE"),c.start=Ir;function Dr(){return Fe?I.CorrelationContextManager.getCurrentContext():null}s(Dr,"FN"),c.getCorrelationContext=Dr;function _r(Ft,Ct){return I.CorrelationContextManager.startOperation(Ft,Ct)}s(_r,"VN"),c.startOperation=_r;function ur(Ft,Ct){return I.CorrelationContextManager.wrapCallback(Ft,Ct)}s(ur,"$N"),c.wrapWithCorrelationContext=ur;var Wr=function(){function Ft(){}return s(Ft,"e"),Ft.setDistributedTracingMode=function(Ct){return w.w3cEnabled=Ct===x.AI_AND_W3C,Ft},Ft.setAutoCollectConsole=function(Ct,ar){return ar===void 0&&(ar=!1),T=Ct,D=ar,Yt&&jt.enable(Ct,ar),Ft},Ft.setAutoCollectExceptions=function(Ct){return O=Ct,Yt&&cr.enable(Ct),Ft},Ft.setAutoCollectPerformance=function(Ct,ar){ar===void 0&&(ar=!0),N=Ct;var kr=S.AutoCollectNativePerformance.parseEnabled(ar);return it=kr.isEnabled,gt=kr.disabledMetrics,Yt&&(Xt.enable(Ct),ut.enable(kr.isEnabled,kr.disabledMetrics)),Ft},Ft.setAutoCollectPreAggregatedMetrics=function(Ct){return z=Ct,Yt&&Je.enable(Ct),Ft},Ft.setAutoCollectHeartbeat=function(Ct){return X=Ct,Yt&&dt.enable(Ct,c.defaultClient.config),Ft},Ft.setAutoCollectRequests=function(Ct){return K=Ct,Yt&&yt.enable(Ct),Ft},Ft.setAutoCollectDependencies=function(Ct){return fe=Ct,Yt&&Lt.enable(Ct),Ft},Ft.setAutoDependencyCorrelation=function(Ct,ar){return Fe=Ct,ke=ar,Yt&&yt.useAutoCorrelation(Ct,ar),Ft},Ft.setUseDiskRetryCaching=function(Ct,ar,kr){return be=Ct,xt=ar,Ht=kr,c.defaultClient&&c.defaultClient.channel&&c.defaultClient.channel.setUseDiskRetryCaching(Ct,ar,kr),Ft},Ft.setInternalLogging=function(Ct,ar){return Ct===void 0&&(Ct=!1),ar===void 0&&(ar=!0),E.enableDebug=Ct,E.disableWarnings=!ar,Ft},Ft.setSendLiveMetrics=function(Ct){return Ct===void 0&&(Ct=!1),c.defaultClient?(!c.liveMetricsClient&&Ct?(c.liveMetricsClient=new y(c.defaultClient.config,null),At=new C(c.liveMetricsClient,1e3,!0),c.liveMetricsClient.addCollector(At),c.defaultClient.quickPulseClient=c.liveMetricsClient):c.liveMetricsClient&&c.liveMetricsClient.enable(Ct),Qe=Ct,Ft):(E.warn("Live metrics client cannot be setup without the default client"),Ft)},Ft.start=Ir,Ft}();c.Configuration=Wr;function Gr(){w.w3cEnabled=!0,c.defaultClient=null,Yt=!1,jt&&jt.dispose(),cr&&cr.dispose(),Xt&&Xt.dispose(),Je&&Je.dispose(),dt&&dt.dispose(),ut&&ut.dispose(),yt&&yt.dispose(),Lt&&Lt.dispose(),c.liveMetricsClient&&(c.liveMetricsClient.enable(!1),Qe=!1,c.liveMetricsClient=void 0)}s(Gr,"zN"),c.dispose=Gr});ue(h,{default:()=>Ol});var ln=nt(V(2037)),Mo=nt(V(9496)),or=nt(V(9496)),va=nt(V(9496)),tn;(function(c){c.ON="on",c.ERROR="error",c.OFF="off"})(tn||(tn={}));function rn(){let c="telemetry",I="enableTelemetry";return va.env.isTelemetryEnabled!==void 0?va.env.isTelemetryEnabled?tn.ON:tn.OFF:va.workspace.getConfiguration(c).get(I)?tn.ON:tn.OFF}s(rn,"Fi");var _c=s(class{constructor(c,I,p,b,C){this.extensionId=c,this.extensionVersion=I,this.telemetryAppender=p,this.osShim=b,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!C,this.updateUserOptStatus(),or.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(or.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(or.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(or.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let c=rn();this.userOptIn=c===tn.ON,this.errorOptIn=c===tn.ERROR||c===tn.ON,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(c){if(!c)return"none";let I="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(p=>{c.indexOf(`${p}+`)===0&&(I=p)}),I}get extension(){return this._extension===void 0&&(this._extension=or.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(c,I){if(c===null||typeof c!="object"||typeof I!="function")return c;let p={};for(let b in c)p[b]=I(b,c[b]);return p}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?this.cleanRemoteName(or.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===or.ExtensionKind.Workspace||or.env.uiKind===or.UIKind.Web):!0}getCommonProperties(){let c=Object.create(null);if(c["common.os"]=this.osShim.platform,c["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),c["common.extname"]=this.extensionId,c["common.extversion"]=this.extensionVersion,or&&or.env){switch(c["common.vscodemachineid"]=or.env.machineId,c["common.vscodesessionid"]=or.env.sessionId,c["common.vscodeversion"]=or.version,c["common.isnewappinstall"]=or.env.isNewAppInstall?or.env.isNewAppInstall.toString():"false",c["common.product"]=or.env.appHost,or.env.uiKind){case or.UIKind.Web:c["common.uikind"]="web";break;case or.UIKind.Desktop:c["common.uikind"]="desktop";break;default:c["common.uikind"]="unknown"}c["common.remotename"]=this.cleanRemoteName(or.env.remoteName)}return c}anonymizeFilePaths(c,I){let p;if(c==null)return"";let b=[];or.env.appRoot!==""&&b.push(new RegExp(or.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&b.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let C=c;if(I){let g=[];for(let w of b)for(;(p=w.exec(c))&&p;)g.push([p.index,w.lastIndex]);let f=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,m=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,v=0;for(C="";(p=m.exec(c))&&p;)p[0]&&!f.test(p[0])&&g.every(([w,E])=>p.index<w||p.index>=E)&&(C+=c.substring(v,p.index)+"<REDACTED: user-file-path>",v=m.lastIndex);v<c.length&&(C+=c.substr(v))}for(let g of b)C=C.replace(g,"");return C}removePropertiesWithPossibleUserInfo(c){if(typeof c!="object")return;let I=Object.create(null);for(let p of Object.keys(c)){let b=c[p];if(!b)continue;let C=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(b.toLowerCase())?I[p]="<REDACTED: secret>":C.test(b)?I[p]="<REDACTED: email>":I[p]=b}return I}sendTelemetryEvent(c,I,p){if(this.userOptIn&&c!==""){I=G(G({},I),this.getCommonProperties());let b=this.cloneAndChange(I,(C,g)=>this.anonymizeFilePaths(g,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${c}`,{properties:this.removePropertiesWithPossibleUserInfo(b),measurements:p})}}sendTelemetryErrorEvent(c,I,p,b){if(this.errorOptIn&&c!==""){I=G(G({},I),this.getCommonProperties());let C=this.cloneAndChange(I,(g,f)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(f,this.firstParty):b===void 0||b.indexOf(g)!==-1?"REDACTED":this.anonymizeFilePaths(f,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${c}`,{properties:this.removePropertiesWithPossibleUserInfo(C),measurements:p})}}sendTelemetryException(c,I,p){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&c){I=G(G({},I),this.getCommonProperties());let b=this.cloneAndChange(I,(C,g)=>this.anonymizeFilePaths(g,this.firstParty));c.stack&&(c.stack=this.anonymizeFilePaths(c.stack,this.firstParty)),this.telemetryAppender.logException(c,{properties:this.removePropertiesWithPossibleUserInfo(b),measurements:p})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(c=>c.dispose()))}},"ao"),_i=s(class{constructor(c){this._key=c,this._isInstantiated=!1,rn()!==tn.OFF&&this.instantiateAppender()}logEvent(c,I){!this._appInsightsClient||this._appInsightsClient.trackEvent({name:c,properties:I==null?void 0:I.properties,measurements:I==null?void 0:I.measurements})}logException(c,I){!this._appInsightsClient||this._appInsightsClient.trackException({exception:c,properties:I==null?void 0:I.properties,measurements:I==null?void 0:I.measurements})}flush(){return this._appInsightsClient&&(this._appInsightsClient.flush(),this._appInsightsClient=void 0),Promise.resolve(void 0)}instantiateAppender(){this._isInstantiated||Promise.resolve().then(()=>nt(Pl())).then(c=>{c.defaultClient?(this._appInsightsClient=new c.TelemetryClient(this._key),this._appInsightsClient.channel.setUseDiskRetryCaching(!0)):(c.setup(this._key).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this._appInsightsClient=c.defaultClient),Mo&&Mo.env&&(this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.userId]=Mo.env.machineId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.sessionId]=Mo.env.sessionId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRole]=Mo.env.appName,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRoleInstance]=Mo.env.appName),this._key&&this._key.indexOf("AIF-")===0&&(this._appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),this._isInstantiated=!0})}},"NE"),Ol=s(class extends _c{constructor(c,I,p,b){let C=new _i(p);p&&p.indexOf("AIF-")===0&&(b=!0);super(c,I,C,{release:ln.release(),platform:ln.platform()},b)}},"_l")},3255:ae=>{function h(V){var Q=new Error("Cannot find module '"+V+"'");throw Q.code="MODULE_NOT_FOUND",Q}s(h,"webpackEmptyContext"),h.keys=()=>[],h.resolve=h,h.id=3255,ae.exports=h},9118:ae=>{function h(V){var Q=new Error("Cannot find module '"+V+"'");throw Q.code="MODULE_NOT_FOUND",Q}s(h,"webpackEmptyContext"),h.keys=()=>[],h.resolve=h,h.id=9118,ae.exports=h},800:(ae,h,V)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.config=h.loadMessageBundle=h.localize=h.format=h.setPseudo=h.isPseudo=h.isDefined=h.BundleFormat=h.MessageFormat=void 0;var Q=V(1926),j;(function(me){me.file="file",me.bundle="bundle",me.both="both"})(j=h.MessageFormat||(h.MessageFormat={}));var ie;(function(me){me.standalone="standalone",me.languagePack="languagePack"})(ie=h.BundleFormat||(h.BundleFormat={}));var pe;(function(me){function L(ue){var Ne=ue;return Ne&&se(Ne.key)&&se(Ne.comment)}s(L,"is"),me.is=L})(pe||(pe={}));function se(me){return typeof me!="undefined"}s(se,"isDefined"),h.isDefined=se,h.isPseudo=!1;function de(me){h.isPseudo=me}s(de,"setPseudo"),h.setPseudo=de;function W(me,L){var ue;return h.isPseudo&&(me="\uFF3B"+me.replace(/[aouei]/g,"$&$&")+"\uFF3D"),L.length===0?ue=me:ue=me.replace(/\{(\d+)\}/g,function(Ne,nt){var We=nt[0],Ee=L[We],Ce=Ne;return typeof Ee=="string"?Ce=Ee:(typeof Ee=="number"||typeof Ee=="boolean"||Ee===void 0||Ee===null)&&(Ce=String(Ee)),Ce}),ue}s(W,"format"),h.format=W;function q(me,L){for(var ue=[],Ne=2;Ne<arguments.length;Ne++)ue[Ne-2]=arguments[Ne];return W(L,ue)}s(q,"localize"),h.localize=q;function F(me){return Q.default().loadMessageBundle(me)}s(F,"loadMessageBundle"),h.loadMessageBundle=F;function G(me){return Q.default().config(me)}s(G,"config"),h.config=G},1926:(ae,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var V;function Q(){if(V===void 0)throw new Error("No runtime abstraction layer installed");return V}s(Q,"RAL"),function(j){function ie(pe){if(pe===void 0)throw new Error("No runtime abstraction layer provided");V=pe}s(ie,"install"),j.install=ie}(Q||(Q={})),h.default=Q},8472:(ae,h,V)=>{"use strict";var Q;Q={value:!0},Q=h.loadMessageBundle=void 0;var j=V(1017),ie=V(7147),pe=V(1926),se=V(800),de=V(800);Q={enumerable:!0,get:function(){return de.MessageFormat}},Q={enumerable:!0,get:function(){return de.BundleFormat}};var W=Object.prototype.toString;function q(ye){return W.call(ye)==="[object Number]"}s(q,"isNumber");function F(ye){return W.call(ye)==="[object String]"}s(F,"isString");function G(ye){return ye===!0||ye===!1}s(G,"isBoolean");function me(ye){return JSON.parse(ie.readFileSync(ye,"utf8"))}s(me,"readJsonFileSync");var L,ue;function Ne(){if(ue={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:se.MessageFormat.bundle},F(process.env.VSCODE_NLS_CONFIG))try{var ye=JSON.parse(process.env.VSCODE_NLS_CONFIG),Be=void 0;if(ye.availableLanguages){var Ke=ye.availableLanguages["*"];F(Ke)&&(Be=Ke)}if(F(ye.locale)&&(ue.locale=ye.locale.toLowerCase()),Be===void 0?ue.language=ue.locale:Be!=="en"&&(ue.language=Be),G(ye._languagePackSupport)&&(ue.languagePackSupport=ye._languagePackSupport),F(ye._cacheRoot)&&(ue.cacheRoot=ye._cacheRoot),F(ye._languagePackId)&&(ue.languagePackId=ye._languagePackId),F(ye._translationsConfigFile)){ue.translationsConfigFile=ye._translationsConfigFile;try{ue.translationsConfig=me(ue.translationsConfigFile)}catch(ze){if(ye._corruptedFile){var Xe=j.dirname(ye._corruptedFile);ie.exists(Xe,function(Ze){Ze&&ie.writeFile(ye._corruptedFile,"corrupted","utf8",function(Le){console.error(Le)})})}}}}catch(ze){}se.setPseudo(ue.locale==="pseudo"),L=Object.create(null)}s(Ne,"initializeSettings"),Ne();function nt(){return ue.languagePackSupport===!0&&ue.cacheRoot!==void 0&&ue.languagePackId!==void 0&&ue.translationsConfigFile!==void 0&&ue.translationsConfig!==void 0}s(nt,"supportsLanguagePack");function We(ye){return function(Be,Ke){for(var Xe=[],ze=2;ze<arguments.length;ze++)Xe[ze-2]=arguments[ze];if(q(Be)){if(Be>=ye.length){console.error(`Broken localize call found. Index out of bounds. Stacktrace is
: `+new Error("").stack);return}return se.format(ye[Be],Xe)}else{if(F(Ke))return console.warn("Message "+Ke+" didn't get externalized correctly."),se.format(Ke,Xe);console.error(`Broken localize call found. Stacktrace is
: `+new Error("").stack)}}}s(We,"createScopedLocalizeFunction");function Ee(ye){var Be;if(ue.cacheLanguageResolution&&Be)Be=Be;else{if(se.isPseudo||!ue.language)Be=".nls.json";else for(var Ke=ue.language;Ke;){var Xe=".nls."+Ke+".json";if(ie.existsSync(ye+Xe)){Be=Xe;break}else{var ze=Ke.lastIndexOf("-");ze>0?Ke=Ke.substring(0,ze):(Be=".nls.json",Ke=null)}}ue.cacheLanguageResolution&&(Be=Be)}return ye+Be}s(Ee,"resolveLanguage");function Ce(ye){for(var Be=ue.language;Be;){var Ke=j.join(ye,"nls.bundle."+Be+".json");if(ie.existsSync(Ke))return Ke;var Xe=Be.lastIndexOf("-");Xe>0?Be=Be.substring(0,Xe):Be=void 0}if(Be===void 0){var Ke=j.join(ye,"nls.bundle.json");if(ie.existsSync(Ke))return Ke}}s(Ce,"findInTheBoxBundle");function Se(ye){try{ie.mkdirSync(ye)}catch(Ke){if(Ke.code==="EEXIST")return;if(Ke.code==="ENOENT"){var Be=j.dirname(ye);Be!==ye&&(Se(Be),ie.mkdirSync(ye))}else throw Ke}}s(Se,"mkdir");function le(ye){var Be=me(j.join(ye,"nls.metadata.json")),Ke=Object.create(null);for(var Xe in Be){var ze=Be[Xe];Ke[Xe]=ze.messages}return Ke}s(le,"createDefaultNlsBundle");function $(ye,Be){var Ke=ue.translationsConfig[ye.id];if(!!Ke){var Xe=me(Ke).contents,ze=me(j.join(Be,"nls.metadata.json")),Ze=Object.create(null);for(var Le in ze){var St=ze[Le],xe=Xe[ye.outDir+"/"+Le];if(xe){for(var Dt=[],ct=0;ct<St.keys.length;ct++){var It=St.keys[ct],$e=F(It)?It:It.key,Me=xe[$e];Me===void 0&&(Me=St.messages[ct]),Dt.push(Me)}Ze[Le]=Dt}else Ze[Le]=St.messages}return Ze}}s($,"createNLSBundle");function Te(ye){var Be=new Date;ie.utimes(ye,Be,Be,function(){})}s(Te,"touch");function ne(ye,Be){return L[ye]=Be,Be}s(ne,"cacheBundle");function ce(ye,Be){var Ke,Xe=j.join(ue.cacheRoot,ye.id+"-"+ye.hash+".json"),ze=!1,Ze=!1;try{return Ke=JSON.parse(ie.readFileSync(Xe,{encoding:"utf8",flag:"r"})),Te(Xe),Ke}catch(Le){if(Le.code==="ENOENT")Ze=!0;else if(Le instanceof SyntaxError)console.log("Syntax error parsing message bundle: "+Le.message+"."),ie.unlink(Xe,function(St){St&&console.error("Deleting corrupted bundle "+Xe+" failed.")}),ze=!0;else throw Le}if(Ke=$(ye,Be),!Ke||ze)return Ke;if(Ze)try{ie.writeFileSync(Xe,JSON.stringify(Ke),{encoding:"utf8",flag:"wx"})}catch(Le){if(Le.code==="EEXIST")return Ke;throw Le}return Ke}s(ce,"loadNlsBundleOrCreateFromI18n");function ge(ye){try{return le(ye)}catch(Be){console.log("Generating default bundle from meta data failed.",Be);return}}s(ge,"loadDefaultNlsBundle");function we(ye,Be){var Ke;if(nt())try{Ke=ce(ye,Be)}catch(ze){console.log("Load or create bundle failed ",ze)}if(!Ke){if(ue.languagePackSupport)return ge(Be);var Xe=Ce(Be);if(Xe)try{return me(Xe)}catch(ze){console.log("Loading in the box message bundle failed.",ze)}Ke=ge(Be)}return Ke}s(we,"loadNlsBundle");function He(ye){for(var Be,Ke=j.dirname(ye);Be=j.join(Ke,"nls.metadata.header.json"),!ie.existsSync(Be);){var Xe=j.dirname(Ke);if(Xe===Ke){Be=void 0;break}else Ke=Xe}return Be}s(He,"tryFindMetaDataHeaderFile");function Ge(ye){if(!ye)return se.localize;var Be=j.extname(ye);if(Be&&(ye=ye.substr(0,ye.length-Be.length)),ue.messageFormat===se.MessageFormat.both||ue.messageFormat===se.MessageFormat.bundle){var Ke=He(ye);if(Ke){var Xe=j.dirname(Ke),ze=L[Xe];if(ze===void 0)try{var Ze=JSON.parse(ie.readFileSync(Ke,"utf8"));try{var Le=we(Ze,Xe);ze=ne(Xe,Le?{header:Ze,nlsBundle:Le}:null)}catch(ct){console.error("Failed to load nls bundle",ct),ze=ne(Xe,null)}}catch(ct){console.error("Failed to read header file",ct),ze=ne(Xe,null)}if(ze){var St=ye.substr(Xe.length+1).replace(/\\/g,"/"),xe=ze.nlsBundle[St];return xe===void 0?(console.error("Messages for file "+ye+" not found. See console for details."),function(){return"Messages not found."}):We(xe)}}}if(ue.messageFormat===se.MessageFormat.both||ue.messageFormat===se.MessageFormat.file)try{var Dt=me(Ee(ye));return Array.isArray(Dt)?We(Dt):se.isDefined(Dt.messages)&&se.isDefined(Dt.keys)?We(Dt.messages):(console.error("String bundle '"+ye+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(ct){ct.code!=="ENOENT"&&console.error("Failed to load single file bundle",ct)}return console.error("Failed to load message bundle for file "+ye),function(){return"Failed to load message bundle. See console for details."}}s(Ge,"loadMessageBundle"),h.loadMessageBundle=Ge;function tt(ye){return ye&&(F(ye.locale)&&(ue.locale=ye.locale.toLowerCase(),ue.language=ue.locale,L=Object.create(null)),ye.messageFormat!==void 0&&(ue.messageFormat=ye.messageFormat),ye.bundleFormat===se.BundleFormat.standalone&&ue.languagePackSupport===!0&&(ue.languagePackSupport=!1)),se.setPseudo(ue.locale==="pseudo"),Ge}s(tt,"config"),Q=tt,pe.default.install(Object.freeze({loadMessageBundle:Ge,config:tt}))},6822:(ae,h,V)=>{"use strict";ae.exports=V(8472)},2479:ae=>{ae.exports=h;function h(V,Q){if(V&&Q)return h(V)(Q);if(typeof V!="function")throw new TypeError("need wrapper function");return Object.keys(V).forEach(function(ie){j[ie]=V[ie]}),j;function j(){for(var ie=new Array(arguments.length),pe=0;pe<ie.length;pe++)ie[pe]=arguments[pe];var se=V.apply(this,ie),de=ie[ie.length-1];return typeof se=="function"&&se!==de&&Object.keys(de).forEach(function(W){se[W]=de[W]}),se}s(j,"wrapper")}s(h,"wrappy")},9166:ae=>{"use strict";ae.exports=require("applicationinsights-native-metrics")},9496:ae=>{"use strict";ae.exports=require("vscode")},9491:ae=>{"use strict";ae.exports=require("assert")},852:ae=>{"use strict";ae.exports=require("async_hooks")},2081:ae=>{"use strict";ae.exports=require("child_process")},6206:ae=>{"use strict";ae.exports=require("console")},2057:ae=>{"use strict";ae.exports=require("constants")},6113:ae=>{"use strict";ae.exports=require("crypto")},9523:ae=>{"use strict";ae.exports=require("dns")},2361:ae=>{"use strict";ae.exports=require("events")},7147:ae=>{"use strict";ae.exports=require("fs")},3685:ae=>{"use strict";ae.exports=require("http")},5687:ae=>{"use strict";ae.exports=require("https")},8188:ae=>{"use strict";ae.exports=require("module")},1808:ae=>{"use strict";ae.exports=require("net")},2037:ae=>{"use strict";ae.exports=require("os")},1017:ae=>{"use strict";ae.exports=require("path")},4074:ae=>{"use strict";ae.exports=require("perf_hooks")},2781:ae=>{"use strict";ae.exports=require("stream")},9512:ae=>{"use strict";ae.exports=require("timers")},7310:ae=>{"use strict";ae.exports=require("url")},3837:ae=>{"use strict";ae.exports=require("util")},9796:ae=>{"use strict";ae.exports=require("zlib")}},__webpack_module_cache__={};function __webpack_require__(ae){var h=__webpack_module_cache__[ae];if(h!==void 0)return h.exports;var V=__webpack_module_cache__[ae]={id:ae,loaded:!1,exports:{}};return __webpack_modules__[ae].call(V.exports,V,V.exports,__webpack_require__),V.loaded=!0,V.exports}s(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=ae=>{var h=ae&&ae.__esModule?()=>ae.default:()=>ae;return __webpack_require__.d(h,{a:h}),h}})(),(()=>{var ae=Object.getPrototypeOf?V=>Object.getPrototypeOf(V):V=>V.__proto__,h;__webpack_require__.t=function(V,Q){if(Q&1&&(V=this(V)),Q&8||typeof V=="object"&&V&&(Q&4&&V.__esModule||Q&16&&typeof V.then=="function"))return V;var j=Object.create(null);__webpack_require__.r(j);var ie={};h=h||[null,ae({}),ae([]),ae(ae)];for(var pe=Q&2&&V;typeof pe=="object"&&!~h.indexOf(pe);pe=ae(pe))Object.getOwnPropertyNames(pe).forEach(se=>ie[se]=()=>V[se]);return ie.default=()=>V,__webpack_require__.d(j,ie),j}})(),(()=>{__webpack_require__.d=(ae,h)=>{for(var V in h)__webpack_require__.o(h,V)&&!__webpack_require__.o(ae,V)&&Object.defineProperty(ae,V,{enumerable:!0,get:h[V]})}})(),(()=>{__webpack_require__.o=(ae,h)=>Object.prototype.hasOwnProperty.call(ae,h)})(),(()=>{__webpack_require__.r=ae=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(ae,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ae,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=ae=>(ae.paths=[],ae.children||(ae.children=[]),ae)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>Ha,activate:()=>Ny,getOpenActionsService:()=>Cu,getState:()=>Qp,isInsiders:()=>Xp,updateState:()=>hh});var ae={};__webpack_require__.r(ae),__webpack_require__.d(ae,{max:()=>pt,min:()=>Ve});var h=__webpack_require__(9496),V=__webpack_require__(8472),Q;(function(r){r.Off="off",r.Auto="auto",r.Always="always"})(Q||(Q={}));var j;(function(r){r.None="none",r.Latest="latest",r.Match="match",r.TipPlusLatest="tip+latest"})(j||(j={})),function(r){function e(t){return t===r.None||t===r.Latest||t===r.Match||t===r.TipPlusLatest?t:r.None}s(e,"sanitize"),r.sanitize=e}(j||(j={}));var ie;(function(r){r.Browse="browse",r.Edit="edit"})(ie||(ie={})),function(r){function e(n){return n===r.Browse||n===r.Edit?n:r.Edit}s(e,"sanitize"),r.sanitize=e;function t(n){return n===r.Browse?r.Edit:r.Browse}s(t,"toggle"),r.toggle=t}(ie||(ie={}));var pe;(function(r){function e(t,n){return t.display===n.display&&t.index===n.index}s(e,"equals"),r.equals=e})(pe||(pe={}));var se;(function(r){r.Branch="branch",r.RemoteBranch="remoteBranch",r.PullRequestBranch="pullRequestBranch",r.PullRequestRemoteBranch="pullRequestRemoteBranch",r.Tag="tag",r.Commit="commit"})(se||(se={}));var de;(function(r){const e=new Map([[se.Branch,j.None],[se.RemoteBranch,j.None],[se.PullRequestBranch,j.Match],[se.PullRequestRemoteBranch,j.Match],[se.Commit,j.Match],[se.Tag,j.Match]]),t=new Map([[se.Branch,ie.Edit],[se.RemoteBranch,ie.Edit],[se.PullRequestBranch,ie.Browse],[se.PullRequestRemoteBranch,ie.Browse],[se.Commit,ie.Browse],[se.Tag,ie.Browse]]);function n(o){var a,l;return{display:(a=t.get(o))!=null?a:ie.Edit,index:(l=e.get(o))!=null?l:j.None}}s(n,"getDefault"),r.getDefault=n;function i(o){switch(o){case se.Branch:case se.RemoteBranch:return{display:ie.Browse,index:j.Latest};case se.PullRequestBranch:case se.PullRequestRemoteBranch:return{display:ie.Browse,index:j.Match};case se.Commit:case se.Tag:return{display:ie.Browse,index:j.Match};default:return{display:ie.Edit,index:j.None}}}s(i,"getIndexDefault"),r.getIndexDefault=i})(de||(de={}));const W=null;var q=__webpack_require__(2307),F=__webpack_require__.n(q);const G="remoteHub",me="modes",L="indexMemento";class ue{constructor(){this._onDidChange=new h.EventEmitter,this._onDidChangeAny=new h.EventEmitter,this.memoryState=new Map}static configure(e){Ne.state=e.workspaceState,e.subscriptions.push(h.workspace.onDidChangeConfiguration(Ne.onConfigurationChanged,Ne))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(G)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(me),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const t of this.memoryState.entries())this.modes[t[0]]=t[1];this._state.update(me,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(L),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,t,n){return n===void 0?h.workspace.getConfiguration(e===void 0?void 0:G,t).get(e===void 0?G:e):h.workspace.getConfiguration(e===void 0?void 0:G,t).get(e===void 0?G:e,n)}getMode(e,t,n){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:ie.sanitize(a.display),index:j.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(t===se.Branch||t===se.RemoteBranch)switch((i=h.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:ie.Edit,index:j.None};case"latest":return{display:ie.Browse,index:j.Latest};case"tipPlusLatest":return{display:ie.Edit,index:j.TipPlusLatest}}if(!n)return de.getDefault(t)}setMode(e,t){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,t),Promise.resolve()):(this.modes[n]=t,this._state.update(me,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,t){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=t,this._state.update(L,this.indexMemento))}getAny(e,t,n){return n===void 0?h.workspace.getConfiguration(void 0,t).get(e):h.workspace.getConfiguration(void 0,t).get(e,n)}changed(e,t,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${G}.${t}`,n))!=null?i:!0}inspect(e,t){return h.workspace.getConfiguration(e===void 0?void 0:G,t).inspect(e===void 0?G:e)}inspectAny(e,t){return h.workspace.getConfiguration(void 0,t).inspect(e)}async migrate(e,t,n){const i=Ne.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(t,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(t,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(t,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(t,n.fallbackValue,h.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,t,n){const i=Ne.inspect(e);if(i===void 0)return;const o=Ne.inspect(t);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(t,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(t,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(t,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,t,n){return h.workspace.getConfiguration(G).update(e,t,n)}updateAny(e,t,n,i){return h.workspace.getConfiguration(void 0,n===h.ConfigurationTarget.Global?void 0:i).update(e,t,n)}updateEffective(e,t){const n=Ne.inspect(e);return n.workspaceFolderValue!==void 0?t===n.workspaceFolderValue?Promise.resolve(void 0):Ne.update(e,t,h.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?t===n.workspaceValue?Promise.resolve(void 0):Ne.update(e,t,h.ConfigurationTarget.Workspace):n.globalValue===t||n.globalValue===void 0&&t===n.defaultValue?Promise.resolve(void 0):Ne.update(e,F()(t,n.defaultValue)?void 0:t,h.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=Xp()),e}}s(ue,"Configuration");const Ne=new ue,nt="";var We;(function(r){r.Off="off",r.Error="error",r.Warn="warn",r.Info="info",r.Debug="debug"})(We||(We={}));var Ee;(function(r){r[r.Off=0]="Off",r[r.Error=1]="Error",r[r.Warn=2]="Warn",r[r.Info=3]="Info",r[r.Debug=4]="Debug"})(Ee||(Ee={}));const Ce="GitHub Repositories",Se="[RemoteHub]",le=s(class{static configure(r,e){this._isDebugging=r.extensionMode===h.ExtensionMode.Development,this.logLevel=e}static enabled(r){return this.level>=this.toOrderedLevel(r)}static get logLevel(){return this._logLevel}static set logLevel(r){var e,t;this._logLevel=r,this.level=this.toOrderedLevel(r),r===We.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(t=this.output)!=null?t:h.window.createOutputChannel(Ce)}static toOrderedLevel(r){switch(r){case We.Off:return 0;case We.Error:return 1;case We.Warn:return 2;case We.Info:return 3;case We.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(r,...e){le.isDebugging&&console.log(this.timestamp,Se,r!=null?r:nt,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${r!=null?r:nt}${this.toLoggableParams(!0,e)}`)}static error(r,e,...t){if(!(this.level<1&&!le.isDebugging)){if(e===void 0){const n=r instanceof Error?r.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}le.isDebugging&&console.error(this.timestamp,Se,e!=null?e:nt,...t,r),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:nt}${this.toLoggableParams(!1,t)}
${String(r)}`)}}static log(r,...e){le.isDebugging&&console.log(this.timestamp,Se,r!=null?r:nt,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${r!=null?r:nt}${this.toLoggableParams(!1,e)}`)}static warn(r,...e){le.isDebugging&&console.warn(this.timestamp,Se,r!=null?r:nt,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${r!=null?r:nt}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var r;(r=this.output)==null||r.show()}static toLoggable(r,e){if(typeof r!="object")return String(r);if(r instanceof h.Uri)return`Uri(${r.toString(!0)})`;try{return JSON.stringify(r,e)}catch{return"<error>"}}static toLoggableName(r){var e,t,n;let i;if(typeof r=="function"){if(r.prototype===void 0||r.prototype.constructor===void 0)return r.name;i=(e=r.prototype.constructor.name)!=null?e:nt}else i=(n=(t=r.constructor)==null?void 0:t.name)!=null?n:nt;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const r=new Date;return`[${r.toISOString().replace(/T/," ").replace(/\..+/,nt)}:${`00${r.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(r,e){if(e.length===0||r&&this.level<4&&!le.isDebugging)return nt;const t=e.map(n=>this.toLoggable(n)).join(", ");return t.length!==0?` \u2014 ${t}`:nt}},"_Logger");let $=le;$.level=0,$._logLevel=We.Off;const Te=47;function ne(r){if(r===void 0)return;const e=r.path.endsWith("/");return!e&&!r.fragment?r.toString():r.with({path:e?r.path.slice(0,-1):r.path,fragment:""}).toString()}s(ne,"asKey");function ce(r){if(r===void 0)return;const e=r.path.endsWith("/");return!e&&!r.query&&!r.fragment?r.toString():r.with({path:e?r.path.slice(0,-1):r.path,query:"",fragment:""}).toString()}s(ce,"asFileKey");function ge(r,e){return`${(e==null?void 0:e.excludeScheme)?"":`${r.scheme}-`}${r.authority}${r.path.endsWith("/")?r.path.slice(0,-1):r.path}`}s(ge,"asFileStorageKey");function we(r){const e=r.path;let t=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===Te){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(t,n)}s(we,"basename");function He(r){const e=r.path;if(e.length===1)return"/";let t,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===Te){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}s(He,"dirname");function Ge(r){const e=r.path.lastIndexOf("/");return e===-1?r.with({path:"/"}):r.with({path:r.path.substring(0,e)})}s(Ge,"getParent");function tt(r,e){const t=typeof e=="string"?e:e.path;return t.startsWith(r.path)?h.Uri.joinPath(r,t.substr(r.path.length)):h.Uri.joinPath(r,t)}s(tt,"joinRelativePath");function ye(r,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),Be(r,e)&&r.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):Be(r,e)&&r.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}s(ye,"isChild");function Be(r,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||r.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===r.scheme&&e.authority===r.authority&&(e.path.length===1||r.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}s(Be,"isDescendent");function Ke(r){return r&&typeof r=="object"&&"scheme"in r}s(Ke,"isSerializedUri");const Xe=s(class{constructor(r){this.storageService=r,this._onDidChange=new h.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(r){const e=ne(r),t=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw $.error(n,`Failed to delete repository metadata for ${e}`),n}!t||setTimeout(()=>this._onDidChange.fire({uri:r}),0)}async get(r){this.assertMatchingScheme(r);const e=ne(r),t=this.cache.get(e);if(t!==void 0)return t;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw $.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(r,e,t,n){this.assertMatchingScheme(r);const i=(await this.get(r)).revision!==e?"revision":void 0,o=ne(r);if(t!==void 0&&!this.validate(t))throw new Error(`Metadata validation failed for ${r.toString()}`);const a={revision:e,cachedMetadata:t};this.cache.set(o,a);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(l){throw this.cache.delete(o),$.error(l,`Failed to save repository metadata for ${o}`),l}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:r,reason:i}),0)}refresh(){this.cache.clear()}validate(r){var e,t,n,i,o,a,l,u;return typeof r.version=="number"&&r.version>=Xe.schemaVersion&&typeof r.timestamp=="number"&&typeof((e=r.provider)==null?void 0:e.id)=="string"&&typeof r.provider.name=="string"&&typeof r.name=="string"&&r.repo&&typeof r.user=="string"&&typeof r.accessLevel=="number"&&typeof((t=r.HEAD)==null?void 0:t.type)=="number"&&typeof((n=r.HEAD)==null?void 0:n.name)=="string"&&typeof((i=r.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=r.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((a=r.HEAD.detached)==null?void 0:a.type)=="number"||typeof((l=r.HEAD.branch)==null?void 0:l.name)=="string")&&typeof((u=r.defaultBranch)==null?void 0:u.name)=="string"&&typeof r.defaultBranch.sha=="string"}assertMatchingScheme(r){if(r.scheme!==tr.scheme)throw new Error(`Uri scheme '${r.scheme}' must match configured scheme '${tr.scheme}'; uri=${r.toString()}`)}getStorageKey(r){return`metadata/${r}`}fromStorage(r){if(!r)return;const e=JSON.parse(r,(t,n)=>(t==="uri"||t.endsWith("Uri"))&&Ke(n)?h.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(r){const e={schemaVersion:Xe.storageSchemaVersion,revision:r};return JSON.stringify(e)}},"_MetadataStore");let ze=Xe;ze.schemaVersion=6,ze.storageSchemaVersion=1;var Ze;(function(r){r[r.Admin=100]="Admin",r[r.Maintain=40]="Maintain",r[r.WriteToPullRequest=31]="WriteToPullRequest",r[r.Write=30]="Write",r[r.Triage=20]="Triage",r[r.Read=10]="Read",r[r.None=0]="None"})(Ze||(Ze={}));var Le;(function(r){r[r.Branch=0]="Branch",r[r.RemoteBranch=1]="RemoteBranch",r[r.Tag=2]="Tag",r[r.Commit=3]="Commit"})(Le||(Le={}));class St extends Error{constructor(e,t){super(typeof e=="string"?e:e.message);this.reauthenticate=t;var n;this.original=typeof e!="string"?e:void 0,(n=Error.captureStackTrace)==null||n.call(Error,this,St)}}s(St,"InvalidCredentialsError");class xe extends Error{constructor(e,t,n){super(e.message);this.original=e,this.name=t,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,xe)}}s(xe,"PullRequestNotFoundError");class Dt extends Error{constructor(e,t){super(e.message);this.original=e,this.name=t;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Dt)}}s(Dt,"RepositoryForbiddenError");class ct extends Error{constructor(e,t){super(e.message);this.original=e,this.name=t;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,ct)}}s(ct,"RepositoryNotFoundError");class It extends Error{constructor(e,t){super(e.message);this.original=e,this.name=t;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,It)}}s(It,"RepositoryEmptyError");class $e extends Error{constructor(e){super(e);var t;(t=Error.captureStackTrace)==null||t.call(Error,this,$e)}}s($e,"DetachedHEADError");class Me extends Error{constructor(e,t){super(e.message);this.original=e,this.duplicate=t;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Me)}}s(Me,"InvalidBranchNameError");class mt extends Error{constructor(e){super(e.message);this.original=e;var t;(t=Error.captureStackTrace)==null||t.call(Error,this,mt)}}s(mt,"MergeConflictError");class Tt extends Error{constructor(e){super(e);var t;(t=Error.captureStackTrace)==null||t.call(Error,this,Tt)}}s(Tt,"NothingToCommitError");class Ut extends Error{constructor(e=!1){super(e?"Unable to sync the repository":"Unable to fetch the repository");var t;(t=Error.captureStackTrace)==null||t.call(Error,this,Ut)}}s(Ut,"SyncOrFetchError");class gr extends Error{constructor(){super("Sync operation will result in conflicts");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,gr)}}s(gr,"SyncConflictsError");class Jt extends Error{constructor(){super("Failed to create and push commit");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,Jt)}}s(Jt,"CommitFailedError");class er extends Error{constructor(e){var t;const n=typeof e=="string"?e:tr.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(t=Error.captureStackTrace)==null||t.call(Error,this,er)}}s(er,"ProviderNotFoundError");const pi=/^[0-9a-f]{40}$/i;function mr(r){return r!==void 0&&pi.test(r)}s(mr,"isSha");const Nr=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function Rt(r){return Nr.test(r)}s(Rt,"isValidBranchName");function qt(r){return r===""||r==="~"||r==="HEAD"?r:r.endsWith("^")?`${r.substr(0,7)}^`:r.substr(0,7)}s(qt,"shortenRef");var ht;(function(r){r[r.Branch=0]="Branch",r[r.Tag=1]="Tag",r[r.Commit=2]="Commit",r[r.PullRequest=3]="PullRequest",r[r.Tree=4]="Tree"})(ht||(ht={}));class ft{constructor(e,t,n,i,o){this.providerService=e,this.uri=t,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}s(ft,"VirtualRepository");var Pt;(function(r){r[r.Repository=0]="Repository",r[r.PullRequest=1]="PullRequest",r[r.Branch=2]="Branch",r[r.Commit=3]="Commit",r[r.File=4]="File",r[r.Tag=5]="Tag"})(Pt||(Pt={}));var et;(function(r){r[r.Clone=-1]="Clone",r[r.Repository=0]="Repository",r[r.PullRequest=1]="PullRequest",r[r.Branch=2]="Branch",r[r.Commit=3]="Commit",r[r.Tag=4]="Tag"})(et||(et={}));var Ot;(function(r){r[r.Open=0]="Open",r[r.Closed=1]="Closed",r[r.Merged=2]="Merged"})(Ot||(Ot={}));var wt;(function(r){r[r.NotIndexed=0]="NotIndexed",r[r.Indexed=1]="Indexed",r[r.Match=2]="Match",r[r.Active=3]="Active"})(wt||(wt={})),function(r){function e(t){return t!==void 0&&(t===r.Indexed||t===r.Match||t===r.Active)}s(e,"hasIndex"),r.hasIndex=e}(wt||(wt={}));var Er;(function(r){function e(t){return t!==void 0&&t.type===3}s(e,"isActive"),r.isActive=e})(Er||(Er={}));var Gt;(function(r){r[r.Latest=1]="Latest",r[r.SHA=2]="SHA"})(Gt||(Gt={}));var $r;(function(r){function e(t){const n=tr.decodeAuthority(t).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(mr(n.idx))return{type:2,sha:n.idx}}}s(e,"decode"),r.decode=e})($r||($r={}));function*Yn(r,e){for(const t of r)yield*e(t)}s(Yn,"flatMap");function*kn(r,e){for(const t of r)e(t)&&(yield t)}s(kn,"filter");function*eo(r,e){for(const t of r){const n=e(t);n!=null&&(yield n)}}s(eo,"filterMap");function ja(r,e){for(const t of r)if(e(t))return t}s(ja,"find");function qs(r,e){let t="";const n=r[Symbol.iterator]();let i=n.next();if(i.done)return t;for(;;){const o=i.value.toString();if(i=n.next(),i.done){t+=o;break}t+=o,t+=e}return t}s(qs,"join");function*rr(r,e){for(const t of r)yield e(t)}s(rr,"map");function to(r,e){for(const t of r)if(e(t))return!0;return!1}s(to,"some");function*ra(...r){for(const e of r)for(const t of e)yield t}s(ra,"union");function*na(r){const e=new Set;for(const t of r)e.has(t)||(e.add(t),yield t)}s(na,"unique");const zs="";function gi(...r){if(r.length===1){const e=r[0];return e===void 0?zs:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(r)}s(gi,"defaultResolver");function fn(r){return(e,t,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${t}`;n.value=function(...a){const l=a.length===0?o:`${o}$${(r!=null?r:gi)(...a)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let u=this[l];const d=s(()=>i.apply(this,a),"run");return u===void 0?u=d():u=u.then(d,d),this[l]=u,u}}}s(fn,"serialize");const Ii=require("process");let So=0;function Co(){return So===Number.MAX_SAFE_INTEGER&&(So=0),++So}s(Co,"getNextInstanceId");const Cn=s(class{constructor(r,e,...t){this.context=r,this.instance=`[${Co().toString().padStart(5)}] `;var n,i,o,a,l,u;let d;if(typeof(e==null?void 0:e.log)=="boolean"?d=e.log?{}:void 0:d=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:We.Info,this.time=(0,Ii.hrtime)(),d){if(!$.enabled(this.logLevel))return;t.length?Di(this.logLevel,`${this.instance}${(o=d.prefix)!=null?o:""}${r}${(a=d.message)!=null?a:""}`,...t):Di(this.logLevel,`${this.instance}${(l=d.prefix)!=null?l:""}${r}${(u=d.message)!=null?u:""}`)}}log(r){this.logCore(this.context,r,!1)}logStep(r,e){(!r||e)&&this.logCore(this.context,e,!1),this.step=r?{time:(0,Ii.hrtime)(),label:r}:void 0}restart(r){this.logCore(this.context,r,!0),this.step=void 0,this.time=(0,Ii.hrtime)()}stop(r){this.restart(r)}logCore(r,e,t){var n,i,o,a,l,u,d;if(!$.enabled(this.logLevel))return;let _="";if(this.step){const[M,k]=(0,Ii.hrtime)(this.step.time),B=M*1e3+Math.floor(k/1e6);_=`${this.step.label?`${this.step.label} took `:""}${B} ms`}if(!t){Di(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${r}${(i=e==null?void 0:e.message)!=null?i:""}${_?` ${_}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[R,A]=(0,Ii.hrtime)(this.time),P=R*1e3+Math.floor(A/1e6);Di(P>500?We.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${r}${(l=e==null?void 0:e.message)!=null?l:""}${(u=e==null?void 0:e.took)!=null?u:" took "}${P} ms${_?` (${_})`:""}${(d=e==null?void 0:e.suffix)!=null?d:""}`)}static start(r,e,...t){var n;(n=Cn.watches.get(r))==null||n.log(),Cn.watches.set(r,new Cn(r,e,...t))}static log(r,e){var t;(t=Cn.watches.get(r))==null||t.log(e)}static stop(r,e){var t;(t=Cn.watches.get(r))==null||t.stop(e),Cn.watches.delete(r)}},"_Stopwatch");let lt=Cn;lt.watches=new Map;function Di(r,e,...t){switch(r){case We.Warn:$.warn(e,...t);break;case We.Info:$.log(e,...t);break;default:$.debug(e,...t);break}}s(Di,"log");function ro(r){return Buffer.from(r,"utf8").toString("hex")}s(ro,"encodeUtf8Hex");function Zn(r){return Buffer.from(r,"hex").toString("utf8")}s(Zn,"decodeUtf8Hex");var pl=__webpack_require__(6724),Ws=Object.defineProperty,Gs=Object.getOwnPropertyDescriptor,Vs=s((r,e,t,n)=>{for(var i=n>1?void 0:n?Gs(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ws(e,t,i),i},"__decorateClass"),Mr;(function(r){r[r.Abort=0]="Abort",r[r.KeepCurrent=1]="KeepCurrent",r[r.DiscardCurrent=2]="DiscardCurrent",r[r.Merge=3]="Merge"})(Mr||(Mr={}));const yr=s(class{constructor(r,e){this.metadataStore=r,this.telemetryService=e,this._providers=new Map,this._onDidChangeProviders=new h.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new h.EventEmitter,this._onDidChangeRepository=new h.EventEmitter,this._onDidSyncRepository=new h.EventEmitter,this._onDidRefresh=new h.EventEmitter,this._onWillRefresh=new h.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=h.Disposable.from(h.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),r.onDidChange(t=>this.onMetadataChanged(t)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(r){const e=this._repositories.get(ne(r.uri));!e||($.log(`VirtualProviderService.onMetadataChanged(${r.uri.toString()}, reason=${r.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:r.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(r){if(r.added.length)for(const e of r.added){const t=ne(e.uri);if(e.uri.scheme!==yr.scheme||this._repositories.has(t))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(t,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new ft(this,e.uri,i,o,n);this._repositories.set(t,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(r.removed.length)for(const e of r.removed){const t=ne(e.uri);if(e.uri.scheme!==yr.scheme||!this._repositories.has(t))continue;const n=this._repositories.get(t);this._repositories.delete(t),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}yn(ni.HasVirtualFolders,this._repositories.size!==0),yn(ni.VirtualFolderProviders,qs(na(rr(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...rr(this._providers.values(),r=>({id:r.id,name:r.name}))]}get repositories(){return[...this.getRepositories()]}register(r,e,t,n,i){var o;if(this._providers.has(r))throw new Error(`Provider '${r}' has already been registered`);const a={id:r,name:e,provider:t,fs:n,index:i};return this._providers.set(r,a),this._onDidChangeProviders.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:r}),this.onWorkspaceFoldersChanged({added:(o=h.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(r);const l=[];for(const[u,d]of[...this._repositories])(d==null?void 0:d.provider.id)===r&&(this._repositories.delete(u),l.push(d));this._onDidChangeRepositories.fire({added:[],removed:l}),this._onDidChangeProviders.fire({added:[],removed:[a]})}}}refresh(){if(this._providers.size===0)return;const r=[],e=[];for(const t of this._providers.values())r.push(...rr(this.getRepositories(t.id),n=>n.uri)),t.index!==void 0&&e.push(t.index);this._onWillRefresh.fire(r),this.metadataStore.refresh(),e.forEach(t=>t.refresh(r)),this._onDidRefresh.fire(r)}getRegisteredProvider(r){const e=this.getProvider(r);return e?{id:e.id,name:e.name}:void 0}getRepository(r,e){const t=h.workspace.getWorkspaceFolder(r);if(!t||t.uri.scheme!==yr.scheme)return;const n=this._repositories.get(ne(t.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(r){return kn(this._repositories.values(),e=>e!==null&&(!r||e.provider.id===r))}getOpenUris(r,e){const t=new Map,n=h.workspace.textDocuments;if(n.length===0)return t;for(const i of n)i.uri.scheme===r&&e.some(o=>Be(i.uri,o))&&t.set(ne(i.uri),i.uri);return t}hasProvider(r,e){const t=typeof r=="string"?r:yr.getProviderId(r),n=this._providers.get(t);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(r){var e;return Boolean((e=this.getProvider(r))==null?void 0:e.provider.isReadonly)}getProvider(r){const e=typeof r=="string"?r:yr.getProviderId(r);return this._providers.get(e)}getRepositoryProvider(r){var e;const t=(e=this.getProvider(r))==null?void 0:e.provider;if(t)return t;throw new er(r)}getFileSystemProvider(r){var e;const t=(e=this.getProvider(r))==null?void 0:e.fs;if(t)return t;throw new er(r)}getRemoteWorkspaceSourceProviders(r){var e,t,n,i;return r?(i=(n=(e=this.getProvider(r))==null?void 0:(t=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(t))!=null?i:[]:[...Yn(this._providers.values(),o=>{var a,l,u;return(u=(l=(a=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:l.call(a))!=null?u:[]})]}isInWorkspace(r){return this.getVirtualWorkspaceUri(r)!==void 0}getAuthentication(r){const e=this.getProvider(r);if(!e)throw new er(r);return e==null?void 0:e.provider.getAuthentication(r)}canOpenRemoteUrl(r,e){if(e){const t=this.getProvider(e),n=t==null?void 0:t.provider.canOpenRemoteUrl(r);return n!==void 0?{provider:t,urlType:n}:void 0}for(const t of this._providers.values()){const n=t.provider.canOpenRemoteUrl(r);if(n!==void 0)return{provider:t,urlType:n}}}async createWorkspaceForRemoteUrl(r,e,t=ir.CurrentWindow){var n;const i=this.canOpenRemoteUrl(r,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(r,t)}createProviderUri(r,e,t){return this.getProviderUri(this.getRepositoryProvider(r).createVirtualUri(yr.baseVirtualWorkspaceUri,e,t))}createRelativeProviderUri(r,e){return this.getProviderUri(this.createRelativeUri(r,e))}createRelativeUri(r,e){const t=this.getProviderRootUri(r);let n=`${t.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=t.with({path:`${t.path}/${e.startsWith("/")?e.substr(1):e}`});return r.scheme===yr.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(r,e){return this.getVirtualUri(this.createRelativeUri(r,e))}createVirtualUri(r,e,t){return this.getRepositoryProvider(r).createVirtualUri(yr.baseVirtualWorkspaceUri,e,t)}async getBestRemoteUri(r,e){const{provider:t,repo:n,ref:i}=this.getVirtualUriMetadata(r);if(e===et.Repository)return this.getRemoteUri(t.id,{repo:n});if(e===et.Clone)return this.getRemoteUri(t.id,{repo:n,clone:!0});if(e===et.PullRequest||e===void 0&&(i==null?void 0:i.type)===ht.PullRequest){if((i==null?void 0:i.type)===ht.PullRequest)return this.getRemoteUri(t.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(r);if(e===et.PullRequest&&o)return this.getRemoteUri(t.id,{repo:n,pullRequest:{id:o.id}})}if(e===et.Branch||e===void 0&&(i==null?void 0:i.type)===ht.Branch){if((i==null?void 0:i.type)===ht.Branch)return this.getRemoteUri(t.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(r);if(o.type===Le.Branch||o.type===Le.RemoteBranch&&e===et.Branch)return this.getRemoteUri(t.id,{repo:n,branch:o.branch.name})}if(e===et.Tag||e===void 0&&(i==null?void 0:i.type)===ht.Tag){if((i==null?void 0:i.type)===ht.Tag)return this.getRemoteUri(t.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(r);if(o.type===Le.Tag)return this.getRemoteUri(t.id,{repo:n,tag:o.detached.name})}if(e===et.Commit||e===void 0&&((i==null?void 0:i.type)===ht.Commit||(i==null?void 0:i.type)===ht.Tree&&mr(i.id))){if((i==null?void 0:i.type)===ht.Commit||(i==null?void 0:i.type)===ht.Tree&&mr(i.id))return this.getRemoteUri(t.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(r);if(e===et.Commit||o.type===Le.Commit)return this.getRemoteUri(t.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(t.id,{repo:n})}getCanonicalUri(r){let{authority:e}=r;const t=e.indexOf(yr.authoritySeparator);return t!==-1&&(e=e.substr(0,t)),r.with({authority:e})}getRemoteUri(r,e){var t,n;return(n=(t=this.getRepositoryProvider(r)).getRemoteUri)==null?void 0:n.call(t,e)}getProviderUri(r){return r.scheme!==yr.scheme?r:r.with({scheme:yr.getProviderId(r)})}getProviderRootUri(r){return r=this.getProviderUri(r),this.getRepositoryProvider(r).getProviderRootUri(r)}getRelativeFilePath(r,e){return e=this.getProviderUri(e!=null?e:r),this.getRepositoryProvider(e).getRelativeFilePath(r,e)}getVirtualUriMetadata(r){return this.getRepositoryProvider(r).getVirtualUriMetadata(r)}getVirtualUri(r){return r.scheme===yr.scheme?r:r.with({scheme:yr.scheme})}getVirtualCanonicalRootUri(r){const e=this.getVirtualUri(this.getProviderRootUri(r));let{authority:t}=e;const n=t.indexOf(yr.authoritySeparator);return n!==-1&&(t=t.substr(0,n)),e.with({authority:t})}getVirtualRootUri(r){return this.getVirtualUri(this.getProviderRootUri(r))}getVirtualWorkspaceUri(r){var e;return(e=h.workspace.getWorkspaceFolder(this.getVirtualUri(r)))==null?void 0:e.uri}createIGitRepository(r,e,t,n){var i,o;return(o=(i=this.getRepositoryProvider(r)).createIGitRepository)==null?void 0:o.call(i,r,e,t,n)}async getCommitOperations(r,e,t){let n;return(t==null?void 0:t.staged)?(n=await e.getStagedChanges(r),n.length===0&&t.staged==="auto"&&(n=await e.getChanges(r))):n=await e.getChanges(r),n.map(o=>{const a=this.getRelativeFilePath(r,o.uri);switch(o.type){case Mt.Created:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Mt.Changed:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Mt.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(r){return{...await this.getMetadataCore(this.getVirtualRootUri(r)),path:this.getRelativeFilePath(r,r)}}async getIndexMetadata(r){const e=this.getProvider(r);return(e==null?void 0:e.index)?e.index.getIndexMetadata(r):void 0}getModeConfig(r,e,t){return Ne.getMode(this.getVirtualRootUri(r),e,Boolean(t))}async getModeRefType(r,e){return r=this.getVirtualRootUri(r),this.getRepositoryProvider(r).getModeRefType(r,e)}getIndexProvider(r){var e;return(e=this.getProvider(r))==null?void 0:e.index}async getMetadataCore(r){const e=ne(r);let t=this.pendingMetadataRequests.get(e);if(t)return t;let{revision:n,cachedMetadata:i}=await this.metadataStore.get(r);if(i!==void 0)return i;const o=this.getProvider(r);if(!o)throw new er(r);const a=$r.decode(r);(a==null?void 0:a.type)===Gt.SHA&&(n=a.sha),t=o.provider.createMetadata(r,n),this.pendingMetadataRequests.set(e,t);try{const l=await t;return await this.updateMetadataCore(r,l,{silent:!0}),l}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(r,e){const t=new lt(`VirtualProviderService.updateMetadata(${r.toString()})`,{},e.HEAD.sha);try{await this.metadataStore.set(this.getVirtualUri(r),e.HEAD.sha,e)}finally{t.stop()}}updateMetadataCore(r,e,t){return this.metadataStore.set(this.getVirtualUri(r),e.HEAD.sha,e,t)}async clone(r){const e=await this.getBestRemoteUri(r,et.Clone);if(!e)throw new Error("No url found for clone");if(Bn)return void h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const t=s(async n=>{try{await n.activate(),await h.commands.executeCommand("git.clone",e.toString(!0))}catch(i){$.error(i,"Unable to clone repository")}},"cloneRepository");if(h.workspace.isTrusted){const n=h.extensions.getExtension("vscode.git");if(n)await t(n);else throw new Error("Git extension not found")}else{const n=h.extensions.onDidChange(async()=>{const o=h.extensions.getExtension("vscode.git");o&&(await t(o),n.dispose())});await h.workspace.requestWorkspaceTrust()||n.dispose()}}createBranch(r,e,t,n){return this.getRepositoryProvider(r).createBranch(r,e,t,n)}createCommit(r,e,t,n){return this.getRepositoryProvider(r).createCommit(r,e,t,n)}createAndPushCommit(r,e,t,n,i){return this.getRepositoryProvider(r).createAndPushCommit(r,e,t,n,i)}createPullRequest(r,e,t,n,i){return this.getRepositoryProvider(r).createPullRequest(r,e,t,n,i)}fetch(r,e){return this.getRepositoryProvider(r).fetch(r,e)}fork(r){return this.getRepositoryProvider(r).fork(r)}getBranches(r,e){return this.getRepositoryProvider(r).getBranches(r,e)}getCommit(r,e){return this.getRepositoryProvider(r).getCommit(r,e)}getCommits(r,e){var t;return(t=this.getRepositoryProvider(r))==null?void 0:t.getCommits(r,e)}compareCommits(r,e){var t;return(t=this.getRepositoryProvider(r))==null?void 0:t.compareCommits(r,e)}getFileContent(r,e,t){return this.getRepositoryProvider(r).getFileContent(r,e,t)}getFork(r){return this.getRepositoryProvider(r).getFork(r)}async getIncomingChanges(r){var e,t,n;return(n=(t=(e=this.getRepositoryProvider(r)).getIncomingChanges)==null?void 0:t.call(e,r))!=null?n:[]}getPullRequest(r,e){return this.getRepositoryProvider(r).getPullRequest(r,e)}getTags(r,e){return this.getRepositoryProvider(r).getTags(r,e)}getSnapshots(r,e){var t,n;return(n=(t=this.getIndexProvider(r))==null?void 0:t.getSnapshots(r,e))!=null?n:Promise.resolve([])}async getTarGz(r){var e,t;return(t=(e=this.getRepositoryProvider(r)).getTarGz)==null?void 0:t.call(e,r)}pushCommit(r,e,t,n){return this.getRepositoryProvider(r).pushCommit(r,e,t,n)}switchTo(r,e,t){return this.getRepositoryProvider(r).switchTo(r,e,t)}async sync(r,e,t){const n=this._repositories.get(ne(r));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const i=this.getProvider(r);if(i===void 0)throw new er(r);let{to:o,reason:a,...l}=t!=null?t:{};return o===void 0&&i.index&&(o=await i.index.resolveIndexRef(r,a==="user")),await i.provider.sync(r,e,{conflictResolution:0,...l,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(r){return this.getFileSystemProvider(r).stat(r)}readDirectory(r){return this.getFileSystemProvider(r).readDirectory(r)}readFile(r){return this.getFileSystemProvider(r).readFile(r)}watch(r,e){return this.getFileSystemProvider(r).watch(r,e)}provideFileSearchResults(r,e,t){return this.getFileSystemProvider(e.folder).provideFileSearchResults(r,e,t)}provideTextSearchResults(r,e,t,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(r,e,t,n)}static decodeAuthority(r,e){const[t,n]=r.authority.split(yr.authoritySeparator);let i;if(n)try{const o=JSON.parse(Zn(n));i=e?e(o):o}catch{}return{scheme:t,metadata:i}}static encodeAuthority(r,e){const t=e?`${yr.authoritySeparator}${ro(JSON.stringify(e))}`:"";return`${r}${t}`}static getProviderId(r){const{authority:e}=r,t=e.indexOf(yr.authoritySeparator);return t!==-1?e.substr(0,t):e}static isCanonicalUri(r){return r.authority.indexOf(yr.authoritySeparator)===-1}},"_VirtualProviderService");let tr=yr;tr.scheme="vscode-vfs",tr.authoritySeparator="+",tr.baseVirtualWorkspaceUri=h.Uri.parse(`${yr.scheme}://`),Vs([fn()],tr.prototype,"getMetadataCore",1);function jr(){}s(jr,"Diff"),jr.prototype={diff:s(function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function a(k){return i?(setTimeout(function(){i(void 0,k)},0),!0):k}s(a,"done"),e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e)),t=this.removeEmpty(this.tokenize(t));var l=t.length,u=e.length,d=1,_=l+u,R=[{newPos:-1,components:[]}],A=this.extractCommon(R[0],t,e,0);if(R[0].newPos+1>=l&&A+1>=u)return a([{value:this.join(t),count:t.length}]);function P(){for(var k=-1*d;k<=d;k+=2){var B=void 0,U=R[k-1],H=R[k+1],re=(H?H.newPos:0)-k;U&&(R[k-1]=void 0);var Y=U&&U.newPos+1<l,he=H&&0<=re&&re<u;if(!Y&&!he){R[k]=void 0;continue}if(!Y||he&&U.newPos<H.newPos?(B=Ks(H),o.pushComponent(B.components,void 0,!0)):(B=U,B.newPos++,o.pushComponent(B.components,!0,void 0)),re=o.extractCommon(B,t,e,k),B.newPos+1>=l&&re+1>=u)return a(qa(o,B.components,t,e,o.useLongestToken));R[k]=B}d++}if(s(P,"execEditLength"),i)s(function k(){setTimeout(function(){if(d>_)return i();P()||k()},0)},"exec")();else for(;d<=_;){var M=P();if(M)return M}},"diff"),pushComponent:s(function(e,t,n){var i=e[e.length-1];i&&i.added===t&&i.removed===n?e[e.length-1]={count:i.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},"pushComponent"),extractCommon:s(function(e,t,n,i){for(var o=t.length,a=n.length,l=e.newPos,u=l-i,d=0;l+1<o&&u+1<a&&this.equals(t[l+1],n[u+1]);)l++,u++,d++;return d&&e.components.push({count:d}),e.newPos=l,u},"extractCommon"),equals:s(function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},"equals"),removeEmpty:s(function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},"removeEmpty"),castInput:s(function(e){return e},"castInput"),tokenize:s(function(e){return e.split("")},"tokenize"),join:s(function(e){return e.join("")},"join")};function qa(r,e,t,n,i){for(var o=0,a=e.length,l=0,u=0;o<a;o++){var d=e[o];if(d.removed){if(d.value=r.join(n.slice(u,u+d.count)),u+=d.count,o&&e[o-1].added){var R=e[o-1];e[o-1]=e[o],e[o]=R}}else{if(!d.added&&i){var _=t.slice(l,l+d.count);_=_.map(function(P,M){var k=n[u+M];return k.length>P.length?k:P}),d.value=r.join(_)}else d.value=r.join(t.slice(l,l+d.count));l+=d.count,d.added||(u+=d.count)}}var A=e[a-1];return a>1&&typeof A.value=="string"&&(A.added||A.removed)&&r.equals("",A.value)&&(e[a-2].value+=A.value,e.pop()),e}s(qa,"buildValues");function Ks(r){return{newPos:r.newPos,components:r.components.slice(0)}}s(Ks,"clonePath");var Qs=new jr;function gl(r,e,t){return Qs.diff(r,e,t)}s(gl,"diffChars");function za(r,e){if(typeof r=="function")e.callback=r;else if(r)for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}s(za,"generateOptions");var Nn=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,ia=/\S/,xo=new jr;xo.equals=function(r,e){return this.options.ignoreCase&&(r=r.toLowerCase(),e=e.toLowerCase()),r===e||this.options.ignoreWhitespace&&!ia.test(r)&&!ia.test(e)},xo.tokenize=function(r){for(var e=r.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<e.length-1;t++)!e[t+1]&&e[t+2]&&Nn.test(e[t])&&Nn.test(e[t+2])&&(e[t]+=e[t+2],e.splice(t+1,2),t--);return e};function ml(r,e,t){return t=za(t,{ignoreWhitespace:!0}),xo.diff(r,e,t)}s(ml,"diffWords");function vl(r,e,t){return xo.diff(r,e,t)}s(vl,"diffWordsWithSpace");var no=new jr;no.tokenize=function(r){var e=[],t=r.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var n=0;n<t.length;n++){var i=t[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Jn(r,e,t){return no.diff(r,e,t)}s(Jn,"diffLines");function yl(r,e,t){var n=za(t,{ignoreWhitespace:!0});return no.diff(r,e,n)}s(yl,"diffTrimmedLines");var Wa=new jr;Wa.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};function _l(r,e,t){return Wa.diff(r,e,t)}s(_l,"diffSentences");var Ga=new jr;Ga.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function Mn(r,e,t){return Ga.diff(r,e,t)}s(Mn,"diffCss");function mi(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mi=s(function(e){return typeof e},"_typeof"):mi=s(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),mi(r)}s(mi,"_typeof");function Fn(r){return Va(r)||ei(r)||Xs(r)||Ys()}s(Fn,"_toConsumableArray");function Va(r){if(Array.isArray(r))return oa(r)}s(Va,"_arrayWithoutHoles");function ei(r){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(r))return Array.from(r)}s(ei,"_iterableToArray");function Xs(r,e){if(!!r){if(typeof r=="string")return oa(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oa(r,e)}}s(Xs,"_unsupportedIterableToArray");function oa(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}s(oa,"_arrayLikeToArray");function Ys(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s(Ys,"_nonIterableSpread");var Zs=Object.prototype.toString,Pi=new jr;Pi.useLongestToken=!0,Pi.tokenize=no.tokenize,Pi.castInput=function(r){var e=this.options,t=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,a){return typeof a=="undefined"?t:a}:n;return typeof r=="string"?r:JSON.stringify(Oi(r,null,null,i),i,"  ")},Pi.equals=function(r,e){return jr.prototype.equals.call(Pi,r.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function wl(r,e,t){return Pi.diff(r,e,t)}s(wl,"diffJson");function Oi(r,e,t,n,i){e=e||[],t=t||[],n&&(r=n(i,r));var o;for(o=0;o<e.length;o+=1)if(e[o]===r)return t[o];var a;if(Zs.call(r)==="[object Array]"){for(e.push(r),a=new Array(r.length),t.push(a),o=0;o<r.length;o+=1)a[o]=Oi(r[o],e,t,n,i);return e.pop(),t.pop(),a}if(r&&r.toJSON&&(r=r.toJSON()),mi(r)==="object"&&r!==null){e.push(r),a={},t.push(a);var l=[],u;for(u in r)r.hasOwnProperty(u)&&l.push(u);for(l.sort(),o=0;o<l.length;o+=1)u=l[o],a[u]=Oi(r[u],e,t,n,u);e.pop(),t.pop()}else a=r;return a}s(Oi,"canonicalize");var io=new jr;io.tokenize=function(r){return r.slice()},io.join=io.removeEmpty=function(r){return r};function oo(r,e,t){return io.diff(r,e,t)}s(oo,"diffArrays");function ki(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=r.split(/\r\n|[\n\v\f\r\x85]/),n=r.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var d={};for(i.push(d);o<t.length;){var _=t[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(_))break;var R=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(_);R&&(d.index=R[1]),o++}for(l(d),l(d),d.hunks=[];o<t.length;){var A=t[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(A))break;if(/^@@/.test(A))d.hunks.push(u());else{if(A&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(A));o++}}}s(a,"parseIndex");function l(d){var _=/^(---|\+\+\+)\s+(.*)$/.exec(t[o]);if(_){var R=_[1]==="---"?"old":"new",A=_[2].split("	",2),P=A[0].replace(/\\\\/g,"\\");/^".*"$/.test(P)&&(P=P.substr(1,P.length-2)),d[R+"FileName"]=P,d[R+"Header"]=(A[1]||"").trim(),o++}}s(l,"parseFileHeader");function u(){var d=o,_=t[o++],R=_.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),A={oldStart:+R[1],oldLines:typeof R[2]=="undefined"?1:+R[2],newStart:+R[3],newLines:typeof R[4]=="undefined"?1:+R[4],lines:[],linedelimiters:[]};A.oldLines===0&&(A.oldStart+=1),A.newLines===0&&(A.newStart+=1);for(var P=0,M=0;o<t.length&&!(t[o].indexOf("--- ")===0&&o+2<t.length&&t[o+1].indexOf("+++ ")===0&&t[o+2].indexOf("@@")===0);o++){var k=t[o].length==0&&o!=t.length-1?" ":t[o][0];if(k==="+"||k==="-"||k===" "||k==="\\")A.lines.push(t[o]),A.linedelimiters.push(n[o]||`
`),k==="+"?P++:k==="-"?M++:k===" "&&(P++,M++);else break}if(!P&&A.newLines===1&&(A.newLines=0),!M&&A.oldLines===1&&(A.oldLines=0),e.strict){if(P!==A.newLines)throw new Error("Added line count did not match for hunk at line "+(d+1));if(M!==A.oldLines)throw new Error("Removed line count did not match for hunk at line "+(d+1))}return A}for(s(u,"parseHunk");o<t.length;)a();return i}s(ki,"parsePatch");function Ka(r,e,t){var n=!0,i=!1,o=!1,a=1;return s(function l(){if(n&&!o){if(i?a++:n=!1,r+a<=t)return a;o=!0}if(!i)return o||(n=!0),e<=r-a?-a++:(i=!0,l())},"iterator")}s(Ka,"distanceIterator");function To(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=ki(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=r.split(/\r\n|[\n\v\f\r\x85]/),i=r.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=t.compareLine||function(Wn,Xn,Ai,Ri){return Xn===Ri},l=0,u=t.fuzzFactor||0,d=0,_=0,R,A;function P(Wn,Xn){for(var Ai=0;Ai<Wn.lines.length;Ai++){var Ri=Wn.lines[Ai],js=Ri.length>0?Ri[0]:" ",xu=Ri.length>0?Ri.substr(1):Ri;if(js===" "||js==="-"){if(!a(Xn+1,n[Xn],js,xu)&&(l++,l>u))return!1;Xn++}}return!0}s(P,"hunkFits");for(var M=0;M<o.length;M++){for(var k=o[M],B=n.length-k.oldLines,U=0,H=_+k.oldStart-1,re=Ka(H,d,B);U!==void 0;U=re())if(P(k,H+U)){k.offset=_+=U;break}if(U===void 0)return!1;d=k.offset+k.oldStart+k.oldLines}for(var Y=0,he=0;he<o.length;he++){var De=o[he],Ie=De.oldStart+De.offset+Y-1;Y+=De.newLines-De.oldLines;for(var Ae=0;Ae<De.lines.length;Ae++){var Ye=De.lines[Ae],Pe=Ye.length>0?Ye[0]:" ",qe=Ye.length>0?Ye.substr(1):Ye,rt=De.linedelimiters[Ae];if(Pe===" ")Ie++;else if(Pe==="-")n.splice(Ie,1),i.splice(Ie,1);else if(Pe==="+")n.splice(Ie,0,qe),i.splice(Ie,0,rt),Ie++;else if(Pe==="\\"){var Nt=De.lines[Ae-1]?De.lines[Ae-1][0]:null;Nt==="+"?R=!0:Nt==="-"&&(A=!0)}}}if(R)for(;!n[n.length-1];)n.pop(),i.pop();else A&&(n.push(""),i.push(`
`));for(var cn=0;cn<n.length-1;cn++)n[cn]=n[cn]+i[cn];return n.join("")}s(To,"applyPatch");function bl(r,e){typeof r=="string"&&(r=ki(r));var t=0;function n(){var i=r[t++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var l=To(a,i,e);e.patched(i,l,function(u){if(u)return e.complete(u);n()})})}s(n,"processIndex"),n()}s(bl,"applyPatches");function aa(r,e,t,n,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var l=Jn(t,n,a);l.push({value:"",lines:[]});function u(U){return U.map(function(H){return" "+H})}s(u,"contextLines");for(var d=[],_=0,R=0,A=[],P=1,M=1,k=s(function(H){var re=l[H],Y=re.lines||re.value.replace(/\n$/,"").split(`
`);if(re.lines=Y,re.added||re.removed){var he;if(!_){var De=l[H-1];_=P,R=M,De&&(A=a.context>0?u(De.lines.slice(-a.context)):[],_-=A.length,R-=A.length)}(he=A).push.apply(he,Fn(Y.map(function(cn){return(re.added?"+":"-")+cn}))),re.added?M+=Y.length:P+=Y.length}else{if(_)if(Y.length<=a.context*2&&H<l.length-2){var Ie;(Ie=A).push.apply(Ie,Fn(u(Y)))}else{var Ae,Ye=Math.min(Y.length,a.context);(Ae=A).push.apply(Ae,Fn(u(Y.slice(0,Ye))));var Pe={oldStart:_,oldLines:P-_+Ye,newStart:R,newLines:M-R+Ye,lines:A};if(H>=l.length-2&&Y.length<=a.context){var qe=/\n$/.test(t),rt=/\n$/.test(n),Nt=Y.length==0&&A.length>Pe.oldLines;!qe&&Nt&&t.length>0&&A.splice(Pe.oldLines,0,"\\ No newline at end of file"),(!qe&&!Nt||!rt)&&A.push("\\ No newline at end of file")}d.push(Pe),_=0,R=0,A=[]}P+=Y.length,M+=Y.length}},"_loop"),B=0;B<l.length;B++)k(B);return{oldFileName:r,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}s(aa,"structuredPatch");function Js(r){var e=[];r.oldFileName==r.newFileName&&e.push("Index: "+r.oldFileName),e.push("==================================================================="),e.push("--- "+r.oldFileName+(typeof r.oldHeader=="undefined"?"":"	"+r.oldHeader)),e.push("+++ "+r.newFileName+(typeof r.newHeader=="undefined"?"":"	"+r.newHeader));for(var t=0;t<r.hunks.length;t++){var n=r.hunks[t];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}s(Js,"formatPatch");function Qa(r,e,t,n,i,o,a){return Js(aa(r,e,t,n,i,o,a))}s(Qa,"createTwoFilesPatch");function ec(r,e,t,n,i,o){return Qa(r,r,e,t,n,i,o)}s(ec,"createPatch");function tc(r,e){return r.length!==e.length?!1:ao(r,e)}s(tc,"arrayEqual");function ao(r,e){if(e.length>r.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==r[t])return!1;return!0}s(ao,"arrayStartsWith");function Ao(r){var e=Io(r.lines),t=e.oldLines,n=e.newLines;t!==void 0?r.oldLines=t:delete r.oldLines,n!==void 0?r.newLines=n:delete r.newLines}s(Ao,"calcLineCount");function so(r,e,t){r=Xa(r,t),e=Xa(e,t);var n={};(r.index||e.index)&&(n.index=r.index||e.index),(r.newFileName||e.newFileName)&&(Ya(r)?Ya(e)?(n.oldFileName=xn(n,r.oldFileName,e.oldFileName),n.newFileName=xn(n,r.newFileName,e.newFileName),n.oldHeader=xn(n,r.oldHeader,e.oldHeader),n.newHeader=xn(n,r.newHeader,e.newHeader)):(n.oldFileName=r.oldFileName,n.newFileName=r.newFileName,n.oldHeader=r.oldHeader,n.newHeader=r.newHeader):(n.oldFileName=e.oldFileName||r.oldFileName,n.newFileName=e.newFileName||r.newFileName,n.oldHeader=e.oldHeader||r.oldHeader,n.newHeader=e.newHeader||r.newHeader)),n.hunks=[];for(var i=0,o=0,a=0,l=0;i<r.hunks.length||o<e.hunks.length;){var u=r.hunks[i]||{oldStart:1/0},d=e.hunks[o]||{oldStart:1/0};if(Za(u,d))n.hunks.push(Ja(u,a)),i++,l+=u.newLines-u.oldLines;else if(Za(d,u))n.hunks.push(Ja(d,l)),o++,a+=d.newLines-d.oldLines;else{var _={oldStart:Math.min(u.oldStart,d.oldStart),oldLines:0,newStart:Math.min(u.newStart+a,d.oldStart+l),newLines:0,lines:[]};rc(_,u.oldStart,u.lines,d.oldStart,d.lines),o++,i++,n.hunks.push(_)}}return n}s(so,"merge");function Xa(r,e){if(typeof r=="string"){if(/^@@/m.test(r)||/^Index:/m.test(r))return ki(r)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return aa(void 0,void 0,e,r)}return r}s(Xa,"loadPatch");function Ya(r){return r.newFileName&&r.newFileName!==r.oldFileName}s(Ya,"fileNameChanged");function xn(r,e,t){return e===t?e:(r.conflict=!0,{mine:e,theirs:t})}s(xn,"selectField");function Za(r,e){return r.oldStart<e.oldStart&&r.oldStart+r.oldLines<e.oldStart}s(Za,"hunkBefore");function Ja(r,e){return{oldStart:r.oldStart,oldLines:r.oldLines,newStart:r.newStart+e,newLines:r.newLines,lines:r.lines}}s(Ja,"cloneHunk");function rc(r,e,t,n,i){var o={offset:e,lines:t,index:0},a={offset:n,lines:i,index:0};for(ca(r,o,a),ca(r,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var l=o.lines[o.index],u=a.lines[a.index];if((l[0]==="-"||l[0]==="+")&&(u[0]==="-"||u[0]==="+"))nc(r,o,a);else if(l[0]==="+"&&u[0]===" "){var d;(d=r.lines).push.apply(d,Fn(Ln(o)))}else if(u[0]==="+"&&l[0]===" "){var _;(_=r.lines).push.apply(_,Fn(Ln(a)))}else l[0]==="-"&&u[0]===" "?sa(r,o,a):u[0]==="-"&&l[0]===" "?sa(r,a,o,!0):l===u?(r.lines.push(l),o.index++,a.index++):Gn(r,Ln(o),Ln(a))}es(r,o),es(r,a),Ao(r)}s(rc,"mergeLines");function nc(r,e,t){var n=Ln(e),i=Ln(t);if(Ro(n)&&Ro(i)){if(ao(n,i)&&ts(t,n,n.length-i.length)){var o;(o=r.lines).push.apply(o,Fn(n));return}else if(ao(i,n)&&ts(e,i,i.length-n.length)){var a;(a=r.lines).push.apply(a,Fn(i));return}}else if(tc(n,i)){var l;(l=r.lines).push.apply(l,Fn(n));return}Gn(r,n,i)}s(nc,"mutualChange");function sa(r,e,t,n){var i=Ln(e),o=ic(t,i);if(o.merged){var a;(a=r.lines).push.apply(a,Fn(o.merged))}else Gn(r,n?o:i,n?i:o)}s(sa,"removal");function Gn(r,e,t){r.conflict=!0,r.lines.push({conflict:!0,mine:e,theirs:t})}s(Gn,"conflict");function ca(r,e,t){for(;e.offset<t.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];r.lines.push(n),e.offset++}}s(ca,"insertLeading");function es(r,e){for(;e.index<e.lines.length;){var t=e.lines[e.index++];r.lines.push(t)}}s(es,"insertTrailing");function Ln(r){for(var e=[],t=r.lines[r.index][0];r.index<r.lines.length;){var n=r.lines[r.index];if(t==="-"&&n[0]==="+"&&(t="+"),t===n[0])e.push(n),r.index++;else break}return e}s(Ln,"collectChange");function ic(r,e){for(var t=[],n=[],i=0,o=!1,a=!1;i<e.length&&r.index<r.lines.length;){var l=r.lines[r.index],u=e[i];if(u[0]==="+")break;if(o=o||l[0]!==" ",n.push(u),i++,l[0]==="+")for(a=!0;l[0]==="+";)t.push(l),l=r.lines[++r.index];u.substr(1)===l.substr(1)?(t.push(l),r.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return t;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:t}}s(ic,"collectContext");function Ro(r){return r.reduce(function(e,t){return e&&t[0]==="-"},!0)}s(Ro,"allRemoves");function ts(r,e,t){for(var n=0;n<t;n++){var i=e[e.length-t+n].substr(1);if(r.lines[r.index+n]!==" "+i)return!1}return r.index+=t,!0}s(ts,"skipRemoveSuperset");function Io(r){var e=0,t=0;return r.forEach(function(n){if(typeof n!="string"){var i=Io(n.mine),o=Io(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),t!==void 0&&(i.newLines===o.newLines?t+=i.newLines:t=void 0)}else t!==void 0&&(n[0]==="+"||n[0]===" ")&&t++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:t}}s(Io,"calcOldNewLineCount");function oc(r){for(var e=[],t,n,i=0;i<r.length;i++)t=r[i],t.added?n=1:t.removed?n=-1:n=0,e.push([n,t.value]);return e}s(oc,"convertChangesToDMP");function ac(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(co(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}s(ac,"convertChangesToXML");function co(r){var e=r;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}s(co,"escapeHTML");var la=/[^a-zA-Z0-9]/,Do=/\s/,Ni=/[\r\n]/,pn=/\n\r?\n$/,ee=/^\r?\n\r?\n/,J;(function(r){r[r.DIFF_DELETE=-1]="DIFF_DELETE",r[r.DIFF_INSERT=1]="DIFF_INSERT",r[r.DIFF_EQUAL=0]="DIFF_EQUAL"})(J||(J={}));function Ve(r,e){return r<e?r:e}s(Ve,"min");function pt(r,e){return r>e?r:e}s(pt,"max");var zt=ae,kt=function(){function r(){this.diffs=[],this.start1=0,this.start2=0,this.length1=0,this.length2=0}return s(r,"PatchObject"),r.prototype.toString=function(){var e,t;this.length1===0?e=this.start1+",0":this.length1===1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?t=this.start2+",0":this.length2===1?t=this.start2+1:t=this.start2+1+","+this.length2;for(var n=["@@ -"+e+" +"+t+` @@
`],i,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case J.DIFF_INSERT:i="+";break;case J.DIFF_DELETE:i="-";break;case J.DIFF_EQUAL:i=" ";break}n[o+1]=i+encodeURI(this.diffs[o][1])+`
`}return n.join("").replace(/%20/g," ")},r}(),vr=function(){function r(){this.diffTimeout=1,this.diffEditCost=4,this.matchThreshold=.5,this.matchDistance=1e3,this.patchDeleteThreshold=.5,this.patchMargin=4,this.matchMaxBits=32}return s(r,"DiffMatchPatch"),r.prototype.diff_main=function(e,t,n,i){typeof i=="undefined"&&(this.diffTimeout<=0?i=Number.MAX_VALUE:i=Date.now()+this.diffTimeout*1e3);var o=i;if(e==null||t==null)throw new Error("Null input. (diff_main)");if(e===t)return e?[[J.DIFF_EQUAL,e]]:[];typeof n=="undefined"&&(n=!0);var a=n,l=this.diff_commonPrefix(e,t),u=e.substring(0,l);e=e.substring(l),t=t.substring(l),l=this.diff_commonSuffix(e,t);var d=e.substring(e.length-l);e=e.substring(0,e.length-l),t=t.substring(0,t.length-l);var _=this.diff_compute_(e,t,a,o);return u&&_.unshift([J.DIFF_EQUAL,u]),d&&_.push([J.DIFF_EQUAL,d]),this.diff_cleanupMerge(_),_},r.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,i=zt.min(e.length,t.length),o=i,a=0;n<o;)e.substring(a,o)===t.substring(a,o)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},r.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!==t.charAt(t.length-1))return 0;for(var n=0,i=zt.min(e.length,t.length),o=i,a=0;n<o;)e.substring(e.length-o,e.length-a)===t.substring(t.length-o,t.length-a)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},r.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],i=0,o=null,a=0,l=0,u=0,d=0,_=0;a<e.length;)e[a][0]===J.DIFF_EQUAL?(n[i++]=a,l=d,u=_,d=0,_=0,o=e[a][1]):(e[a][0]===J.DIFF_INSERT?d+=e[a][1].length:_+=e[a][1].length,o&&o.length<=zt.max(l,u)&&o.length<=zt.max(d,_)&&(e.splice(n[i-1],0,[J.DIFF_DELETE,o]),e[n[i-1]+1][0]=J.DIFF_INSERT,i--,i--,a=i>0?n[i-1]:-1,l=0,u=0,d=0,_=0,o=null,t=!0)),a++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]===J.DIFF_DELETE&&e[a][0]===J.DIFF_INSERT){var R=e[a-1][1],A=e[a][1],P=this.diff_commonOverlap_(R,A),M=this.diff_commonOverlap_(A,R);P>=M?(P>=R.length/2||P>=A.length/2)&&(e.splice(a,0,[J.DIFF_EQUAL,A.substring(0,P)]),e[a-1][1]=R.substring(0,R.length-P),e[a+1][1]=A.substring(P),a++):(M>=R.length/2||M>=A.length/2)&&(e.splice(a,0,[J.DIFF_EQUAL,R.substring(0,M)]),e[a-1][0]=J.DIFF_INSERT,e[a-1][1]=A.substring(0,A.length-M),e[a+1][0]=J.DIFF_DELETE,e[a+1][1]=R.substring(M),a++),a++}a++}},r.prototype.diff_cleanupSemanticLossless=function(e){for(var t=1;t<e.length-1;){if(e[t-1][0]===J.DIFF_EQUAL&&e[t+1][0]===J.DIFF_EQUAL){var n=e[t-1][1],i=e[t][1],o=e[t+1][1],a=this.diff_commonSuffix(n,i);if(a){var l=i.substring(i.length-a);n=n.substring(0,n.length-a),i=l+i.substring(0,i.length-a),o=l+o}for(var u=n,d=i,_=o,R=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);i.charAt(0)===o.charAt(0);){n+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var A=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);A>=R&&(R=A,u=n,d=i,_=o)}e[t-1][1]!==u&&(u?e[t-1][1]=u:(e.splice(t-1,1),t--),e[t][1]=d,_?e[t+1][1]=_:(e.splice(t+1,1),t--))}t++}},r.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],i=0,o=null,a=0,l=!1,u=!1,d=!1,_=!1;a<e.length;)e[a][0]===J.DIFF_EQUAL?(e[a][1].length<this.diffEditCost&&(d||_)?(n[i++]=a,l=d,u=_,o=e[a][1]):(i=0,o=null),d=_=!1):(e[a][0]===J.DIFF_DELETE?_=!0:d=!0,o&&(l&&u&&d&&_||o.length<this.diffEditCost/2&&Number(l)+Number(u)+Number(d)+Number(_)===3)&&(e.splice(n[i-1],0,[J.DIFF_DELETE,o]),e[n[i-1]+1][0]=J.DIFF_INSERT,i--,o=null,l&&u?(d=_=!0,i=0):(i--,a=i>0?n[i-1]:-1,d=_=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},r.prototype.diff_cleanupMerge=function(e){e.push([J.DIFF_EQUAL,""]);for(var t=0,n=0,i=0,o="",a="",l;t<e.length;)switch(e[t][0]){case J.DIFF_INSERT:i++,a+=e[t][1],t++;break;case J.DIFF_DELETE:n++,o+=e[t][1],t++;break;case J.DIFF_EQUAL:n+i>1?(n!==0&&i!==0&&(l=this.diff_commonPrefix(a,o),l!==0&&(t-n-i>0&&e[t-n-i-1][0]===J.DIFF_EQUAL?e[t-n-i-1][1]+=a.substring(0,l):(e.splice(0,0,[J.DIFF_EQUAL,a.substring(0,l)]),t++),a=a.substring(l),o=o.substring(l)),l=this.diff_commonSuffix(a,o),l!==0&&(e[t][1]=a.substring(a.length-l)+e[t][1],a=a.substring(0,a.length-l),o=o.substring(0,o.length-l))),t-=n+i,e.splice(t,n+i),o.length&&(e.splice(t,0,[J.DIFF_DELETE,o]),t++),a.length&&(e.splice(t,0,[J.DIFF_INSERT,a]),t++),t++):t!==0&&e[t-1][0]===J.DIFF_EQUAL?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++,i=0,n=0,o="",a="";break}e[e.length-1][1]===""&&e.pop();var u=!1;for(t=1;t<e.length-1;)e[t-1][0]===J.DIFF_EQUAL&&e[t+1][0]===J.DIFF_EQUAL&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)===e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),u=!0):e[t][1].substring(0,e[t+1][1].length)===e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),u=!0)),t++;u&&this.diff_cleanupMerge(e)},r.prototype.diff_xIndex=function(e,t){var n=0,i=0,o=0,a=0,l;for(l=0;l<e.length&&(e[l][0]!==J.DIFF_INSERT&&(n+=e[l][1].length),e[l][0]!==J.DIFF_DELETE&&(i+=e[l][1].length),!(n>t));l++)o=n,a=i;return e.length!==l&&e[l][0]===J.DIFF_DELETE?a:a+(t-o)},r.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,o=/>/g,a=/\n/g,l=0;l<e.length;l++){var u=e[l][0],d=e[l][1],_=d.replace(n,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(u){case J.DIFF_INSERT:t[l]='<ins style="background:#e6ffe6;">'+_+"</ins>";break;case J.DIFF_DELETE:t[l]='<del style="background:#ffe6e6;">'+_+"</del>";break;case J.DIFF_EQUAL:t[l]="<span>"+_+"</span>";break}}return t.join("")},r.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==J.DIFF_INSERT&&(t[n]=e[n][1]);return t.join("")},r.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==J.DIFF_DELETE&&(t[n]=e[n][1]);return t.join("")},r.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,o=0;o<e.length;o++){var a=e[o][0],l=e[o][1];switch(a){case J.DIFF_INSERT:n+=l.length;break;case J.DIFF_DELETE:i+=l.length;break;case J.DIFF_EQUAL:t+=zt.max(n,i),n=0,i=0;break}}return t+=zt.max(n,i),t},r.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case J.DIFF_INSERT:t[n]="+"+encodeURI(e[n][1]);break;case J.DIFF_DELETE:t[n]="-"+e[n][1].length;break;case J.DIFF_EQUAL:t[n]="="+e[n][1].length;break}return t.join("	").replace(/%20/g," ")},r.prototype.diff_fromDelta=function(e,t){for(var n=[],i=0,o=0,a=t.split(/\t/g),l=0;l<a.length;l++){var u=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{n[i++]=[J.DIFF_INSERT,decodeURI(u)]}catch(R){throw new Error("Illegal escape in diff_fromDelta: "+u)}break;case"-":case"=":var d=parseInt(u,10);if(isNaN(d)||d<0)throw new Error("Invalid number in diff_fromDelta: "+u);var _=e.substring(o,o+=d);a[l].charAt(0)==="="?n[i++]=[J.DIFF_EQUAL,_]:n[i++]=[J.DIFF_DELETE,_];break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(o!==e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+")");return n},r.prototype.diff_linesToChars=function(e,t){var n=[],i={};n[0]="";var o=this.diff_linesToCharsMunge_(e,n,i,4e4),a=this.diff_linesToCharsMunge_(t,n,i,65535);return{chars1:o,chars2:a,lineArray:n}},r.prototype.diff_charsToLines=function(e,t){for(var n=0;n<e.length;n++){for(var i=e[n][1],o=[],a=0;a<i.length;a++)o[a]=t[i.charCodeAt(a)];e[n][1]=o.join("")}},r.prototype.match_main=function(e,t,n){if(e==null||t==null||n==null)throw new Error("Null input. (match_main)");return n=zt.max(0,zt.min(n,e.length)),e===t?0:e.length?e.substring(n,n+t.length)===t?n:this.match_bitap_(e,t,n):-1},r.prototype.patch_make=function(e,t,n){var i,o;if(typeof e=="string"&&typeof t=="string"&&typeof n=="undefined")i=e,o=this.diff_main(i,t,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&typeof e=="object"&&typeof t=="undefined"&&typeof n=="undefined")o=e,i=this.diff_text1(o);else if(typeof e=="string"&&t&&typeof t=="object"&&typeof n=="undefined")i=e,o=t;else if(typeof e=="string"&&typeof t=="string"&&n&&typeof n=="object")i=e,o=n;else throw new Error("Unknown call format to patch_make");if(o.length===0)return[];for(var a=[],l=new kt,u=0,d=0,_=0,R=i,A=i,P=0;P<o.length;P++){var M=o[P][0],k=o[P][1];switch(!u&&M!==J.DIFF_EQUAL&&(l.start1=d,l.start2=_),M){case J.DIFF_INSERT:l.diffs[u++]=o[P],l.length2+=k.length,A=A.substring(0,_)+k+A.substring(_);break;case J.DIFF_DELETE:l.length1+=k.length,l.diffs[u++]=o[P],A=A.substring(0,_)+A.substring(_+k.length);break;case J.DIFF_EQUAL:k.length<=2*this.patchMargin&&u&&o.length!==P+1?(l.diffs[u++]=o[P],l.length1+=k.length,l.length2+=k.length):k.length>=2*this.patchMargin&&u&&(this.patch_addContext_(l,R),a.push(l),l=new kt,u=0,R=A,d=_);break}M!==J.DIFF_INSERT&&(d+=k.length),M!==J.DIFF_DELETE&&(_+=k.length)}return u&&(this.patch_addContext_(l,R),a.push(l)),a},r.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){for(var i=e[n],o=new kt,a=0;a<i.diffs.length;a++)o.diffs[a]=[i.diffs[a][0],i.diffs[a][1]];o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[n]=o}return t},r.prototype.patch_apply=function(e,t){if(e.length===0)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var l=e[a].start2+i,u=this.diff_text1(e[a].diffs),d=void 0,_=-1;if(u.length>this.matchMaxBits?(d=this.match_main(t,u.substring(0,this.matchMaxBits),l),d!==-1&&(_=this.match_main(t,u.substring(u.length-this.matchMaxBits),l+u.length-this.matchMaxBits),(_===-1||d>=_)&&(d=-1))):d=this.match_main(t,u,l),d===-1)o[a]=!1,i-=e[a].length2-e[a].length1;else{o[a]=!0,i=d-l;var R=void 0;if(_===-1?R=t.substring(d,d+u.length):R=t.substring(d,_+this.matchMaxBits),u===R)t=t.substring(0,d)+this.diff_text2(e[a].diffs)+t.substring(d+u.length);else{var A=this.diff_main(u,R,!1);if(u.length>this.matchMaxBits&&this.diff_levenshtein(A)/u.length>this.patchDeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(A);for(var P=0,M=0,k=0;k<e[a].diffs.length;k++){var B=e[a].diffs[k];B[0]!==J.DIFF_EQUAL&&(M=this.diff_xIndex(A,P)),B[0]===J.DIFF_INSERT?t=t.substring(0,d+M)+B[1]+t.substring(d+M):B[0]===J.DIFF_DELETE&&(t=t.substring(0,d+M)+t.substring(d+this.diff_xIndex(A,P+B[1].length))),B[0]!==J.DIFF_DELETE&&(P+=B[1].length)}}}}}return t=t.substring(n.length,t.length-n.length),[t,o]},r.prototype.patch_addPadding=function(e){for(var t=this.patchMargin,n="",i=1;i<=t;i++)n+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var o=e[0],a=o.diffs;if(a.length===0||a[0][0]!==J.DIFF_EQUAL)a.unshift([J.DIFF_EQUAL,n]),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>a[0][1].length){var l=t-a[0][1].length;a[0][1]=n.substring(a[0][1].length)+a[0][1],o.start1-=l,o.start2-=l,o.length1+=l,o.length2+=l}if(o=e[e.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==J.DIFF_EQUAL)a.push([J.DIFF_EQUAL,n]),o.length1+=t,o.length2+=t;else if(t>a[a.length-1][1].length){var l=t-a[a.length-1][1].length;a[a.length-1][1]+=n.substring(0,l),o.length1+=l,o.length2+=l}return n},r.prototype.patch_splitMax=function(e){for(var t=this.matchMaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var i=e[n];e.splice(n--,1);for(var o=i.start1,a=i.start2,l="";i.diffs.length!==0;){var u=new kt,d=!0;for(u.start1=o-l.length,u.start2=a-l.length,l!==""&&(u.length1=u.length2=l.length,u.diffs.push([J.DIFF_EQUAL,l]));i.diffs.length!==0&&u.length1<t-this.patchMargin;){var _=i.diffs[0][0],R=i.diffs[0][1];_===J.DIFF_INSERT?(u.length2+=R.length,a+=R.length,u.diffs.push(i.diffs.shift()),d=!1):_===J.DIFF_DELETE&&u.diffs.length===1&&u.diffs[0][0]===J.DIFF_EQUAL&&R.length>2*t?(u.length1+=R.length,o+=R.length,d=!1,u.diffs.push([_,R]),i.diffs.shift()):(R=R.substring(0,t-u.length1-this.patchMargin),u.length1+=R.length,o+=R.length,_===J.DIFF_EQUAL?(u.length2+=R.length,a+=R.length):d=!1,u.diffs.push([_,R]),R===i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(R.length))}l=this.diff_text2(u.diffs),l=l.substring(l.length-this.patchMargin);var A=this.diff_text1(i.diffs).substring(0,this.patchMargin);A!==""&&(u.length1+=A.length,u.length2+=A.length,u.diffs.length!==0&&u.diffs[u.diffs.length-1][0]===J.DIFF_EQUAL?u.diffs[u.diffs.length-1][1]+=A:u.diffs.push([J.DIFF_EQUAL,A])),d||e.splice(++n,0,u)}}},r.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},r.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split(`
`),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var a=n[i].match(o);if(!a)throw new Error("Invalid patch string: "+n[i]);var l=new kt;t.push(l),l.start1=parseInt(a[1],10),a[2]===""?(l.start1--,l.length1=1):a[2]==="0"?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),a[4]===""?(l.start2--,l.length2=1):a[4]==="0"?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),i++;for(var u=void 0,d=void 0,_=void 0;i<n.length;){u=n[i].charAt(0),_=n[i].substring(1);try{d=decodeURI(_)}catch(R){throw new Error("Illegal escape in patch_fromText: "+_)}if(u==="-")l.diffs.push([J.DIFF_DELETE,d]);else if(u==="+")l.diffs.push([J.DIFF_INSERT,d]);else if(u===" ")l.diffs.push([J.DIFF_EQUAL,d]);else{if(u==="@")break;if(u!=="")throw new Error('Invalid patch mode "'+u+'" in: '+d)}i++}}return t},r.prototype.diff_compute_=function(e,t,n,i){var o;if(!e)return[[J.DIFF_INSERT,t]];if(!t)return[[J.DIFF_DELETE,e]];var a=e.length>t.length?e:t,l=e.length>t.length?t:e,u=a.indexOf(l);if(u!==-1)return o=[[J.DIFF_INSERT,a.substring(0,u)],[J.DIFF_EQUAL,l],[J.DIFF_INSERT,a.substring(u+l.length)]],e.length>t.length&&(o[0][0]=J.DIFF_DELETE,o[2][0]=J.DIFF_DELETE),o;if(l.length===1)return[[J.DIFF_DELETE,e],[J.DIFF_INSERT,t]];var d=this.diff_halfMatch_(e,t);if(d){var _=d[0],R=d[1],A=d[2],P=d[3],M=d[4],k=this.diff_main(_,A,n,i),B=this.diff_main(R,P,n,i);return k.concat([[J.DIFF_EQUAL,M]],B)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,i):this.diff_bisect_(e,t,i)},r.prototype.diff_lineMode_=function(e,t,n){var i=this.diff_linesToChars(e,t);e=i.chars1,t=i.chars2;var o=i.lineArray,a=this.diff_main(e,t,!1,n);this.diff_charsToLines(a,o),this.diff_cleanupSemantic(a),a.push([J.DIFF_EQUAL,""]);for(var l=0,u=0,d=0,_="",R="";l<a.length;){switch(a[l][0]){case J.DIFF_INSERT:d++,R+=a[l][1];break;case J.DIFF_DELETE:u++,_+=a[l][1];break;case J.DIFF_EQUAL:if(u>=1&&d>=1){a.splice(l-u-d,u+d),l=l-u-d;for(var A=this.diff_main(_,R,!1,n),P=A.length-1;P>=0;P--)a.splice(l,0,A[P]);l=l+A.length}d=0,u=0,_="",R="";break}l++}return a.pop(),a},r.prototype.diff_bisect_=function(e,t,n){for(var i=e.length,o=t.length,a=Math.ceil((i+o)/2),l=a,u=2*a,d=new Array(u),_=new Array(u),R=0;R<u;R++)d[R]=-1,_[R]=-1;d[l+1]=0,_[l+1]=0;for(var A=i-o,P=A%2!=0,M=0,k=0,B=0,U=0,H=0;H<a&&!(Date.now()>n);H++){for(var re=-H+M;re<=H-k;re+=2){var Y=l+re,he=void 0;re===-H||re!==H&&d[Y-1]<d[Y+1]?he=d[Y+1]:he=d[Y-1]+1;for(var De=he-re;he<i&&De<o&&e.charAt(he)===t.charAt(De);)he++,De++;if(d[Y]=he,he>i)k+=2;else if(De>o)M+=2;else if(P){var Ie=l+A-re;if(Ie>=0&&Ie<u&&_[Ie]!==-1){var Ae=i-_[Ie];if(he>=Ae)return this.diff_bisectSplit_(e,t,he,De,n)}}}for(var Ye=-H+B;Ye<=H-U;Ye+=2){var Ie=l+Ye,Ae=void 0;Ye===-H||Ye!==H&&_[Ie-1]<_[Ie+1]?Ae=_[Ie+1]:Ae=_[Ie-1]+1;for(var Pe=Ae-Ye;Ae<i&&Pe<o&&e.charAt(i-Ae-1)===t.charAt(o-Pe-1);)Ae++,Pe++;if(_[Ie]=Ae,Ae>i)U+=2;else if(Pe>o)B+=2;else if(!P){var Y=l+A-Ye;if(Y>=0&&Y<u&&d[Y]!==-1){var he=d[Y],De=l+he-Y;if(Ae=i-Ae,he>=Ae)return this.diff_bisectSplit_(e,t,he,De,n)}}}}return[[J.DIFF_DELETE,e],[J.DIFF_INSERT,t]]},r.prototype.diff_bisectSplit_=function(e,t,n,i,o){var a=e.substring(0,n),l=t.substring(0,i),u=e.substring(n),d=t.substring(i),_=this.diff_main(a,l,!1,o),R=this.diff_main(u,d,!1,o);return _.concat(R)},r.prototype.diff_linesToCharsMunge_=function(e,t,n,i){for(var o="",a=0,l=-1,u=t.length;l<e.length-1;){l=e.indexOf(`
`,a),l===-1&&(l=e.length-1);var d=e.substring(a,l+1);(n.hasOwnProperty?n.hasOwnProperty(d):n[d]!==void 0)?o+=String.fromCharCode(n[d]):(u===i&&(d=e.substring(a),l=e.length),o+=String.fromCharCode(u),n[d]=u,t[u++]=d),a=l+1}return o},r.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(n===0||i===0)return 0;n>i?e=e.substring(n-i):n<i&&(t=t.substring(0,n));var o=zt.min(n,i);if(e===t)return o;for(var a=0,l=1;;){var u=e.substring(o-l),d=t.indexOf(u);if(d===-1)return a;l+=d,(d===0||e.substring(o-l)===t.substring(0,l))&&(a=l,l++)}},r.prototype.diff_halfMatch_=function(e,t){if(this.diffTimeout<=0)return null;var n=e.length>t.length?e:t,i=e.length>t.length?t:e;if(n.length<4||i.length*2<n.length)return null;var o=this.diff_halfMatchI_(n,i,Math.ceil(n.length/4)),a=this.diff_halfMatchI_(n,i,Math.ceil(n.length/2)),l;if(!o&&!a)return null;a?o?l=o[4].length>a[4].length?o:a:l=a:l=o;var u,d,_,R,A=l[4];return e.length>t.length?(u=l[0],d=l[1],_=l[2],R=l[3]):(_=l[0],R=l[1],u=l[2],d=l[3]),[u,d,_,R,A]},r.prototype.diff_halfMatchI_=function(e,t,n){for(var i=e.substring(n,n+Math.floor(e.length/4)),o="",a,l,u,d,_=t.indexOf(i,0);_!==-1;){var R=this.diff_commonPrefix(e.substring(n),t.substring(_)),A=this.diff_commonSuffix(e.substring(0,n),t.substring(0,_));o.length<A+R&&(o=t.substring(_-A,_)+t.substring(_,_+R),a=e.substring(0,n-A),l=e.substring(n+R),u=t.substring(0,_-A),d=t.substring(_+R)),_=t.indexOf(i,_+1)}return o.length*2>=e.length?[a,l,u,d,o]:null},r.prototype.diff_cleanupSemanticScore_=function(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),i=t.charAt(0),o=n.match(la),a=i.match(la),l=o&&n.match(Do),u=a&&i.match(Do),d=l&&n.match(Ni),_=u&&i.match(Ni),R=d&&e.match(pn),A=_&&t.match(ee);return R||A?5:d||_?4:o&&!l&&u?3:l||u?2:o||a?1:0},r.prototype.match_bitap_=function(e,t,n){if(t.length>this.matchMaxBits)throw new Error("Pattern too long for this browser");var i=this.match_alphabet_(t),o=this.matchThreshold,a=e.indexOf(t,n);a!==-1&&(o=zt.min(this.match_bitapScore_(0,a,t,n),o),a=e.lastIndexOf(t,n+t.length),a!==-1&&(o=zt.min(this.match_bitapScore_(0,a,t,n),o)));var l=1<<t.length-1;a=-1;for(var u,d,_=t.length+e.length,R,A=0;A<t.length;A++){for(u=0,d=_;u<d;)this.match_bitapScore_(A,n+d,t,n)<=o?u=d:_=d,d=Math.floor((_-u)/2+u);_=d;var P=zt.max(1,n-d+1),M=zt.min(n+d,e.length)+t.length,k=Array(M+2);k[M+1]=(1<<A)-1;for(var B=M;B>=P;B--){var U=i[e.charAt(B-1)];if(A===0?k[B]=(k[B+1]<<1|1)&U:k[B]=(k[B+1]<<1|1)&U|((R[B+1]|R[B])<<1|1)|R[B+1],k[B]&l){var H=this.match_bitapScore_(A,B-1,t,n);if(H<=o)if(o=H,a=B-1,a>n)P=zt.max(1,2*n-a);else break}}if(this.match_bitapScore_(A+1,n,t,n)>o)break;R=k}return a},r.prototype.match_bitapScore_=function(e,t,n,i){var o=e/n.length,a=Math.abs(i-t);return this.matchDistance?o+a/this.matchDistance:a?1:o},r.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},r.prototype.patch_addContext_=function(e,t){if(t.length!==0){if(e.start2==null)throw Error("patch not initialized");for(var n=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(n)!==t.lastIndexOf(n)&&n.length<this.matchMaxBits-this.patchMargin-this.patchMargin;)i+=this.patchMargin,n=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.patchMargin;var o=t.substring(e.start2-i,e.start2);o&&e.diffs.unshift([J.DIFF_EQUAL,o]);var a=t.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push([J.DIFF_EQUAL,a]),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},r}();function Sr(r,e){let t={};for(let o=0;o<e.length;o++){const a=e[o];t[a]?t[a].push(o):t[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<r.length;o++){const a=r[o],l=t[a]||[];let u=0,d=i[0];for(let _=0;_<l.length;_++){const R=l[_];let A;for(A=u;A<i.length&&!(i[A].buffer2index<R&&(A===i.length-1||i[A+1].buffer2index>R));A++);if(A<i.length){const P={buffer1index:o,buffer2index:R,chain:i[A]};if(u===i.length?i.push(d):i[u]=d,u=A+1,d=P,u===i.length)break}}i[u]=d}return i[i.length-1]}s(Sr,"LCS");function Pr(r,e){const t=Sr(r,e);let n=[],i=r.length,o=e.length,a={common:[]};function l(){a.common.length&&(a.common.reverse(),n.push(a),a={common:[]})}s(l,"processCommon");for(let u=t;u!==null;u=u.chain){let d={buffer1:[],buffer2:[]};for(;--i>u.buffer1index;)d.buffer1.push(r[i]);for(;--o>u.buffer2index;)d.buffer2.push(e[o]);(d.buffer1.length||d.buffer2.length)&&(l(),d.buffer1.reverse(),d.buffer2.reverse(),n.push(d)),i>=0&&a.common.push(r[i])}return l(),n.reverse(),n}s(Pr,"diffComm");function dr(r,e){const t=Sr(r,e);let n=[],i=r.length,o=e.length;for(let a=t;a!==null;a=a.chain){const l=i-a.buffer1index-1,u=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(l||u)&&n.push({buffer1:[i+1,l],buffer1Content:r.slice(i+1,i+1+l),buffer2:[o+1,u],buffer2Content:e.slice(o+1,o+1+u)})}return n.reverse(),n}s(dr,"diffIndices");function gn(r,e){const t=Sr(r,e);let n=[],i=r.length,o=e.length;function a(l,u,d){let _=[];for(let R=0;R<d;R++)_.push(l[u+R]);return{offset:u,length:d,chunk:_}}s(a,"chunkDescription");for(let l=t;l!==null;l=l.chain){const u=i-l.buffer1index-1,d=o-l.buffer2index-1;i=l.buffer1index,o=l.buffer2index,(u||d)&&n.push({buffer1:a(r,l.buffer1index+1,u),buffer2:a(e,l.buffer2index+1,d)})}return n.reverse(),n}s(gn,"diffPatch");function mn(r,e,t){let n=[];function i(u,d){n.push({ab:d,oStart:u.buffer1[0],oLength:u.buffer1[1],abStart:u.buffer2[0],abLength:u.buffer2[1]})}s(i,"addHunk"),dr(e,r).forEach(u=>i(u,"a")),dr(e,t).forEach(u=>i(u,"b")),n.sort((u,d)=>u.oStart-d.oStart);let o=[],a=0;function l(u){u>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:u-a,bufferContent:e.slice(a,u)}),a=u)}for(s(l,"advanceTo");n.length;){let u=n.shift(),d=u.oStart,_=u.oStart+u.oLength,R=[u];for(l(d);n.length;){const A=n[0],P=A.oStart;if(P>_)break;_=Math.max(_,P+A.oLength),R.push(n.shift())}if(R.length===1){if(u.abLength>0){const A=u.ab==="a"?r:t;o.push({stable:!0,buffer:u.ab,bufferStart:u.abStart,bufferLength:u.abLength,bufferContent:A.slice(u.abStart,u.abStart+u.abLength)})}}else{let A={a:[r.length,-1,e.length,-1],b:[t.length,-1,e.length,-1]};for(;R.length;){u=R.shift();const H=u.oStart,re=H+u.oLength,Y=u.abStart,he=Y+u.abLength;let De=A[u.ab];De[0]=Math.min(Y,De[0]),De[1]=Math.max(he,De[1]),De[2]=Math.min(H,De[2]),De[3]=Math.max(re,De[3])}const P=A.a[0]+(d-A.a[2]),M=A.a[1]+(_-A.a[3]),k=A.b[0]+(d-A.b[2]),B=A.b[1]+(_-A.b[3]);let U={stable:!1,aStart:P,aLength:M-P,aContent:r.slice(P,M),oStart:d,oLength:_-d,oContent:e.slice(d,_),bStart:k,bLength:B-k,bContent:t.slice(k,B)};o.push(U)}a=_}return l(e.length),o}s(mn,"diff3MergeRegions");function Or(r,e,t,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof r=="string",a=typeof e=="string",l=typeof t=="string";o&&(r=r.split(n.stringSeparator)),a&&(e=e.split(n.stringSeparator)),l&&(t=t.split(n.stringSeparator));let u=[];const d=mn(r,e,t);let _=[];function R(){_.length&&u.push({ok:_}),_=[]}s(R,"flushOk");function A(P,M){if(P.length!==M.length)return!1;for(let k=0;k<P.length;k++)if(P[k]!==M[k])return!1;return!0}return s(A,"isFalseConflict"),d.forEach(P=>{P.stable?_.push(...P.bufferContent):n.excludeFalseConflicts&&A(P.aContent,P.bContent)?_.push(...P.aContent):(R(),u.push({conflict:{a:P.aContent,aIndex:P.aStart,o:P.oContent,oIndex:P.oStart,b:P.bContent,bIndex:P.bStart}}))}),R(),u}s(Or,"diff3Merge");function Tn(r,e,t,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=Or(r,e,t,n);let a=!1,l=[];return o.forEach(u=>{u.ok?l=l.concat(u.ok):u.conflict&&(a=!0,l.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),l=l.concat(u.conflict.a),l.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),l=l.concat(u.conflict.o),l.push("======="),l=l.concat(u.conflict.b),l.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:a,result:l}}s(Tn,"mergeDiff3");function vn(r,e,t,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=Or(r,e,t,n);let a=!1,l=[];for(let u=0;u<o.length;u++){const d=o[u];d.ok?l=l.concat(d.ok):(a=!0,l=l.concat([`
<<<<<<<<<
`],d.conflict.a,[`
=========
`],d.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:l}}s(vn,"node_diff3_merge");function vi(r,e,t,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=Or(r,e,t,n);let a=!1,l=[];for(let u=0;u<o.length;u++){const d=o[u];if(d.ok)l=l.concat(d.ok);else{const _=Pr(d.conflict.a,d.conflict.b);for(let R=0;R<_.length;R++){let A=_[R];A.common?l=l.concat(A.common):(a=!0,l=l.concat([`
<<<<<<<<<
`],A.buffer1,[`
=========
`],A.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:l}}s(vi,"mergeDigIn");function ti(r,e){let t=[],n=0;function i(o){for(;n<o;)t.push(r[n]),n++}s(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let l=0;l<a.buffer2.chunk.length;l++)t.push(a.buffer2.chunk[l]);n+=a.buffer1.length}return i(r.length),t}s(ti,"patch");function Mi(r){return r.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}s(Mi,"stripPatch");function sc(r){return r.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}s(sc,"invertPatch");const Fi=new vr;Fi.diffTimeout=0;function Li(r,e,t){return Ne.get("diff.useDiffMatchPatch")===!0?Fi.patch_toText(Fi.patch_make(e,t)):ec(r,e,t)}s(Li,"diffs_createPatch");function cc(r,e,t){return To(r,e,t)}s(cc,"diffs_applyPatch");function Tu(r,e){const t=[];for(const n of ki(r,e))t.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),t.push(n);return t}s(Tu,"reversePatch");function El(r,e,t){let n=`
`;const i=r.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const u=i.filter(d=>d===`\r
`).length;n=u>i.length-u?`\r
`:`
`}const o=vn(r,e,t,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),a=o.result;let l=!1;if(o.conflict){let u;const d=[];let _=0;for(const P of a)P===`
<<<<<<<<<
`?u={start:_,separator:_,end:_}:P===`
=========
`?u.separator=_:P===`
>>>>>>>>>
`&&(u.end=_,d.push(u)),_++;let R=0,A=0;for(const P of d)a.splice(P.start-R,1),R++,A=P.end-P.separator+1,a.splice(P.separator-R,A),R+=A;d.length&&(l=!0)}return{conflicts:l,mergedContent:a.join(n)}}s(El,"diffs_merge");function Au(r){return r!==void 0&&typeof r.then=="function"}s(Au,"isPromise");const Ru="";function Iu(...r){if(r.length===1){const e=r[0];return e===void 0?Ru:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(r)}s(Iu,"gate_defaultResolver");function qr(r){return(e,t,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${t}`;n.value=function(...a){const l=a.length===0?o:`${o}$${(r!=null?r:Iu)(...a)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let u=this[l];if(u===void 0){let d;try{if(d=i.apply(this,a),d==null||!Au(d))return d;this[l]=u=d.then(_=>(this[l]=void 0,_)).catch(_=>{throw this[l]=void 0,_})}catch(_){throw this[l]=void 0,_}}return u}}}s(qr,"gate");let lc=0;function Du(){return lc===Number.MAX_SAFE_INTEGER&&(lc=0),String(++lc)}s(Du,"getNextLockId");class Sl{constructor(){this.id=Du()}async synchronize(e){let t;const n=this.promise;this.promise=new Promise(i=>t=i),await n;try{return await e()}finally{t()}}}s(Sl,"Lock");class ua{constructor(e){this.lock=new Sl,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,t){let n;const i=new lt(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:t?` \u2022 ${t}`:""},logLevel:We.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>n=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:t?` \u2022 ${t}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:t?` \u2022 ${t}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,t){let n;const i=new lt(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:t?` \u2022 ${t}`:""},logLevel:We.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:t?` \u2022 ${t}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:t?` \u2022 ${t}`:"",took:" locked for "}),n(),this.writer=void 0}}}s(ua,"ReaderWriterLock");class Cl{constructor(){this.locks=new Map}async synchronizeRead(e,t,n){let i=this.locks.get(e);return i===void 0&&(i=new ua(String(e)),this.locks.set(e,i)),i.synchronizeRead(t,n)}async synchronizeWrite(e,t,n){let i=this.locks.get(e);return i===void 0&&(i=new ua(String(e)),this.locks.set(e,i)),i.synchronizeWrite(t,n)}}s(Cl,"KeyedReaderWriterLock");async function da(r){return(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,6113,23))).createHash("sha1").update(r).digest("base64")}s(da,"sha1");var Pu=Object.defineProperty,Ou=Object.getOwnPropertyDescriptor,ku=s((r,e,t,n)=>{for(var i=n>1?void 0:n?Ou(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Pu(e,t,i),i},"changeStore_decorateClass");const $n=(0,V.loadMessageBundle)(),Nu=h.FileSystemError.FileNotFound().code,xl=`===================================================================
`,ri=new TextDecoder,Mu=new TextEncoder;var Mt;(function(r){r[r.Changed=1]="Changed",r[r.Created=2]="Created",r[r.Deleted=3]="Deleted"})(Mt||(Mt={}));function Fu(r){return r&&"type"in r&&"uri"in r&&"uri"in r&&"fileType"in r&&"revision"in r&&"timestamp"in r}s(Fu,"isOperation");function ha(r,e,t){return{type:r.type,rootUri:e,uri:t!=null?t:r.uri}}s(ha,"toEvent");const Po=s(class{constructor(r,e,t,n,i,o){this.providerService=r,this.storageService=e,this.fileStorageService=t,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new Cl,this.scopedStores=new Map,o===void 0&&(Po._instance=this,this.disposable=h.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var r;(r=this.disposable)==null||r.dispose()}async exportDebugInfo(r){var e;async function t(n){const i=await h.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void h.window.showTextDocument(i)}if(s(t,"exportCore"),r===void 0)for(const n of(e=h.workspace.workspaceFolders)!=null?e:[])await t.call(this,n.uri);else return t.call(this,r)}async getWorkspaceProvidersWithChanges(){var r,e;const t=new Map;for(const n of(r=h.workspace.workspaceFolders)!=null?r:[])if(n.uri.scheme===tr.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;t.set(i.id,i)}return[...t.values()]}async getWorkspacesWithChanges(){var r;const e=new lt("ChangeStore.getWorkspacesWithChanges()");try{const t=[];for(const n of(r=h.workspace.workspaceFolders)!=null?r:[])n.uri.scheme===tr.scheme&&await this.hasChanges(n.uri)&&t.push(n.uri);return t.length>0?t:void 0}finally{e.stop()}}async acceptAll(r,e){const t=`ChangeStore.acceptAll(${r.toString()}, ${e==null?void 0:e.staged})`;$.log(t);const n=[];await this.lock.synchronizeWrite(ne(r),async()=>{const i=await this.getWorkingOperations(r),o=[];let a=[];const l=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(u=>u.staged));for(const u of i){if(l&&!u.staged){a.push(u);continue}u.fileType===h.FileType.File&&await this.discardWorkingContent(r,u.uri);let d;if(u.type===2&&u.fileType===h.FileType.Directory&&(i.some(_=>ye(_.uri,u.uri))||(d={type:3,rootUri:r,uri:u.uri})),n.push(d!=null?d:ha(u,r)),u.type===2){let _=u.uri;for(;;){const{parent:R}=this.findParent(_,i,A=>A.type===2);if(R){o.push(R),_=R.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(u=>o.includes(u)?(n.push(ha(u,r)),!1):!0)),await this.saveWorkingOperations(r,a)},t),n.length!==0&&this._onDidChange.fire(n)}async discard(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=`ChangeStore.discard(${r.toString()})`;$.log(t);const n=[];await this.lock.synchronizeWrite(ne(e),async()=>this.discardCore(e,r,n),t),n.length!==0&&this._onDidChange.fire(n)}async discardCore(r,e,t){$.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(r);if(n.length===0)return;const i=ce(e),o=n.findIndex(u=>ce(u.uri)===i);if(o===-1)return;const[a]=n.splice(o,1);let l;switch(a.type){case 2:l=3;break;case 3:l=2;break;default:l=a.type;break}if(t.push({type:l,rootUri:r,uri:e}),a.type===2){let u=a.uri;for(;;){const{parent:d,parentIndex:_}=this.findNewParentWithOnlyChild(u,n);if(d){n.splice(_,1),t.push({type:3,rootUri:r,uri:d.uri}),u=d.uri;continue}break}}await this.saveWorkingOperations(r,n),a.fileType===h.FileType.File&&await this.discardWorkingContent(r,e)}async discardAll(r,e){const t=this.getUriScope(r);if(t)return this.getScopedChangeStore(t).discardAll(r,e);const n=`ChangeStore.discardAll(${r.toString()}, ${e==null?void 0:e.staged})`;$.log(n);const i=[];await this.lock.synchronizeWrite(ne(r),async()=>{const o=await this.getWorkingOperations(r),a=[];let l=[];const u=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(d=>d.staged));for(const d of o){if(u&&!d.staged){l.push(d);continue}d.fileType===h.FileType.File&&await this.discardWorkingContent(r,d.uri);let _;switch(d.type){case 2:_=3;break;case 3:_=2;break;default:_=d.type;break}if(i.push({type:_,rootUri:r,uri:d.uri}),d.type===2){let R=d.uri;for(;;){const{parent:A}=this.findNewParentWithOnlyChild(R,o);if(A){a.push(A),R=A.uri;continue}break}}}l.length>0&&a.length>0&&(l=l.filter(d=>a.includes(d)?(i.push({type:3,rootUri:r,uri:d.uri}),!1):!0)),await this.saveWorkingOperations(r,l)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=`ChangeStore.stage(${r.toString()})`;$.log(t);const n=[];await this.lock.synchronizeWrite(ne(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(r,e);i!==void 0&&await this.spliceOperation(r,o,{...i,staged:!0,timestamp:Date.now()},n)},t),n.length!==0&&this._onDidChange.fire(n)}async stageAll(r){const e=`ChangeStore.stageAll(${r.toString()})`;$.log(e);const t=[];await this.lock.synchronizeWrite(ne(r),async()=>{const n=(await this.getWorkingOperations(r)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(r,n),t.push(...n.map(i=>ha(i,r))))},e),t.length!==0&&this._onDidChange.fire(t)}async unstage(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=`ChangeStore.unstage(${r.toString()})`;$.log(t);const n=[];await this.lock.synchronizeWrite(ne(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(r,e);i!==void 0&&await this.spliceOperation(r,o,{...i,staged:!1,timestamp:Date.now()},n)},t),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(r){const e=`ChangeStore.unstageAll(${r.toString()})`;$.log(e);const t=[];await this.lock.synchronizeWrite(ne(r),async()=>{const n=(await this.getWorkingOperations(r)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(r,n),t.push(...n.map(i=>ha(i,r))))},e),t.length!==0&&this._onDidChange.fire(t)}async hasChanges(r){const e=this.getUriScope(r);if(e)return this.getScopedChangeStore(e).hasChanges(r);const t=ne(r),n=this.cache.get(t);return n!==void 0?n.length!==0:this.lock.synchronizeRead(t,async()=>(await this.getWorkingOperations(r)).length!==0,`ChangeStore.hasChanges(${r.toString()})`)}maybeHasChanges(r,e){const t=this.getUriScope(r);if(t)return this.getScopedChangeStore(t).maybeHasChanges(r,e);const n=ne(r),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=ce(e);return i.some(a=>ce(a.uri)===o)}async hasMergeConflicts(r){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${r.toString()})`)}async hasStagedChanges(r){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${r.toString()})`)}async hasWorkingChanges(r){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${r.toString()})`)}async getChange(r){const e=this.getUriScope(r);if(e)return this.getScopedChangeStore(e).getChange(r);const t=this.providerService.getVirtualRootUri(r);if(t!==void 0)return this.lock.synchronizeRead(ne(t),async()=>{const{operation:n}=await this.getWorkingOperation(r,t);return n},`ChangeStore.getChange(${r.toString()})`)}async getChanges(r,e){const t=this.getUriScope(r);return t?this.getScopedChangeStore(t).getChanges(r,e):this.lock.synchronizeRead(ne(r),async()=>{let n=await this.getWorkingOperations(r);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(a=>{var l;return(!i||a.conflicts===void 0)&&((l=o==null?void 0:o(a))!=null?l:!0)})}return n},`ChangeStore.getChanges(${r.toString()})`)}async getGroupedChanges(r,e){const t=this.getUriScope(r);return t?this.getScopedChangeStore(t).getGroupedChanges(r,e):this.lock.synchronizeRead(ne(r),async()=>{var n,i;const o=await this.getWorkingOperations(r),a={conflicts:[],staged:[],working:[]};for(const l of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,l))!=null?i:!0)||(l.conflicts?a.conflicts.push(l):l.staged?a.staged.push(l):a.working.push(l));return a},`ChangeStore.getChangesByType(${r.toString()})`)}async getContent(r){const e=this.providerService.getVirtualRootUri(r);if(e===void 0)throw new Error(`Unable to find content for ${r.toString()}; Repository not found`);const t=ne(e),n=this.cache.get(t);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${r.toString()}`);return this.lock.synchronizeRead(t,async()=>{const i=ri.decode(await this.getWorkingContent(e,r));if(i!==void 0)return i;throw new Error(`Unable to find content for ${r.toString()}`)},`ChangeStore.getContent(${r.toString()}}`)}async getMergeConflicts(r,e){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${r.toString()})`)}async getStagedChanges(r,e){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${r.toString()})`)}async getWorkingChanges(r,e){return this.lock.synchronizeRead(ne(r),async()=>(await this.getWorkingOperations(r)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${r.toString()})`)}async applyChangeset(r,e,t,n){var i;let o;Fu(t)?o=t:n=n!=null?n:t,$.log(`ChangeStore.applyChangeset${r.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const a=this.getScopedChangeStore(e.workspaceId),l=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(r,l,{...n,getIncomingContent:async u=>{const d=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,u),e.workspaceId);return ri.decode(await h.workspace.fs.readFile(d))},merge:async(u,d,_)=>{try{const R=this.providerService.getProviderUri(u),A=ri.decode(await h.workspace.fs.readFile(R)),P=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,d),e.workspaceId),M=ri.decode(await h.workspace.fs.readFile(P));return{...El(_,A,M),baseUri:R,incomingUri:P}}catch(R){throw new Error(`Unable to apply patch to ${d}: ${String(R)}`)}}})}async applyPatch(r,e,t){if($.log(`ChangeStore.applyPatch(${r.toString()})`,t==null?void 0:t.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(r,e,t)}async applyPatchCore(r,e,t={}){const n=`ChangeStore.applyPatchCore(${r.toString()})`;$.debug(n,t==null?void 0:t.save);const i=new h.WorkspaceEdit,o=[],a=new Map;async function l(A){var P;const M=ne(A),k=h.workspace.textDocuments.find(B=>ne(B.uri)===M);return(P=k==null?void 0:k.getText())!=null?P:ri.decode(await h.workspace.fs.readFile(A))}s(l,"getContent");async function u(A){try{const P=await h.workspace.fs.stat(A);return Boolean(P)}catch{return!1}}s(u,"exists");async function d(A,P,M){let k=cc("",M,{fuzzFactor:0});if(k===!1){if(!t.getIncomingContent)throw new Error(`Unable to apply patch to ${P}`);k=await t.getIncomingContent(P)}i.createFile(A,{overwrite:!0}),i.replace(A,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),k)}s(d,"applyCreate");async function _(A,P,M,k){const B=await l(A);let U=cc(B,M,{fuzzFactor:1});if(U===!1){if(t.merge===void 0)throw new Error(`Unable to apply patch to ${P}; Resulted in conflicts`);const H={title:$n("apply patch failed prompt confirm","Merge")},re={title:$n("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await h.window.showWarningMessage($n("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,P),{modal:!0,useCustom:!0},H,re)!==H)return;const he=await t.merge(A,P,B);U=he.mergedContent,he.conflicts&&a.set(ne(A),{type:k,baseUri:he.baseUri,incomingUri:he.incomingUri})}i.replace(A,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),U)}s(_,"applyModification");const R=(t==null?void 0:t.reverse)?Tu(e,{}):ki(e,{});for(const A of R)if(A.oldFileName==="/dev/null"){if(!A.newFileName)continue;const P=A.newFileName.startsWith("b/")?A.newFileName.substr(2):A.newFileName,M=this.providerService.createRelativeVirtualUri(r,P);o.push(ne(M)),!await u(M)?await d(M,P,A):await _(M,P,A,2)}else if(A.newFileName==="/dev/null"){if(!A.oldFileName)continue;const P=A.oldFileName.startsWith("a/")?A.oldFileName.substr(2):A.oldFileName,M=this.providerService.createRelativeVirtualUri(r,P);await u(M)&&i.deleteFile(M)}else if(A.oldFileName===A.newFileName){if(!A.newFileName)continue;const P=this.providerService.createRelativeVirtualUri(r,A.newFileName);o.push(ne(P)),!await u(P)?await d(P,A.newFileName,A):await _(P,A.newFileName,A,1)}else throw new Error(`Unable to apply patch to ${A.oldFileName}; Renames aren't currently supported`);if(await h.workspace.applyEdit(i),t.save&&o.length)for(const A of o){const P=h.workspace.textDocuments.find(M=>ne(M.uri)===A);await(P==null?void 0:P.save())}a.size&&setTimeout(async()=>{const A=[];await this.lock.synchronizeWrite(ne(r),async()=>{const P=await this.getWorkingOperations(r);if(P.length===0)return;let M=-1;for(const k of P){M++;const B=a.get(ne(k.uri));B!==void 0&&await this.spliceOperation(k.uri,M,{...k,conflicts:{baseUri:B.baseUri,incomingUri:B.incomingUri,status:[k.type,B.type]},timestamp:Date.now()},A)}},n),A.length!==0&&this._onDidChange.fire(A)},0)}async createChangeset(r){$.log(`ChangeStore.createChangeset${r.toString()})`);const e=await this.createPatch(r);return e?{workspaceId:this.workspaceId,uri:r,patch:e}:void 0}async createPatch(r,e,t){if($.log(`ChangeStore.createPatch${r.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(r);if((t==null?void 0:t.staged)&&(o=o.filter(l=>l.staged)),o.length===0)return"";const a=[];for(const l of o){const u=await this.createPatchCore(r,l);a.push(u)}return a.join("")}const{operation:n}=await this.getWorkingOperation(e,r);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(t==null?void 0:t.staged)&&n.staged?"":await this.createPatchCore(r,n)}async createPatchCore(r,e){const t=this.providerService.getRelativeFilePath(r,e.uri),n=`diff --git a/${t} b/${t}`;if(e.type===2){let u=await this.getContent(e.uri),d;!u.endsWith(`
`)&&!u.endsWith(`\r
`)?d=`
\\ No newline at end of file`:d="";let _=0;return u=u.replace(/\r?\n/g,R=>(_++,`${R}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${t}
@@ -0,0 +1,${_} @@
+${u}${d}`}if(e.type===3){let u=ri.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),d=0;return u=u.replace(/\r?\n/g,_=>(d++,`${_}-`)),`${n}
deleted file mode 100644
--- a/${t}
+++ /dev/null
@@ -1,${d} +0,0 @@
-${u}`}const i=await this.getContent(e.uri),o=ri.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),a=Li(t,o,i),l=a.indexOf(xl);return`${n}
${a.substr(l+xl.length)}`}async keep(r,e){const t=this.providerService.getVirtualWorkspaceUri(r);if(t===void 0)return;const n=`ChangeStore.keep(${r.toString()})`;$.log(n,e);const i=[];await this.lock.synchronizeWrite(ne(t),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(r,t);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,u]=o.conflicts.status;switch(u){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(r,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(r,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(r,a,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(t,r,i);break;case 1:await this.spliceOperation(r,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(r,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case 1:switch(o.type){case 3:await this.spliceOperation(r,a,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(t,r,i);case 1:await this.spliceOperation(r,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const l=e!==void 0?await h.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(r,a,{...o,type:1,originalHash:l!==void 0?await da(l):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(r,e,t){const n=this.providerService.getVirtualWorkspaceUri(r);if(n===void 0)return;const i=`ChangeStore.merge(${r.toString()})`;$.log(i,e,t);const o=[];await this.lock.synchronizeWrite(ne(n),async()=>{const{operation:a,index:l}=await this.getWorkingOperation(r,n);if(a===void 0)return;switch(e.type){case 1:switch(a.type){case 3:return void this.spliceOperation(r,l,{...a,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:t.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(a.type){case 3:case 1:return;case 2:break}break;case 3:switch(a.type){case 3:return this.discardCore(n,r,o);case 1:return void this.spliceOperation(r,l,{...a,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:return}}const u=await this.getWorkingContent(n,r),d=await h.workspace.fs.readFile(t.providerUri),_=await h.workspace.fs.readFile(e.providerUri),R=El(ri.decode(u),ri.decode(d),ri.decode(_));await this.writeFileCore(n,r,o,Mu.encode(R.mergedContent),_!=null?_:new Uint8Array(0),R.conflicts?{baseUri:t.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(r,e,t,n){let i;const o=this.providerService.getVirtualRootUri(r);return o!==void 0&&({operation:i}=await this.getWorkingOperation(r,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(e):((i==null?void 0:i.type)===2&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,r,t,n]})}resolveOpenCommand(r,e){return{command:"vscode.open",title:"Open File",arguments:[r,e]}}getScopedUri(r,e){const t=typeof e=="string"?e:e.workspaceId;return t===this.workspaceId?r:r.with({fragment:t})}getUriScope(r){return r.fragment||void 0}getScopedChangeStore(r){const e=typeof r=="string"?r:r.workspaceId;$.log(`ChangeStore.getScopedChangeStore(${e})`);let t=this.scopedStores.get(e);return t===void 0&&(t=e===this.workspaceId?new Po.ScopedChangeStore(this,e,this.workspaceId):new Po.ScopedChangeStore(new Po(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,t)),t}async stat(r){const e=this.getUriScope(r);if(e)return this.getScopedChangeStore(e).stat(r);const t=this.providerService.getVirtualRootUri(r);if(t===void 0)return;const n=ne(t),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:a}=await this.getWorkingOperation(r,t);if(a!==void 0){if(a.type===3)throw h.FileSystemError.FileNotFound(`The ${a.fileType===h.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${r.toString()}`)}async readFile(r){const e=this.getUriScope(r);if(e)return this.getScopedChangeStore(e).readFile(r);const t=new lt(`ChangeStore.readFile(${r.toString()})`);try{const n=this.providerService.getVirtualRootUri(r);if(n===void 0)return;const i=ne(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){t.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,r)},t.context)}finally{t.stop()}}async createDirectory(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=new lt(`ChangeStore.createDirectory(${r.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(ne(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(r,e),a=await this.providerService.getMetadata(r);await this.spliceOperation(r,o,i===void 0?{type:2,uri:r,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},t.context),n.length===0)return;this._onDidChange.fire(n)}finally{t.stop()}}async deleteDirectory(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=new lt(`ChangeStore.deleteDirectory(${r.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(ne(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(r,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,r,n);const a=await this.providerService.getMetadata(r);await this.spliceOperation(r,o,{type:3,uri:r,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},t.context),n.length===0)return;this._onDidChange.fire(n)}finally{t.stop()}}async updateDirectoryEntries(r,e){const t=this.providerService.getVirtualWorkspaceUri(r);if(t===void 0)return e;const n=new lt(`ChangeStore.updateDirectoryEntries(${r.toString()})`,{},e.length);try{const i=ne(t),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=tt(t,r),l=await this.getWorkingOperations(t);for(const u of l)switch(u.type){case 1:break;case 2:{if(ye(u.uri,a)){const d=this.providerService.getRelativeFilePath(r,u.uri);e.push([d,u.fileType])}break}case 3:{if(ye(u.uri,a)){const d=this.providerService.getRelativeFilePath(r,u.uri),_=e.findIndex(([R])=>R===d);_!==-1&&e.splice(_,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(r,e,t,n){const i=this.providerService.getVirtualWorkspaceUri(r);if(i===void 0)return;const o=new lt(`ChangeStore.writeFile(${r.toString()})`,{},e.length,n);try{const a=[];if(await this.lock.synchronizeWrite(ne(i),async()=>this.writeFileCore(i,r,a,e,t,n),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(r,e,t,n,i,o){const a=new lt(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:l,index:u},d,_]=await Promise.all([this.getWorkingOperation(e,r),da(n),da(i)]);if(d===_&&(l==null?void 0:l.type)===1)return this.discardCore(r,e,t);if(d===(l==null?void 0:l.hash)&&_===(l==null?void 0:l.originalHash))return;const[{HEAD:R}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(r,e,n)]);await this.spliceOperation(e,u,l===void 0?{type:1,uri:e,fileType:h.FileType.File,revision:R.sha,timestamp:Date.now(),size:n.byteLength,hash:d,originalHash:_,conflicts:o,staged:!1}:{...l,revision:R.sha,timestamp:Date.now(),size:n.byteLength,hash:d,originalHash:_,conflicts:o,staged:!1},t)}finally{a.stop()}}async createFile(r,e){const t=this.providerService.getVirtualWorkspaceUri(r);if(t===void 0)return;const n=new lt(`ChangeStore.createFile(${r.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(ne(t),async()=>{const[{operation:o,index:a},l,u]=await Promise.all([this.getWorkingOperation(r,t),da(e),this.providerService.getMetadata(r),this.saveWorkingContent(t,r,e)]);await this.spliceOperation(r,a,o===void 0?{type:2,uri:r,fileType:h.FileType.File,revision:u.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l,originalHash:l}:{...o,type:2,revision:u.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(r){const e=this.providerService.getVirtualWorkspaceUri(r);if(e===void 0)return;const t=new lt(`ChangeStore.deleteFile(${r.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(ne(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(r,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,r,n);const[a]=await Promise.all([this.providerService.getMetadata(r),this.discardWorkingContent(e,r)]);await this.spliceOperation(r,o,{type:3,uri:r,fileType:h.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},t.context),n.length===0)return;this._onDidChange.fire(n)}finally{t.stop()}}findParent(r,e,t){const n=Ge(r),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&t(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(r,e){const t=ce(r);return this.findParent(r,e,(n,i)=>n.type===2&&!i.some(o=>ye(o.uri,n.uri)&&ce(o.uri)!==t))}async getWorkingOperation(r,e){return this.findWorkingOperation(r,await this.getWorkingOperations(e))}findWorkingOperation(r,e){if(e.length===0)return{operation:void 0,index:-1};const t=ce(r);let n=-1;const i=e.find((o,a)=>ce(o.uri)!==t?!1:(n=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(r){const e=ne(r);let t=this.cache.get(e);return t===void 0&&(t=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,t)),t}async saveWorkingOperations(r,e){$.debug(`ChangeStore.saveWorkingOperations(${r.toString()})`,e.length);const t=ne(r);this.cache.set(t,e);try{await this.storageService.store(this.getOperationsStorageKey(t),this.toStorage(e))}catch(n){throw this.cache.delete(t),$.error(n,`Failed to save repository changes for ${t}`),n}}getOperationsStorageKey(r){return`operations/${r}`}async getWorkingContent(r,e){try{return await this.fileStorageService.get(this.getFileStorageKey(r,e))}catch(t){throw $.error(t),this.telemetryService.sendException(t),t}}async discardWorkingContent(r,e){$.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(r,e))}catch(t){if(t instanceof h.FileSystemError&&t.code===Nu)return;throw $.error(t),this.telemetryService.sendException(t),t}}async saveWorkingContent(r,e,t){$.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,t.length);try{return await this.fileStorageService.store(this.getFileStorageKey(r,e),t)}catch(n){throw $.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(r,e){return`changestore/${ge(e)}`}async spliceOperation(r,e,t,n){const i=this.providerService.getVirtualWorkspaceUri(r);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,t):o.push(t),await this.saveWorkingOperations(i,o),n.push(ha(t,i,r))}fromStorage(r){if(!r)return[];try{const e=JSON.parse(r,(t,n)=>(t==="uri"||t.endsWith("Uri"))&&Ke(n)?typeof n=="string"?h.Uri.parse(n):h.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw $.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(r){const e={schemaVersion:Po.operationsStorageSchemaVersion,operations:r};return JSON.stringify(e)}},"_ChangeStore");let Br=Po;Br.operationsStorageSchemaVersion=1,Br.ScopedChangeStore=class{constructor(r,e,t){this.changeStore=r,this.scope=e,this.workspaceId=t}createPatch(r,e,t){return this.changeStore.createPatch(this.stripUriScope(r),this.stripUriScope(e),t)}discardAll(r,e){return this.changeStore.discardAll(this.stripUriScope(r),e)}getChange(r){return this.changeStore.getChange(this.stripUriScope(r))}getChanges(r,e){return this.changeStore.getChanges(this.stripUriScope(r),e)}async getGroupedChanges(r,e){return this.changeStore.getGroupedChanges(this.stripUriScope(r),e)}hasChanges(r){return this.changeStore.hasChanges(this.stripUriScope(r))}maybeHasChanges(r,e){return this.changeStore.maybeHasChanges(this.stripUriScope(r),this.stripUriScope(e))}async stat(r){const t=this.changeStore.getUriScope(r)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(r));return n!==void 0&&t&&(n.permissions=h.FilePermission.Readonly),n}readFile(r){return this.changeStore.readFile(this.stripUriScope(r))}resolveDiffCommand(r,e,t,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(r,this.scope),this.changeStore.getScopedUri(e,this.scope),t,n)}stripUriScope(r){return r===void 0||!r.fragment?r:r.with({fragment:""})}},ku([qr()],Br.prototype,"getWorkingOperations",1);function uc(r){switch(r){case 1:return $n("change type changed","Modified");case 2:return $n("change type created","Added");case 3:return $n("change type deleted","Deleted")}}s(uc,"getStatusText");function Tl(r){const[e,t]=r;switch(e){case 1:switch(t){case 1:case 2:return $n("conflict status changed both","Modified by Both");case 3:return $n("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(t){case 1:case 2:return $n("conflict status created both","Added by Both");case 3:return $n("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(t){case 1:case 2:return $n("conflict status deleted us","Deleted by Current");case 3:return $n("conflict status deleted both","Deleted by Both")}break}}s(Tl,"getConflictStatusText");var dc=__webpack_require__(8361),hc=__webpack_require__.n(dc);const Lu="Type of classified event does not match event properties",fc=s(class{constructor(r){this.sharedProperties={},fc._instance=this,this.reporter=new(hc())(r.extension.id,r.extension.packageJSON.version,fc.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(r,e){e!==Lu&&this.reporter.sendTelemetryEvent(r,{...this.sharedProperties,...e})}sendEvent(r,e,t){this.reporter.sendTelemetryEvent(r,{...this.sharedProperties,...e},t)}sendErrorEvent(r,e,t){this.reporter.sendTelemetryErrorEvent(r,{...this.sharedProperties,...e},t)}sendException(r,e,t){this.reporter.sendTelemetryException(r,{...this.sharedProperties,...e},t)}setSharedProperty(r,e){this.sharedProperties[r]=e}},"_TelemetryService");let fa=fc;fa.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function $u(r,e){h.env.appHost==="github.dev"&&($.debug(`Executing ${r}`),e={...e,errorDetail:e.errorDetail instanceof Error?e.errorDetail.name:void 0},h.commands.executeCommand(r,e).then(t=>{},t=>{$.debug(`Failed to execute ${r}`,t)}))}s($u,"reportWorkbenchLoadResult");function Al(r,e){if(r===e)return-1;let t=0;for(;r[t]===e[t];)t++;return t}s(Al,"indexOfDifference");const rs=(0,V.loadMessageBundle)();let Bn;var pc;(function(r){function e(t){const n=Hu(t);return Bn=h.env.uiKind===h.UIKind.Web,$.warn(`Running on the ${Bn?"web":"desktop"}${t.extensionRuntime!==h.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${t.globalStorageUri.toString(!0)}`),n}s(e,"configure"),r.configure=e})(pc||(pc={}));function Bu(){var r,e;return(e=(r=h.workspace.workspaceFolders)==null?void 0:r.every(t=>t.uri.scheme===tr.scheme))!=null?e:!1}s(Bu,"isVirtualWorkspace");var ir;(function(r){r.CurrentWindow="currentWindow",r.NewWindow="newWindow",r.AddToWorkspace="addToWorkspace"})(ir||(ir={}));const Uu=/\/workspaceStorage\/(?<id>[^/]+)/i;function Hu(r){var e;if(r.storageUri===void 0)return"";const t=Uu.exec(r.storageUri.path);let n;if((e=t==null?void 0:t.groups)==null?void 0:e.id)n=t.groups.id;else{n=r.storageUri.path;const i=Al(r.globalStorageUri.path,n),o=`/${r.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}s(Hu,"getWorkspaceId");async function Un(r,e){var t,n,i,o,a;if(fa.instance.sendEvent("openWorkspace",{location:r.location}),r.location===ir.AddToWorkspace){const u=(n=(t=h.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;return void h.workspace.updateWorkspaceFolders(u,0,{uri:r.uri,name:r.name})}if(r.location===ir.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const u=await Br.instance.getWorkspaceProvidersWithChanges();if(u.length){const d={title:rs("continue","Continue")},_={title:rs("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(Bn?rs("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,u.map(A=>A.name).join(", ")):rs("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,u.map(A=>A.name).join(", ")),{modal:!0,useCustom:!0},d,_)!==d){fa.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const l=h.env.remoteName?!0:void 0;return r.filesToOpen&&(r.location===ir.CurrentWindow&&l===void 0&&((i=h.workspace.workspaceFolders)==null?void 0:i.length)===1&&h.workspace.workspaceFolders[0].uri.toString()===r.uri.toString()?await((o=Cu())==null?void 0:o.openPendingFiles(r.uri,r.filesToOpen)):await((a=Cu())==null?void 0:a.setPendingFilesToOpen(r.uri,r.filesToOpen))),fa.instance.sendEvent("openWorkspace.success",{location:r.location,forceLocalWindow:String(l)}),void h.commands.executeCommand("vscode.openFolder",r.uri,{forceNewWindow:r.location===ir.NewWindow,forceLocalWindow:l})}s(Un,"openWorkspace");var ni;(function(r){r.HasVirtualFolders="remoteHub:hasVirtualFolders",r.HasSearchIndexes="remoteHub:hasSearchIndexes",r.EnabledSomeSearchIndexes="remoteHub:enabledSomeSearchIndexes",r.EnabledAllSearchIndexes="remoteHub:enabledAllSearchIndexes",r.VirtualFolderProviders="remoteHub:virtualFolderProviders",r.HasPullRequestExtension="remoteHub:hasPullRequestExtension",r.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",r.HasRecentRepositories="remoteHub:hasRecentRepositories"})(ni||(ni={}));const Rl=new Map;function Oo(r){return r==="isWeb"?Bn:r==="remoteName"?h.env.remoteName:r==="virtualWorkspace"?Bu():r.startsWith("config.")?Ne.getAny(r.substr(7)):Rl.get(r)}s(Oo,"getContext");function ko(r){return r==="isWeb"||r==="remoteName"||r==="virtualWorkspace"||r.startsWith("config.")||r.startsWith("remoteHub:")||r.startsWith("continueOn:")}s(ko,"isSupportedContextKey");async function yn(r,e){Rl.set(r,e),!r.startsWith("continueOn:")&&await h.commands.executeCommand("setContext",r,e)}s(yn,"setContext");class Il{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await h.commands.executeCommand(this.menuItem.command,e)}}s(Il,"ContinueOnCommandQuickPickItem");var gc;(function(r){async function e(t,n,i){const o=ju(t).map(u=>new Il(u)),a=h.window.createQuickPick(),l=[];try{return await new Promise(d=>{l.push(a.onDidHide(()=>d(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[_]=a.activeItems;d(_)}})),a.title=i,a.placeholder=n,a.items=o,a.show()})}finally{a.dispose(),l.forEach(u=>void u.dispose())}}s(e,"show"),r.show=e})(gc||(gc={}));function ju(r){var e,t,n,i,o;const a=new Map,[,l]=r.split(".");for(const d of h.extensions.all){const{name:_,displayName:R,contributes:A}=d.packageJSON;if(!A)continue;const P=(t=(e=A.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:t.continueOn;if(P==null?void 0:P.length){const M=new Map(((n=A.commands)!=null?n:[]).map(k=>[k.command,k]));for(const k of P){if(!k.command)continue;if(a.has(k.command)){$.warn(`Duplicate 'continueOn' menu command: ${k.command}`);continue}const B=M.get(k.command);if(!B){$.warn(`Unable to find 'continueOn' menu command: ${k.command}`);continue}if(!qu(k.when))continue;const U=(o=(i=k.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(k.command,{extension:{id:_,name:R,builtin:_===l},command:B.command,title:B.title,icon:typeof B.icon=="string"?B.icon:void 0,group:U>0?k.group.substr(0,U):k.group,order:U>0?Number(k.group.substr(U+1)):0,category:B.category})}}}function u(d,_){const R=d.group,A=_.group;if(R!==A){if(!R)return 1;if(!A||R==="navigation")return-1;if(A==="navigation")return 1;const P=R.localeCompare(A);if(P!==0)return P}return d.order<_.order?-1:d.order>_.order?1:d.title.localeCompare(_.title)}return s(u,"compareMenuItems"),[...a.values()].sort(u)}s(ju,"getContinueOnContributions");function qu(r){return r?r.split("&&").every(e=>{const t=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!t)return!0;const[,n,i,o,a,l]=t;if(i){if(i==="false")return!1;if(!ko(i))return!0;const u=Oo(i);return n?!u:u}if(o&&a&&l)switch(a){case"==":return!ko(o)||!ko(l)||Oo(o)==Oo(l);case"!=":return!ko(o)||!ko(l)||Oo(o)!=Oo(l);case"=~":{if(!ko(o))return!0;const u=Oo(o);try{return new RegExp(l.slice(1,-1)).test(String(u!=null?u:""))}catch{return!1}}}return!0}):!0}s(qu,"evaluateWhenClause");class ns{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,t=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},t),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}s(ns,"TaskDebouncer");const Jr=(0,V.loadMessageBundle)(),pa=Symbol("QuickPickGoBack");var mc;(function(r){async function e(t,n,i,o,a,l){const u=t.getRemoteWorkspaceSourceProviders();let d=[];u.length===0?d=[]:d=u.map(M=>new vc(M));const _=await n.getRemoteWorkspaceSourceProvider();if(_){const M=await _.provideSources();M&&d.push(...M.filter(k=>Ne.get("azureRepos.enabled")?!0:k.providerId==="github").map(k=>({label:`${k.icon?`${k.icon} `:""}${k.name}`,description:k.description,detail:k.detail,url:k.url,workspace:k.url?void 0:k.workspace,buttons:[_n.OpenInNewWindow]})))}const R=h.window.createQuickPick();R.ignoreFocusOut=!0;const A=[];let P=i;try{for(;;){const M=await new Promise(k=>{A.push(R.onDidHide(()=>k(void 0)),R.onDidChangeValue(B=>{B=B.trim(),B.length===0?R.items=d:R.activeItems.length===0||R.activeItems[0]instanceof lo?R.items=[new lo(t,B),...d]:R.items=d}),R.onDidAccept(()=>{if(R.activeItems.length!==0){const[B]=R.activeItems;(!(B instanceof lo)||B.validate())&&k(B)}}),R.onDidChangeActive(()=>{if(P!==void 0||!(l==null?void 0:l.allowAddToWorkspace))return;const[B]=R.activeItems;let U=!0;if(B===void 0?U=Boolean(R.value):U=B instanceof lo,U){if(R.buttons.length===1)return;R.buttons=[_n.AddToWorkspace]}else{if(R.buttons.length===0)return;R.buttons=[]}}),R.onDidTriggerButton(B=>{if(B===_n.AddToWorkspace){const[U]=R.activeItems;if(!(U instanceof lo))return;U.validate()&&(P=ir.AddToWorkspace,k(U))}}),R.onDidTriggerItemButton(B=>{switch(B.button){case _n.OpenInNewWindow:P=ir.NewWindow,k(B.item);break;default:break}})),R.title=a,R.placeholder=o,R.matchOnDescription=!0,R.items=d,R.sortByLabel=!1,R.show()});if(M instanceof vc){const k=await M.show(P,M.placeholder,a,l);if(k===pa)continue;return k}return[M,P]}}finally{R.dispose(),A.forEach(M=>void M.dispose())}}s(e,"show"),r.show=e})(mc||(mc={}));class vc{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,t,n,i){const o=h.window.createQuickPick(),a=new ns(500),l=[a];async function u(B,U,H,re,Y){const he=await B.provideSources(U,H,re,Y);return he==null?void 0:he.map(De=>({label:`${De.icon?`${De.icon} `:""}${De.name}`,description:De.description,detail:De.detail,url:De.url,workspace:De.workspace,buttons:[_n.OpenInNewWindow]}))}s(u,"getItems");async function d(B){var U;P=void 0;const H=o.activeItems;o.items=(U=B!=null?B:await k)!=null?U:[],A&&H.length!==0&&(o.activeItems=o.items.filter(re=>H.some(Y=>Y.url===re.url))),o.busy=!1}s(d,"setItems");let _,R;if(this.provider.provideOrganization&&this.provider.provideProject){if(_=await this.provider.provideOrganization(),!_)return[void 0,void 0];if(R=await this.provider.provideProject(_),!R)return[void 0,void 0]}let A=!1,P,M=e;const k=u(this.provider,_,R,void 0,{sort:"updated"});try{const B=await new Promise(U=>{l.push(o.onDidHide(()=>U(void 0)),o.onDidChangeValue(H=>{A=!1,H=H.trim(),o.busy=!0;const re=a.debounce(H?()=>u(this.provider,_,R,H,{sort:"stars"}):()=>k);P===void 0&&(P=re.then(Y=>d(Y)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[H]=o.activeItems;U(H)}}),o.onDidChangeActive(()=>{if(A=o.activeItems.length!==0,M!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[H]=o.activeItems;if(H===void 0){if(o.buttons.length===1)return;o.buttons=[h.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[h.QuickInputButtons.Back,_n.AddToWorkspace]}}),o.onDidTriggerButton(H=>{if(H===h.QuickInputButtons.Back){U(pa);return}if(H===_n.AddToWorkspace){const[re]=o.activeItems;if(re===void 0)return;M=ir.AddToWorkspace,U(re)}}),o.onDidTriggerItemButton(H=>{switch(H.button){case _n.OpenInNewWindow:M=ir.NewWindow,U(H.item);break;default:break}})),o.title=n,o.placeholder=t,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[h.QuickInputButtons.Back],o.busy=!0,o.show(),P=a.debounce(()=>k,0).then(H=>d(H))});return B===pa?B:[B,M]}finally{o.dispose(),l.forEach(B=>void B.dispose())}}}s(vc,"RemoteSourceProviderPickerItem");class lo{constructor(e,t){this.url=t,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(t)}get buttons(){return[_n.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:t}=this.canOpenResult;switch(t){case Pt.Branch:return Jr("remote url picker open branch","Open Branch from {0} Repository",e.name);case Pt.Tag:return Jr("remote url picker open tag","Open Tag from {0} Repository",e.name);case Pt.Commit:return Jr("remote url picker open commit","Open Commit from {0} Repository",e.name);case Pt.File:return Jr("remote url picker open file","Open File from {0} Repository",e.name);case Pt.PullRequest:return Jr("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return Jr("remote url picker open repository","Open {0} Repository",e.name)}}return Jr("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}s(lo,"RemoteUrlQuickPickItem");var _n;(function(r){r.AddToWorkspace={iconPath:new h.ThemeIcon("plus"),tooltip:Jr("remote url picker button add to workspace","Add to Workspace")},r.OpenInNewWindow={iconPath:new h.ThemeIcon("empty-window"),tooltip:Jr("remote picker open in new window","Open in New Window")}})(_n||(_n={}));var zu=Object.defineProperty,Wu=Object.getOwnPropertyDescriptor,yi=s((r,e,t,n)=>{for(var i=n>1?void 0:n?Wu(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&zu(e,t,i),i},"messages_decorateClass");const Cr=(0,V.loadMessageBundle)();class Vn{showGitHubStatus500Message(){return h.window.showErrorMessage(Cr("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),Cr("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void h.window.showErrorMessage(Cr("401 error notification","The provided credentials are either invalid or expired."),Cr("ok","OK"));const t=Cr("401 error notification confirm","Reauthenticate");await h.window.showErrorMessage(Cr("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),t)===t&&e()}async showStatus403Message(e){if(!e)return void h.window.showErrorMessage(Cr("403 error notification","The provided credentials do not have the required access."),Cr("ok","OK"));const t=Cr("403 error notification confirm","Reauthenticate");await h.window.showErrorMessage(Cr("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?"),t)===t&&e()}async showRepositoryEmptyMessage(e){const t=Cr("repository empty open","Open Repository");await h.window.showErrorMessage(Cr("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),t)===t&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,t){const n=Cr("pull request not found open","Open Pull Request");await h.window.showErrorMessage(Cr("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,t),n)===n&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,t){const n=Cr("pull request head not found ok","OK");await h.window.showWarningMessage(Cr("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,t),n)}async showRepositoryForbiddenMessage(e){const t=Cr("repository forbidden open","Open Repository");await h.window.showErrorMessage(Cr("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),t)===t&&h.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const t=Cr("repository not found confirm","Open Repository");await h.window.showErrorMessage(Cr("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),t)===t&&h.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const t=Cr("unable to open repo confirm","Open Repository");await h.window.showErrorMessage(Cr("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),t)===t&&h.commands.executeCommand("remoteHub.openRepository")}}s(Vn,"Messages"),yi([qr(()=>"")],Vn.prototype,"showGitHubStatus500Message",1),yi([qr(()=>"")],Vn.prototype,"showStatus401Message",1),yi([qr(()=>"")],Vn.prototype,"showStatus403Message",1),yi([qr()],Vn.prototype,"showRepositoryEmptyMessage",1),yi([qr()],Vn.prototype,"showPullRequestNotFoundMessage",1),yi([qr()],Vn.prototype,"showPullRequestHeadNotFoundMessage",1),yi([qr()],Vn.prototype,"showRepositoryForbiddenMessage",1),yi([qr()],Vn.prototype,"showRepositoryNotFoundMessage",1),yi([qr()],Vn.prototype,"showUnableToOpenRepositoryMessage",1);const en=new Vn,Fr=(0,V.loadMessageBundle)();function ga(r,e,t,n,i){async function o(l){const[u,d]=await mc.show(r,t,l,Fr("open repo placeholder","Enter a remote url, or select a remote provider"),l===ir.AddToWorkspace?Fr("open repo title add to workspace","Add Remote Repository to Workspace"):Fr("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!u){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let _;if(u.workspace)_=u.workspace,_.location=d!=null?d:_.location;else if(_=await r.createWorkspaceForRemoteUrl(u.url,void 0,d!=null?d:l),!_){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await Un(_)}catch(_){if(i.sendException(_),_ instanceof St){const{reauthenticate:R}=_;en.showStatus401Message(()=>R());return}if(_ instanceof ct){en.showRepositoryNotFoundMessage(_.name);return}if(_ instanceof Dt){en.showRepositoryForbiddenMessage(_.name);return}if(_ instanceof It){en.showRepositoryEmptyMessage(_.name);return}if(_ instanceof xe){en.showPullRequestNotFoundMessage(_.name,_.id);return}$.error(_)}}s(o,"openRepository");async function a(l,u,d){if(d==null?void 0:d.workspaceFolder){const R=r.getRepository(d.workspaceFolder,u);if(R!==void 0)return R}const _=u?r.repositories.filter(R=>R.provider.id===u):r.repositories;if(_.length!==0){if(_.length>1){const R=await h.window.showQuickPick(_.map(A=>({label:A.name,description:A.provider.name,repository:A})),{placeHolder:l});return R?R.repository:void 0}return _[0]}}return s(a,"getRepository"),[h.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),h.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),h.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn",async()=>{const l=await a(Fr("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(l===void 0)return;i.sendEvent("command.continueOn");const u=await gc.show(n,Fr("continue on placeholder","Choose how you would like to continue working"),Fr("continue on title","Continue '{0}' on",l.name));if(!u){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await e.hasChanges(l.uri)){const R={title:Fr("continue","Continue")},A={title:Fr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(Fr("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},R,A)!==R){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const d=r.getRemoteUri(l.provider.id,{repo:l.id}),{HEAD:_}=await l.getMetadata();await u.execute({provider:l.provider,workspaceFolder:l.uri,name:l.name,url:d==null?void 0:d.toString(!0),ref:_.name})}),h.commands.registerCommand("remoteHub.openOnDesktop",async l=>{if(!Bn)return;const u=await a(Fr("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,l);if(u===void 0)return;const d=await r.getBestRemoteUri(u.uri);d!==void 0&&(i.sendEvent("command.openOnDesktop"),h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://${n}/open?url=${encodeURIComponent(d.toString(!0))}`)))}),h.commands.registerCommand("remoteHub.openOnWeb",async l=>{if(Bn)return;const u=await a(Fr("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,l);if(u===void 0)return;const d=await r.getBestRemoteUri(u.uri);d!==void 0&&(i.sendEvent("command.openOnWeb"),h.env.openExternal(d))}),h.commands.registerCommand("remoteHub.goToRepository",async()=>{var l,u,d;i.sendEvent("command.goToRepository");const _=await a(Fr("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!_)return;const R=await r.getMetadata(_.uri);let A;const P={provider:_.provider,repo:_.id,path:((l=h.window.activeTextEditor)==null?void 0:l.document.uri)?r.getRelativeFilePath((u=h.window.activeTextEditor)==null?void 0:u.document.uri):void 0};return R.HEAD.type===Le.Branch&&(((d=h.window.activeTextEditor)==null?void 0:d.document)||R.defaultBranch.name!==R.HEAD.name)?A={...P,branch:R.HEAD.name}:R.HEAD.type===Le.Tag?A={...P,tag:R.HEAD.name}:R.HEAD.type===Le.Commit?A={...P,sha:R.HEAD.sha}:A={...P},h.commands.executeCommand("remoteHub.openOnRemote",A)}),h.commands.registerCommand("remoteHub.openOnRemote",async l=>{i.sendEvent("command.openOnRemote");const{provider:u,...d}=l,_=r.getRemoteUri(u.id,d);if(_){await h.env.openExternal(_);return}h.window.showErrorMessage(Fr("open on remote command provider not supported","Unable to open the resource on {0}",l.provider.name))}),h.commands.registerCommand("remoteHub.clone",async l=>{const u=await a(Fr("clone placeholder","Choose which repository to clone"),void 0,l);if(u!==void 0){if(i.sendEvent("command.clone"),l===void 0&&await e.hasChanges(u.uri)){const d={title:Fr("continue","Continue")},_={title:Fr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(Fr("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},d,_)!==d){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await r.clone(u.uri)}}),h.commands.registerCommand("remoteHub.refresh",()=>void r.refresh()),h.commands.registerCommand("remoteHub.enableDebugLogging",()=>Ne.updateEffective("logLevel",We.Debug)),h.commands.registerCommand("remoteHub.disableDebugLogging",()=>Ne.updateEffective("logLevel",We.Warn)),h.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{await t.exportDebugInfo(),await e.exportDebugInfo()}),h.commands.registerCommand("remoteHub.setContext",async(l,u)=>{if(!l.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await yn(l,u)}),h.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const l={title:Fr("continue on","Continue Working On...")};await h.window.showInformationMessage(Fr("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},l)===l&&await h.commands.executeCommand("remoteHub.continueOn")}),h.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>Bn?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}s(ga,"registerCommands");function Kn(r){return r}s(Kn,"command");async function is(r,e){return h.commands.executeCommand(r,e)}s(is,"executeCommand");class Dl{constructor(){this._timeout=0,this._disposable=Ne.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const t=Ne.get("autoFetch");this._config={enabled:(e=t.enabled)!=null?e:!0,interval:t.interval*1e3}}return this._config}onConfigurationChanged(e){!Ne.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await is("remoteHub.fetchAll",{automated:!0})}catch(e){$.error(e,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}s(Dl,"AutoFetchService");const Gu=require("buffer");var Vu=__webpack_require__(6113),Ku=__webpack_require__.n(Vu);const os=new Uint8Array(256);let ma=os.length;function Qu(){return ma>os.length-16&&(Ku().randomFillSync(os),ma=0),os.slice(ma,ma+=16)}s(Qu,"rng");const Xu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Yu(r){return typeof r=="string"&&Xu.test(r)}s(Yu,"validate");const Zu=Yu,zr=[];for(let r=0;r<256;++r)zr.push((r+256).toString(16).substr(1));function Ju(r,e=0){const t=(zr[r[e+0]]+zr[r[e+1]]+zr[r[e+2]]+zr[r[e+3]]+"-"+zr[r[e+4]]+zr[r[e+5]]+"-"+zr[r[e+6]]+zr[r[e+7]]+"-"+zr[r[e+8]]+zr[r[e+9]]+"-"+zr[r[e+10]]+zr[r[e+11]]+zr[r[e+12]]+zr[r[e+13]]+zr[r[e+14]]+zr[r[e+15]]).toLowerCase();if(!Zu(t))throw TypeError("Stringified UUID is invalid");return t}s(Ju,"stringify");const ed=Ju;function td(r,e,t){r=r||{};const n=r.random||(r.rng||Qu)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let i=0;i<16;++i)e[t+i]=n[i];return e}return ed(n)}s(td,"v4");const yc=td;var xr=__webpack_require__(2781),as=__webpack_require__(3685),No=__webpack_require__(7310),Pl=__webpack_require__(5687),ln=__webpack_require__(9796);const Mo=xr.Readable,or=Symbol("buffer"),va=Symbol("type");class tn{constructor(){this[va]="";const e=arguments[0],t=arguments[1],n=[];let i=0;if(e){const a=e,l=Number(a.length);for(let u=0;u<l;u++){const d=a[u];let _;d instanceof Buffer?_=d:ArrayBuffer.isView(d)?_=Buffer.from(d.buffer,d.byteOffset,d.byteLength):d instanceof ArrayBuffer?_=Buffer.from(d):d instanceof tn?_=d[or]:_=Buffer.from(typeof d=="string"?d:String(d)),i+=_.length,n.push(_)}}this[or]=Buffer.concat(n);let o=t&&t.type!==void 0&&String(t.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[va]=o)}get size(){return this[or].length}get type(){return this[va]}text(){return Promise.resolve(this[or].toString())}arrayBuffer(){const e=this[or],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new Mo;return e._read=function(){},e.push(this[or]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],n=arguments[1];let i,o;t===void 0?i=0:t<0?i=Math.max(e+t,0):i=Math.min(t,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const a=Math.max(o-i,0),u=this[or].slice(i,i+a),d=new tn([],{type:arguments[2]});return d[or]=u,d}}s(tn,"Blob"),Object.defineProperties(tn.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(tn.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function rn(r,e,t){Error.call(this,r),this.message=r,this.type=e,t&&(this.code=this.errno=t.code),Error.captureStackTrace(this,this.constructor)}s(rn,"FetchError"),rn.prototype=Object.create(Error.prototype),rn.prototype.constructor=rn,rn.prototype.name="FetchError";let _c;try{_c=require("encoding").convert}catch(r){}const _i=Symbol("Body internals"),Ol=xr.PassThrough;function c(r){var e=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.size;let i=n===void 0?0:n;var o=t.timeout;let a=o===void 0?0:o;r==null?r=null:b(r)?r=Buffer.from(r.toString()):C(r)||Buffer.isBuffer(r)||(Object.prototype.toString.call(r)==="[object ArrayBuffer]"?r=Buffer.from(r):ArrayBuffer.isView(r)?r=Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof xr||(r=Buffer.from(String(r)))),this[_i]={body:r,disturbed:!1,error:null},this.size=i,this.timeout=a,r instanceof xr&&r.on("error",function(l){const u=l.name==="AbortError"?l:new rn(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[_i].error=u})}s(c,"Body"),c.prototype={get body(){return this[_i].body},get bodyUsed(){return this[_i].disturbed},arrayBuffer(){return I.call(this).then(function(r){return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)})},blob(){let r=this.headers&&this.headers.get("content-type")||"";return I.call(this).then(function(e){return Object.assign(new tn([],{type:r.toLowerCase()}),{[or]:e})})},json(){var r=this;return I.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(t){return c.Promise.reject(new rn(`invalid json response body at ${r.url} reason: ${t.message}`,"invalid-json"))}})},text(){return I.call(this).then(function(r){return r.toString()})},buffer(){return I.call(this)},textConverted(){var r=this;return I.call(this).then(function(e){return p(e,r.headers)})}},Object.defineProperties(c.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),c.mixIn=function(r){for(const e of Object.getOwnPropertyNames(c.prototype))if(!(e in r)){const t=Object.getOwnPropertyDescriptor(c.prototype,e);Object.defineProperty(r,e,t)}};function I(){var r=this;if(this[_i].disturbed)return c.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[_i].disturbed=!0,this[_i].error)return c.Promise.reject(this[_i].error);let e=this.body;if(e===null)return c.Promise.resolve(Buffer.alloc(0));if(C(e)&&(e=e.stream()),Buffer.isBuffer(e))return c.Promise.resolve(e);if(!(e instanceof xr))return c.Promise.resolve(Buffer.alloc(0));let t=[],n=0,i=!1;return new c.Promise(function(o,a){let l;r.timeout&&(l=setTimeout(function(){i=!0,a(new rn(`Response timeout while trying to fetch ${r.url} (over ${r.timeout}ms)`,"body-timeout"))},r.timeout)),e.on("error",function(u){u.name==="AbortError"?(i=!0,a(u)):a(new rn(`Invalid response body while trying to fetch ${r.url}: ${u.message}`,"system",u))}),e.on("data",function(u){if(!(i||u===null)){if(r.size&&n+u.length>r.size){i=!0,a(new rn(`content size at ${r.url} over limit: ${r.size}`,"max-size"));return}n+=u.length,t.push(u)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(t,n))}catch(u){a(new rn(`Could not create Buffer from response body for ${r.url}: ${u.message}`,"system",u))}}})})}s(I,"consumeBody");function p(r,e){if(typeof _c!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const t=e.get("content-type");let n="utf-8",i,o;return t&&(i=/charset=([^;]*)/i.exec(t)),o=r.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),_c(r,"UTF-8",n).toString()}s(p,"convertBody");function b(r){return typeof r!="object"||typeof r.append!="function"||typeof r.delete!="function"||typeof r.get!="function"||typeof r.getAll!="function"||typeof r.has!="function"||typeof r.set!="function"?!1:r.constructor.name==="URLSearchParams"||Object.prototype.toString.call(r)==="[object URLSearchParams]"||typeof r.sort=="function"}s(b,"isURLSearchParams");function C(r){return typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&typeof r.constructor.name=="string"&&/^(Blob|File)$/.test(r.constructor.name)&&/^(Blob|File)$/.test(r[Symbol.toStringTag])}s(C,"isBlob");function g(r){let e,t,n=r.body;if(r.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof xr&&typeof n.getBoundary!="function"&&(e=new Ol,t=new Ol,n.pipe(e),n.pipe(t),r[_i].body=e,n=t),n}s(g,"clone");function f(r){return r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":b(r)?"application/x-www-form-urlencoded;charset=UTF-8":C(r)?r.type||null:Buffer.isBuffer(r)||Object.prototype.toString.call(r)==="[object ArrayBuffer]"||ArrayBuffer.isView(r)?null:typeof r.getBoundary=="function"?`multipart/form-data;boundary=${r.getBoundary()}`:r instanceof xr?null:"text/plain;charset=UTF-8"}s(f,"extractContentType");function m(r){const e=r.body;return e===null?0:C(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}s(m,"getTotalBytes");function v(r,e){const t=e.body;t===null?r.end():C(t)?t.stream().pipe(r):Buffer.isBuffer(t)?(r.write(t),r.end()):t.pipe(r)}s(v,"writeToStream"),c.Promise=global.Promise;const w=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,E=/[^\t\x20-\x7e\x80-\xff]/;function y(r){if(r=`${r}`,w.test(r)||r==="")throw new TypeError(`${r} is not a legal HTTP header name`)}s(y,"validateName");function S(r){if(r=`${r}`,E.test(r))throw new TypeError(`${r} is not a legal HTTP header value`)}s(S,"validateValue");function x(r,e){e=e.toLowerCase();for(const t in r)if(t.toLowerCase()===e)return t}s(x,"lib_find");const T=Symbol("map");class D{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[T]=Object.create(null),e instanceof D){const t=e.raw(),n=Object.keys(t);for(const i of n)for(const o of t[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const t=e[Symbol.iterator];if(t!=null){if(typeof t!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,y(e);const t=x(this[T],e);return t===void 0?null:this[T][t].join(", ")}forEach(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=O(this),i=0;for(;i<n.length;){var o=n[i];const a=o[0],l=o[1];e.call(t,l,a,this),n=O(this),i++}}set(e,t){e=`${e}`,t=`${t}`,y(e),S(t);const n=x(this[T],e);this[T][n!==void 0?n:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,y(e),S(t);const n=x(this[T],e);n!==void 0?this[T][n].push(t):this[T][e]=[t]}has(e){return e=`${e}`,y(e),x(this[T],e)!==void 0}delete(e){e=`${e}`,y(e);const t=x(this[T],e);t!==void 0&&delete this[T][t]}raw(){return this[T]}keys(){return z(this,"key")}values(){return z(this,"value")}[Symbol.iterator](){return z(this,"key+value")}}s(D,"Headers"),D.prototype.entries=D.prototype[Symbol.iterator],Object.defineProperty(D.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(D.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function O(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(r[T]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return r[T][n].join(", ")}:function(n){return[n.toLowerCase(),r[T][n].join(", ")]})}s(O,"getHeaders");const N=Symbol("internal");function z(r,e){const t=Object.create(X);return t[N]={target:r,kind:e,index:0},t}s(z,"createHeadersIterator");const X=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==X)throw new TypeError("Value of `this` is not a HeadersIterator");var r=this[N];const e=r.target,t=r.kind,n=r.index,i=O(e,t),o=i.length;return n>=o?{value:void 0,done:!0}:(this[N].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(X,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function K(r){const e=Object.assign({__proto__:null},r[T]),t=x(r[T],"Host");return t!==void 0&&(e[t]=e[t][0]),e}s(K,"exportNodeCompatibleHeaders");function fe(r){const e=new D;for(const t of Object.keys(r))if(!w.test(t))if(Array.isArray(r[t]))for(const n of r[t])E.test(n)||(e[T][t]===void 0?e[T][t]=[n]:e[T][t].push(n));else E.test(r[t])||(e[T][t]=[r[t]]);return e}s(fe,"createHeadersLenient");const be=Symbol("Response internals"),Fe=as.STATUS_CODES;class ke{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.call(this,e,t);const n=t.status||200,i=new D(t.headers);if(e!=null&&!i.has("Content-Type")){const o=f(e);o&&i.append("Content-Type",o)}this[be]={url:t.url,status:n,statusText:t.statusText||Fe[n],headers:i,counter:t.counter}}get url(){return this[be].url||""}get status(){return this[be].status}get ok(){return this[be].status>=200&&this[be].status<300}get redirected(){return this[be].counter>0}get statusText(){return this[be].statusText}get headers(){return this[be].headers}clone(){return new ke(g(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}s(ke,"Response"),c.mixIn(ke.prototype),Object.defineProperties(ke.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(ke.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const Qe=Symbol("Request internals"),it=No.parse,gt=No.format,xt="destroy"in xr.Readable.prototype;function Ht(r){return typeof r=="object"&&typeof r[Qe]=="object"}s(Ht,"isRequest");function jt(r){const e=r&&typeof r=="object"&&Object.getPrototypeOf(r);return!!(e&&e.constructor.name==="AbortSignal")}s(jt,"isAbortSignal");class cr{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;Ht(e)?n=it(e.url):(e&&e.href?n=it(e.href):n=it(`${e}`),e={});let i=t.method||e.method||"GET";if(i=i.toUpperCase(),(t.body!=null||Ht(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=t.body!=null?t.body:Ht(e)&&e.body!==null?g(e):null;c.call(this,o,{timeout:t.timeout||e.timeout||0,size:t.size||e.size||0});const a=new D(t.headers||e.headers||{});if(o!=null&&!a.has("Content-Type")){const u=f(o);u&&a.append("Content-Type",u)}let l=Ht(e)?e.signal:null;if("signal"in t&&(l=t.signal),l!=null&&!jt(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[Qe]={method:i,redirect:t.redirect||e.redirect||"follow",headers:a,parsedURL:n,signal:l},this.follow=t.follow!==void 0?t.follow:e.follow!==void 0?e.follow:20,this.compress=t.compress!==void 0?t.compress:e.compress!==void 0?e.compress:!0,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent}get method(){return this[Qe].method}get url(){return gt(this[Qe].parsedURL)}get headers(){return this[Qe].headers}get redirect(){return this[Qe].redirect}get signal(){return this[Qe].signal}clone(){return new cr(this)}}s(cr,"Request"),c.mixIn(cr.prototype),Object.defineProperty(cr.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(cr.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function Xt(r){const e=r[Qe].parsedURL,t=new D(r[Qe].headers);if(t.has("Accept")||t.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(r.signal&&r.body instanceof xr.Readable&&!xt)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(r.body==null&&/^(POST|PUT)$/i.test(r.method)&&(n="0"),r.body!=null){const o=m(r);typeof o=="number"&&(n=String(o))}n&&t.set("Content-Length",n),t.has("User-Agent")||t.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),r.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip,deflate");let i=r.agent;return typeof i=="function"&&(i=i(e)),!t.has("Connection")&&!i&&t.set("Connection","close"),Object.assign({},e,{method:r.method,headers:K(t),agent:i})}s(Xt,"getNodeRequestOptions");function Je(r){Error.call(this,r),this.type="aborted",this.message=r,Error.captureStackTrace(this,this.constructor)}s(Je,"AbortError"),Je.prototype=Object.create(Error.prototype),Je.prototype.constructor=Je,Je.prototype.name="AbortError";const dt=xr.PassThrough,ut=No.resolve;function yt(r,e){if(!yt.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return c.Promise=yt.Promise,new yt.Promise(function(t,n){const i=new cr(r,e),o=Xt(i),a=(o.protocol==="https:"?Pl:as).request,l=i.signal;let u=null;const d=s(function(){let k=new Je("The user aborted a request.");n(k),i.body&&i.body instanceof xr.Readable&&i.body.destroy(k),!(!u||!u.body)&&u.body.emit("error",k)},"abort");if(l&&l.aborted){d();return}const _=s(function(){d(),P()},"abortAndFinalize"),R=a(o);let A;l&&l.addEventListener("abort",_);function P(){R.abort(),l&&l.removeEventListener("abort",_),clearTimeout(A)}s(P,"finalize"),i.timeout&&R.once("socket",function(M){A=setTimeout(function(){n(new rn(`network timeout at: ${i.url}`,"request-timeout")),P()},i.timeout)}),R.on("error",function(M){n(new rn(`request to ${i.url} failed, reason: ${M.message}`,"system",M)),P()}),R.on("response",function(M){clearTimeout(A);const k=fe(M.headers);if(yt.isRedirect(M.statusCode)){const Y=k.get("Location"),he=Y===null?null:ut(i.url,Y);switch(i.redirect){case"error":n(new rn(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),P();return;case"manual":if(he!==null)try{k.set("Location",he)}catch(Ie){n(Ie)}break;case"follow":if(he===null)break;if(i.counter>=i.follow){n(new rn(`maximum redirect reached at: ${i.url}`,"max-redirect")),P();return}const De={headers:new D(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if(M.statusCode!==303&&i.body&&m(i)===null){n(new rn("Cannot follow redirect with body being a readable stream","unsupported-redirect")),P();return}(M.statusCode===303||(M.statusCode===301||M.statusCode===302)&&i.method==="POST")&&(De.method="GET",De.body=void 0,De.headers.delete("content-length")),t(yt(new cr(he,De))),P();return}}M.once("end",function(){l&&l.removeEventListener("abort",_)});let B=M.pipe(new dt);const U={url:i.url,status:M.statusCode,statusText:M.statusMessage,headers:k,size:i.size,timeout:i.timeout,counter:i.counter},H=k.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||H===null||M.statusCode===204||M.statusCode===304){u=new ke(B,U),t(u);return}const re={flush:ln.Z_SYNC_FLUSH,finishFlush:ln.Z_SYNC_FLUSH};if(H=="gzip"||H=="x-gzip"){B=B.pipe(ln.createGunzip(re)),u=new ke(B,U),t(u);return}if(H=="deflate"||H=="x-deflate"){M.pipe(new dt).once("data",function(he){(he[0]&15)==8?B=B.pipe(ln.createInflate()):B=B.pipe(ln.createInflateRaw()),u=new ke(B,U),t(u)});return}if(H=="br"&&typeof ln.createBrotliDecompress=="function"){B=B.pipe(ln.createBrotliDecompress()),u=new ke(B,U),t(u);return}u=new ke(B,U),t(u)}),v(R,i)})}s(yt,"fetch"),yt.isRedirect=function(r){return r===301||r===302||r===303||r===307||r===308},yt.Promise=global.Promise;const Lt=yt;var Yt=__webpack_require__(271),At=__webpack_require__.n(Yt);const Zt=Lt;async function Ir(r,e,t){const n=new(At());t.onCancellationRequested(()=>{n.abort()});try{return await Lt(r,{...e,signal:n.signal})}catch(i){throw t.isCancellationRequested?new h.CancellationError:i}}s(Ir,"fetchWithCancellation");const Dr=V.loadMessageBundle(),_r="https://app.vssps.visualstudio.com/oauth2",ur="https://vscode.dev/codeExchangeProxyEndpoints/azuredevops",Wr="B6B1E9E6-B408-45D9-A6EA-AF1FFBAB6A0F",Gr=["vso.code"];function Ft(r){return(r.query.includes("&")?r.query:decodeURIComponent(r.query)).split("&").reduce((t,n)=>{const i=n.split("=");return t[i[0]]=i[1],t},{})}s(Ft,"parseQuery");const Ct=new h.EventEmitter,ar=new h.EventEmitter,kr="Network failure",ss="AzDO",uo="azuredevops";class Vt{constructor(e){this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this.secretStorage=e.secrets,this.extensionId=e.extension.id}async initialize(){await this.secretStorage.get(ss)&&($.debug("Detected outdated auth session format. Removing and will ask for new auth session... "),await this.secretStorage.delete(ss));const t=await this.secretStorage.get(uo);if(t)try{const i=this.parseStoredData(t).map(async o=>{var a;if(!o.refreshToken)return Promise.resolve();try{await this.refreshToken(o.refreshToken,o.scope,o.id)}catch(l){l.message===kr?await this.handleRefreshNetworkError(o.id,o.refreshToken,o.scope)||(this._tokens.push({accessToken:void 0,refreshToken:o.refreshToken,account:{label:(a=o.account.label)!=null?a:o.account.displayName,id:o.account.id},scope:o.scope,sessionId:o.id}),this.pollForReconnect(o.id,o.refreshToken,o.scope)):await this.removeSession(o.id)}});await Promise.all(i)}catch(n){$.log("Failed to initialize stored data"),await this.clearSessions()}this._disposables.push(this.secretStorage.onDidChange(()=>this.checkForUpdates))}parseStoredData(e){return JSON.parse(e)}async storeTokenData(){const e=this._tokens.map(t=>({id:t.sessionId,refreshToken:t.refreshToken,scope:t.scope,account:t.account}));await this.secretStorage.store(uo,JSON.stringify(e))}async checkForUpdates(){const e=[];let t=[];const n=await this.secretStorage.get(uo);if(n)try{const i=this.parseStoredData(n);let o=i.map(async a=>{if(!this._tokens.some(u=>u.scope===a.scope&&u.sessionId===a.id)&&a.refreshToken)try{const u=await this.refreshToken(a.refreshToken,a.scope,a.id);e.push(this.convertToSessionSync(u))}catch(u){u.message===kr||await this.removeSession(a.id)}});o=o.concat(this._tokens.map(async a=>{i.some(u=>a.scope===u.scope&&a.sessionId===u.id)||(await this.removeSession(a.sessionId),t.push(this.convertToSessionSync(a)))})),await Promise.all(o)}catch(i){$.error(i),t=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(t=this._tokens.map(this.convertToSessionSync),$.log("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach(i=>{clearTimeout(i)}),this._refreshTimeouts.clear());(e.length||t.length)&&Ct.fire({added:e,removed:t,changed:[]})}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e){const t=await this.resolveAccessToken(e);return{id:e.sessionId,accessToken:t,account:e.account,scopes:e.scope.split(" ")}}async resolveAccessToken(e){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?$.log(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):$.log("Token available from cache"),Promise.resolve(e.accessToken);try{$.log("Token expired or unavailable, trying refresh");const t=await this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(t.accessToken)return t.accessToken;throw new Error("No access token returned.")}catch(t){throw new Error("Unavailable due to network problems")}}getTokenClaims(e){try{return JSON.parse(Gu.Buffer.from(e.split(".")[1],"base64").toString())}catch(t){throw $.error(t),new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map(e=>this.convertToSession(e)))}async getSessions(e){if(!e)return this.sessions;const t=e.sort().join(" "),n=this._tokens.filter(i=>i.scope===t);return Promise.all(n.map(i=>this.convertToSession(i)))}createSession(e){return $.log("Logging in..."),this.loginWithoutLocalServer(e)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[]}isTestEnvironment(e){return/\.azurewebsites\.net$/.test(e.authority)||e.authority.startsWith("localhost:")}async loginWithoutLocalServer(e){var t;const n=await h.env.asExternalUri(h.Uri.parse(`${h.env.uriScheme}://${this.extensionId}/login`));if(this.isTestEnvironment(n)){const d=await h.window.showInputBox({prompt:'Azure Repos Personal Access Token (you must have "vso.code" in your scopes)',ignoreFocusOut:!0});if(!d)throw new Error("Sign in failed: No token provided");return{id:"test",accessToken:d,scopes:Gr,account:{id:"test",label:"Test Account"}}}const i=n.toString(),o=h.Uri.parse(`${_r}/authorize?client_id=${Wr}&response_type=Assertion&state=${encodeURIComponent(i)}&scope=${encodeURIComponent(Gr.join(" "))}&redirect_uri=${encodeURIComponent(ur)}`),a=new Promise((d,_)=>{const R=setTimeout(()=>{clearTimeout(R),_("Login timed out.")},1e3*60*5)}),l=(t=this._pendingStates.get(e))!=null?t:[];this._pendingStates.set(e,[...l,i]);let u=this._codeExchangePromises.get(e);return u||(u=this.handleCodeResponse(e),this._codeExchangePromises.set(e,u)),h.env.openExternal(o),Promise.race([u,a]).finally(()=>{this._pendingStates.delete(e),this._codeExchangePromises.delete(e)})}async handleCodeResponse(e){let t;return new Promise((n,i)=>{t=ar.event(async o=>{try{$.log(`Received Uri: ${o.toString()}`);const a=Ft(o);if(!a)throw new Error(`No access info found in query: ${JSON.stringify(a)}`);const l=a,u=await this.getTokenFromResponse(l,e);this.setToken(u,e);const d=await this.convertToSession(u);n(d)}catch(a){$.error(a),i(a)}})}).then(n=>(t.dispose(),n)).catch(n=>{throw t.dispose(),n})}setToken(e,t){const n=this._tokens.findIndex(i=>i.sessionId===e.sessionId);return n>-1?this._tokens.splice(n,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout(async()=>{try{const i=await this.refreshToken(e.refreshToken,t,e.sessionId);Ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){i.message===kr?await this.handleRefreshNetworkError(e.sessionId,e.refreshToken,t)||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(await this.removeSession(e.sessionId),Ct.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}},1e3*(e.expiresIn*2/3))),this.storeTokenData()}async getTokenFromResponse(e,t,n){var i;const o=this.getTokenClaims(e.access_token),a=await Zt("https://app.vssps.visualstudio.com/_apis/profile/profiles/me?api-version=6.0",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});let l;if(a.ok)l=(await a.json()).displayName;else{const u=await a.text();$.error(u),l="User"}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+e.expires_in*1e3:void 0,accessToken:e.access_token,refreshToken:e.refresh_token,scope:t,sessionId:n!=null?n:`${o.nameid}/${yc()}`,account:{label:l,id:`${o.nameid}/${(i=o.aui)!=null?i:""}`}}}async refreshToken(e,t,n){$.log("Refreshing token...");const i=`refresh_token=${encodeURIComponent(e)}`;let o;try{o=await Zt(ur,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":i.length.toString()},body:i})}catch(a){throw $.error("Refreshing token failed"),new Error(kr)}try{if(o.ok){const a=await o.json(),l=await this.getTokenFromResponse({access_token:a.access_token,expires_in:a.expires_in,refresh_token:a.refresh_token},t,n);return this.setToken(l,t),$.log("Token refresh success"),l}throw new Error("Bad request.")}catch(a){throw await h.window.showErrorMessage(Dr("signOut","You have been signed out because reading stored authentication information failed.")),$.error(`Refreshing token failed: ${o.statusText}`),new Error("Refreshing token failed")}}clearSessionTimeout(e){const t=this._refreshTimeouts.get(e);t&&(clearTimeout(t),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const t=this._tokens.findIndex(i=>i.sessionId===e);let n;return t>-1&&(n=this._tokens[t],this._tokens.splice(t,1)),this.clearSessionTimeout(e),n}pollForReconnect(e,t,n){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const i=await this.refreshToken(t,n,e);Ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){this.pollForReconnect(e,t,n)}},1e3*60*30))}handleRefreshNetworkError(e,t,n,i=1){return new Promise((o,a)=>{if(i===3)return $.error("Token refresh failed after 3 attempts"),o(!1);const l=5*i*i;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const u=await this.refreshToken(t,n,e);return Ct.fire({added:[],removed:[],changed:[this.convertToSessionSync(u)]}),o(!0)}catch(u){return o(await this.handleRefreshNetworkError(e,t,n,i+1))}},1e3*l))})}async removeSession(e){$.log(`Logging out of session '${e}'`);const t=this.removeInMemorySessionData(e);let n;return t&&(n=this.convertToSessionSync(t)),this._tokens.length===0?await this.secretStorage.delete(uo):this.storeTokenData(),n}async clearSessions(){$.log("Logging out of all sessions"),this._tokens=[],await this.secretStorage.delete(uo),this._refreshTimeouts.forEach(e=>{clearTimeout(e)}),this._refreshTimeouts.clear()}}s(Vt,"AzureDevOpsAuthService");const cs=s(class{constructor(r){this.onDidChangeSessions=Ct.event,this.loginService=new Vt(r),this.initializePromise=this.loginService.initialize(),this.disposable=h.authentication.registerAuthenticationProvider(cs.id,"Azure Repos",this)}dispose(){this.disposable.dispose()}async getSessions(r){return await this.initializePromise,this.loginService.getSessions(r)}async createSession(r){await this.initializePromise;const e=await this.loginService.createSession(r.sort().join(" "));return Ct.fire({added:[e],removed:[],changed:[]}),e}async removeSession(r){await this.initializePromise;const e=await this.loginService.removeSession(r);e&&Ct.fire({added:[],removed:[e],changed:[]})}},"_AzDOAuthenticationProvider");let wi=cs;wi.id="azurerepos";var Hn=__webpack_require__(7360),ii=__webpack_require__(850),$i=__webpack_require__.n(ii);function An(r,e,t){if(!(e==null?void 0:e.length)&&!(t==null?void 0:t.length))return new Set(r);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(a=>`${a}/**`)]),o=$i()(r,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(t==null?void 0:t.length){const i=new Set([...t,...t.map(o=>`${o}/**`)]);if(n===void 0){const o=$i().not(r,[...i],{dot:!0,nocase:!0});n=new Set(o)}else $i()(r,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}s(An,"globFilter");var ls=Object.defineProperty,us=Object.getOwnPropertyDescriptor,Rn=s((r,e,t,n)=>{for(var i=n>1?void 0:n?us(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&ls(e,t,i),i},"fs_decorateClass");const wc=(0,V.loadMessageBundle)(),Fo=h.FileSystemError.FileNotFound().code,ds=/(\/|\\)/g;class Bi{constructor(e,t,n){this.providerService=e,this.azdo=t,this.changeStore=n,this._onDidChangeFile=new h.EventEmitter,this.contentCache=new Map,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.pathTypeMap={},this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),h.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(i=>{i.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([i.repository.uri])}),e.onDidRefresh(i=>this.onRefreshOrRepositoryChanged(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.azdo.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(t=>tr.getProviderId(t)===this.scheme).map(t=>this.providerService.getProviderUri(t)),e.length!==0){$.log(`AzDOFS.onRefreshOrRepositoryChanged(${e.map(t=>t.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[t,n]of[...this.pendingUriRequests])e.some(i=>Be(n.uri,i))&&(this.pendingUriRequests.delete(t),n.outdated=!0);for(const[t,{uri:n}]of[...this.contentCache])e.some(i=>Be(n,i))&&this.contentCache.delete(t);this.updateOpenOrWatchedUris(e)}}onTextDocumentClosed(e){e.scheme===this.scheme&&this.contentCache.delete(ne(e))}updateOpenOrWatchedUris(e){const t=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>Be(o,a))&&(this.implicitlyWatchedUris.delete(i),t.set(i,o));$.debug(`AzDOFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${t.size}`);for(const i of e)t.set(ne(i),i);const n=[...t.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{$.debug(`AzDOFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,t){const n=ne(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){const t=ne(e);this.implicitlyWatchedUris.set(t,e);const n={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${t}`,n);const i=await this.providerService.getMetadata(e),o=h.FilePermission.Readonly;if(!i.path)return{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o};if(i.path in this.pathTypeMap||await this.updateWorkspaceItemMap(i,e.path,!0),i.path in this.pathTypeMap)return this.pathTypeMap[i.path]===h.FileType.Directory?{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o}:{type:h.FileType.File,mtime:0,ctime:0,size:0,permissions:o};if(this.implicitlyWatchedUris.delete(t),e.query!=="~")throw h.FileSystemError.FileNotFound(e);return{type:h.FileType.File,size:0,ctime:0,mtime:Date.now(),permissions:h.FilePermission.Readonly}}finally{this.pendingUriRequests.delete(`stat:${t}`),(n==null?void 0:n.outdated)&&setTimeout(()=>{$.log(`AzDOFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async updateWorkspaceItemMap(e,t,n){const i=new Array,o=await this.azdo.getRepoItems(e,t,{recursionLevel:"OneLevel"});for(const a of o){const l=a.path.substring(1);if(l!==e.path||n){const u=a.isFolder===!0?h.FileType.Directory:h.FileType.File;this.pathTypeMap[l]=u,i.push([l,u])}}return i}async readDirectory(e){this.implicitlyWatchedUris.set(ne(e),e);const t=this.providerService.getVirtualRootUri(e),n=await this.providerService.getMetadata(e);return(await this.updateWorkspaceItemMap(n,e.path,!1)).map(o=>[this.providerService.getRelativeFilePath(e,tt(t,o[0])),o[1]])}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){var t;const n=ne(e);this.implicitlyWatchedUris.set(n,e);let i=this.contentCache.get(n);if(i!==void 0)return i.content;const o={uri:e,outdated:!1};try{return this.pendingUriRequests.set(n,o),i={content:this.azdo.getFileContent(e),uri:e},this.contentCache.set(n,i),await i.content}catch(a){if(this.implicitlyWatchedUris.delete(n),i!==void 0&&i.content===((t=this.contentCache.get(n))==null?void 0:t.content)&&this.contentCache.delete(n),e.query==="~"&&a instanceof h.FileSystemError&&a.code===Fo)return new Uint8Array(0);throw a}finally{this.pendingUriRequests.delete(n),(o==null?void 0:o.outdated)&&setTimeout(()=>{$.log(`AzDOFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,t,n){throw h.FileSystemError.NoPermissions()}delete(e,t){throw h.FileSystemError.NoPermissions()}rename(e,t,n){throw h.FileSystemError.NoPermissions()}copy(e,t,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:t,maxResults:n,includes:i,excludes:o},a){const l=`${ne(t)}|${JSON.stringify({includes:i,excludes:o})}`;let u=this.fileSearchCache.get(l);if(u===void 0){const _=await this.providerService.getMetadata(t),R=await this.azdo.getRepoItems(_,"",{recursionLevel:"Full"});let A=[];for(const P of R)P.isFolder||A.push(P.path);if(A.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(A=[...An(A,i,o)]),u=A.map(P=>Hn.prepareSlow(P)),this.fileSearchCache.set(l,u)}let d;return e.pattern===""?d=u.map(_=>h.Uri.joinPath(t,_.target)):(d=Hn.go(e.pattern.replace(ds,"/"),u,{allowTypo:!0,limit:n}).map(_=>h.Uri.joinPath(t,_.target)),Hn.cleanup()),n!==void 0&&n!==0&&n<d.length&&(d=d.slice(0,n)),d}async provideTextSearchResults(e,t,n,i){const o=[];(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&o.push({text:wc("azdo flags not supported","Search flags are not supported."),type:h.TextSearchCompleteMessageType.Warning});const a=await this.azdo.searchCodeQuery(e.pattern,t.folder,{maxResults:t.maxResults,context:{before:t.beforeContext,after:t.afterContext}});if(a.warnings&&a.warnings.forEach(u=>{o.push({text:u,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let l;for(const u of a.matches)l=h.Uri.joinPath(t.folder,u.path),n.report({uri:l,ranges:u.ranges,preview:{text:u.preview,matches:u.matches}});return{limitHit:!1,message:o}}}s(Bi,"AzDOFS"),Rn([fn()],Bi.prototype,"stat",1),Rn([fn()],Bi.prototype,"readDirectory",1),Rn([fn()],Bi.prototype,"readFile",1);var bi;(function(r){r[r.Force=0]="Force",r[r.ForceWithLease=1]="ForceWithLease"})(bi||(bi={}));var nn;(function(r){r[r.Head=0]="Head",r[r.RemoteHead=1]="RemoteHead",r[r.Tag=2]="Tag"})(nn||(nn={}));var oi;(function(r){r[r.INDEX_MODIFIED=0]="INDEX_MODIFIED",r[r.INDEX_ADDED=1]="INDEX_ADDED",r[r.INDEX_DELETED=2]="INDEX_DELETED",r[r.INDEX_RENAMED=3]="INDEX_RENAMED",r[r.INDEX_COPIED=4]="INDEX_COPIED",r[r.MODIFIED=5]="MODIFIED",r[r.DELETED=6]="DELETED",r[r.UNTRACKED=7]="UNTRACKED",r[r.IGNORED=8]="IGNORED",r[r.INTENT_TO_ADD=9]="INTENT_TO_ADD",r[r.ADDED_BY_US=10]="ADDED_BY_US",r[r.ADDED_BY_THEM=11]="ADDED_BY_THEM",r[r.DELETED_BY_US=12]="DELETED_BY_US",r[r.DELETED_BY_THEM=13]="DELETED_BY_THEM",r[r.BOTH_ADDED=14]="BOTH_ADDED",r[r.BOTH_DELETED=15]="BOTH_DELETED",r[r.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(oi||(oi={}));var ya;(function(r){r.BadConfigFile="BadConfigFile",r.AuthenticationFailed="AuthenticationFailed",r.NoUserNameConfigured="NoUserNameConfigured",r.NoUserEmailConfigured="NoUserEmailConfigured",r.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",r.NotAGitRepository="NotAGitRepository",r.NotAtRepositoryRoot="NotAtRepositoryRoot",r.Conflict="Conflict",r.StashConflict="StashConflict",r.UnmergedChanges="UnmergedChanges",r.PushRejected="PushRejected",r.RemoteConnectionError="RemoteConnectionError",r.DirtyWorkTree="DirtyWorkTree",r.CantOpenResource="CantOpenResource",r.GitNotFound="GitNotFound",r.CantCreatePipe="CantCreatePipe",r.PermissionDenied="PermissionDenied",r.CantAccessRemote="CantAccessRemote",r.RepositoryNotFound="RepositoryNotFound",r.RepositoryIsLocked="RepositoryIsLocked",r.BranchNotFullyMerged="BranchNotFullyMerged",r.NoRemoteReference="NoRemoteReference",r.InvalidBranchName="InvalidBranchName",r.BranchAlreadyExists="BranchAlreadyExists",r.NoLocalChanges="NoLocalChanges",r.NoStashFound="NoStashFound",r.LocalChangesOverwritten="LocalChangesOverwritten",r.NoUpstreamBranch="NoUpstreamBranch",r.IsInSubmodule="IsInSubmodule",r.WrongCase="WrongCase",r.CantLockRef="CantLockRef",r.CantRebaseMultipleBranches="CantRebaseMultipleBranches",r.PatchDoesNotApply="PatchDoesNotApply",r.NoPathFound="NoPathFound",r.UnknownPath="UnknownPath"})(ya||(ya={}));function _a(r){return Buffer.from(r,"base64")}s(_a,"fromBase64");function wn(r){return Buffer.from(r).toString("base64")}s(wn,"toBase64");var Ei=Object.defineProperty,bn=Object.getOwnPropertyDescriptor,Ui=s((r,e,t,n)=>{for(var i=n>1?void 0:n?bn(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ei(e,t,i),i},"provider_decorateClass");const fr=/^https?:\/\/dev\.azure\.com(?:\/defaultcollection)?\/(?<organization>[^/]+)(?:\/(?<project>[^_/][^/]*))?(?:\/_git)?\/(?<repo>[^/?#]+)(?:\/commit\/(?<commit>[0-9a-f]{40})|\/pullrequest\/(?<pull>\d+))?/i,wa=(0,V.loadMessageBundle)(),Hi=1,Ur=Object.freeze({id:"azurerepos",name:"Azure Repos"});function un(r){const{scheme:e,metadata:t}=tr.decodeAuthority(r),[,n,i,o,...a]=r.path.split("/");return{scheme:e,provider:Ur,name:`${n}/${i}/${o}`,repo:{organization:n,project:i,name:o},path:a.join("/")||"",ref:t==null?void 0:t.ref,idx:t==null?void 0:t.idx}}s(un,"getAzDOMetadata");function bc(r,e){const{repo:t}=e!=null?e:un(r);return r.with({path:`/${t.organization}/${t.project}/${t.name}`,query:"",fragment:""})}s(bc,"getAzDORootUri");function ba(r,e,t){const{repo:{organization:n,name:i}}=r instanceof h.Uri?un(r):r;return h.Uri.parse(`azurerepos://${tr.encodeAuthority("azurerepos",{v:Hi,ref:{type:ht.Commit,id:e}})}/${n}/${i}/${t}`)}s(ba,"getAzDORevisionUri");function hs(r){var e,t,n,i,o,a;const l=fr.exec(r);if((l==null?void 0:l.groups)===void 0)return;const{organization:u,project:d,repo:_,commit:R}=l.groups,A=Ft(h.Uri.parse(r)),P=/^GB(?<branchName>.+)/i.exec((e=A.version)!=null?e:""),M=/^GT(?<tagName>.+)/i.exec((t=A.version)!=null?t:""),k=/^GC(?<commit>[0-9a-f]{40})/i.exec((n=A.version)!=null?n:""),B=A.path&&A.path!=="/"?A.path:void 0;return{organization:u,project:d,repo:_,branch:(i=P==null?void 0:P.groups)==null?void 0:i.branchName,tag:(o=M==null?void 0:M.groups)==null?void 0:o.tagName,commit:R!=null?R:(a=k==null?void 0:k.groups)==null?void 0:a.commit,path:B}}s(hs,"parseAzureReposUrl");class Ea{constructor(e){this.providerService=e}get isReadonly(){return!0}get scheme(){return"azurerepos"}dispose(){}async ensureAuthenticated(e=!1){const t=new lt("AzDO.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return await h.authentication.getSession(wi.id,Gr,{createIfNone:!0,forceNewSession:e})}catch{try{const o=await h.authentication.getSession(wi.id,Gr,{createIfNone:!1});if(o!==void 0)return o}catch{}return new Promise(o=>{async function a(){const u=await h.authentication.getSession(wi.id,Gr,{createIfNone:!0});u!==void 0&&o(u)}s(a,"getSession");const l=h.authentication.onDidChangeSessions(async u=>{u.provider.id===wi.id&&(l.dispose(),await a())})})}}s(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id===wi.id&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{t.stop()}}async getAuthentication(e){const t=await this.ensureAuthenticated();return{provider:Ur,session:t,getRichNavigationHeaders:()=>({"X-Git-AzureDevOps":`Basic ${this.getBase64AuthenticationSessionToken(t)}`})}}getBase64AuthenticationSessionToken(e){if(this._sessionTokenBase64===void 0){if(e===void 0)return this.ensureAuthenticated().then(t=>(this._sessionTokenBase64=wn(`PAT:${t.accessToken}`),this._sessionTokenBase64));this._sessionTokenBase64=wn(`PAT:${e.accessToken}`)}return this._sessionTokenBase64}clearAuthenticationSession(){this._session=void 0,this._sessionTokenBase64=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async sendGetRequest(e,t,n,i){const a=`${n?`https://dev.azure.com/${e}/${n}/_apis/`:`https://dev.azure.com/${e}/_apis/`}${t}${i?`?${i}&`:"?"}api-version=5.1`;try{const l=await this.getBase64AuthenticationSessionToken();if(!l)throw new St("Unauthenticated",()=>this.reauthenticate());const u=await Zt(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${l}`}});if(u.status===401)throw new St("Unauthenticated",()=>this.reauthenticate());if(u.status===404)return;const d=await u.json();return d!=null?d:void 0}catch(l){throw $.error(l),l instanceof St&&en.showStatus401Message(l.reauthenticate),l}}async sendPostRequest(e,t){try{const n=await this.getBase64AuthenticationSessionToken();if(!n)throw new St("Unauthenticated",()=>this.reauthenticate());const i=await Zt(e,{method:"POST",body:t,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${n}`}});if(i.status===401)throw new St("Unauthenticated",()=>this.reauthenticate());const o=await i.json();return o!=null?o:void 0}catch(n){throw $.error(n),n instanceof St&&en.showStatus401Message(n.reauthenticate),n}}canOpenRemoteUrl(e){const t=hs(e);if(t===void 0)return;const{branch:n,tag:i,commit:o,path:a}=t;return a?Pt.File:n?Pt.Branch:i?Pt.Tag:o?Pt.Commit:Pt.Repository}async createWorkspaceForRemoteUrl(e,t=ir.CurrentWindow){const n=hs(e);if(n===void 0)return;const{organization:i,project:o,repo:a,branch:l,tag:u,commit:d,path:_}=n;let R;l?R={type:ht.Branch,id:l}:u?R={type:ht.Tag,id:u}:d&&(R={type:ht.Commit,id:d});const A=this.providerService.createVirtualUri("azurerepos",{repo:{organization:i,project:o!=null?o:a,name:a},ref:R});return{name:(await this.providerService.getMetadata(A)).name,uri:A,location:t,filesToOpen:_?[_]:void 0}}createVirtualUri(e,{repo:t,ref:n,idx:i},o){if((n==null?void 0:n.type)===ht.Tree)throw new Error(`Invalid ref type '${n.type}'`);const a=n!==void 0||i!==void 0?{v:Hi}:void 0;return a&&(n&&(a.ref={type:n.type,id:n.id}),i&&(a.idx=i)),e.with({authority:tr.encodeAuthority("azurerepos",a),path:`/${t.organization}/${t.project}/${t.name}${(o==null?void 0:o.startsWith("/"))?o:`/${o!=null?o:""}`}`})}getRemoteUri(e){const t=`https://dev.azure.com/${e.repo.organization}/${e.repo.project}/_git/${e.repo.name}`,n=e.path?`&path=/${e.path}`:"";return e.pullRequest?h.Uri.parse(t):e.branch?h.Uri.parse(`${t}?version=GB${e.branch}${n}`):e.tag?h.Uri.parse(`${t}?version=GT${e.tag}${n}`):e.sha?h.Uri.parse(`${t}?version=GC${e.sha}${n}`):h.Uri.parse(t)}getProviderRootUri(e){return bc(e)}getRelativeFilePath(e,t){const{path:n}=un(e),{path:i}=un(tt(e,t));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:t,name:n,repo:i,ref:o}=un(e);return{provider:t,name:n,repo:i,ref:o}}async validateBranchOrTagCasing(e,t,n,i){const o=`git/repositories/${n}/refs`,a="includeLinks=true",l=await this.sendGetRequest(e,o,t,a);if((l==null?void 0:l.value)===void 0){$.warn("Could not get branches, might be incorrect auth token");return}const u=l.value;if(u.length===0)return i?{type:ht.Branch,id:i}:void 0;const d=`refs/heads/${i.toLowerCase()}`,_=`refs/tags/${i.toLowerCase()}`;for(const R of u){const A=R.name;if(A.toLowerCase()==d)return{type:ht.Branch,id:A.substr(11)};if(A.toLowerCase()==_)return{type:ht.Tag,id:A.substr(10)}}}async getModeRefType(e,t){const{HEAD:n,pullRequest:i}=await(t!=null?t:this.getMetadata(e));switch(n.type){case Le.Branch:return i!==void 0?se.PullRequestBranch:se.Branch;case Le.RemoteBranch:return i!==void 0?se.PullRequestRemoteBranch:se.RemoteBranch;case Le.Tag:return se.Tag;case Le.Commit:return se.Commit}}async createMetadata(e,t){var n,i,o,a;const l=new lt(`AzDO.createMetadata(${e.toString()}, ${t})`);let u;try{let{provider:d,name:_,repo:{organization:R,project:A,name:P},ref:M}=un(e);if(!M||M.type===ht.Commit&&/HEAD/i.test(M.id))M={type:ht.Commit,id:"HEAD"};else if((M.type===ht.Branch||M.type===ht.Tag)&&(M=await this.validateBranchOrTagCasing(R,A,P,M.id),M===void 0))throw new Error(`Cannot get metadata for Uri(${e.toString(!0)}); Unable to find the specified branch or tag`);const k=await this.getRepositoryInfo(R,A,P,M);if(k===void 0)throw u=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let B;if(t)B=t;else if(M.type===ht.Commit)B=M.id;else if(B=(i=(n=k.ref)==null?void 0:n.sha)!=null?i:k.defaultBranch.sha,B===void 0)throw u=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let U;((o=k.ref)==null?void 0:o.prefix)==="refs/heads/"?U={type:Le.Branch,name:k.ref.name,sha:B,branch:{name:k.ref.name,sha:k.ref.sha}}:((a=k.ref)==null?void 0:a.prefix)==="refs/tags/"?U={type:Le.Tag,name:k.ref.name,sha:B,detached:{type:Le.Tag,name:k.ref.name}}:U={type:Le.Commit,name:qt(B),sha:B,detached:{type:Le.Commit,name:qt(B)}};const H={version:ze.schemaVersion,timestamp:Date.now(),provider:d,name:_,repo:k.repo,user:k.user,accessLevel:k.accessLevel,HEAD:U,defaultBranch:k.defaultBranch,pullRequest:k.pullRequest};return u=` \u2022 HEAD=${U.sha}`,H}finally{l.stop(u?{suffix:u}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(azure-devops)",label:wa("open repo from","Open Repository from {0}","Azure Repos"),placeholder:wa("pick repo","Choose a repository"),provideOrganization:async()=>{var e;return(e=await this.getOrganization())==null?void 0:e.label},provideProject:async e=>{var t;return(t=await this.getTeamProject(e))==null?void 0:t.label},provideSources:async(e,t,n,i)=>{if(n)return;const o=await this.searchRepositoriesQuery(e,t);return o==null?void 0:o.map(a=>({providerId:"azurerepos",name:a.name,icon:"$(repo)",description:`${a.fork?`$(repo-forked) ${a.fork}`:""}${a.stars>0?`${a.fork?" \u2022 ":""}$(star-full) ${a.stars}`:""}`,detail:a.description,url:a.url}))}}]}async createBranch(e,t,n,i){throw new Error("Branch creation is currently not supported")}async createCommit(e,t,n,i){throw new Error("Commit creation is currently not supported")}async createAndPushCommit(e,t,n,i,o){throw new Error("Commit creation is currently not supported")}async createPullRequest(e,t,n,i,o){throw new Error("PR creation is currently not supported")}async fetch(e,t){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,t);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,t,n){var i,o,a,l;const{force:u,to:d}={...n,force:t||(n==null?void 0:n.force)},_=new lt(`AzDO.fetch(${e.toString()}, force=${u}, to=${d})`);let R;try{const A=await this.getMetadata(e);if(A.HEAD.detached)return R=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:A};if(A.HEAD.type===Le.RemoteBranch)return R=" \u2022 Skipped; remote branch",{fetched:!1,metadata:A};const P=await this.getBranchTips(e);if(!P)throw R=" \u2022 Unable to fetch branch tips",new Ut(t);if(!u&&!d&&((i=P.defaultBranch)==null?void 0:i.sha)!==void 0&&P.defaultBranch.sha===A.defaultBranch.sha&&((o=P.branch)==null?void 0:o.sha)!==void 0&&P.branch.sha===A.HEAD.branch.sha)return R=" \u2022 No changes detected",{fetched:!1,metadata:A};let M;if(((a=P.defaultBranch)==null?void 0:a.sha)!==void 0&&P.defaultBranch.sha!==A.defaultBranch.sha&&(M={defaultBranch:{...A.defaultBranch,sha:P.defaultBranch.sha}}),((l=P.branch)==null?void 0:l.sha)===void 0){if(R=" \u2022 Unable to find branch tip",u)throw new Ut(t);return M!==void 0?{fetched:!0,metadata:{...A,...M}}:{fetched:!1,metadata:A}}return P.branch.sha!==A.HEAD.branch.sha&&(M={...M,HEAD:{...A.HEAD,branch:{...A.HEAD.branch,sha:P.branch.sha},detached:void 0}}),P.branch.sha===A.HEAD.sha?(R=" \u2022 Up to date",A.state!==void 0||M!==void 0?{fetched:!0,metadata:{...A,...M,state:void 0}}:{fetched:!1,metadata:A}):M!==void 0?{fetched:!0,metadata:{...A,...M}}:{fetched:!1,metadata:A}}finally{_.stop(R?{suffix:R}:void 0)}}async fork(e){throw new Error("Forks are currently not supported")}async getBranches(e,t){try{const n=await this.getRefs(e,{...t,filter:"heads",filterContains:t==null?void 0:t.query});if(n.length===0)return{branches:[]};const i=[];for(const o of n)!o.name.startsWith("refs/heads/")||i.push({type:nn.Head,name:o.name.substr(11),commit:o.objectId,commitUrl:o.url});return{branches:i}}catch(n){return{branches:[]}}}async getCommit(e,t){try{const{repo:{organization:n,project:i,name:o}}=await this.getMetadata(e),a=`git/repositories/${o}/commits/${t}`,l=await this.sendGetRequest(n,a,i);return l===void 0?void 0:{hash:l.commitId,message:l.comment,parents:l.parents,authorDate:new Date(l.author.date),authorEmail:l.author.email,authorName:l.author.name,commitDate:new Date(l.committer.date)}}catch(n){return}}async getCommits(e,t){var n,i;try{const{repo:{organization:o,project:a,name:l}}=await this.getMetadata(e),u=`git/repositories/${l}/commits`;let d=`searchCriteria.itemVersion.version=${(n=t==null?void 0:t.cursor)!=null?n:t==null?void 0:t.ref}&searchCriteria.itemVersion.versionType=commit`;(t==null?void 0:t.path)&&(d+=`&searchCriteria.itemPath=${t.path}`);const _=(i=t==null?void 0:t.limit)!=null?i:100;d+=`&searchCriteria.$top=${_+1}`;const R=await this.sendGetRequest(o,u,a,d);if((R==null?void 0:R.value)===void 0)return;const A=R.value.map((M,k)=>({hash:M.commitId,message:M.comment,parents:R.value[k+1]?[R.value[k+1].commitId]:[],authorDate:new Date(M.author.date),authorEmail:M.author.email,authorName:M.author.name,commitDate:new Date(M.committer.date)}));let P;return A.length>_&&(A.splice(A.length-1,1),P={cursor:A[A.length-1].hash,more:!0}),{commits:A,paging:P}}catch(o){return}}async getFileContent(e,t,n){var i,o;try{const{HEAD:a,repo:{organization:l,project:u,id:d},path:_}=await this.providerService.getMetadata(e);n=n!=null?n:_;const R=`git/repositories/${d}/items`;let A="";n&&(A+=`path=${n}&includeContent=true`),t||mr((i=a.branch)==null?void 0:i.name)?A+=`&versionDescriptor.version=${t!=null?t:(o=a.branch)==null?void 0:o.name}&versionDescriptor.versionType=commit`:a.type===Le.Branch?A+=`&versionDescriptor.version=${a.branch.name}&versionDescriptor.versionType=branch`:a.type===Le.Tag&&(A+=`&versionDescriptor.version=${a.name}&versionDescriptor.versionType=tag`);const P=await this.sendGetRequest(l,R,u,A);if(P)return new TextEncoder().encode(P.content);throw h.FileSystemError.FileNotFound(e)}catch(a){throw $.logLevel===We.Debug&&$.error(a),a}}async getFork(e){throw new Error("Forks are currently not supported")}async getIncomingChanges(e){var t,n;return(n=(t=(await this.getMetadata(e)).state)==null?void 0:t.incomingChanges)!=null?n:[]}async compareCommits(e,t){throw new Error("Comparing commits is currently not supported")}async getObjectDetails(e,t,n){throw new Error("Not able to get object detail")}async getPullRequest(e,t){throw new Error("PRs are currently not supported")}async getRepoItems(e,t,n){const i=`git/repositories/${e.repo.name}/items`,[,,,,...o]=t.split("/");let a=`scopePath=${o.join("/")}&recursionLevel=${n.recursionLevel}&includeContentMetadata=true`;e.HEAD.type===Le.Commit?a+=`&versionDescriptor.version=${e.HEAD.sha}&versionDescriptor.versionType=commit`:e.HEAD.type===Le.Branch?a+=`&versionDescriptor.version=${e.HEAD.branch.name}&versionDescriptor.versionType=branch`:e.HEAD.type===Le.Tag&&(a+=`&versionDescriptor.version=${e.HEAD.name}&versionDescriptor.versionType=tag`);const l=await this.sendGetRequest(e.repo.organization,i,e.repo.project,a);return l&&Array.isArray(l==null?void 0:l.value)?l==null?void 0:l.value:($.debug(`AzDOProvider.getRepoItems returned ${l===void 0?"empty":"invalid"} result ${l==null?void 0:l.value} for path ${t}`),[])}async getTags(e,t){try{const n=await this.getRefs(e,{...t,filter:"tags",filterContains:t==null?void 0:t.query});if(n.length===0)return{tags:[]};const i=[];for(const o of n)!o.name.startsWith("refs/tags/")||i.push({type:nn.Tag,name:o.name.substr(10),commit:o.objectId,commitUrl:o.url});return{tags:i}}catch(n){return{tags:[]}}}async getTarGz(e,t){throw new Error("Getting zip is currently not supported")}async pushCommit(e,t,n,i){throw new Error("Commit pushing is not currently supported")}async getRefs(e,t){var n;const{repo:{organization:i,project:o,name:a}}=un(e),l=`git/repositories/${a}/refs`;let u="includeLinks=true";(t==null?void 0:t.filter)&&(u+=`&filter=${t.filter}`),(t==null?void 0:t.filterContains)&&(u+=`&filterContains=${t.filterContains}`),(t==null?void 0:t.limit)&&(u+=`&$top=${t.limit}`);const d=await this.sendGetRequest(i,l,o,u);return(n=d==null?void 0:d.value)!=null?n:[]}async getOrganization(){const e=s(async()=>{const t=await this.getAccounts();return t?t.sort((n,i)=>n.accountName.localeCompare(i.accountName)).map(n=>({label:n.accountName})):[]},"getQuickPickItems");return h.window.showQuickPick(e(),{placeHolder:"Choose an Azure DevOps Organization",title:"Choose an Azure DevOps Organization",ignoreFocusOut:!0})}async getTeamProject(e){const t=s(async()=>{const n=await this.sendGetRequest(e,"projects");return(n==null?void 0:n.value)?n.value.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({label:i.name,description:i.description})):[]},"getQuickPickItems");return h.window.showQuickPick(t(),{placeholder:"Choose an Azure DevOps project",title:"Choose an Azure DevOps project",ignoreFocusOut:!0})}async searchRepositoriesQuery(e,t){try{const n=await this.sendGetRequest(e,"git/repositories",t);return n?n.value.filter(i=>i.defaultBranch&&!i.isDisabled).sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({name:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0})):void 0}catch(n){throw $.error(n),n}}async getAccounts(){var e;try{const t=await this.getBase64AuthenticationSessionToken();if(!t)throw new St("Unauthenticated",()=>this.reauthenticate());const i=`https://app.vssps.visualstudio.com/_apis/accounts?memberId=${(e=this._session)==null?void 0:e.account.id.split("/")[0]}&api-version=6.0`,o=await Zt(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${t}`}});if(o.status===401)throw new St("Unauthenticated",()=>this.reauthenticate());return(await o.json()).value}catch(t){$.error(t);return}}async searchCodeQuery(e,t,n){var i;const{repo:{organization:o,project:a,name:l},HEAD:u,defaultBranch:d}=await this.getMetadata(t),_=`https://almsearch.dev.azure.com/${o}/${a}/_apis/search/codesearchresults?api-version=6.1-preview.1`,R=u.branch?u.branch.name:d.name,A={searchText:e,$skip:0,$top:1e3,filters:{Project:[a],Repository:[l],Path:["/"],Branch:[R]},$orderBy:[{field:"filename",sortOrder:"ASC"}],includeSnippet:!0},P=await this.sendPostRequest(_,JSON.stringify(A)),M=new h.Range(0,0,0,0),k=[];let B;for(const U of(i=P==null?void 0:P.results)!=null?i:[])for(const H of U.matches.content){B={path:U.path,ranges:[],preview:"",matches:[]};const re=Math.max(0,H.line-1),Y=H.charOffset,he=Y+H.length;B.preview=H.codeSnippet?H.codeSnippet:`CharOffset: ${H.charOffset}, Type: ${H.type}`,B.ranges.push(new h.Range(re,Y,re,he)),B.matches.push(M),k.push(B)}return{matches:k,limitHit:!1}}async switchTo(e,t,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let l;if(!(t!==void 0&&(typeof t=="string"?t.startsWith("refs/heads/")?l={type:ht.Branch,id:t.substr(11)}:t.startsWith("refs/tags/")?l={type:ht.Tag,id:t.substr(10)}:l={type:ht.Branch,id:t}:l={...t,type:t.type===ht.Tree?ht.Branch:t.type},(a==null?void 0:a.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?ir.NewWindow:ir.CurrentWindow}}async sync(e,t,n){var i,o,a,l,u,d;const _=new lt(`AzDO.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let R;try{const{metadata:A}=await this.fetchCore(e,!0,{to:n.to});if(A.HEAD.detached){R=" \u2022 Skipped; detached HEAD";return}if(((o=(i=A==null?void 0:A.state)==null?void 0:i.behind)!=null?o:0)>0&&await t.hasChanges(e)){_.logStep("Fetching upstream changes");const P=[],M=(l=(a=A.state)==null?void 0:a.incomingChanges)!=null?l:[];if(M.length>0){const k=await t.getChanges(e);for(const B of k){const U=this.providerService.getRelativeFilePath(e,B.uri),H=M.find(re=>re.uri.path===B.uri.path);if(H!==void 0){P.push({path:U,current:B,incomingType:H.type});break}}}if(P.length>0)switch(n.conflictResolution){case Mr.KeepCurrent:_.logStep("Syncing (keep) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const k of P)await t.keep(k.current.uri,{type:k.incomingType,providerUri:ba(A,A.HEAD.branch.sha,k.path)});break;case Mr.DiscardCurrent:_.logStep("Syncing (discard) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const k of P)await t.discard(k.current.uri);break;case Mr.Merge:_.logStep("Syncing (merge) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const k of P)await t.merge(k.current.uri,{type:k.incomingType,providerUri:ba(A,A.HEAD.branch.sha,k.path)},{providerUri:ba(A,A.HEAD.sha,k.path)});break;case Mr.Abort:default:throw _.logStep("Syncing (abort) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,A),new gr}}R=` \u2022 to=${(u=n.to)!=null?u:A.HEAD.branch.sha}`,await this.fastForwardTo(e,(d=n.to)!=null?d:A.HEAD.branch.sha,A)}finally{_.stop(R?{suffix:R}:void 0)}}async fastForwardTo(e,t,n){if(n.HEAD.detached)throw new $e("Unable to fast-forward; no current branch");n.HEAD.sha===t&&n.state===void 0||($.log(`Fast forward to ${t}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:t},state:void 0,timestamp:Date.now()}),t!==n.HEAD.branch.sha&&await this.fetchCore(e,!1,{to:t}))}async getBranchTips(e,t){try{const{repo:{organization:n,project:i,name:o},HEAD:{branch:a}}=await this.getMetadata(e);t===void 0?t=a?`heads/${a.name}`:"":t.startsWith("refs/")&&(t=t.slice(5));const l=`git/repositories/${o}/refs`,u=`includeLinks=true&filter=${t}`,d=await this.sendGetRequest(n,l,i,u),_=d==null?void 0:d.value;if(_===[])return;const R={target:{oid:_[0].objectId}},A=`git/repositories/${o}`,P=await this.sendGetRequest(n,A,i);let M=P==null?void 0:P.defaultBranch;M.startsWith("refs/")&&(M=M.slice(5));const k=`git/repositories/${o}/refs`,B=`includeLinks=true&filter=${M}`,U=await this.sendGetRequest(n,k,i,B),H=U==null?void 0:U.value;if(H===[])return;const re={target:{oid:H[0].objectId}};if(!re&&!R)return;const Y=re?{sha:re.target.oid}:void 0,he=R?{sha:R.target.oid}:void 0;return{defaultBranch:Y,branch:he}}catch(n){return}}async getRepositoryId(e,t,n){const i=`git/repositories/${n}`,o=await this.sendGetRequest(e,i,t);if(o){if(o.id)return o.id;throw new Error("Sign in page was returned for repoId. Check the token sent")}throw new Error("Can't get Repo Id")}async getRepositoryInfo(e,t,n,i){const o=await this.getRepositoryId(e,t,n),a=`git/repositories/${o}`,l=await this.sendGetRequest(e,a,t);if(!l)return;l.defaultBranch.startsWith("refs/heads/")&&(l.defaultBranch=l.defaultBranch.substr(11));const u=`git/repositories/${n}/stats/branches`,d=`name=${l.defaultBranch}`,_=await this.sendGetRequest(e,u,t,d);if(!_)return;const R={user:"jepetty",repo:{organization:e,project:t,name:n,id:o},accessLevel:Ze.Read,defaultBranch:{name:_.name,sha:_.commit.commitId}};if(i.type===ht.Branch){const A=`git/repositories/${n}/stats/branches`,P=`name=${i.id}`,M=await this.sendGetRequest(e,A,t,P);if(M)return{...R,ref:{name:M.name,sha:M.commit.commitId,prefix:"refs/heads/"}}}else if(i.type===ht.Tag){const A=`git/repositories/${o}/items`,P=`versionDescriptor.version=${i.id}&versionDescriptor.versionType=tag`,M=await this.sendGetRequest(e,A,t,P);if(M&&M.value.length===1)return{...R,ref:{name:i.id,sha:M.value[0].commitId,prefix:"refs/tags/"}}}else{if(i.type===ht.Commit)return i.id==="HEAD"&&(i.id=l.defaultBranch),{...R,ref:{name:i.id,sha:mr(i.id)?i.id:_.commit.commitId,prefix:mr(i.id)?"":"refs/heads/"}};throw new Error("Not supported yet :(")}}}s(Ea,"AzDORepositoryProvider"),Ui([qr()],Ea.prototype,"ensureAuthenticated",1);class fs{constructor(e,t){this.providerService=e,this.changeStore=t,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepositories(n=>{for(const i of n.added)this.repositoryOpened(i);for(const i of n.removed)this.repositoryClosed(i)}),Ne.onDidChange(n=>{for(const i of this.services.values()){const o=i.service.getRepository();n.affectsConfiguration("remoteHub.richNavigation.indexMode",o.uri)&&i.service.updateIndexMode().catch(a=>{$.error(a)})}}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const t=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(t,1)}}async repositoryOpened(e){const t=ne(e.uri);if(!this.handledRepositories.has(t)){this.handledRepositories.add(t);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e,this.changeStore);if(i!==void 0){const o=i();this.services.set(t,{service:o});break}}}}repositoryClosed(e){const t=ne(e.uri);this.handledRepositories.delete(t);const n=this.services.get(t);n!==void 0&&(n.service.dispose(),this.services.delete(ne(e.uri)))}}s(fs,"CodeNavigationServices");/*! (c) Andrea Giammarchi - ISC */var En={};try{(function(r,e){if(new r("q=%2B").get("q")!==e||new r({q:e}).get("q")!==e||new r([["q",e]]).get("q")!==e||new r(`q=
`).toString()!=="q=%0A"||new r({q:" &"}).toString()!=="q=+%26"||new r({q:"%zx"}).toString()!=="q=%25zx")throw r;En.URLSearchParams=r})(URLSearchParams,"+")}catch(r){(function(e,t,n){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,l=/%(?![0-9a-fA-F]{2})/g,u=/\+/g,d={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},_={append:function(H,re){M(this._ungap,H,re)},delete:function(H){delete this._ungap[H]},get:function(H){return this.has(H)?this._ungap[H][0]:null},getAll:function(H){return this.has(H)?this._ungap[H].slice(0):[]},has:function(H){return H in this._ungap},set:function(H,re){this._ungap[H]=[t(re)]},forEach:function(H,re){var Y=this;for(var he in Y._ungap)Y._ungap[he].forEach(De,he);function De(Ie){H.call(re,Ie,t(he),Y)}s(De,"invoke")},toJSON:function(){return{}},toString:function(){var H=[];for(var re in this._ungap)for(var Y=B(re),he=0,De=this._ungap[re];he<De.length;he++)H.push(Y+"="+B(De[he]));return H.join("&")}};for(var R in _)o(A.prototype,R,{configurable:!0,writable:!0,value:_[R]});En.URLSearchParams=A;function A(H){var re=i(null);switch(o(this,"_ungap",{value:re}),!0){case!H:break;case typeof H=="string":H.charAt(0)==="?"&&(H=H.slice(1));for(var Y=H.split("&"),he=0,De=Y.length;he<De;he++){var Ie=Y[he],Ae=Ie.indexOf("=");-1<Ae?M(re,k(Ie.slice(0,Ae)),k(Ie.slice(Ae+1))):Ie.length&&M(re,k(Ie),"")}break;case n(H):for(var he=0,De=H.length;he<De;he++){var Ie=H[he];M(re,Ie[0],Ie[1])}break;case"forEach"in H:H.forEach(P,re);break;default:for(var Ye in H)M(re,Ye,H[Ye])}}s(A,"URLSearchParams");function P(H,re){M(this,re,H)}s(P,"addEach");function M(H,re,Y){var he=n(Y)?Y.join(","):Y;re in H?H[re].push(he):H[re]=[he]}s(M,"appendTo");function k(H){return decodeURIComponent(H.replace(l,"%25").replace(u," "))}s(k,"decode");function B(H){return encodeURIComponent(H).replace(a,U)}s(B,"encode");function U(H){return d[H]}s(U,"replacer")})(Object,String,Array.isArray)}(function(r){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in r||(r.forEach=s(function(i,o){var a=this,l=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(u){!u.length||u in l||(l[u]=a.getAll(u)).forEach(function(d){i.call(o,d,u,a)})})},"forEach")),"keys"in r||(r.keys=s(function(){return t(this,function(i,o){this.push(o)})},"keys")),"values"in r||(r.values=s(function(){return t(this,function(i,o){this.push(i)})},"values")),"entries"in r||(r.entries=s(function(){return t(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in r)&&(r[Symbol.iterator]=r.entries),"sort"in r||(r.sort=s(function(){for(var i=this.entries(),o=i.next(),a=o.done,l=[],u=Object.create(null),d,_,R;!a;)R=o.value,_=R[0],l.push(_),_ in u||(u[_]=[]),u[_].push(R[1]),o=i.next(),a=o.done;for(l.sort(),d=0;d<l.length;d++)this.delete(l[d]);for(d=0;d<l.length;d++)_=l[d],this.append(_,u[_].shift())},"sort"));function t(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}s(t,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,a=s(function(R){function A(k,B){r.append.call(this,k,B),k=this.toString(),R.set.call(this._usp,k?"?"+k:"")}s(A,"append");function P(k){r.delete.call(this,k),k=this.toString(),R.set.call(this._usp,k?"?"+k:"")}s(P,"del");function M(k,B){r.set.call(this,k,B),k=this.toString(),R.set.call(this._usp,k?"?"+k:"")}return s(M,"set"),function(k,B){return k.append=A,k.delete=P,k.set=M,i(k,"_usp",{configurable:!0,writable:!0,value:B})}},"createSearchParamsPollute"),l=s(function(R){return function(A,P){return i(A,"_searchParams",{configurable:!0,writable:!0,value:R(P,A)}),P}},"createSearchParamsCreate"),u=s(function(R){var A=R.append;R.append=r.append,URLSearchParams.call(R,R._usp.search.slice(1)),R.append=A},"updateSearchParams"),d=s(function(R,A){if(!(R instanceof A))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+A.name)},"verifySearchParams"),_=s(function(R){var A=R.prototype,P=o(A,"searchParams"),M=o(A,"href"),k=o(A,"search"),B;!P&&k&&k.set&&(B=l(a(k)),n.defineProperties(A,{href:{get:function(){return M.get.call(this)},set:function(U){var H=this._searchParams;M.set.call(this,U),H&&u(H)}},search:{get:function(){return k.get.call(this)},set:function(U){var H=this._searchParams;k.set.call(this,U),H&&u(H)}},searchParams:{get:function(){return d(this,R),this._searchParams||B(this,new URLSearchParams(this.search.slice(1)))},set:function(U){d(this,R),B(this,U)}}}))},"upgradeClass");try{_(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&_(URL)}catch(R){}}(Object)})(En.URLSearchParams.prototype,Object);const ps=En.URLSearchParams;var Ec=__webpack_require__(6822);const Et=(0,V.loadMessageBundle)(),Sa=60,Ca=Sa*60,jn=Ca*24,gs=jn*7,ms=jn*30,vs=jn*365;function Si(r,e){typeof r!="number"&&(r=r.getTime());const t=Math.round((new Date().getTime()-r)/1e3);if(t<-30)return Et("date.fromNow.in","in {0}",Si(new Date().getTime()+t*1e3,{ago:!1,short:e==null?void 0:e.short}));if(t<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?Et("date.fromNow.seconds.short.ago","secs ago"):Et("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?Et("date.fromNow.now.short","now"):Et("date.fromNow.now","Just now");let n;return t<Sa?(n=t,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):Et("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?Et("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):Et("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.seconds.singular.short","{0} sec",n):Et("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?Et("date.fromNow.seconds.plural.short","{0} secs",n):Et("date.fromNow.seconds.plural","{0} seconds",n)):t<Ca?(n=Math.floor(t/Sa),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.minutes.singular.short.ago","{0} min ago",n):Et("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?Et("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):Et("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.minutes.singular.short","{0} min",n):Et("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?Et("date.fromNow.minutes.plural.short","{0} mins",n):Et("date.fromNow.minutes.plural","{0} minutes",n)):t<jn?(n=Math.floor(t/Ca),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.hours.singular.short.ago","{0} hr ago",n):Et("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?Et("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):Et("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.hours.singular.short","{0} hr",n):Et("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?Et("date.fromNow.hours.plural.short","{0} hrs",n):Et("date.fromNow.hours.plural","{0} hours",n)):t<gs?(n=Math.floor(t/jn),(e==null?void 0:e.ago)?n===1?Et("date.fromNow.days.singular.ago","{0} day ago",n):Et("date.fromNow.days.plural.ago","{0} days ago",n):n===1?Et("date.fromNow.days.singular","{0} day",n):Et("date.fromNow.days.plural","{0} days",n)):t<ms?(n=Math.floor(t/gs),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):Et("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?Et("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):Et("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.weeks.singular.short","{0} wk",n):Et("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?Et("date.fromNow.weeks.plural.short","{0} wks",n):Et("date.fromNow.weeks.plural","{0} weeks",n)):t<vs?(n=Math.floor(t/ms),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.months.singular.short.ago","{0} mo ago",n):Et("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?Et("date.fromNow.months.plural.short.ago","{0} mos ago",n):Et("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.months.singular.short","{0} mo",n):Et("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?Et("date.fromNow.months.plural.short","{0} mos",n):Et("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(t/vs),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?Et("date.fromNow.years.singular.short.ago","{0} yr ago",n):Et("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?Et("date.fromNow.years.plural.short.ago","{0} yrs ago",n):Et("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?Et("date.fromNow.years.singular.short","{0} yr",n):Et("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?Et("date.fromNow.years.plural.short","{0} yrs",n):Et("date.fromNow.years.plural","{0} years",n))}s(Si,"fromNow");var ys,wr;(function(r){r.None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last})(wr||(wr={}));class _s{constructor(){this[ys]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=wr.None){const n=this._map.get(e);if(!!n)return t!==wr.None&&this.touch(n,t),n.value}set(e,t,n=wr.None){let i=this._map.get(e);if(i)i.value=t,n!==wr.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case wr.None:this.addItemLast(i);break;case wr.First:this.addItemFirst(i);break;case wr.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.key,done:!1};return t=t.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:t.value,done:!1};return t=t.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const i={value:[t.key,t.value],done:!1};return t=t.next,i}return{value:void 0,done:!0}}};return n}[(ys=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==wr.First&&t!==wr.Last)){if(t===wr.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===wr.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}s(_s,"LinkedMap");class Z extends _s{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=wr.AsNew){return super.get(e,t)}peek(e){return super.get(e,wr.None)}set(e,t){return super.set(e,t,wr.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}s(Z,"LRUCache");function ve(r,e,t){return new Tr(new bt(r),new bt(e)).ComputeDiff(t).changes}s(ve,"stringDiff");class Re{constructor(e,t,n,i){this.originalStart=e,this.originalLength=t,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}s(Re,"DiffChange");var ot;(function(r){r[r.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",r[r.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",r[r.MAX_UINT_8=255]="MAX_UINT_8",r[r.MAX_UINT_16=65535]="MAX_UINT_16",r[r.MAX_UINT_32=4294967295]="MAX_UINT_32",r[r.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(ot||(ot={}));function st(r,e){return(e<<5)-e+r|0}s(st,"numberHash");function vt(r,e){e=st(149417,e);for(let t=0,n=r.length;t<n;t++)e=st(r.charCodeAt(t),e);return e}s(vt,"stringHash");class bt{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)t[n]=e.charCodeAt(n);return t}}s(bt,"StringDiffSequence");class $t{static Assert(e,t){if(!e)throw new Error(t)}}s($t,"Debug");class Bt{static Copy(e,t,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[t+a]}static Copy2(e,t,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[t+a]}}s(Bt,"MyArray");var In;(function(r){r[r.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(In||(In={}));class Vr{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Re(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}s(Vr,"DiffChangeHelper");class Tr{constructor(e,t,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=t;const[i,o,a]=Tr._getElements(e),[l,u,d]=Tr._getElements(t);this._hasStrings=a&&d,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=l,this._modifiedElementsOrHash=u,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(Tr._isStringArray(t)){const n=new Int32Array(t.length);for(let i=0,o=t.length;i<o;i++)n[i]=vt(t[i],0);return[t,n,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const n=Tr._getStrictElement(this._originalSequence,e),i=Tr._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,o){const a=[!1];let l=this.ComputeDiffRecursive(e,t,n,i,a);return o&&(l=this.PrettifyChanges(l)),{quitEarly:a[0],changes:l}}ComputeDiffRecursive(e,t,n,i,o){for(o[0]=!1;e<=t&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;t>=e&&i>=n&&this.ElementsAreEqual(t,i);)t--,i--;if(e>t||n>i){let R;return n<=i?($t.Assert(e===t+1,"originalStart should only be one more than originalEnd"),R=[new Re(e,0,n,i-n+1)]):e<=t?($t.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),R=[new Re(e,t-e+1,n,0)]):($t.Assert(e===t+1,"originalStart should only be one more than originalEnd"),$t.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),R=[]),R}const a=[0],l=[0],u=this.ComputeRecursionPoint(e,t,n,i,a,l,o),d=a[0],_=l[0];if(u!==null)return u;if(!o[0]){const R=this.ComputeDiffRecursive(e,d,n,_,o);let A=[];return o[0]?A=[new Re(d+1,t-(d+1)+1,_+1,i-(_+1)+1)]:A=this.ComputeDiffRecursive(d+1,t,_+1,i,o),this.ConcatenateChanges(R,A)}return[new Re(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,o,a,l,u,d,_,R,A,P,M,k,B,U,H){let re=null,Y=null,he=new Vr,De=t,Ie=n,Ae=P[0]-B[0]-i,Ye=-1073741824,Pe=this.m_forwardHistory.length-1;do{const qe=Ae+e;qe===De||qe<Ie&&d[qe-1]<d[qe+1]?(R=d[qe+1],M=R-Ae-i,R<Ye&&he.MarkNextChange(),Ye=R,he.AddModifiedElement(R+1,M),Ae=qe+1-e):(R=d[qe-1]+1,M=R-Ae-i,R<Ye&&he.MarkNextChange(),Ye=R-1,he.AddOriginalElement(R,M+1),Ae=qe-1-e),Pe>=0&&(d=this.m_forwardHistory[Pe],e=d[0],De=1,Ie=d.length-1)}while(--Pe>=-1);if(re=he.getReverseChanges(),H[0]){let qe=P[0]+1,rt=B[0]+1;if(re!==null&&re.length>0){const Nt=re[re.length-1];qe=Math.max(qe,Nt.getOriginalEnd()),rt=Math.max(rt,Nt.getModifiedEnd())}Y=[new Re(qe,A-qe+1,rt,k-rt+1)]}else{he=new Vr,De=a,Ie=l,Ae=P[0]-B[0]-u,Ye=1073741824,Pe=U?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const qe=Ae+o;qe===De||qe<Ie&&_[qe-1]>=_[qe+1]?(R=_[qe+1]-1,M=R-Ae-u,R>Ye&&he.MarkNextChange(),Ye=R+1,he.AddOriginalElement(R+1,M+1),Ae=qe+1-o):(R=_[qe-1],M=R-Ae-u,R>Ye&&he.MarkNextChange(),Ye=R,he.AddModifiedElement(R+1,M+1),Ae=qe-1-o),Pe>=0&&(_=this.m_reverseHistory[Pe],o=_[0],De=1,Ie=_.length-1)}while(--Pe>=-1);Y=he.getChanges()}return this.ConcatenateChanges(re,Y)}ComputeRecursionPoint(e,t,n,i,o,a,l){let u=0,d=0,_=0,R=0,A=0,P=0;e--,n--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const M=t-e+(i-n),k=M+1,B=new Int32Array(k),U=new Int32Array(k),H=i-n,re=t-e,Y=e-n,he=t-i,Ie=(re-H)%2==0;B[H]=e,U[re]=t,l[0]=!1;for(let Ae=1;Ae<=M/2+1;Ae++){let Ye=0,Pe=0;_=this.ClipDiagonalBound(H-Ae,Ae,H,k),R=this.ClipDiagonalBound(H+Ae,Ae,H,k);for(let rt=_;rt<=R;rt+=2){rt===_||rt<R&&B[rt-1]<B[rt+1]?u=B[rt+1]:u=B[rt-1]+1,d=u-(rt-H)-Y;const Nt=u;for(;u<t&&d<i&&this.ElementsAreEqual(u+1,d+1);)u++,d++;if(B[rt]=u,u+d>Ye+Pe&&(Ye=u,Pe=d),!Ie&&Math.abs(rt-re)<=Ae-1&&u>=U[rt])return o[0]=u,a[0]=d,Nt<=U[rt]&&1447>0&&Ae<=1447+1?this.WALKTRACE(H,_,R,Y,re,A,P,he,B,U,u,t,o,d,i,a,Ie,l):null}const qe=(Ye-e+(Pe-n)-Ae)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(Ye,qe))return l[0]=!0,o[0]=Ye,a[0]=Pe,qe>0&&1447>0&&Ae<=1447+1?this.WALKTRACE(H,_,R,Y,re,A,P,he,B,U,u,t,o,d,i,a,Ie,l):(e++,n++,[new Re(e,t-e+1,n,i-n+1)]);A=this.ClipDiagonalBound(re-Ae,Ae,re,k),P=this.ClipDiagonalBound(re+Ae,Ae,re,k);for(let rt=A;rt<=P;rt+=2){rt===A||rt<P&&U[rt-1]>=U[rt+1]?u=U[rt+1]-1:u=U[rt-1],d=u-(rt-re)-he;const Nt=u;for(;u>e&&d>n&&this.ElementsAreEqual(u,d);)u--,d--;if(U[rt]=u,Ie&&Math.abs(rt-H)<=Ae&&u<=B[rt])return o[0]=u,a[0]=d,Nt>=B[rt]&&1447>0&&Ae<=1447+1?this.WALKTRACE(H,_,R,Y,re,A,P,he,B,U,u,t,o,d,i,a,Ie,l):null}if(Ae<=1447){let rt=new Int32Array(R-_+2);rt[0]=H-_+1,Bt.Copy2(B,_,rt,1,R-_+1),this.m_forwardHistory.push(rt),rt=new Int32Array(P-A+2),rt[0]=re-A+1,Bt.Copy2(U,A,rt,1,P-A+1),this.m_reverseHistory.push(rt)}}return this.WALKTRACE(H,_,R,Y,re,A,P,he,B,U,u,t,o,d,i,a,Ie,l)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const n=e[t],i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,a=n.originalLength>0,l=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!l||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const d=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!d)break;n.originalStart++,n.modifiedStart++}let u=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],u)){e[t]=u[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const n=e[t];let i=0,o=0;if(t>0){const R=e[t-1];i=R.originalStart+R.originalLength,o=R.modifiedStart+R.modifiedLength}const a=n.originalLength>0,l=n.modifiedLength>0;let u=0,d=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let R=1;;R++){const A=n.originalStart-R,P=n.modifiedStart-R;if(A<i||P<o||a&&!this.OriginalElementsAreEqual(A,A+n.originalLength)||l&&!this.ModifiedElementsAreEqual(P,P+n.modifiedLength))break;const k=(A===i&&P===o?5:0)+this._boundaryScore(A,n.originalLength,P,n.modifiedLength);k>d&&(d=k,u=R)}n.originalStart-=u,n.modifiedStart-=u;const _=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],_)){e[t-1]=_[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,n=e.length;t<n;t++){const i=e[t-1],o=e[t],a=o.originalStart-i.originalStart-i.originalLength,l=i.originalStart,u=o.originalStart+o.originalLength,d=u-l,_=i.modifiedStart,R=o.modifiedStart+o.modifiedLength,A=R-_;if(a<5&&d<20&&A<20){const P=this._findBetterContiguousSequence(l,d,_,A,a);if(P){const[M,k]=P;(M!==i.originalStart+i.originalLength||k!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=M-i.originalStart,i.modifiedLength=k-i.modifiedStart,o.originalStart=M+a,o.modifiedStart=k+a,o.originalLength=u-o.originalStart,o.modifiedLength=R-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,n,i,o){if(t<o||i<o)return null;const a=e+t-o+1,l=n+i-o+1;let u=0,d=0,_=0;for(let R=e;R<a;R++)for(let A=n;A<l;A++){const P=this._contiguousSequenceScore(R,A,o);P>0&&P>u&&(u=P,d=R,_=A)}return u>0?[d,_]:null}_contiguousSequenceScore(e,t,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,t,n,i){const o=this._OriginalRegionIsBoundary(e,t)?1:0,a=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+a}ConcatenateChanges(e,t){let n=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],n)){const i=new Array(e.length+t.length-1);return Bt.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Bt.Copy(t,1,i,e.length,t.length-1),i}else{const i=new Array(e.length+t.length);return Bt.Copy(e,0,i,0,e.length),Bt.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,n){if($t.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),$t.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let l=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(l=t.modifiedStart+t.modifiedLength-e.modifiedStart),n[0]=new Re(i,o,a,l),!0}else return n[0]=null,!1}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i)return e;const o=n,a=i-n-1,l=t%2==0;if(e<0){const u=o%2==0;return l===u?0:1}else{const u=a%2==0;return l===u?i-1:i-2}}}s(Tr,"LcsDiff");var Kr;(function(r){function e(n,i){return n instanceof Lo?i:new h.Position(i.line,i.character)}s(e,"makePosition"),r.makePosition=e;function t(n,i){return n instanceof Lo?i:new h.Range(i.start.line,i.start.character,i.end.line,i.end.character)}s(t,"makeRange"),r.makeRange=t})(Kr||(Kr={}));var Qn;(function(r){r[r.index2code=1]="index2code",r[r.code2Index=2]="code2Index"})(Qn||(Qn={}));const kl=s(class{constructor(r,e,t,n){this.diffCache=new Z(32),this.indexDocumentCache=new Z(32),this.codeDocumentCache=new Z(32),this.providerService=r,this.rootUri=e,this.index=t,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const r=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return r===void 0?new Map:new Map(r.map(e=>[e.uri.toString(),e.type]))}async needsMapping(r){const e=r.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,r).length!==0}async mapPositionFromCodeToIndex(r,e){const t=r.uri;if(!t.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(t.toString());if(i===Mt.Created||i===Mt.Deleted)return;const o=await this.getIndexDocument(t);if(o===void 0)return;const a=this.getDiff(2,o,r);if(a.length===0)return e;const l=r.offsetAt(new h.Position(e.line,e.character));let u=l;for(const A of a){if(A.modifiedStart<=l&&l<A.modifiedStart+A.modifiedLength)return;if(u<A.modifiedStart)break;u=u-(A.modifiedLength-A.originalLength)}const d=o.positionAt(u),_=this.getWordAtOffset(o.lineAt(d.line).text,d.character),R=this.getWordAtOffset(r.lineAt(e.line).text,e.character);if(!(_===void 0||R===void 0||_!==R))return new h.Position(d.line,d.character)}async mapRangeFromIndexToCode(r,e){const t=r instanceof h.Uri?r:r.uri;if(!t.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(t.toString());if(i===Mt.Created||i===Mt.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(t),this.getCodeDocument(r)]);if(o===void 0||a===void 0)return;const l=this.getDiff(1,o,a);if(l.length===0)return e;const u=o.offsetAt(e.start);let d=u;const _=o.offsetAt(e.end);let R=_;for(const B of l){if(R<B.originalStart)break;const U=B.modifiedLength-B.originalLength;if(B.originalStart<=u){if(u<B.originalStart+B.originalLength)return;d+=U}else if(_<B.originalStart+B.originalLength)return;if(B.originalStart<=_){if(_<B.originalStart+B.originalLength)return;R+=U}}const A=a.positionAt(d),P=a.positionAt(R),M=o.getText(e),k=a.getText(Kr.makeRange(a,{start:A,end:P}));if(M===k)return new h.Range(A.line,A.character,P.line,P.character)}async getIndexDocument(r){return this.getDocument(this.indexDocumentCache,r,this.index)}async getCodeDocument(r){return r instanceof h.Uri?this.getDocument(this.codeDocumentCache,r,this.code):r}async getDocument(r,e,t){let n=r.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,t),r.set(e.toString(),n),n.then(i=>{i===void 0&&r.set(e.toString(),null)},void 0)),n}async _getDocument(r,e){const t=r.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,t).then(n=>new Lo(r,Number.MAX_VALUE,kl.textDecoder.decode(n)),()=>{})}getDiff(r,e,t){if(e.uri.toString()!==t.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${t.uri.toString()}) are pointing to a different document`);const n=`${r}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===t.version||(i={original:e.version,modified:t.version,changes:ve(e.getText(),t.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(r,e){let t="findStart",n=0,i=r.length,o=0;for(;o<r.length&&t!=="endFound";){switch(o===e&&(t="findEnd"),r[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(t){case"findStart":n=o+1;break;case"findEnd":i=o,t="endFound";break}break}o++}return t==="endFound"?r.substring(n,i):void 0}},"_DiffMapper");let Sc=kl;Sc.textDecoder=new TextDecoder("utf8");var Nl;(function(r){r[r.LineFeed=10]="LineFeed",r[r.CarriageReturn=13]="CarriageReturn"})(Nl||(Nl={}));class Lo{static computeLineOffsets(e,t,n=0){const i=t?[n]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,t,n){this._content=n,this.uri=e,this.version=t,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Lo.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}lineAt(e){const t=this.getLineOffsets();if(e>=t.length)return{lineNumber:e,text:""};const n=t[e],i=t[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const t=this.getLineOffsets();let n=0,i=t.length;if(i===0)return{line:0,character:e};for(;n<i;){const a=Math.floor((n+i)/2);t[a]>e?i=a:n=a+1}const o=n-1;return{line:o,character:e-t[o]}}offsetAt(e){const t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;const n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}s(Lo,"TextDocument");var Ml;(function(r){r.MIN_VALUE=-2147483648,r.MAX_VALUE=2147483647})(Ml||(Ml={}));var ws;(function(r){r.MIN_VALUE=0,r.MAX_VALUE=2147483647})(ws||(ws={}));var ai;(function(r){function e(n,i){return n===Number.MAX_VALUE&&(n=ws.MAX_VALUE),i===Number.MAX_VALUE&&(i=ws.MAX_VALUE),{line:n,character:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.objectLiteral(i)&&Ue.uinteger(i.line)&&Ue.uinteger(i.character)}s(t,"is"),r.is=t})(ai||(ai={}));var Qr;(function(r){function e(n,i,o,a){if(Ue.uinteger(n)&&Ue.uinteger(i)&&Ue.uinteger(o)&&Ue.uinteger(a))return{start:ai.create(n,i),end:ai.create(o,a)};if(ai.is(n)&&ai.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+a+"]")}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.objectLiteral(i)&&ai.is(i.start)&&ai.is(i.end)}s(t,"is"),r.is=t})(Qr||(Qr={}));var Cc;(function(r){function e(n,i){return{uri:n,range:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Qr.is(i.range)&&(Ue.string(i.uri)||Ue.undefined(i.uri))}s(t,"is"),r.is=t})(Cc||(Cc={}));var bs;(function(r){function e(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Qr.is(i.targetRange)&&Ue.string(i.targetUri)&&(Qr.is(i.targetSelectionRange)||Ue.undefined(i.targetSelectionRange))&&(Qr.is(i.originSelectionRange)||Ue.undefined(i.originSelectionRange))}s(t,"is"),r.is=t})(bs||(bs={}));var xc;(function(r){function e(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.numberRange(i.red,0,1)&&Ue.numberRange(i.green,0,1)&&Ue.numberRange(i.blue,0,1)&&Ue.numberRange(i.alpha,0,1)}s(t,"is"),r.is=t})(xc||(xc={}));var Fl;(function(r){function e(n,i){return{range:n,color:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Qr.is(i.range)&&xc.is(i.color)}s(t,"is"),r.is=t})(Fl||(Fl={}));var xa;(function(r){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.string(i.label)&&(Ue.undefined(i.textEdit)||ji.is(i))&&(Ue.undefined(i.additionalTextEdits)||Ue.typedArray(i.additionalTextEdits,ji.is))}s(t,"is"),r.is=t})(xa||(xa={}));var ho;(function(r){r.Comment="comment",r.Imports="imports",r.Region="region"})(ho||(ho={}));var Ll;(function(r){function e(n,i,o,a,l){var u={startLine:n,endLine:i};return Ue.defined(o)&&(u.startCharacter=o),Ue.defined(a)&&(u.endCharacter=a),Ue.defined(l)&&(u.kind=l),u}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.uinteger(i.startLine)&&Ue.uinteger(i.startLine)&&(Ue.undefined(i.startCharacter)||Ue.uinteger(i.startCharacter))&&(Ue.undefined(i.endCharacter)||Ue.uinteger(i.endCharacter))&&(Ue.undefined(i.kind)||Ue.string(i.kind))}s(t,"is"),r.is=t})(Ll||(Ll={}));var Tc;(function(r){function e(n,i){return{location:n,message:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Cc.is(i.location)&&Ue.string(i.message)}s(t,"is"),r.is=t})(Tc||(Tc={}));var fo;(function(r){r.Error=1,r.Warning=2,r.Information=3,r.Hint=4})(fo||(fo={}));var Es;(function(r){r.Unnecessary=1,r.Deprecated=2})(Es||(Es={}));var Ac;(function(r){function e(t){var n=t;return n!=null&&Ue.string(n.href)}s(e,"is"),r.is=e})(Ac||(Ac={}));var Ss;(function(r){function e(n,i,o,a,l,u){var d={range:n,message:i};return Ue.defined(o)&&(d.severity=o),Ue.defined(a)&&(d.code=a),Ue.defined(l)&&(d.source=l),Ue.defined(u)&&(d.relatedInformation=u),d}s(e,"create"),r.create=e;function t(n){var i,o=n;return Ue.defined(o)&&Qr.is(o.range)&&Ue.string(o.message)&&(Ue.number(o.severity)||Ue.undefined(o.severity))&&(Ue.integer(o.code)||Ue.string(o.code)||Ue.undefined(o.code))&&(Ue.undefined(o.codeDescription)||Ue.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(Ue.string(o.source)||Ue.undefined(o.source))&&(Ue.undefined(o.relatedInformation)||Ue.typedArray(o.relatedInformation,Tc.is))}s(t,"is"),r.is=t})(Ss||(Ss={}));var $o;(function(r){function e(n,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var l={title:n,command:i};return Ue.defined(o)&&o.length>0&&(l.arguments=o),l}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.string(i.title)&&Ue.string(i.command)}s(t,"is"),r.is=t})($o||($o={}));var ji;(function(r){function e(o,a){return{range:o,newText:a}}s(e,"replace"),r.replace=e;function t(o,a){return{range:{start:o,end:o},newText:a}}s(t,"insert"),r.insert=t;function n(o){return{range:o,newText:""}}s(n,"del"),r.del=n;function i(o){var a=o;return Ue.objectLiteral(a)&&Ue.string(a.newText)&&Qr.is(a.range)}s(i,"is"),r.is=i})(ji||(ji={}));var Bo;(function(r){function e(n,i,o){var a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}s(e,"create"),r.create=e;function t(n){var i=n;return i!==void 0&&Ue.objectLiteral(i)&&Ue.string(i.label)&&(Ue.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(Ue.string(i.description)||i.description===void 0)}s(t,"is"),r.is=t})(Bo||(Bo={}));var on;(function(r){function e(t){var n=t;return typeof n=="string"}s(e,"is"),r.is=e})(on||(on={}));var si;(function(r){function e(o,a,l){return{range:o,newText:a,annotationId:l}}s(e,"replace"),r.replace=e;function t(o,a,l){return{range:{start:o,end:o},newText:a,annotationId:l}}s(t,"insert"),r.insert=t;function n(o,a){return{range:o,newText:"",annotationId:a}}s(n,"del"),r.del=n;function i(o){var a=o;return ji.is(a)&&(Bo.is(a.annotationId)||on.is(a.annotationId))}s(i,"is"),r.is=i})(si||(si={}));var Ta;(function(r){function e(n,i){return{textDocument:n,edits:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ra.is(i.textDocument)&&Array.isArray(i.edits)}s(t,"is"),r.is=t})(Ta||(Ta={}));var Uo;(function(r){function e(n,i,o){var a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}s(e,"create"),r.create=e;function t(n){var i=n;return i&&i.kind==="create"&&Ue.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||Ue.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Ue.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||on.is(i.annotationId))}s(t,"is"),r.is=t})(Uo||(Uo={}));var Ho;(function(r){function e(n,i,o,a){var l={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(l.options=o),a!==void 0&&(l.annotationId=a),l}s(e,"create"),r.create=e;function t(n){var i=n;return i&&i.kind==="rename"&&Ue.string(i.oldUri)&&Ue.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||Ue.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Ue.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||on.is(i.annotationId))}s(t,"is"),r.is=t})(Ho||(Ho={}));var Ci;(function(r){function e(n,i,o){var a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}s(e,"create"),r.create=e;function t(n){var i=n;return i&&i.kind==="delete"&&Ue.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||Ue.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||Ue.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||on.is(i.annotationId))}s(t,"is"),r.is=t})(Ci||(Ci={}));var Aa;(function(r){function e(t){var n=t;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return Ue.string(i.kind)?Uo.is(i)||Ho.is(i)||Ci.is(i):Ta.is(i)}))}s(e,"is"),r.is=e})(Aa||(Aa={}));var jo=function(){function r(e,t){this.edits=e,this.changeAnnotations=t}return s(r,"TextEditChangeImpl"),r.prototype.insert=function(e,t,n){var i,o;if(n===void 0?i=ji.insert(e,t):on.is(n)?(o=n,i=si.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=si.insert(e,t,o)),this.edits.push(i),o!==void 0)return o},r.prototype.replace=function(e,t,n){var i,o;if(n===void 0?i=ji.replace(e,t):on.is(n)?(o=n,i=si.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=si.replace(e,t,o)),this.edits.push(i),o!==void 0)return o},r.prototype.delete=function(e,t){var n,i;if(t===void 0?n=ji.del(e):on.is(t)?(i=t,n=si.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(t),n=si.del(e,i)),this.edits.push(n),i!==void 0)return i},r.prototype.add=function(e){this.edits.push(e)},r.prototype.all=function(){return this.edits},r.prototype.clear=function(){this.edits.splice(0,this.edits.length)},r.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},r}(),Cs=function(){function r(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return s(r,"ChangeAnnotations"),r.prototype.all=function(){return this._annotations},Object.defineProperty(r.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),r.prototype.manage=function(e,t){var n;if(on.is(e)?n=e:(n=this.nextId(),t=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(t===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},r.prototype.nextId=function(){return this._counter++,this._counter.toString()},r}(),yh=function(){function r(e){var t=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new Cs(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(Ta.is(n)){var i=new jo(n.edits,t._changeAnnotations);t._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new jo(e.changes[n]);t._textEditChanges[n]=i})):this._workspaceEdit={}}return s(r,"WorkspaceChange"),Object.defineProperty(r.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),r.prototype.getTextEditChange=function(e){if(Ra.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version},n=this._textEditChanges[t.uri];if(!n){var i=[],o={textDocument:t,edits:i};this._workspaceEdit.documentChanges.push(o),n=new jo(i,this._changeAnnotations),this._textEditChanges[t.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new jo(i),this._textEditChanges[e]=n}return n}},r.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new Cs,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},r.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},r.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Bo.is(t)||on.is(t)?i=t:n=t;var o,a;if(i===void 0?o=Uo.create(e,n):(a=on.is(i)?i:this._changeAnnotations.manage(i),o=Uo.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},r.prototype.renameFile=function(e,t,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;Bo.is(n)||on.is(n)?o=n:i=n;var a,l;if(o===void 0?a=Ho.create(e,t,i):(l=on.is(o)?o:this._changeAnnotations.manage(o),a=Ho.create(e,t,i,l)),this._workspaceEdit.documentChanges.push(a),l!==void 0)return l},r.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Bo.is(t)||on.is(t)?i=t:n=t;var o,a;if(i===void 0?o=Ci.create(e,n):(a=on.is(i)?i:this._changeAnnotations.manage(i),o=Ci.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},r}(),Rc;(function(r){function e(n){return{uri:n}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.string(i.uri)}s(t,"is"),r.is=t})(Rc||(Rc={}));var xs;(function(r){function e(n,i){return{uri:n,version:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.string(i.uri)&&Ue.integer(i.version)}s(t,"is"),r.is=t})(xs||(xs={}));var Ra;(function(r){function e(n,i){return{uri:n,version:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.string(i.uri)&&(i.version===null||Ue.integer(i.version))}s(t,"is"),r.is=t})(Ra||(Ra={}));var qi;(function(r){function e(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.string(i.uri)&&Ue.string(i.languageId)&&Ue.integer(i.version)&&Ue.string(i.text)}s(t,"is"),r.is=t})(qi||(qi={}));var Dn;(function(r){r.PlainText="plaintext",r.Markdown="markdown"})(Dn||(Dn={})),function(r){function e(t){var n=t;return n===r.PlainText||n===r.Markdown}s(e,"is"),r.is=e}(Dn||(Dn={}));var Ic;(function(r){function e(t){var n=t;return Ue.objectLiteral(t)&&Dn.is(n.kind)&&Ue.string(n.value)}s(e,"is"),r.is=e})(Ic||(Ic={}));var Dc;(function(r){r.Text=1,r.Method=2,r.Function=3,r.Constructor=4,r.Field=5,r.Variable=6,r.Class=7,r.Interface=8,r.Module=9,r.Property=10,r.Unit=11,r.Value=12,r.Enum=13,r.Keyword=14,r.Snippet=15,r.Color=16,r.File=17,r.Reference=18,r.Folder=19,r.EnumMember=20,r.Constant=21,r.Struct=22,r.Event=23,r.Operator=24,r.TypeParameter=25})(Dc||(Dc={}));var $l;(function(r){r.PlainText=1,r.Snippet=2})($l||($l={}));var Pc;(function(r){r.Deprecated=1})(Pc||(Pc={}));var Bl;(function(r){function e(n,i,o){return{newText:n,insert:i,replace:o}}s(e,"create"),r.create=e;function t(n){var i=n;return i&&Ue.string(i.newText)&&Qr.is(i.insert)&&Qr.is(i.replace)}s(t,"is"),r.is=t})(Bl||(Bl={}));var Ul;(function(r){r.asIs=1,r.adjustIndentation=2})(Ul||(Ul={}));var Oc;(function(r){function e(t){return{label:t}}s(e,"create"),r.create=e})(Oc||(Oc={}));var Hl;(function(r){function e(t,n){return{items:t||[],isIncomplete:!!n}}s(e,"create"),r.create=e})(Hl||(Hl={}));var te;(function(r){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}s(e,"fromPlainText"),r.fromPlainText=e;function t(n){var i=n;return Ue.string(i)||Ue.objectLiteral(i)&&Ue.string(i.language)&&Ue.string(i.value)}s(t,"is"),r.is=t})(te||(te={}));var _e;(function(r){function e(t){var n=t;return!!n&&Ue.objectLiteral(n)&&(Ic.is(n.contents)||te.is(n.contents)||Ue.typedArray(n.contents,te.is))&&(t.range===void 0||Qr.is(t.range))}s(e,"is"),r.is=e})(_e||(_e={}));var Oe;(function(r){function e(t,n){return n?{label:t,documentation:n}:{label:t}}s(e,"create"),r.create=e})(Oe||(Oe={}));var _t;(function(r){function e(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:t};return Ue.defined(n)&&(a.documentation=n),Ue.defined(i)?a.parameters=i:a.parameters=[],a}s(e,"create"),r.create=e})(_t||(_t={}));var Kt;(function(r){r.Text=1,r.Read=2,r.Write=3})(Kt||(Kt={}));var lr;(function(r){function e(t,n){var i={range:t};return Ue.number(n)&&(i.kind=n),i}s(e,"create"),r.create=e})(lr||(lr={}));var hr;(function(r){r.File=1,r.Module=2,r.Namespace=3,r.Package=4,r.Class=5,r.Method=6,r.Property=7,r.Field=8,r.Constructor=9,r.Enum=10,r.Interface=11,r.Function=12,r.Variable=13,r.Constant=14,r.String=15,r.Number=16,r.Boolean=17,r.Array=18,r.Object=19,r.Key=20,r.Null=21,r.EnumMember=22,r.Struct=23,r.Event=24,r.Operator=25,r.TypeParameter=26})(hr||(hr={}));var Qt;(function(r){r.Deprecated=1})(Qt||(Qt={}));var pr;(function(r){function e(t,n,i,o,a){var l={name:t,kind:n,location:{uri:o,range:i}};return a&&(l.containerName=a),l}s(e,"create"),r.create=e})(pr||(pr={}));var Pn;(function(r){function e(n,i,o,a,l,u){var d={name:n,detail:i,kind:o,range:a,selectionRange:l};return u!==void 0&&(d.children=u),d}s(e,"create"),r.create=e;function t(n){var i=n;return i&&Ue.string(i.name)&&Ue.number(i.kind)&&Qr.is(i.range)&&Qr.is(i.selectionRange)&&(i.detail===void 0||Ue.string(i.detail))&&(i.deprecated===void 0||Ue.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}s(t,"is"),r.is=t})(Pn||(Pn={}));var Ar;(function(r){r.Empty="",r.QuickFix="quickfix",r.Refactor="refactor",r.RefactorExtract="refactor.extract",r.RefactorInline="refactor.inline",r.RefactorRewrite="refactor.rewrite",r.Source="source",r.SourceOrganizeImports="source.organizeImports",r.SourceFixAll="source.fixAll"})(Ar||(Ar={}));var qo;(function(r){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.typedArray(i.diagnostics,Ss.is)&&(i.only===void 0||Ue.typedArray(i.only,Ue.string))}s(t,"is"),r.is=t})(qo||(qo={}));var Ts;(function(r){function e(n,i,o){var a={title:n},l=!0;return typeof i=="string"?(l=!1,a.kind=i):$o.is(i)?a.command=i:a.edit=i,l&&o!==void 0&&(a.kind=o),a}s(e,"create"),r.create=e;function t(n){var i=n;return i&&Ue.string(i.title)&&(i.diagnostics===void 0||Ue.typedArray(i.diagnostics,Ss.is))&&(i.kind===void 0||Ue.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||$o.is(i.command))&&(i.isPreferred===void 0||Ue.boolean(i.isPreferred))&&(i.edit===void 0||Aa.is(i.edit))}s(t,"is"),r.is=t})(Ts||(Ts={}));var As;(function(r){function e(n,i){var o={range:n};return Ue.defined(i)&&(o.data=i),o}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Qr.is(i.range)&&(Ue.undefined(i.command)||$o.is(i.command))}s(t,"is"),r.is=t})(As||(As={}));var kc;(function(r){function e(n,i){return{tabSize:n,insertSpaces:i}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Ue.uinteger(i.tabSize)&&Ue.boolean(i.insertSpaces)}s(t,"is"),r.is=t})(kc||(kc={}));var _h;(function(r){function e(n,i,o){return{range:n,target:i,data:o}}s(e,"create"),r.create=e;function t(n){var i=n;return Ue.defined(i)&&Qr.is(i.range)&&(Ue.undefined(i.target)||Ue.string(i.target))}s(t,"is"),r.is=t})(_h||(_h={}));var wh;(function(r){function e(n,i){return{range:n,parent:i}}s(e,"create"),r.create=e;function t(n){var i=n;return i!==void 0&&Qr.is(i.range)&&(i.parent===void 0||r.is(i.parent))}s(t,"is"),r.is=t})(wh||(wh={}));var Ky=null,bh;(function(r){function e(o,a,l,u){return new ag(o,a,l,u)}s(e,"create"),r.create=e;function t(o){var a=o;return!!(Ue.defined(a)&&Ue.string(a.uri)&&(Ue.undefined(a.languageId)||Ue.string(a.languageId))&&Ue.uinteger(a.lineCount)&&Ue.func(a.getText)&&Ue.func(a.positionAt)&&Ue.func(a.offsetAt))}s(t,"is"),r.is=t;function n(o,a){for(var l=o.getText(),u=i(a,function(M,k){var B=M.range.start.line-k.range.start.line;return B===0?M.range.start.character-k.range.start.character:B}),d=l.length,_=u.length-1;_>=0;_--){var R=u[_],A=o.offsetAt(R.range.start),P=o.offsetAt(R.range.end);if(P<=d)l=l.substring(0,A)+R.newText+l.substring(P,l.length);else throw new Error("Overlapping edit");d=A}return l}s(n,"applyEdits"),r.applyEdits=n;function i(o,a){if(o.length<=1)return o;var l=o.length/2|0,u=o.slice(0,l),d=o.slice(l);i(u,a),i(d,a);for(var _=0,R=0,A=0;_<u.length&&R<d.length;){var P=a(u[_],d[R]);P<=0?o[A++]=u[_++]:o[A++]=d[R++]}for(;_<u.length;)o[A++]=u[_++];for(;R<d.length;)o[A++]=d[R++];return o}s(i,"mergeSort")})(bh||(bh={}));var ag=function(){function r(e,t,n,i){this._uri=e,this._languageId=t,this._version=n,this._content=i,this._lineOffsets=void 0}return s(r,"FullTextDocument"),Object.defineProperty(r.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),r.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},r.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},r.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],t=this._content,n=!0,i=0;i<t.length;i++){n&&(e.push(i),n=!1);var o=t.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<t.length&&t.charAt(i+1)===`
`&&i++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},r.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,i=t.length;if(i===0)return ai.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);t[o]>e?i=o:n=o+1}var a=n-1;return ai.create(a,e-t[a])},r.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],i=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(r.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),r}(),Ue;(function(r){var e=Object.prototype.toString;function t(P){return typeof P!="undefined"}s(t,"defined"),r.defined=t;function n(P){return typeof P=="undefined"}s(n,"undefined"),r.undefined=n;function i(P){return P===!0||P===!1}s(i,"boolean"),r.boolean=i;function o(P){return e.call(P)==="[object String]"}s(o,"string"),r.string=o;function a(P){return e.call(P)==="[object Number]"}s(a,"number"),r.number=a;function l(P,M,k){return e.call(P)==="[object Number]"&&M<=P&&P<=k}s(l,"numberRange"),r.numberRange=l;function u(P){return e.call(P)==="[object Number]"&&-2147483648<=P&&P<=2147483647}s(u,"integer"),r.integer=u;function d(P){return e.call(P)==="[object Number]"&&0<=P&&P<=2147483647}s(d,"uinteger"),r.uinteger=d;function _(P){return e.call(P)==="[object Function]"}s(_,"func"),r.func=_;function R(P){return P!==null&&typeof P=="object"}s(R,"objectLiteral"),r.objectLiteral=R;function A(P,M){return Array.isArray(P)&&P.every(M)}s(A,"typedArray"),r.typedArray=A})(Ue||(Ue={}));var Nc;(function(r){function e(n){return typeof n=="string"||n instanceof String}s(e,"string"),r.string=e;function t(n){return typeof n=="number"||n instanceof Number}s(t,"number"),r.number=t})(Nc||(Nc={}));var rd;(function(r){function e(t){const n=t;return n!=null&&(Nc.number(n.value)||Nc.string(n.value))&&Nc.string(n.target)}s(e,"is"),r.is=e})(rd||(rd={}));class Eh extends h.Diagnostic{constructor(e,t,n,i){super(e,t,n);this.data=i,this.hasDiagnosticCode=!1}}s(Eh,"ProtocolDiagnostic");var zi;(function(r){const e=Object.prototype.toString;function t(_){return typeof _!="undefined"}s(t,"defined"),r.defined=t;function n(_){return _===!0||_===!1}s(n,"boolean"),r.boolean=n;function i(_){return e.call(_)==="[object String]"}s(i,"string"),r.string=i;function o(_){return e.call(_)==="[object Number]"}s(o,"number"),r.number=o;function a(_){return _!==null&&typeof _=="object"}s(a,"objectLiteral"),r.objectLiteral=a;function l(_){return Array.isArray(_)}s(l,"array"),r.array=l;function u(_){return l(_)&&_.every(R=>i(R))}s(u,"stringArray"),r.stringArray=u;function d(_,R){return Array.isArray(_)&&_.every(R)}s(d,"typedArray"),r.typedArray=d})(zi||(zi={}));var jl;(function(r){function e(t){const n=t;return n&&zi.string(n.language)&&zi.string(n.value)}s(e,"is"),r.is=e})(jl||(jl={}));function sg(r){const e=s(oe=>h.Uri.parse(oe),"nullConverter"),t=r!=null?r:e;function n(oe){return t(oe)}s(n,"asUri");function i(oe){return oe.map(o)}s(i,"asDiagnostics");function o(oe){const at=new Eh(R(oe.range),oe.message,P(oe.severity),oe.data);return oe.code!==void 0&&(Ac.is(oe.codeDescription)?at.code={value:oe.code,target:n(oe.codeDescription.href)}:rd.is(oe.code)?(at.hasDiagnosticCode=!0,at.code={value:oe.code.value,target:n(oe.code.target)}):at.code=oe.code),oe.source&&(at.source=oe.source),oe.relatedInformation&&(at.relatedInformation=a(oe.relatedInformation)),Array.isArray(oe.tags)&&(at.tags=u(oe.tags)),at}s(o,"asDiagnostic");function a(oe){return oe.map(l)}s(a,"asRelatedInformation");function l(oe){return new h.DiagnosticRelatedInformation(Ae(oe.location),oe.message)}s(l,"asDiagnosticRelatedInformation");function u(oe){if(!oe)return;const at=[];for(const Wt of oe){const hn=d(Wt);hn!==void 0&&at.push(hn)}return at.length>0?at:void 0}s(u,"asDiagnosticTags");function d(oe){switch(oe){case Es.Unnecessary:return h.DiagnosticTag.Unnecessary;case Es.Deprecated:return h.DiagnosticTag.Deprecated;default:return}}s(d,"asDiagnosticTag");function _(oe){if(!!oe)return new h.Position(oe.line,oe.character)}s(_,"asPosition");function R(oe){if(!!oe)return new h.Range(_(oe.start),_(oe.end))}s(R,"asRange");function A(oe){return oe.map(at=>R(at))}s(A,"asRanges");function P(oe){if(oe==null)return h.DiagnosticSeverity.Error;switch(oe){case fo.Error:return h.DiagnosticSeverity.Error;case fo.Warning:return h.DiagnosticSeverity.Warning;case fo.Information:return h.DiagnosticSeverity.Information;case fo.Hint:return h.DiagnosticSeverity.Hint}return h.DiagnosticSeverity.Error}s(P,"asDiagnosticSeverity");function M(oe){if(zi.string(oe))return new h.MarkdownString(oe);if(jl.is(oe))return new h.MarkdownString().appendCodeblock(oe.value,oe.language);if(Array.isArray(oe)){const Wt=[];for(const hn of oe){const fl=new h.MarkdownString;jl.is(hn)?fl.appendCodeblock(hn.value,hn.language):fl.appendMarkdown(hn),Wt.push(fl)}return Wt}let at;switch(oe.kind){case Dn.Markdown:return new h.MarkdownString(oe.value);case Dn.PlainText:return at=new h.MarkdownString,at.appendText(oe.value),at;default:return at=new h.MarkdownString,at.appendText(`Unsupported Markup content received. Kind is: ${oe.kind}`),at}}s(M,"asHoverContent");function k(oe){if(zi.string(oe))return oe;switch(oe.kind){case Dn.Markdown:return new h.MarkdownString(oe.value);case Dn.PlainText:return oe.value;default:return`Unsupported Markup content received. Kind is: ${oe.kind}`}}s(k,"asDocumentation");function B(oe){if(!!oe)return new h.Hover(M(oe.contents),R(oe.range))}s(B,"asHover");function U(oe){if(!!oe)return new h.TextEdit(R(oe.range),oe.newText)}s(U,"asTextEdit");function H(oe){if(!!oe)return oe.map(U)}s(H,"asTextEdits");function re(oe){if(!oe)return;const at=new h.SignatureHelp;return zi.number(oe.activeSignature)?at.activeSignature=oe.activeSignature:at.activeSignature=0,zi.number(oe.activeParameter)?at.activeParameter=oe.activeParameter:at.activeParameter=0,oe.signatures&&(at.signatures=Y(oe.signatures)),at}s(re,"asSignatureHelp");function Y(oe){return oe.map(he)}s(Y,"asSignatureInformations");function he(oe){const at=new h.SignatureInformation(oe.label);return oe.documentation!==void 0&&(at.documentation=k(oe.documentation)),oe.parameters!==void 0&&(at.parameters=De(oe.parameters)),oe.activeParameter!==void 0&&(at.activeParameter=oe.activeParameter),at}s(he,"asSignatureInformation");function De(oe){return oe.map(Ie)}s(De,"asParameterInformations");function Ie(oe){const at=new h.ParameterInformation(oe.label);return oe.documentation&&(at.documentation=k(oe.documentation)),at}s(Ie,"asParameterInformation");function Ae(oe){if(!!oe)return new h.Location(t(oe.uri),R(oe.range))}s(Ae,"asLocation");function Ye(oe){if(!!oe)return rt(oe)}s(Ye,"asDeclarationResult");function Pe(oe){if(!!oe)return rt(oe)}s(Pe,"asDefinitionResult");function qe(oe){if(!oe)return;const at={targetUri:t(oe.targetUri),targetRange:R(oe.targetSelectionRange),originSelectionRange:R(oe.originSelectionRange),targetSelectionRange:R(oe.targetSelectionRange)};if(!at.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return at}s(qe,"asLocationLink");function rt(oe){if(!!oe)return zi.array(oe)?oe.length===0?[]:bs.is(oe[0])?oe.map(hn=>qe(hn)):oe.map(Wt=>Ae(Wt)):bs.is(oe)?[qe(oe)]:Ae(oe)}s(rt,"asLocationResult");function Nt(oe){if(!!oe)return oe.map(at=>Ae(at))}s(Nt,"asReferences");function cn(oe){if(!!oe)return oe.map(Wn)}s(cn,"asDocumentHighlights");function Wn(oe){const at=new h.DocumentHighlight(R(oe.range));return zi.number(oe.kind)&&(at.kind=Xn(oe.kind)),at}s(Wn,"asDocumentHighlight");function Xn(oe){switch(oe){case Kt.Text:return h.DocumentHighlightKind.Text;case Kt.Read:return h.DocumentHighlightKind.Read;case Kt.Write:return h.DocumentHighlightKind.Write}return h.DocumentHighlightKind.Text}s(Xn,"asDocumentHighlightKind");function Ai(oe,at){if(!!oe)return oe.map(Wt=>Zp(Wt,at))}s(Ai,"asSymbolInformations");function Ri(oe){return oe<=hr.TypeParameter?oe-1:h.SymbolKind.Property}s(Ri,"asSymbolKind");function js(oe){switch(oe){case Qt.Deprecated:return h.SymbolTag.Deprecated;default:return}}s(js,"asSymbolTag");function xu(oe){if(oe==null)return;const at=[];for(const Wt of oe){const hn=js(Wt);hn!==void 0&&at.push(hn)}return at.length===0?void 0:at}s(xu,"asSymbolTags");function Zp(oe,at){const Wt=new h.SymbolInformation(oe.name,Ri(oe.kind),R(oe.location.range),oe.location.uri?t(oe.location.uri):at);return Jp(Wt,oe),oe.containerName&&(Wt.containerName=oe.containerName),Wt}s(Zp,"asSymbolInformation");function By(oe){if(oe!=null)return oe.map(ph)}s(By,"asDocumentSymbols");function ph(oe){var at;const Wt=new h.DocumentSymbol(oe.name,(at=oe.detail)!=null?at:"",Ri(oe.kind),R(oe.range),R(oe.selectionRange));if(Jp(Wt,oe),oe.children!==void 0&&oe.children.length>0){const hn=[];for(const fl of oe.children)hn.push(ph(fl));Wt.children=hn}return Wt}s(ph,"asDocumentSymbol");function Jp(oe,at){oe.tags=xu(at.tags),at.deprecated&&(oe.tags?oe.tags.includes(h.SymbolTag.Deprecated)||(oe.tags=oe.tags.concat(h.SymbolTag.Deprecated)):oe.tags=[h.SymbolTag.Deprecated])}s(Jp,"fillTags");function gh(oe){const at={title:oe.title,command:oe.command};return oe.arguments&&(at.arguments=oe.arguments),at}s(gh,"asCommand");function Uy(oe){if(!!oe)return oe.map(gh)}s(Uy,"asCommands");const Eo=new Map;Eo.set(Ar.Empty,h.CodeActionKind.Empty),Eo.set(Ar.QuickFix,h.CodeActionKind.QuickFix),Eo.set(Ar.Refactor,h.CodeActionKind.Refactor),Eo.set(Ar.RefactorExtract,h.CodeActionKind.RefactorExtract),Eo.set(Ar.RefactorInline,h.CodeActionKind.RefactorInline),Eo.set(Ar.RefactorRewrite,h.CodeActionKind.RefactorRewrite),Eo.set(Ar.Source,h.CodeActionKind.Source),Eo.set(Ar.SourceOrganizeImports,h.CodeActionKind.SourceOrganizeImports);function mh(oe){if(oe==null)return;let at=Eo.get(oe);if(at)return at;const Wt=oe.split(".");at=h.CodeActionKind.Empty;for(const hn of Wt)at=at.append(hn);return at}s(mh,"asCodeActionKind");function Hy(oe){if(oe!=null)return oe.map(at=>mh(at))}s(Hy,"asCodeActionKinds");function jy(oe){if(oe==null)return;const at=new h.CodeAction(oe.title);return oe.kind!==void 0&&(at.kind=mh(oe.kind)),oe.diagnostics&&(at.diagnostics=i(oe.diagnostics)),oe.edit&&(at.edit=eg(oe.edit)),oe.command&&(at.command=gh(oe.command)),oe.isPreferred!==void 0&&(at.isPreferred=oe.isPreferred),at}s(jy,"asCodeAction");function eg(oe){if(!oe)return;const at=new h.WorkspaceEdit;return oe.documentChanges?oe.documentChanges.forEach(Wt=>{if(Uo.is(Wt))at.createFile(t(Wt.uri),Wt.options);else if(Ho.is(Wt))at.renameFile(t(Wt.oldUri),t(Wt.newUri),Wt.options);else if(Ci.is(Wt))at.deleteFile(t(Wt.uri),Wt.options);else if(Ta.is(Wt))at.set(t(Wt.textDocument.uri),H(Wt.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Wt,void 0,4)}`)}):oe.changes&&Object.keys(oe.changes).forEach(Wt=>{at.set(t(Wt),H(oe.changes[Wt]))}),at}s(eg,"asWorkspaceEdit");function tg(oe){return new h.Color(oe.red,oe.green,oe.blue,oe.alpha)}s(tg,"asColor");function rg(oe){return new h.ColorInformation(R(oe.range),tg(oe.color))}s(rg,"asColorInformation");function qy(oe){if(Array.isArray(oe))return oe.map(rg)}s(qy,"asColorInformations");function ng(oe){const at=new h.ColorPresentation(oe.label);return at.additionalTextEdits=H(oe.additionalTextEdits),oe.textEdit&&(at.textEdit=U(oe.textEdit)),at}s(ng,"asColorPresentation");function zy(oe){if(Array.isArray(oe))return oe.map(ng)}s(zy,"asColorPresentations");function ig(oe){if(oe)switch(oe){case ho.Comment:return h.FoldingRangeKind.Comment;case ho.Imports:return h.FoldingRangeKind.Imports;case ho.Region:return h.FoldingRangeKind.Region}}s(ig,"asFoldingRangeKind");function og(oe){return new h.FoldingRange(oe.startLine,oe.endLine,ig(oe.kind))}s(og,"asFoldingRange");function Wy(oe){if(Array.isArray(oe))return oe.map(og)}s(Wy,"asFoldingRanges");function vh(oe){return new h.SelectionRange(R(oe.range),oe.parent?vh(oe.parent):void 0)}s(vh,"asSelectionRange");function Gy(oe){if(!Array.isArray(oe))return[];const at=[];for(const Wt of oe)at.push(vh(Wt));return at}return s(Gy,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:R,asRanges:A,asPosition:_,asDiagnosticSeverity:P,asDiagnosticTag:d,asHover:B,asTextEdit:U,asTextEdits:H,asSignatureHelp:re,asSignatureInformations:Y,asSignatureInformation:he,asParameterInformations:De,asParameterInformation:Ie,asDeclarationResult:Ye,asDefinitionResult:Pe,asLocation:Ae,asReferences:Nt,asDocumentHighlights:cn,asDocumentHighlight:Wn,asDocumentHighlightKind:Xn,asSymbolKind:Ri,asSymbolTag:js,asSymbolTags:xu,asSymbolInformations:Ai,asSymbolInformation:Zp,asDocumentSymbols:By,asDocumentSymbol:ph,asCommand:gh,asCommands:Uy,asCodeAction:jy,asCodeActionKind:mh,asCodeActionKinds:Hy,asWorkspaceEdit:eg,asFoldingRangeKind:ig,asFoldingRange:og,asFoldingRanges:Wy,asColor:tg,asColorInformation:rg,asColorInformations:qy,asColorPresentation:ng,asColorPresentations:zy,asSelectionRange:vh,asSelectionRanges:Gy}}s(sg,"createConverter");const Hr=(0,Ec.loadMessageBundle)();var Wi;(function(r){function e(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}s(e,"externalUri"),r.externalUri=e;function t(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}s(t,"externalIndexUri"),r.externalIndexUri=t})(Wi||(Wi={}));var zo;(function(r){function e(i){if(i.HEAD.type===Le.Branch||i.HEAD.type===Le.RemoteBranch)return i.HEAD.name}s(e,"getBranchName"),r.getBranchName=e;function t(i){if(i.HEAD.type!==Le.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}s(t,"getIndexBranchName"),r.getIndexBranchName=t;async function n(i,o,a=Xr.timeout){const l=await i.getMetadata(o),u=Wi.externalIndexUri(i,l),d=r.getIndexBranchName(l);if(!(u===void 0||d===void 0))return Xr.getIndexedTip(u,d,{authentication:i.getAuthentication(o)},a)}s(n,"getIndexedTip"),r.getIndexedTip=n})(zo||(zo={}));var Mc;(function(r){const e=new Z(1024);function t(a,l,u){let d=e.get(u);return d!==void 0||(d=a.getCommit(l,u),e.set(u,d)),d}s(t,"get"),r.get=t;async function n(a,l,u){const d=[];for(const R of u)d.push(t(a,l,R));const _=[];for(const R of await Promise.all(d))R!==void 0&&_.push(R);return _}s(n,"all"),r.all=n;function i(a,l){const u=a.commitDate,d=l.commitDate;return u===void 0&&d===void 0?0:u===void 0?1:d===void 0?-1:u<d?1:u>d?-1:0}s(i,"sort"),r.sort=i;function o(a){const l=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",u=a.commitDate!==void 0?`  \u2022  ${Si(a.commitDate,{ago:!0})}`:"",d=a.branchName!==void 0?` - ${a.branchName}`:"",_=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:l,date:u,branch:d,tag:_}}s(o,"getCommitInfo"),r.getCommitInfo=o})(Mc||(Mc={}));var Sh;(function(r){r[r.Unknown=0]="Unknown",r[r.New=1]="New",r[r.Failed=2]="Failed",r[r.Partial=3]="Partial",r[r.InProgress=4]="InProgress",r[r.Complete=5]="Complete",r[r.PartialIndex=6]="PartialIndex",r[r.CompleteIndex=7]="CompleteIndex"})(Sh||(Sh={}));var ql;(function(r){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:t(n.BranchName),creationDate:new Date(n._ts*1e3)}}s(e,"asWorkspaceSnapshot"),r.asWorkspaceSnapshot=e;function t(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}s(t,"getBranchName")})(ql||(ql={}));var Xr;(function(r){r.timeout=5*60*1e3;const e=new Z(32),t=new Z(32);async function n(_,R,A,P=r.timeout){const M=await i(_,R,A,P);if(!(M===void 0||M.length===0))return M[0]}s(n,"getIndexedTip"),r.getIndexedTip=n;async function i(_,R,A,P=r.timeout){const M=a(_,R);let k=e.get(M);if(k===void 0||k!==void 0&&Date.now()-k.time>P){const B=ci.getAllWorkspaceSnapshots(_,A,R);k={time:Date.now(),promise:B,snapshots:void 0},e.set(M,k)}if(k.snapshots!==null){if(k.snapshots===void 0){let B=await k.promise;if(B===void 0){k.snapshots=null;return}B.sort((U,H)=>H.creationDate.getTime()-U.creationDate.getTime()),B=B.filter(U=>U.state===5||U.state===3),k.snapshots=B}return k.snapshots}}s(i,"all"),r.all=i;async function o(_,R,A,P,M=r.timeout){const k=_.toString();let B=t.get(k);if(B===null)return;if(B!==void 0)return B;const U=a(_,A),H=e.get(U);if(H!==void 0&&Date.now()-H.time<=M){if(H.snapshots===null)return;const re=H.snapshots!==void 0?H.snapshots:await i(_,A,P);if(re!==void 0){for(const Y of re)if(Y.commitId===R)return Y}return}if(B=await ci.getWorkspaceSnapshot(R,P),B===void 0){t.set(k,null);return}return t.set(k,B),B}s(o,"single"),r.single=o;function a(_,R){return R!==void 0?`${R}\\${_.toString()}`:_.toString()}s(a,"getAllCacheKey");async function l(_,R,A,P=r.timeout){return await o(_,R,void 0,A,P)!==void 0}s(l,"exists"),r.exists=l;async function u(_,R,A,P=r.timeout){return await i(_,R,A,P)!==void 0}s(u,"branch"),r.branch=u;async function d(_,R,A){const P=new Map(A.map(B=>[B.commitId,B])),M=await Mc.all(_,R.uri,A.map(B=>B.commitId));if(M.length===0)return;const k=[];for(const B of M){const U=P.get(B.hash);U!==void 0&&k.push({...U,commit:B})}if(k.length!==0)return k}s(d,"resolve"),r.resolve=d})(Xr||(Xr={}));var Gi;(function(r){function e(t=!1){return{hoverProvider:t,declarationProvider:t,definitionProvider:t,typeDefinitionProvider:t,referencesProvider:t,documentSymbolProvider:t,foldingRangeProvider:t,diagnosticProvider:t}}s(e,"create"),r.create=e})(Gi||(Gi={}));var ci;(function(r){const e="v0.1",t="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(U,H,re){var Y;const he=await Zt(U,{method:"POST",body:JSON.stringify(H),headers:{"Content-Type":"application/json",...(await re.authentication).getRichNavigationHeaders(),"x-correlation-id":(Y=re.correlationId)!=null?Y:yc()}});if(!!he.ok)return he.json()}s(n,"postRequest");async function i(U,H,re){const Y=await Zt(U,{method:"POST",body:H,headers:(await re.authentication).getRichNavigationHeaders()});if(!!Y.ok)return await Y.json()}s(i,"postForm");function o(U,H){return`${t}/${e}/HttpLanguageService/${U}/${H}`}s(o,"makeRequestUrl");async function a(U,H){const re=await Zt(`${t}/${e}/WorkspaceSnapshot?commitId=${U}`,{headers:(await H.authentication).getRichNavigationHeaders()});if(re.ok){const Y=await re.json();return{workspaceId:Y.workspaceId,snapshotId:Y.snapshotId,state:Y.state,commitId:U.toLowerCase(),branchName:void 0,creationDate:new Date}}}s(a,"getWorkspaceSnapshot"),r.getWorkspaceSnapshot=a;async function l(U,H,re){const Y=new ps;Y.append("uriString",U.toString(!0)),re!==void 0&&Y.append("branchName",re);try{const he=await i(`${t}/${e}/WorkspaceSnapshot/all`,Y,H);return he===void 0?void 0:he.map(ql.asWorkspaceSnapshot)}catch(he){$.error(he);return}}s(l,"getAllWorkspaceSnapshots"),r.getAllWorkspaceSnapshots=l;async function u(U,H,re){const Y=new ps;Y.append("uriString",U.toString(!0)),re!==void 0&&Y.append("branchName",re);try{const he=await i(`${t}/${e}/WorkspaceSnapshot/latest`,Y,H);return he===void 0?void 0:ql.asWorkspaceSnapshot(he)}catch(he){$.error(he);return}}s(u,"getLatestWorkspaceSnapshot"),r.getLatestWorkspaceSnapshot=u;async function d(U,H,re){try{return n(o(U,"textDocument/capabilities"),H,re)}catch(Y){$.error(Y);return}}s(d,"capabilities"),r.capabilities=d;async function _(U,H,re){try{return n(o(U,"textDocument/hover"),H,re)}catch(Y){$.error(Y);return}}s(_,"provideHover"),r.provideHover=_;async function R(U,H,re){try{return n(o(U,"textDocument/definition"),H,re)}catch(Y){$.error(Y);return}}s(R,"provideDefinition"),r.provideDefinition=R;async function A(U,H,re){try{return n(o(U,"textDocument/declaration"),H,re)}catch(Y){$.error(Y);return}}s(A,"provideDeclaration"),r.provideDeclaration=A;async function P(U,H,re){try{return n(o(U,"textDocument/typeDefinition"),H,re)}catch(Y){$.error(Y);return}}s(P,"provideTypeDefinition"),r.provideTypeDefinition=P;async function M(U,H,re){try{return n(o(U,"textDocument/references"),H,re)}catch(Y){$.error(Y);return}}s(M,"provideReferences"),r.provideReferences=M;async function k(U,H,re){try{return n(o(U,"textDocument/foldingRange"),H,re)}catch(Y){$.error(Y);return}}s(k,"providerFoldingRanges"),r.providerFoldingRanges=k;async function B(U,H,re){const Y=h.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${U}/${H}/assets/designtime`,query:`id=${re}`});try{const he=await Zt(Y.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return he.ok?he.text():void 0}catch(he){$.error(he);return}}s(B,"getDesignTimeFileContent"),r.getDesignTimeFileContent=B})(ci||(ci={}));class Ch{constructor(e,t){this.providerService=e,this.telemetryService=t,this.metadata=new Map;const n=[];n.push(this.providerService.onDidChangeRepositories(i=>{var o;for(const a of i.added){const l=a.uri,u=Ne.getIndexMemento(l);if(u!==void 0){const d=Wi.externalIndexUri(this.providerService,l);d!==void 0&&(typeof((o=u.branch)==null?void 0:o.name)=="string"?Xr.all(d,u.branch.name,{authentication:this.providerService.getAuthentication(l)}).catch(void 0):typeof u.ref=="string"&&mr(u.ref)&&Xr.single(d,u.ref,void 0,{authentication:this.providerService.getAuthentication(l)}).catch(void 0))}this.providerService.getMetadata(l).then(d=>{const _={},R=d.pullRequest===void 0?zo.getIndexBranchName(d):void 0;R!==void 0?_.branch={name:R}:_.ref=d.HEAD.sha,Ne.setIndexMemento(l,_).then(void 0,void 0)},void 0)}})),n.push(this.providerService.onDidChangeRepository(i=>{const o=i.repository.uri,a=ne(o);this.metadata.delete(a),this.getIndexMetadata(o).catch(void 0)})),this.disposable=h.Disposable.from(...n)}dispose(){this.disposable.dispose()}async resolveIndexRef(e,t){const n=await this.providerService.getModeRefType(e),i=$r.decode(e);if(i!==void 0){if(i.type===Gt.Latest)return n===se.Branch?this.getIndexedTip(e,t?0:Xr.timeout):void 0;if(i.type===Gt.SHA){const a=Wi.externalIndexUri(this.providerService,e);return a===void 0?void 0:await Xr.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},t?0:Xr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===j.Latest)return this.getIndexedTip(e,t?0:Xr.timeout)}refresh(e){for(const t of e)this.metadata.delete(t.toString())}getIndexMetadata(e){const t=this.providerService.getVirtualRootUri(e),n=ne(t);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,t=Xr.timeout){const n=await zo.getIndexedTip(this.providerService,e,t);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const t=new lt(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=Wi.externalIndexUri(this.providerService,e);if(n===void 0)return;t.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;t.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const l=this.providerService.getAuthentication(e),u=a.pullRequest===void 0?zo.getIndexBranchName(a):void 0,d=await Xr.single(n,a.HEAD.sha,u,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===Le.Branch||a.HEAD.type===Le.RemoteBranch){const P=$r.decode(e);if(P!==void 0)return t.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),d===void 0?P.type===Gt.Latest?(t.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),u!==void 0&&await Xr.branch(n,u,{authentication:this.providerService.getAuthentication(e)})?{type:wt.Indexed}:{type:wt.NotIndexed}):{type:wt.NotIndexed}:P.type===Gt.Latest||P.type===Gt.SHA?{type:wt.Active,sha:Promise.resolve(d.commitId),branch:{name:d.branchName}}:{type:wt.Match,sha:Promise.resolve(d.commitId),branch:{name:d.branchName}}}t.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const R=this.providerService.getModeConfig(e,await o),A=this.providerService.getVirtualUriMetadata(e);if((R.index===j.Latest||R.index===j.Match)&&d!==void 0)return{type:wt.Active,sha:Promise.resolve(d.commitId),branch:{name:d.branchName}};if(R.index===j.TipPlusLatest&&A.provider.id==="github"){if(d!==void 0&&d.commitId===a.HEAD.sha)return{type:wt.Active,sha:Promise.resolve(d.commitId),branch:{name:d.branchName}};if(a.HEAD.type===Le.Branch&&u!==void 0){t.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const P=await Xr.all(n,u,{authentication:l});if(P!==void 0&&P.length>0)return{type:wt.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,P),branch:{name:u}}}}return d!==void 0?{type:wt.Indexed}:a.HEAD.type===Le.Branch&&(t.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),u!==void 0&&await Xr.branch(n,u,{authentication:l}))?{type:wt.Indexed}:{type:wt.NotIndexed}}finally{t.stop()}}async computeClosestIndex(e,t,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(_=>_.commitId)),o=await this.providerService.getCommits(e,{ref:t,limit:100});if(o===void 0)return;let a;for(const _ of o.commits)if(_.hash===t){a=_;break}if(a===void 0)return;const l=new Map(o.commits.map(_=>[_.hash,_])),u=[a];let d;for(;u.length>0;){for(d=u.shift();d!==void 0&&!i.has(d.hash);)if(d.parents.length>0){for(let _=1;_<d.parents.length;_++){const R=l.get(d.parents[_]);R!==void 0&&u.push(R)}d=l.get(d.parents[0])}if(d!==void 0)break}return d!==void 0?d.hash:void 0}async getSnapshots(e,t){const n=Wi.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await Xr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const t=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,t)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:a}=t,l=[];if(n!==void 0){let u;const d=[`${qt(a.sha)}`];if(n.type===wt.Active){const _=await n.sha;o.index===j.Latest||o.index===j.Match?(u=o.display===ie.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",d.push(Hr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===j.TipPlusLatest&&(u="$(layers-dot)",_!==t.HEAD.sha?d.push(Hr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):d.push(Hr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===wt.Match?(u="$(layers)",d.push(Hr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===wt.Indexed&&(u="$(layers)",d.push(Hr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));u&&l.push(Kn({command:"remoteHub.indexMode.select",title:u,tooltip:d.join(`
`),arguments:[{uri:e}]}))}return l}}s(Ch,"RichNavIndexProvider");var Ia;(function(r){let e;function t(){return e=h.window.createStatusBarItem(h.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,h.window.onDidChangeActiveTextEditor(()=>{u()}),h.commands.registerCommand("remoteHub.indexMode.select",_=>{d(_).catch(R=>$.log("Selecting index mode failed.",R))})]}s(t,"create"),r.create=t;const n=new Map;function i(_){n.set(_.key(),_)}s(i,"addService"),r.addService=i;function o(_){n.delete(_.key())}s(o,"removeService"),r.removeService=o;function a(_){return n.get(ne(_))}s(a,"getService");async function l(_){for(const R of n.values())if(await R.handles(_))return R}s(l,"getServiceForDocument");async function u(){try{let _=s(function(M){const k=M.lastIndexOf("/");return k<=0?M:M.substr(k+1)},"basename");const R=h.window.activeTextEditor;if(R===void 0){e.hide();return}const A=await l(R.document);if(A===void 0){e.hide();return}const P=await A.isDocumentIndexed(R.document);P===zl.Indexed?(e.text="$(compass)",e.tooltip=new h.MarkdownString(Hr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",_(R.document.uri.path))),e.show()):P===zl.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new h.MarkdownString(Hr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",_(R.document.uri.path))),e.show()):e.hide()}catch(_){e.hide()}}s(u,"updateStatusBarItem"),r.updateStatusBarItem=u;async function d(_){var R;const A=_.uri,P=a(A);if(P===void 0)return;const[M,k,B,U]=await Promise.all([P.getBranchName(),P.getMetadata(),P.getIndexMetadata(),P.getModeRefType(A)]);if(B===void 0||!wt.hasIndex(B.type))return;let H,re=!1;const Y=$r.decode(A);(Y==null?void 0:Y.type)===Gt.Latest||(Y==null?void 0:Y.type)===Gt.SHA?(re=!0,H={display:ie.Browse,index:Y.type===Gt.Latest?j.Latest:j.Match}):H=(R=P.getCurrentIndexMode())!=null?R:P.getModeConfig(A,U);const he=P.getUriMetadata(),De=Hr("current item","{0} current","$(check)"),Ie={kind:"disable",label:Hr("RichNavStatus.disable.label","Disable"),description:H.index===j.None?`  \u2022  ${De}`:void 0,detail:Hr("RichNavStatus.disable.detail","Disable rich navigation. {0}",he.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let Ae,Ye;if(U===se.PullRequestBranch||U===se.PullRequestRemoteBranch||U===se.Commit||U===se.Tag){const Pe={kind:"match",label:Hr("RichNavStatus.match.label","Current indexed commit - readonly"),description:H.index===j.Match&&H.display===ie.Browse?`  \u2022  ${De}`:void 0,detail:Hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},qe={kind:"match+writeable",label:Hr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:H.index===j.Match&&H.display===ie.Edit?`  \u2022  ${De}`:void 0,detail:Hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let rt=he.provider.id==="github";rt&&(rt=k.HEAD.type===Le.RemoteBranch?k.HEAD.branch.remote.accessLevel>=Ze.Write:!0);const Nt=rt?[Pe,qe,Ie]:[Pe,Ie];Ye=await h.window.showQuickPick(Nt,{placeHolder:"Pick a rich navigation mode"})}else if(U===se.Branch||U===se.RemoteBranch){const Pe={kind:"latest",label:Hr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:H.index===j.Latest?`  \u2022  ${De}`:void 0,detail:Hr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},qe={kind:"tip+latest",label:Hr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:H.index===j.TipPlusLatest?`  \u2022  ${De}`:void 0,detail:Hr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},rt=he.provider.id==="github"?[Pe,qe,Ie]:[Pe,Ie];Ye=await h.window.showQuickPick(rt,{placeHolder:Hr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",M)})}if(Ye!==void 0&&(Ye.kind==="disable"?Ae={display:ie.Edit,index:j.None}:Ye.kind==="match"?Ae={display:ie.Browse,index:j.Match}:Ye.kind==="match+writeable"?Ae={display:ie.Edit,index:j.Match}:Ye.kind==="tip+latest"?Ae={display:ie.Edit,index:j.TipPlusLatest}:Ye.kind==="latest"&&(Ae={display:ie.Browse,index:j.Latest}),Ae!==void 0&&!pe.equals(H,Ae))){if(await P.hasChanges()&&Ae.display===ie.Browse){await h.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(await P.updateIndexMode(Ae),re){const Pe=await P.getNonIndexedWorkspaceDescriptor();Pe!==void 0&&Un(Pe)}}}s(d,"toggleIndexMode")})(Ia||(Ia={}));class nd{constructor(e){this.telemetryService=e}static createStatus(){return Ia.create()}async createNavigationService(e,t,n){const i=await e.getIndexMetadata(t.uri);if(!(i===void 0||i.type===wt.NotIndexed))return()=>new od(e,t,n,this.telemetryService)}}s(nd,"RichNavServiceProvider");var Fc;(function(r){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function t(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return h.Uri.from({scheme:po.scheme,authority:ro(JSON.stringify(a)),path:o[4]})}s(t,"toVSCode"),r.toVSCode=t;function n(i){if(i.scheme!==po.scheme)return;let o;try{return o=JSON.parse(Zn(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}s(n,"toRichNavComponents"),r.toRichNavComponents=n})(Fc||(Fc={}));const id=s(class{constructor(){this._onDidChangeFile=new h.EventEmitter,this.cache=new Z(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(r,e){return id.emptyDisposable}async stat(r){const e=await this.getFile(r);if(e===void 0)throw h.FileSystemError.FileNotFound();return{type:h.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:h.FilePermission.Readonly}}readDirectory(r){return[]}createDirectory(r){throw h.FileSystemError.NoPermissions()}async readFile(r){const e=await this.getFile(r);if(e===void 0)throw h.FileSystemError.FileNotFound();return e.content}writeFile(r,e,t){throw h.FileSystemError.NoPermissions()}delete(r,e){throw h.FileSystemError.NoPermissions()}rename(r,e,t){throw h.FileSystemError.NoPermissions()}async getFile(r){let e=this.cache.get(r.toString());if(e!==void 0)return e;if(r.scheme!==id.scheme)return;const t=Fc.toRichNavComponents(r);if(t===void 0)return;const n=await ci.getDesignTimeFileContent(t.workspaceId,t.snapshotId,t.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(r.toString(),e),e}},"_RichNavFileSystemProvider");let po=id;po.scheme="vsck-fs",po.emptyDisposable={dispose:()=>{}};var zl;(function(r){r[r.NotIndexed=0]="NotIndexed",r[r.IndexMapped=1]="IndexMapped",r[r.Indexed=2]="Indexed"})(zl||(zl={}));const Vi=s(class{static registerCapability(r,e,t){var n;const i=this.disabledCapabilities.get(r);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(r);return(o==null?void 0:o[e])?!1:(n=t[e])!=null?n:!1}constructor(r,e,t,n){this.providerService=r,this.repository=e,this.changeStore=t,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const i=s((a=!1)=>{const l=this.repository.uri;a||(this.metadata=this.providerService.getMetadata(l),this.indexMetadata=this.providerService.getIndexMetadata(l)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(l,this.metadata)]).then(async u=>{var d,_;const[R,A,P]=this.currentlyResolved,[M,k,B]=u,U=this.providerService.getModeConfig(l,B);if(R!==void 0&&A!==void 0&&P!==void 0&&R.HEAD.sha===M.HEAD.sha&&k!==void 0&&A.type===k.type&&P.index===U.index&&P.display===U.display){const re=(A==null?void 0:A.type)===wt.Active?await A.sha:void 0,Y=(k==null?void 0:k.type)===wt.Active?await k.sha:void 0;if(re===Y)return}const H={newDisplayMode:U.display,newIndexMode:U.index,newIndexType:(k==null?void 0:k.type)===void 0?"undefined":wt[k==null?void 0:k.type],currentDisplayMode:(d=P==null?void 0:P.display)!=null?d:"undefined",currentIndexMode:(_=P==null?void 0:P.index)!=null?_:"undefined",currentIndexType:(A==null?void 0:A.type)===void 0?"undefined":wt[A==null?void 0:A.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",H),this.currentlyResolved=[M,k,U];for(const re of this.registeredFeatures.values())re.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,Er.isActive(k)){const re=Wi.externalIndexUri(this.providerService,M),Y=await k.sha;if(re!==void 0&&Y!==void 0){const he=await Xr.single(re,Y,zo.getIndexBranchName(M),{authentication:this.providerService.getAuthentication(l)});he!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:he.snapshotId}),this.workspaceSnapshot=he,this.documentListeners=this.installDocumentListeners(),((U==null?void 0:U.display)===ie.Edit||M.HEAD.sha!==Y)&&(this.mapper=new Sc(this.providerService,l,Y,M.HEAD.sha)))}}await Ia.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Z(2048),this.knownDesignTimeFiles=new Set;const o=[];o.push(this.providerService.onDidChangeRepository(a=>{ne(a.repository.uri)===ne(this.repository.uri)&&i()})),o.push(this.providerService.onDidRefresh(a=>{for(const l of a)if(ne(l)===ne(this.repository.uri)){i();break}})),this.environmentListeners=h.Disposable.from(...o),i(!0),Ia.addService(this),this.indexMetadata.then(async a=>{var l;const u=this.repository.uri;let d=!1;const _=$r.decode(this.repository.uri);if(_!==void 0&&a!==void 0&&(_.type===Gt.Latest&&a.type!==wt.Active||_.type===Gt.SHA&&(a.type!==wt.Active||await a.sha!==_.sha))&&(d=!0),!d){await this.metadata;const R=await this.providerService.getModeRefType(u,this.metadata),A=(l=this.currentlyResolved[2])!=null?l:this.providerService.getModeConfig(u,R,!0);A!==void 0&&A.display===ie.Browse&&a!==void 0&&A.index!==j.None&&a.type!==wt.Active?d=!0:(a==null?void 0:a.type)===wt.Active&&await a.sha===void 0&&((A==null?void 0:A.display)===ie.Browse,d=!0)}d&&h.window.showWarningMessage(Hr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Vi.fileSystemProvider===void 0&&(Vi.fileSystemProvider=new po,h.workspace.registerFileSystemProvider(po.scheme,Vi.fileSystemProvider))}getRepository(){return this.repository}async updateIndexMode(r){const e=this.currentlyResolved[2],t=r!==void 0;if(r===void 0){const n=this.repository.uri,i=await this.providerService.getModeRefType(n,this.metadata);r=this.providerService.getModeConfig(n,i),await new Promise(o=>setTimeout(o,1e3))}if(e===void 0||e.index!==r.index||e.display!==r.display){if(r.index===j.Latest){await Promise.all([this.metadata,this.indexMetadata]);const n=await this.getIndexedTip();if(n===void 0)return;await this.sync(n.hash)}else r.index===j.TipPlusLatest&&(await Promise.all([this.metadata,this.indexMetadata]),await this.sync());t&&await Ne.setMode(this.repository.uri,r),this.refresh()}}getCurrentIndexMode(){return this.currentlyResolved[2]}key(){return ne(this.repository.uri)}dispose(){for(const r of this.registeredFeatures.values())r.dispose();this.registeredFeatures.clear(),Ia.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(r){return r.uri.scheme!==tr.scheme?Promise.resolve(!1):Promise.resolve(r.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return zo.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(r,e){return this.providerService.getModeConfig(r,e)}getModeRefType(r){return this.providerService.getModeRefType(r)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:r,repo:e}=await this.metadata,{ref:t}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:r,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:t}),location:ir.CurrentWindow}}async isDocumentIndexed(r){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===wt.NotIndexed||this.workspaceSnapshot===void 0)return 0;const t=this.pendingCapabilitiesRequests.get(r.uri.toString());return t!==void 0&&await t,this.registeredFeatures.has(r.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(r)?1:2:0}async getIndexedTip(){const r=await this.metadata,e=Wi.externalIndexUri(this.providerService,r),t=zo.getIndexBranchName(r);if(e===void 0||t===void 0)return;const n=await Xr.getIndexedTip(e,t,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await Mc.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:t}}hasChanges(){return this.changeStore.hasChanges(this.repository.uri)}sync(r){return this.providerService.sync(this.repository.uri,this.changeStore,{to:r,reason:"user"})}async getCommit(r){const e=await this.metadata,t=Wi.externalIndexUri(this.providerService,e);if(t===void 0)return;const[n,i]=await Promise.all([Mc.get(this.providerService,this.repository.uri,r),Xr.single(t,r,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const r=[],e=s(async t=>{const n=t.uri.scheme;if(tr.scheme!==n&&po.scheme!==n)return;const i=t.uri.toString();if(n===tr.scheme&&!i.startsWith(this.repositoryRoot)||n===po.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const l=this.capabilities(t.uri);this.pendingCapabilitiesRequests.set(i,l),a=await l,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!h.workspace.textDocuments.some(l=>l===t)||this.registerProviders(t,a,o)}},"openHandler");return r.push(h.workspace.onDidOpenTextDocument(e)),h.workspace.textDocuments.forEach(e),r.push(h.workspace.onDidCloseTextDocument(t=>{const n=t.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(t.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),h.Disposable.from(...r)}registerProviders(r,e,t){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=r.languageId,a=[{scheme:this.repository.uri.scheme,pattern:r.uri.fsPath,language:r.languageId,exclusive:!0}],l=[],u=new Promise((k,B)=>{const U=`/${n.snapshotId}/source/`;this.metadata.then(H=>{k(sg(re=>{const Y=h.Uri.parse(re);if(H===void 0)return Y;try{if(Y.scheme==="vsck"&&Y.authority===n.workspaceId&&Y.path.startsWith(U))return this.repository.createRelativeUri(Y.path.substr(U.length));const he=Fc.toVSCode(re);return he!==void 0?(this.knownDesignTimeFiles.add(he.toString()),he):Y}catch(he){return Y}}))},B)}),d=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function _(k){const B=d.exec(k);return B===null||B.length===2}s(_,"designTimeFilter");function R(k){if(k==null)return k;if(Array.isArray(k)){if(k.length===0)return[];const B=k[0];return typeof B.uri=="string"?k.filter(re=>_(re.uri)):typeof B.targetUri=="string"?k.filter(re=>_(re.targetUri)):[]}return d.exec(k.uri)===null?k:void 0}s(R,"filterDesignTimeFiles");async function A(k,B,U){var H,re,Y;if(U==null||k===void 0)return U;const he=new Map(h.workspace.textDocuments.map(Ie=>[Ie.uri.toString(!0),Ie]));if(Array.isArray(U)){const Ie=[],Ae=[];if(U.length===0)return[];for(const Ye of U){const Pe=Ye;if(Pe.uri instanceof h.Uri){const qe=await k.mapRangeFromIndexToCode((H=he.get(Pe.uri.toString()))!=null?H:Pe.uri,Pe.range);qe!==void 0&&Ie.push(new h.Location(Pe.uri,qe))}else{const qe=Ye,rt=(re=he.get(qe.targetUri.toString()))!=null?re:qe.targetUri,Nt=qe.originSelectionRange?await k.mapRangeFromIndexToCode(B,qe.originSelectionRange):void 0;if(Nt!==void 0||qe.originSelectionRange===void 0){const cn=await k.mapRangeFromIndexToCode(rt,qe.targetRange);if(cn!==void 0){const Wn=qe.targetSelectionRange?await k.mapRangeFromIndexToCode(rt,qe.targetSelectionRange):void 0;(Wn!==void 0||qe.targetSelectionRange===void 0)&&Ae.push({targetUri:qe.targetUri,targetRange:cn,targetSelectionRange:Wn,originSelectionRange:Nt})}}}}return Ie.length>0?Ie:Ae}const De=await k.mapRangeFromIndexToCode((Y=he.get(U.uri.toString()))!=null?Y:U.uri,U.range);if(De!==void 0)return new h.Location(U.uri,De)}s(A,"mapLocations");const P=s(k=>({authentication:this.providerService.getAuthentication(k.uri),correlationId:yc()}),"getRestApiOptions"),M=s((k,B)=>{const U={method:k,correlationId:B.correlationId};this.telemetryService.publicLog2("codex.restAPICall",U)},"sendTelemetry");Vi.registerCapability(i,"hoverProvider",e)&&l.push(h.languages.registerHoverProvider(a,{provideHover:async(k,B)=>{const U=await this.createTextDocumentPositionParams(k,B);if(U===void 0)return;const H=P(k);return M("codex.provideHover",H),(await u).asHover(await ci.provideHover(t,U,H))}})),Vi.registerCapability(i,"definitionProvider",e)&&l.push(h.languages.registerDefinitionProvider(a,{provideDefinition:async(k,B)=>{const U=await this.createTextDocumentPositionParams(k,B);if(U===void 0)return;const H=P(k);return M("codex.provideDefinition",H),A(this.mapper,k,(await u).asDefinitionResult(R(await ci.provideDefinition(t,U,H))))}})),Vi.registerCapability(i,"declarationProvider",e)&&l.push(h.languages.registerDeclarationProvider(a,{provideDeclaration:async(k,B)=>{const U=await this.createTextDocumentPositionParams(k,B);if(U===void 0)return;const H=P(k);return M("codex.provideDeclaration",H),A(this.mapper,k,(await u).asDeclarationResult(R(await ci.provideDeclaration(t,U,H))))}})),Vi.registerCapability(i,"typeDefinitionProvider",e)&&l.push(h.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(k,B)=>{const U=await this.createTextDocumentPositionParams(k,B);if(U===void 0)return;const H=P(k);return M("codex.provideTypeDefinition",H),A(this.mapper,k,(await u).asDefinitionResult(R(await ci.provideTypeDefinition(t,U,H))))}})),Vi.registerCapability(i,"referencesProvider",e)&&l.push(h.languages.registerReferenceProvider(a,{provideReferences:async(k,B,U)=>{const H=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(k,B):B;if(H===void 0)return;const re={position:{line:H.line,character:H.character},textDocument:{uri:this.createRichNavDocumentUri(k.uri).toString(!0)},context:{includeDeclaration:U.includeDeclaration}},Y=P(k);return M("codex.provideReferences",Y),A(this.mapper,k,(await u).asReferences(R(await ci.provideReferences(t,re,Y))))}})),Vi.registerCapability(i,"foldingRangeProvider",e)&&l.push(h.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async k=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(k))return;const B=P(k);return M("codex.provideFoldingRanges",B),(await u).asFoldingRanges(await ci.providerFoldingRanges(t,this.createTextDocumentParams(k.uri),B))}})),this.registeredFeatures.set(r.uri.toString(),h.Disposable.from(...l)),Ia.updateStatusBarItem()}async capabilities(r){var e;const t=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(t!==void 0)return(e=await ci.capabilities(t,this.createTextDocumentParams(r),{authentication:this.providerService.getAuthentication(r)}))!=null?e:void 0}createTextDocumentParams(r){return{textDocument:{uri:this.createRichNavDocumentUri(r).toString(!0)}}}async createTextDocumentPositionParams(r,e){const t=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(r,e):e;if(t!==void 0)return{position:{line:t.line,character:t.character},textDocument:{uri:this.createRichNavDocumentUri(r.uri).toString(!0)}}}createRichNavDocumentUri(r){if(r.scheme===po.scheme){const n=Fc.toRichNavComponents(r);return n===void 0?r:h.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),t=r.toString(!0);return h.Uri.file(t.substr(e.length))}},"_RichNavService");let od=Vi;od.localCapabilities=new Map([["javascript",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Gi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),od.disabledCapabilities=new Map([["javascript",Object.assign(Gi.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Gi.create(),{declarationProvider:!0})],["typescript",Object.assign(Gi.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Gi.create(),{declarationProvider:!0})]]);var xh=s((r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)},"__accessCheck"),Ki=s((r,e,t)=>(xh(r,e,"read from private field"),t?t.call(r):e.get(r)),"__privateGet"),Th=s((r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},"__privateAdd"),Ah=s((r,e,t,n)=>(xh(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),"__privateSet"),li,Wl;class Rh{constructor(e,t){Th(this,li,void 0),Th(this,Wl,void 0),Ah(this,li,e),Ah(this,Wl,t)}async loadWorkspaceContents(e){if(e.scheme!=="vscode-vfs")return!1;const t=Ki(this,li).getProviderRootUri(e);if(t.scheme!=="github")return!1;try{return await Ki(this,Wl).getTar(t),!0}catch(n){return $.error(n),!1}}async getMetadata(e){const t=Ki(this,li).getVirtualUriMetadata(e);if(t===void 0)return;const{provider:n,repo:i}=t;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Ki(this,li).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Ki(this,li).getRegisteredProvider(e)}getProviderUri(e){return Ki(this,li).getProviderUri(e)}getProviderRootUri(e){return Ki(this,li).getProviderRootUri(e)}isProviderUri(e,t){return e.scheme!==tr.scheme&&Ki(this,li).hasProvider(e,t)}getVirtualUri(e){return Ki(this,li).getVirtualUri(e)}getVirtualWorkspaceUri(e){return Ki(this,li).getVirtualWorkspaceUri(e)}}s(Rh,"ExtensionApi"),li=new WeakMap,Wl=new WeakMap;var cg=Object.defineProperty,lg=Object.getOwnPropertyDescriptor,ad=s((r,e,t,n)=>{for(var i=n>1?void 0:n?lg(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&cg(e,t,i),i},"src_fs_decorateClass");const sd=h.FileSystemError.FileNotFound().code;class Lc{constructor(e,t){this.providerService=e,this.changeStore=t,this._onDidChangeFile=new h.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),t.onDidChange(n=>{const i=n.map(o=>{switch(o.type){case Mt.Created:return{type:h.FileChangeType.Created,uri:o.uri};case Mt.Changed:return{type:h.FileChangeType.Changed,uri:o.uri};case Mt.Deleted:return{type:h.FileChangeType.Deleted,uri:o.uri}}});setTimeout(()=>this._onDidChangeFile.fire(i),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return tr.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(t=>t.scheme===this.scheme),e.length!==0&&($.log(`fs.onRefreshOrRepositoryChanged(${e.map(t=>t.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const t=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>Be(o,a))&&(this.implicitlyWatchedUris.delete(i),t.set(i,o));$.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${t.size}`);for(const i of e)t.set(ne(i),i);const n=[...t.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{$.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,t){const n=ne(e);this.watchedUris.set(n,e);const i=this.providerService.watch(this.providerService.getProviderUri(e),t);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const t=new lt(`fs.stat(${e.toString()})`);let n;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(t.logStep("ChangeStore query"),n=await this.changeStore.stat(e),n!==void 0)return n;t.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else t.logStep("Provider query"),this.implicitlyWatchedUris.set(ne(e),e);return n=await this.providerService.stat(this.providerService.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(ne(e)),t.stop()}}async readDirectory(e){const t=new lt(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(ne(e),e);try{t.logStep("Provider query");let n=await this.providerService.readDirectory(this.providerService.getProviderUri(e));return this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(t.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.changeStore.updateDirectoryEntries(e,n)),n}finally{t.stop()}}async createDirectory(e){const t=new lt(`fs.createDirectory(${e.toString()})`);try{await this.changeStore.createDirectory(e)}catch(n){throw $.error(n,t.context),n}finally{t.stop()}}async readFile(e){const t=new lt(`fs.readFile(${e.toString()})`),n=ne(e);let i;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){t.logStep("ChangeStore query");const o=await this.changeStore.readFile(e);if(o!==void 0)return o;t.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else t.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(this.providerService.getProviderUri(e)),i}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),t.stop()}}async writeFile(e,t,n){const i=new lt(`fs.writeFile(${e.toString()})`,{},t.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw h.FileSystemError.FileExists()}catch(a){if(a instanceof h.FileSystemError&&a.code===sd){if(!n.create)throw h.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.changeStore.createFile(e,t);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(this.providerService.getProviderUri(e))}catch(l){if(l instanceof h.FileSystemError&&l.code===sd)a=new Uint8Array;else throw l}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.changeStore.writeFile(e,t,a)}}catch(a){throw $.error(a,i.context),a}}finally{i.stop()}}async delete(e,t){const n=new lt(`fs.delete(${e.toString()})`,{},t);try{switch((await this.stat(e)).type){case h.FileType.File:await this.changeStore.deleteFile(e);break;case h.FileType.Directory:{await this.deleteDirectory(e,t);break}default:throw h.FileSystemError.NoPermissions()}}catch(i){throw $.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,t){const n=new lt(`fs.deleteDirectory(${e.toString()})`,{},t);try{const i=await this.readDirectory(e);if(i.length!==0){if(!t.recursive&&i.some(([,o])=>o===h.FileType.Directory))throw h.FileSystemError.NoPermissions();for(const[o,a]of i)a===h.FileType.Directory?await this.deleteDirectory(h.Uri.joinPath(e,o),t):await this.changeStore.deleteFile(h.Uri.joinPath(e,o))}await this.changeStore.deleteDirectory(e)}catch(i){throw $.error(i,n.context),i}finally{n.stop()}}async rename(e,t,n){const i=new lt(`fs.rename(${e.toString()} -> ${t.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(t,a,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case h.FileType.Directory:{await this.renameDirectory(e,t,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw $.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,t,n){const i=new lt(`fs.renameDirectory(${e.toString()} -> ${t.toString()})`,{},n);try{await this.copyDirectory(e,t,n),await this.delete(e,{recursive:!0})}catch(o){throw $.error(o,i.context),o}finally{i.stop()}}async copy(e,t,n){const i=new lt(`fs.copy(${e.toString()} -> ${t.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(t,a,{create:!0,overwrite:n.overwrite});break}case h.FileType.Directory:{await this.copyDirectory(e,t,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw $.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,t,n){const i=new lt(`fs.copyDirectory(${e.toString()} -> ${t.toString()})`,{},n);try{if(await this.exists(t))throw h.FileSystemError.FileExists();try{await this.createDirectory(t);const o=await this.readDirectory(e);for(const[a,l]of o)l===h.FileType.Directory?await this.copyDirectory(h.Uri.joinPath(e,a),h.Uri.joinPath(t,a),n):await this.copy(h.Uri.joinPath(e,a),h.Uri.joinPath(t,a),n)}catch(o){throw $.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(t){if(t instanceof h.FileSystemError&&t.code===sd)return!1;throw t}}async provideFileSearchResults(e,t,n){var i;const o=new lt(`fs.provideFileSearchResults(${e.pattern}, ${t.folder.toString()})`,{logLevel:We.Debug});let a;try{return a=await this.providerService.provideFileSearchResults(e,{...t,folder:this.providerService.getProviderUri(t.folder)},n),a==null?void 0:a.map(l=>this.providerService.getVirtualUri(l))}catch(l){throw $.error(l,o.context),l}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}provideTextSearchResults(e,t,n,i){return this.providerService.provideTextSearchResults(e,{...t,folder:this.providerService.getProviderUri(t.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}s(Lc,"ChangeTrackingFileSystem"),ad([fn()],Lc.prototype,"stat",1),ad([fn()],Lc.prototype,"readDirectory",1),ad([fn()],Lc.prototype,"readFile",1);function ug(r){return r.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}s(ug,"escapeRegExpCharacters");function dg(r,e,t={}){if(!r)throw new Error("Cannot create regex from empty string");e||(r=ug(r)),t.wholeWord&&(/\B/.test(r.charAt(0))||(r=`\\b${r}`),/\B/.test(r.charAt(r.length-1))||(r=`${r}\\b`));let n="gmu";return t.matchCase||(n+="i"),new RegExp(r,n)}s(dg,"createRegExp");let Ih,Dh,cd;const hg=s((r,e,t,n)=>{const i=`${e.join("--")};;;;${t.join("--")}`,o=r.map(l=>l.path).join("::");if(Ih===o&&i==Dh&&cd)return cd;const a=An((n?r.filter(l=>l.size<n):r).map(l=>l.path),e,t);return Ih=o,Dh=i,cd=a,a},"generateIncludeSet"),fg=s((r,e,t,n)=>{var i;const o=[];let a;if(typeof r=="string")a=r;else{const _=r;if(_[0]==255&&_[1]==254)a=new TextDecoder("utf-16le").decode(_);else if(_[0]==254&&_[1]==255)a=new TextDecoder("utf-16be").decode(_);else if(a=new TextDecoder("utf8").decode(_),a.slice(0,1e3).includes("\uFFFD")&&_.includes(0))return[]}const l=[];let u=null,d=n.remainingResultQuota;for(;(d===void 0||d>=0)&&(u=t.exec(a));)l.push({matchStartIndex:u.index,matchedText:u[0]}),d!==void 0&&d--;if(l.length){const _=new Set,R=new Set,A=[],P=s(H=>a.slice(A[H].start,A[H].end),"readLine");let M=0,k=null;const B=/\r?\n/g;for(;k=B.exec(a);)A.push({start:M,end:k.index}),M=k.index+k[0].length;M<a.length&&A.push({start:M,end:a.length});let U=0;for(const{matchStartIndex:H,matchedText:re}of l){if(d!==void 0&&d<0)break;for(;Boolean(A[U+1])&&H>A[U].end;)U++;let Y=U;for(;Boolean(A[Y+1])&&H+re.length>A[Y].end;)Y++;if(n.beforeContext)for(let Pe=Math.max(0,U-n.beforeContext);Pe<U;Pe++)_.add(Pe);let he="",De=0;for(let Pe=U;Pe<=Y;Pe++){let qe=P(Pe);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&qe.length>n.previewOptions.charsPerLine&&(De=Math.max(H-A[U].start-20,0),qe=qe.substr(De,n.previewOptions.charsPerLine)),he+=`${qe}
`,R.add(Pe)}const Ie=new h.Range(U,H-A[U].start,Y,H+re.length-A[Y].start),Ae=new h.Range(0,H-A[U].start-De,Y-U,H+re.length-A[Y].start-(Y===U?De:0)),Ye={uri:h.Uri.file(e),ranges:Ie,preview:{text:he,matches:Ae}};if(o.push(Ye),n.afterContext)for(let Pe=Y+1;Pe<=Math.min(Y+n.afterContext,A.length-1);Pe++)_.add(Pe)}for(const H of _)R.has(H)||o.push({uri:h.Uri.file(e),text:P(H),lineNumber:H+1})}return o},"getFileResults");/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const pg=4,Ph=0,Oh=1,gg=2;function Rs(r){let e=r.length;for(;--e>=0;)r[e]=0}s(Rs,"zero$1");const mg=0,kh=1,vg=2,yg=3,_g=258,ld=29,$c=256,Bc=$c+1+ld,Is=30,ud=19,Nh=2*Bc+1,Da=15,dd=16,wg=7,hd=256,Mh=16,Fh=17,Lh=18,fd=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Gl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),bg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),$h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Eg=512,go=new Array((Bc+2)*2);Rs(go);const Uc=new Array(Is*2);Rs(Uc);const Hc=new Array(Eg);Rs(Hc);const jc=new Array(_g-yg+1);Rs(jc);const pd=new Array(ld);Rs(pd);const Vl=new Array(Is);Rs(Vl);function gd(r,e,t,n,i){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=r&&r.length}s(gd,"StaticTreeDesc");let Bh,Uh,Hh;function md(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}s(md,"TreeDesc");const jh=s(r=>r<256?Hc[r]:Hc[256+(r>>>7)],"d_code"),qc=s((r,e)=>{r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255},"put_short"),qn=s((r,e,t)=>{r.bi_valid>dd-t?(r.bi_buf|=e<<r.bi_valid&65535,qc(r,r.bi_buf),r.bi_buf=e>>dd-r.bi_valid,r.bi_valid+=t-dd):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)},"send_bits"),Qi=s((r,e,t)=>{qn(r,t[e*2],t[e*2+1])},"send_code"),qh=s((r,e)=>{let t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1},"bi_reverse"),Sg=s(r=>{r.bi_valid===16?(qc(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)},"bi_flush"),Cg=s((r,e)=>{const t=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,l=e.stat_desc.extra_base,u=e.stat_desc.max_length;let d,_,R,A,P,M,k=0;for(A=0;A<=Da;A++)r.bl_count[A]=0;for(t[r.heap[r.heap_max]*2+1]=0,d=r.heap_max+1;d<Nh;d++)_=r.heap[d],A=t[t[_*2+1]*2+1]+1,A>u&&(A=u,k++),t[_*2+1]=A,!(_>n)&&(r.bl_count[A]++,P=0,_>=l&&(P=a[_-l]),M=t[_*2],r.opt_len+=M*(A+P),o&&(r.static_len+=M*(i[_*2+1]+P)));if(k!==0){do{for(A=u-1;r.bl_count[A]===0;)A--;r.bl_count[A]--,r.bl_count[A+1]+=2,r.bl_count[u]--,k-=2}while(k>0);for(A=u;A!==0;A--)for(_=r.bl_count[A];_!==0;)R=r.heap[--d],!(R>n)&&(t[R*2+1]!==A&&(r.opt_len+=(A-t[R*2+1])*t[R*2],t[R*2+1]=A),_--)}},"gen_bitlen"),zh=s((r,e,t)=>{const n=new Array(Da+1);let i=0,o,a;for(o=1;o<=Da;o++)n[o]=i=i+t[o-1]<<1;for(a=0;a<=e;a++){let l=r[a*2+1];l!==0&&(r[a*2]=qh(n[l]++,l))}},"gen_codes"),xg=s(()=>{let r,e,t,n,i;const o=new Array(Da+1);for(t=0,n=0;n<ld-1;n++)for(pd[n]=t,r=0;r<1<<fd[n];r++)jc[t++]=n;for(jc[t-1]=n,i=0,n=0;n<16;n++)for(Vl[n]=i,r=0;r<1<<Gl[n];r++)Hc[i++]=n;for(i>>=7;n<Is;n++)for(Vl[n]=i<<7,r=0;r<1<<Gl[n]-7;r++)Hc[256+i++]=n;for(e=0;e<=Da;e++)o[e]=0;for(r=0;r<=143;)go[r*2+1]=8,r++,o[8]++;for(;r<=255;)go[r*2+1]=9,r++,o[9]++;for(;r<=279;)go[r*2+1]=7,r++,o[7]++;for(;r<=287;)go[r*2+1]=8,r++,o[8]++;for(zh(go,Bc+1,o),r=0;r<Is;r++)Uc[r*2+1]=5,Uc[r*2]=qh(r,5);Bh=new gd(go,fd,$c+1,Bc,Da),Uh=new gd(Uc,Gl,0,Is,Da),Hh=new gd(new Array(0),bg,0,ud,wg)},"tr_static_init"),Wh=s(r=>{let e;for(e=0;e<Bc;e++)r.dyn_ltree[e*2]=0;for(e=0;e<Is;e++)r.dyn_dtree[e*2]=0;for(e=0;e<ud;e++)r.bl_tree[e*2]=0;r.dyn_ltree[hd*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0},"init_block"),Gh=s(r=>{r.bi_valid>8?qc(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},"bi_windup"),Tg=s((r,e,t,n)=>{Gh(r),n&&(qc(r,t),qc(r,~t)),r.pending_buf.set(r.window.subarray(e,e+t),r.pending),r.pending+=t},"copy_block"),Vh=s((r,e,t,n)=>{const i=e*2,o=t*2;return r[i]<r[o]||r[i]===r[o]&&n[e]<=n[t]},"smaller"),vd=s((r,e,t)=>{const n=r.heap[t];let i=t<<1;for(;i<=r.heap_len&&(i<r.heap_len&&Vh(e,r.heap[i+1],r.heap[i],r.depth)&&i++,!Vh(e,n,r.heap[i],r.depth));)r.heap[t]=r.heap[i],t=i,i<<=1;r.heap[t]=n},"pqdownheap"),Kh=s((r,e,t)=>{let n,i,o=0,a,l;if(r.last_lit!==0)do n=r.pending_buf[r.d_buf+o*2]<<8|r.pending_buf[r.d_buf+o*2+1],i=r.pending_buf[r.l_buf+o],o++,n===0?Qi(r,i,e):(a=jc[i],Qi(r,a+$c+1,e),l=fd[a],l!==0&&(i-=pd[a],qn(r,i,l)),n--,a=jh(n),Qi(r,a,t),l=Gl[a],l!==0&&(n-=Vl[a],qn(r,n,l)));while(o<r.last_lit);Qi(r,hd,e)},"compress_block"),yd=s((r,e)=>{const t=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let a,l,u=-1,d;for(r.heap_len=0,r.heap_max=Nh,a=0;a<o;a++)t[a*2]!==0?(r.heap[++r.heap_len]=u=a,r.depth[a]=0):t[a*2+1]=0;for(;r.heap_len<2;)d=r.heap[++r.heap_len]=u<2?++u:0,t[d*2]=1,r.depth[d]=0,r.opt_len--,i&&(r.static_len-=n[d*2+1]);for(e.max_code=u,a=r.heap_len>>1;a>=1;a--)vd(r,t,a);d=o;do a=r.heap[1],r.heap[1]=r.heap[r.heap_len--],vd(r,t,1),l=r.heap[1],r.heap[--r.heap_max]=a,r.heap[--r.heap_max]=l,t[d*2]=t[a*2]+t[l*2],r.depth[d]=(r.depth[a]>=r.depth[l]?r.depth[a]:r.depth[l])+1,t[a*2+1]=t[l*2+1]=d,r.heap[1]=d++,vd(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],Cg(r,e),zh(t,u,r.bl_count)},"build_tree"),Qh=s((r,e,t)=>{let n,i=-1,o,a=e[0*2+1],l=0,u=7,d=4;for(a===0&&(u=138,d=3),e[(t+1)*2+1]=65535,n=0;n<=t;n++)o=a,a=e[(n+1)*2+1],!(++l<u&&o===a)&&(l<d?r.bl_tree[o*2]+=l:o!==0?(o!==i&&r.bl_tree[o*2]++,r.bl_tree[Mh*2]++):l<=10?r.bl_tree[Fh*2]++:r.bl_tree[Lh*2]++,l=0,i=o,a===0?(u=138,d=3):o===a?(u=6,d=3):(u=7,d=4))},"scan_tree"),Xh=s((r,e,t)=>{let n,i=-1,o,a=e[0*2+1],l=0,u=7,d=4;for(a===0&&(u=138,d=3),n=0;n<=t;n++)if(o=a,a=e[(n+1)*2+1],!(++l<u&&o===a)){if(l<d)do Qi(r,o,r.bl_tree);while(--l!=0);else o!==0?(o!==i&&(Qi(r,o,r.bl_tree),l--),Qi(r,Mh,r.bl_tree),qn(r,l-3,2)):l<=10?(Qi(r,Fh,r.bl_tree),qn(r,l-3,3)):(Qi(r,Lh,r.bl_tree),qn(r,l-11,7));l=0,i=o,a===0?(u=138,d=3):o===a?(u=6,d=3):(u=7,d=4)}},"send_tree"),Ag=s(r=>{let e;for(Qh(r,r.dyn_ltree,r.l_desc.max_code),Qh(r,r.dyn_dtree,r.d_desc.max_code),yd(r,r.bl_desc),e=ud-1;e>=3&&r.bl_tree[$h[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),Rg=s((r,e,t,n)=>{let i;for(qn(r,e-257,5),qn(r,t-1,5),qn(r,n-4,4),i=0;i<n;i++)qn(r,r.bl_tree[$h[i]*2+1],3);Xh(r,r.dyn_ltree,e-1),Xh(r,r.dyn_dtree,t-1)},"send_all_trees"),Ig=s(r=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return Ph;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return Oh;for(t=32;t<$c;t++)if(r.dyn_ltree[t*2]!==0)return Oh;return Ph},"detect_data_type");let Yh=!1;const Dg=s(r=>{Yh||(xg(),Yh=!0),r.l_desc=new md(r.dyn_ltree,Bh),r.d_desc=new md(r.dyn_dtree,Uh),r.bl_desc=new md(r.bl_tree,Hh),r.bi_buf=0,r.bi_valid=0,Wh(r)},"_tr_init$1"),Zh=s((r,e,t,n)=>{qn(r,(mg<<1)+(n?1:0),3),Tg(r,e,t,!0)},"_tr_stored_block$1"),Pg=s(r=>{qn(r,kh<<1,3),Qi(r,hd,go),Sg(r)},"_tr_align$1"),Og=s((r,e,t,n)=>{let i,o,a=0;r.level>0?(r.strm.data_type===gg&&(r.strm.data_type=Ig(r)),yd(r,r.l_desc),yd(r,r.d_desc),a=Ag(r),i=r.opt_len+3+7>>>3,o=r.static_len+3+7>>>3,o<=i&&(i=o)):i=o=t+5,t+4<=i&&e!==-1?Zh(r,e,t,n):r.strategy===pg||o===i?(qn(r,(kh<<1)+(n?1:0),3),Kh(r,go,Uc)):(qn(r,(vg<<1)+(n?1:0),3),Rg(r,r.l_desc.max_code+1,r.d_desc.max_code+1,a+1),Kh(r,r.dyn_ltree,r.dyn_dtree)),Wh(r),n&&Gh(r)},"_tr_flush_block$1"),kg=s((r,e,t)=>(r.pending_buf[r.d_buf+r.last_lit*2]=e>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=e&255,r.pending_buf[r.l_buf+r.last_lit]=t&255,r.last_lit++,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(jc[t]+$c+1)*2]++,r.dyn_dtree[jh(e)*2]++),r.last_lit===r.lit_bufsize-1),"_tr_tally$1");var Ng=Dg,Mg=Zh,Fg=Og,Lg=kg,$g=Pg,Bg={_tr_init:Ng,_tr_stored_block:Mg,_tr_flush_block:Fg,_tr_tally:Lg,_tr_align:$g},zc=s((r,e,t,n)=>{let i=r&65535|0,o=r>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do i=i+e[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0},"adler32");const Ug=s(()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},"makeTable"),Hg=new Uint32Array(Ug());var an=s((r,e,t,n)=>{const i=Hg,o=n+t;r^=-1;for(let a=n;a<o;a++)r=r>>>8^i[(r^e[a])&255];return r^-1},"crc32"),Pa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Oa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:jg,_tr_stored_block:qg,_tr_flush_block:zg,_tr_tally:Wo,_tr_align:Wg}=Bg,{Z_NO_FLUSH:ka,Z_PARTIAL_FLUSH:Gg,Z_FULL_FLUSH:Vg,Z_FINISH:Go,Z_BLOCK:Jh,Z_OK:Xi,Z_STREAM_END:ef,Z_STREAM_ERROR:ui,Z_DATA_ERROR:Kg,Z_BUF_ERROR:_d,Z_DEFAULT_COMPRESSION:Qg,Z_FILTERED:Xg,Z_HUFFMAN_ONLY:Kl,Z_RLE:Yg,Z_FIXED:Zg,Z_DEFAULT_STRATEGY:Jg,Z_UNKNOWN:em,Z_DEFLATED:Ql}=Oa,tm=9,rm=15,nm=8,im=29,wd=256+1+im,om=30,am=19,sm=2*wd+1,cm=15,nr=3,Vo=258,xi=Vo+nr+1,lm=32,Xl=42,bd=69,Yl=73,Zl=91,Jl=103,Na=113,Wc=666,Yr=1,Gc=2,Ma=3,Ds=4,um=3,Ko=s((r,e)=>(r.msg=Pa[e],e),"err"),tf=s(r=>(r<<1)-(r>4?9:0),"rank"),Qo=s(r=>{let e=r.length;for(;--e>=0;)r[e]=0},"zero");let Xo=s((r,e,t)=>(e<<r.hash_shift^t)&r.hash_mask,"HASH_ZLIB");const Yo=s(r=>{const e=r.state;let t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(r.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},"flush_pending"),dn=s((r,e)=>{zg(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Yo(r.strm)},"flush_block_only"),sr=s((r,e)=>{r.pending_buf[r.pending++]=e},"put_byte"),Vc=s((r,e)=>{r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255},"putShortMSB"),dm=s((r,e,t,n)=>{let i=r.avail_in;return i>n&&(i=n),i===0?0:(r.avail_in-=i,e.set(r.input.subarray(r.next_in,r.next_in+i),t),r.state.wrap===1?r.adler=zc(r.adler,e,i,t):r.state.wrap===2&&(r.adler=an(r.adler,e,i,t)),r.next_in+=i,r.total_in+=i,i)},"read_buf"),rf=s((r,e)=>{let t=r.max_chain_length,n=r.strstart,i,o,a=r.prev_length,l=r.nice_match;const u=r.strstart>r.w_size-xi?r.strstart-(r.w_size-xi):0,d=r.window,_=r.w_mask,R=r.prev,A=r.strstart+Vo;let P=d[n+a-1],M=d[n+a];r.prev_length>=r.good_match&&(t>>=2),l>r.lookahead&&(l=r.lookahead);do if(i=e,!(d[i+a]!==M||d[i+a-1]!==P||d[i]!==d[n]||d[++i]!==d[n+1])){n+=2,i++;do;while(d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&d[++n]===d[++i]&&n<A);if(o=Vo-(A-n),n=A-Vo,o>a){if(r.match_start=e,a=o,o>=l)break;P=d[n+a-1],M=d[n+a]}}while((e=R[e&_])>u&&--t!=0);return a<=r.lookahead?a:r.lookahead},"longest_match"),Fa=s(r=>{const e=r.w_size;let t,n,i,o,a;do{if(o=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-xi)){r.window.set(r.window.subarray(e,e+e),0),r.match_start-=e,r.strstart-=e,r.block_start-=e,n=r.hash_size,t=n;do i=r.head[--t],r.head[t]=i>=e?i-e:0;while(--n);n=e,t=n;do i=r.prev[--t],r.prev[t]=i>=e?i-e:0;while(--n);o+=e}if(r.strm.avail_in===0)break;if(n=dm(r.strm,r.window,r.strstart+r.lookahead,o),r.lookahead+=n,r.lookahead+r.insert>=nr)for(a=r.strstart-r.insert,r.ins_h=r.window[a],r.ins_h=Xo(r,r.ins_h,r.window[a+1]);r.insert&&(r.ins_h=Xo(r,r.ins_h,r.window[a+nr-1]),r.prev[a&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=a,a++,r.insert--,!(r.lookahead+r.insert<nr)););}while(r.lookahead<xi&&r.strm.avail_in!==0)},"fill_window"),hm=s((r,e)=>{let t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(Fa(r),r.lookahead===0&&e===ka)return Yr;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;const n=r.block_start+t;if((r.strstart===0||r.strstart>=n)&&(r.lookahead=r.strstart-n,r.strstart=n,dn(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-xi&&(dn(r,!1),r.strm.avail_out===0))return Yr}return r.insert=0,e===Go?(dn(r,!0),r.strm.avail_out===0?Ma:Ds):(r.strstart>r.block_start&&(dn(r,!1),r.strm.avail_out===0),Yr)},"deflate_stored"),Ed=s((r,e)=>{let t,n;for(;;){if(r.lookahead<xi){if(Fa(r),r.lookahead<xi&&e===ka)return Yr;if(r.lookahead===0)break}if(t=0,r.lookahead>=nr&&(r.ins_h=Xo(r,r.ins_h,r.window[r.strstart+nr-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-xi&&(r.match_length=rf(r,t)),r.match_length>=nr)if(n=Wo(r,r.strstart-r.match_start,r.match_length-nr),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=nr){r.match_length--;do r.strstart++,r.ins_h=Xo(r,r.ins_h,r.window[r.strstart+nr-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Xo(r,r.ins_h,r.window[r.strstart+1]);else n=Wo(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(n&&(dn(r,!1),r.strm.avail_out===0))return Yr}return r.insert=r.strstart<nr-1?r.strstart:nr-1,e===Go?(dn(r,!0),r.strm.avail_out===0?Ma:Ds):r.last_lit&&(dn(r,!1),r.strm.avail_out===0)?Yr:Gc},"deflate_fast"),Ps=s((r,e)=>{let t,n,i;for(;;){if(r.lookahead<xi){if(Fa(r),r.lookahead<xi&&e===ka)return Yr;if(r.lookahead===0)break}if(t=0,r.lookahead>=nr&&(r.ins_h=Xo(r,r.ins_h,r.window[r.strstart+nr-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=nr-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-xi&&(r.match_length=rf(r,t),r.match_length<=5&&(r.strategy===Xg||r.match_length===nr&&r.strstart-r.match_start>4096)&&(r.match_length=nr-1)),r.prev_length>=nr&&r.match_length<=r.prev_length){i=r.strstart+r.lookahead-nr,n=Wo(r,r.strstart-1-r.prev_match,r.prev_length-nr),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=i&&(r.ins_h=Xo(r,r.ins_h,r.window[r.strstart+nr-1]),t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=nr-1,r.strstart++,n&&(dn(r,!1),r.strm.avail_out===0))return Yr}else if(r.match_available){if(n=Wo(r,0,r.window[r.strstart-1]),n&&dn(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return Yr}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(n=Wo(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<nr-1?r.strstart:nr-1,e===Go?(dn(r,!0),r.strm.avail_out===0?Ma:Ds):r.last_lit&&(dn(r,!1),r.strm.avail_out===0)?Yr:Gc},"deflate_slow"),fm=s((r,e)=>{let t,n,i,o;const a=r.window;for(;;){if(r.lookahead<=Vo){if(Fa(r),r.lookahead<=Vo&&e===ka)return Yr;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=nr&&r.strstart>0&&(i=r.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=r.strstart+Vo;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);r.match_length=Vo-(o-i),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=nr?(t=Wo(r,1,r.match_length-nr),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=Wo(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(dn(r,!1),r.strm.avail_out===0))return Yr}return r.insert=0,e===Go?(dn(r,!0),r.strm.avail_out===0?Ma:Ds):r.last_lit&&(dn(r,!1),r.strm.avail_out===0)?Yr:Gc},"deflate_rle"),pm=s((r,e)=>{let t;for(;;){if(r.lookahead===0&&(Fa(r),r.lookahead===0)){if(e===ka)return Yr;break}if(r.match_length=0,t=Wo(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(dn(r,!1),r.strm.avail_out===0))return Yr}return r.insert=0,e===Go?(dn(r,!0),r.strm.avail_out===0?Ma:Ds):r.last_lit&&(dn(r,!1),r.strm.avail_out===0)?Yr:Gc},"deflate_huff");function Yi(r,e,t,n,i){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=n,this.func=i}s(Yi,"Config");const Kc=[new Yi(0,0,0,0,hm),new Yi(4,4,8,4,Ed),new Yi(4,5,16,8,Ed),new Yi(4,6,32,32,Ed),new Yi(4,4,16,16,Ps),new Yi(8,16,32,32,Ps),new Yi(8,16,128,128,Ps),new Yi(8,32,128,256,Ps),new Yi(32,128,258,1024,Ps),new Yi(32,258,258,4096,Ps)],gm=s(r=>{r.window_size=2*r.w_size,Qo(r.head),r.max_lazy_match=Kc[r.level].max_lazy,r.good_match=Kc[r.level].good_length,r.nice_match=Kc[r.level].nice_length,r.max_chain_length=Kc[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=nr-1,r.match_available=0,r.ins_h=0},"lm_init");function mm(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ql,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(sm*2),this.dyn_dtree=new Uint16Array((2*om+1)*2),this.bl_tree=new Uint16Array((2*am+1)*2),Qo(this.dyn_ltree),Qo(this.dyn_dtree),Qo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(cm+1),this.heap=new Uint16Array(2*wd+1),Qo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*wd+1),Qo(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}s(mm,"DeflateState");const nf=s(r=>{if(!r||!r.state)return Ko(r,ui);r.total_in=r.total_out=0,r.data_type=em;const e=r.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Xl:Na,r.adler=e.wrap===2?0:1,e.last_flush=ka,jg(e),Xi},"deflateResetKeep"),of=s(r=>{const e=nf(r);return e===Xi&&gm(r.state),e},"deflateReset"),vm=s((r,e)=>!r||!r.state||r.state.wrap!==2?ui:(r.state.gzhead=e,Xi),"deflateSetHeader"),af=s((r,e,t,n,i,o)=>{if(!r)return ui;let a=1;if(e===Qg&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>tm||t!==Ql||n<8||n>15||e<0||e>9||o<0||o>Zg)return Ko(r,ui);n===8&&(n=9);const l=new mm;return r.state=l,l.strm=r,l.wrap=a,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+nr-1)/nr),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=(1+2)*l.lit_bufsize,l.level=e,l.strategy=o,l.method=t,of(r)},"deflateInit2"),ym=s((r,e)=>af(r,e,Ql,rm,nm,Jg),"deflateInit"),_m=s((r,e)=>{let t,n;if(!r||!r.state||e>Jh||e<0)return r?Ko(r,ui):ui;const i=r.state;if(!r.output||!r.input&&r.avail_in!==0||i.status===Wc&&e!==Go)return Ko(r,r.avail_out===0?_d:ui);i.strm=r;const o=i.last_flush;if(i.last_flush=e,i.status===Xl)if(i.wrap===2)r.adler=0,sr(i,31),sr(i,139),sr(i,8),i.gzhead?(sr(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),sr(i,i.gzhead.time&255),sr(i,i.gzhead.time>>8&255),sr(i,i.gzhead.time>>16&255),sr(i,i.gzhead.time>>24&255),sr(i,i.level===9?2:i.strategy>=Kl||i.level<2?4:0),sr(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(sr(i,i.gzhead.extra.length&255),sr(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(r.adler=an(r.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=bd):(sr(i,0),sr(i,0),sr(i,0),sr(i,0),sr(i,0),sr(i,i.level===9?2:i.strategy>=Kl||i.level<2?4:0),sr(i,um),i.status=Na);else{let a=Ql+(i.w_bits-8<<4)<<8,l=-1;i.strategy>=Kl||i.level<2?l=0:i.level<6?l=1:i.level===6?l=2:l=3,a|=l<<6,i.strstart!==0&&(a|=lm),a+=31-a%31,i.status=Na,Vc(i,a),i.strstart!==0&&(Vc(i,r.adler>>>16),Vc(i,r.adler&65535)),r.adler=1}if(i.status===bd)if(i.gzhead.extra){for(t=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),Yo(r),t=i.pending,i.pending===i.pending_buf_size));)sr(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Yl)}else i.status=Yl;if(i.status===Yl)if(i.gzhead.name){t=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),Yo(r),t=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,sr(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),n===0&&(i.gzindex=0,i.status=Zl)}else i.status=Zl;if(i.status===Zl)if(i.gzhead.comment){t=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),Yo(r),t=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,sr(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>t&&(r.adler=an(r.adler,i.pending_buf,i.pending-t,t)),n===0&&(i.status=Jl)}else i.status=Jl;if(i.status===Jl&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Yo(r),i.pending+2<=i.pending_buf_size&&(sr(i,r.adler&255),sr(i,r.adler>>8&255),r.adler=0,i.status=Na)):i.status=Na),i.pending!==0){if(Yo(r),r.avail_out===0)return i.last_flush=-1,Xi}else if(r.avail_in===0&&tf(e)<=tf(o)&&e!==Go)return Ko(r,_d);if(i.status===Wc&&r.avail_in!==0)return Ko(r,_d);if(r.avail_in!==0||i.lookahead!==0||e!==ka&&i.status!==Wc){let a=i.strategy===Kl?pm(i,e):i.strategy===Yg?fm(i,e):Kc[i.level].func(i,e);if((a===Ma||a===Ds)&&(i.status=Wc),a===Yr||a===Ma)return r.avail_out===0&&(i.last_flush=-1),Xi;if(a===Gc&&(e===Gg?Wg(i):e!==Jh&&(qg(i,0,0,!1),e===Vg&&(Qo(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Yo(r),r.avail_out===0))return i.last_flush=-1,Xi}return e!==Go?Xi:i.wrap<=0?ef:(i.wrap===2?(sr(i,r.adler&255),sr(i,r.adler>>8&255),sr(i,r.adler>>16&255),sr(i,r.adler>>24&255),sr(i,r.total_in&255),sr(i,r.total_in>>8&255),sr(i,r.total_in>>16&255),sr(i,r.total_in>>24&255)):(Vc(i,r.adler>>>16),Vc(i,r.adler&65535)),Yo(r),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Xi:ef)},"deflate$2"),wm=s(r=>{if(!r||!r.state)return ui;const e=r.state.status;return e!==Xl&&e!==bd&&e!==Yl&&e!==Zl&&e!==Jl&&e!==Na&&e!==Wc?Ko(r,ui):(r.state=null,e===Na?Ko(r,Kg):Xi)},"deflateEnd"),bm=s((r,e)=>{let t=e.length;if(!r||!r.state)return ui;const n=r.state,i=n.wrap;if(i===2||i===1&&n.status!==Xl||n.lookahead)return ui;if(i===1&&(r.adler=zc(r.adler,e,t,0)),n.wrap=0,t>=n.w_size){i===0&&(Qo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let u=new Uint8Array(n.w_size);u.set(e.subarray(t-n.w_size,t),0),e=u,t=n.w_size}const o=r.avail_in,a=r.next_in,l=r.input;for(r.avail_in=t,r.next_in=0,r.input=e,Fa(n);n.lookahead>=nr;){let u=n.strstart,d=n.lookahead-(nr-1);do n.ins_h=Xo(n,n.ins_h,n.window[u+nr-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++;while(--d);n.strstart=u,n.lookahead=nr-1,Fa(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=nr-1,n.match_available=0,r.next_in=a,r.input=l,r.avail_in=o,n.wrap=i,Xi},"deflateSetDictionary");var Em=ym,Sm=af,Cm=of,xm=nf,Tm=vm,Am=_m,Rm=wm,Im=bm,Dm="pako deflate (from Nodeca project)",Qc={deflateInit:Em,deflateInit2:Sm,deflateReset:Cm,deflateResetKeep:xm,deflateSetHeader:Tm,deflate:Am,deflateEnd:Rm,deflateSetDictionary:Im,deflateInfo:Dm};const Pm=s((r,e)=>Object.prototype.hasOwnProperty.call(r,e),"_has");var Om=s(function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)Pm(t,n)&&(r[n]=t[n])}}return r},"pako_esm_assign"),km=s(r=>{let e=0;for(let n=0,i=r.length;n<i;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,i=0,o=r.length;n<o;n++){let a=r[n];t.set(a,i),i+=a.length}return t},"flattenChunks"),eu={assign:Om,flattenChunks:km};let sf=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){sf=!1}const Xc=new Uint8Array(256);for(let r=0;r<256;r++)Xc[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;Xc[254]=Xc[254]=1;var Nm=s(r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,n,i,o,a=r.length,l=0;for(i=0;i<a;i++)t=r.charCodeAt(i),(t&64512)==55296&&i+1<a&&(n=r.charCodeAt(i+1),(n&64512)==56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),l+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(l),o=0,i=0;o<l;i++)t=r.charCodeAt(i),(t&64512)==55296&&i+1<a&&(n=r.charCodeAt(i+1),(n&64512)==56320&&(t=65536+(t-55296<<10)+(n-56320),i++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e},"string2buf");const Mm=s((r,e)=>{if(e<65534&&r.subarray&&sf)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t},"buf2binstring");var Fm=s((r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let n,i;const o=new Array(t*2);for(i=0,n=0;n<t;){let a=r[n++];if(a<128){o[i++]=a;continue}let l=Xc[a];if(l>4){o[i++]=65533,n+=l-1;continue}for(a&=l===2?31:l===3?15:7;l>1&&n<t;)a=a<<6|r[n++]&63,l--;if(l>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return Mm(o,i)},"buf2string"),Lm=s((r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)==128;)t--;return t<0||t===0?e:t+Xc[r[t]]>e?t:e},"utf8border"),Yc={string2buf:Nm,buf2string:Fm,utf8border:Lm};function $m(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}s($m,"ZStream");var cf=$m;const lf=Object.prototype.toString,{Z_NO_FLUSH:Bm,Z_SYNC_FLUSH:Um,Z_FULL_FLUSH:Hm,Z_FINISH:jm,Z_OK:tu,Z_STREAM_END:qm,Z_DEFAULT_COMPRESSION:zm,Z_DEFAULT_STRATEGY:Wm,Z_DEFLATED:Gm}=Oa;function Zc(r){this.options=eu.assign({level:zm,method:Gm,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wm},r||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cf,this.strm.avail_out=0;let t=Qc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==tu)throw new Error(Pa[t]);if(e.header&&Qc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=Yc.string2buf(e.dictionary):lf.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,t=Qc.deflateSetDictionary(this.strm,n),t!==tu)throw new Error(Pa[t]);this._dict_set=!0}}s(Zc,"Deflate$1"),Zc.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?jm:Bm,typeof r=="string"?t.input=Yc.string2buf(r):lf.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(o===Um||o===Hm)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(i=Qc.deflate(t,o),i===qm)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),i=Qc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===tu;if(t.avail_out===0){this.onData(t.output);continue}if(o>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0},Zc.prototype.onData=function(r){this.chunks.push(r)},Zc.prototype.onEnd=function(r){r===tu&&(this.result=eu.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Sd(r,e){const t=new Zc(e);if(t.push(r,!0),t.err)throw t.msg||Pa[t.err];return t.result}s(Sd,"deflate$1");function Vm(r,e){return e=e||{},e.raw=!0,Sd(r,e)}s(Vm,"deflateRaw$1");function Km(r,e){return e=e||{},e.gzip=!0,Sd(r,e)}s(Km,"gzip$1");var Qm=Zc,Xm=Sd,Ym=Vm,Zm=Km,Jm=Oa,ev={Deflate:Qm,deflate:Xm,deflateRaw:Ym,gzip:Zm,constants:Jm};const ru=30,tv=12;var rv=s(function(e,t){let n,i,o,a,l,u,d,_,R,A,P,M,k,B,U,H,re,Y,he,De,Ie,Ae,Ye,Pe;const qe=e.state;n=e.next_in,Ye=e.input,i=n+(e.avail_in-5),o=e.next_out,Pe=e.output,a=o-(t-e.avail_out),l=o+(e.avail_out-257),u=qe.dmax,d=qe.wsize,_=qe.whave,R=qe.wnext,A=qe.window,P=qe.hold,M=qe.bits,k=qe.lencode,B=qe.distcode,U=(1<<qe.lenbits)-1,H=(1<<qe.distbits)-1;e:do{M<15&&(P+=Ye[n++]<<M,M+=8,P+=Ye[n++]<<M,M+=8),re=k[P&U];t:for(;;){if(Y=re>>>24,P>>>=Y,M-=Y,Y=re>>>16&255,Y===0)Pe[o++]=re&65535;else if(Y&16){he=re&65535,Y&=15,Y&&(M<Y&&(P+=Ye[n++]<<M,M+=8),he+=P&(1<<Y)-1,P>>>=Y,M-=Y),M<15&&(P+=Ye[n++]<<M,M+=8,P+=Ye[n++]<<M,M+=8),re=B[P&H];r:for(;;){if(Y=re>>>24,P>>>=Y,M-=Y,Y=re>>>16&255,Y&16){if(De=re&65535,Y&=15,M<Y&&(P+=Ye[n++]<<M,M+=8,M<Y&&(P+=Ye[n++]<<M,M+=8)),De+=P&(1<<Y)-1,De>u){e.msg="invalid distance too far back",qe.mode=ru;break e}if(P>>>=Y,M-=Y,Y=o-a,De>Y){if(Y=De-Y,Y>_&&qe.sane){e.msg="invalid distance too far back",qe.mode=ru;break e}if(Ie=0,Ae=A,R===0){if(Ie+=d-Y,Y<he){he-=Y;do Pe[o++]=A[Ie++];while(--Y);Ie=o-De,Ae=Pe}}else if(R<Y){if(Ie+=d+R-Y,Y-=R,Y<he){he-=Y;do Pe[o++]=A[Ie++];while(--Y);if(Ie=0,R<he){Y=R,he-=Y;do Pe[o++]=A[Ie++];while(--Y);Ie=o-De,Ae=Pe}}}else if(Ie+=R-Y,Y<he){he-=Y;do Pe[o++]=A[Ie++];while(--Y);Ie=o-De,Ae=Pe}for(;he>2;)Pe[o++]=Ae[Ie++],Pe[o++]=Ae[Ie++],Pe[o++]=Ae[Ie++],he-=3;he&&(Pe[o++]=Ae[Ie++],he>1&&(Pe[o++]=Ae[Ie++]))}else{Ie=o-De;do Pe[o++]=Pe[Ie++],Pe[o++]=Pe[Ie++],Pe[o++]=Pe[Ie++],he-=3;while(he>2);he&&(Pe[o++]=Pe[Ie++],he>1&&(Pe[o++]=Pe[Ie++]))}}else if((Y&64)==0){re=B[(re&65535)+(P&(1<<Y)-1)];continue r}else{e.msg="invalid distance code",qe.mode=ru;break e}break}}else if((Y&64)==0){re=k[(re&65535)+(P&(1<<Y)-1)];continue t}else if(Y&32){qe.mode=tv;break e}else{e.msg="invalid literal/length code",qe.mode=ru;break e}break}}while(n<i&&o<l);he=M>>3,n-=he,M-=he<<3,P&=(1<<M)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<l?257+(l-o):257-(o-l),qe.hold=P,qe.bits=M},"inflate_fast");const Os=15,uf=852,df=592,hf=0,Cd=1,ff=2,nv=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),iv=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ov=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),av=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Jc=s((r,e,t,n,i,o,a,l)=>{const u=l.bits;let d=0,_=0,R=0,A=0,P=0,M=0,k=0,B=0,U=0,H=0,re,Y,he,De,Ie,Ae=null,Ye=0,Pe;const qe=new Uint16Array(Os+1),rt=new Uint16Array(Os+1);let Nt=null,cn=0,Wn,Xn,Ai;for(d=0;d<=Os;d++)qe[d]=0;for(_=0;_<n;_++)qe[e[t+_]]++;for(P=u,A=Os;A>=1&&qe[A]===0;A--);if(P>A&&(P=A),A===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,l.bits=1,0;for(R=1;R<A&&qe[R]===0;R++);for(P<R&&(P=R),B=1,d=1;d<=Os;d++)if(B<<=1,B-=qe[d],B<0)return-1;if(B>0&&(r===hf||A!==1))return-1;for(rt[1]=0,d=1;d<Os;d++)rt[d+1]=rt[d]+qe[d];for(_=0;_<n;_++)e[t+_]!==0&&(a[rt[e[t+_]]++]=_);if(r===hf?(Ae=Nt=a,Pe=19):r===Cd?(Ae=nv,Ye-=257,Nt=iv,cn-=257,Pe=256):(Ae=ov,Nt=av,Pe=-1),H=0,_=0,d=R,Ie=o,M=P,k=0,he=-1,U=1<<P,De=U-1,r===Cd&&U>uf||r===ff&&U>df)return 1;for(;;){Wn=d-k,a[_]<Pe?(Xn=0,Ai=a[_]):a[_]>Pe?(Xn=Nt[cn+a[_]],Ai=Ae[Ye+a[_]]):(Xn=32+64,Ai=0),re=1<<d-k,Y=1<<M,R=Y;do Y-=re,i[Ie+(H>>k)+Y]=Wn<<24|Xn<<16|Ai|0;while(Y!==0);for(re=1<<d-1;H&re;)re>>=1;if(re!==0?(H&=re-1,H+=re):H=0,_++,--qe[d]==0){if(d===A)break;d=e[t+a[_]]}if(d>P&&(H&De)!==he){for(k===0&&(k=P),Ie+=R,M=d-k,B=1<<M;M+k<A&&(B-=qe[M+k],!(B<=0));)M++,B<<=1;if(U+=1<<M,r===Cd&&U>uf||r===ff&&U>df)return 1;he=H&De,i[he]=P<<24|M<<16|Ie-o|0}}return H!==0&&(i[Ie+H]=d-k<<24|64<<16|0),l.bits=P,0},"inflate_table");const sv=0,pf=1,gf=2,{Z_FINISH:mf,Z_BLOCK:cv,Z_TREES:nu,Z_OK:La,Z_STREAM_END:lv,Z_NEED_DICT:uv,Z_STREAM_ERROR:di,Z_DATA_ERROR:vf,Z_MEM_ERROR:yf,Z_BUF_ERROR:dv,Z_DEFLATED:_f}=Oa,wf=1,bf=2,Ef=3,Sf=4,Cf=5,xf=6,Tf=7,Af=8,Rf=9,If=10,iu=11,mo=12,xd=13,Df=14,Td=15,Pf=16,Of=17,kf=18,Nf=19,ou=20,au=21,Mf=22,Ff=23,Lf=24,$f=25,Bf=26,Ad=27,Uf=28,Hf=29,Rr=30,jf=31,hv=32,fv=852,pv=592,gv=15,qf=s(r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24),"zswap32");function mv(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}s(mv,"InflateState");const zf=s(r=>{if(!r||!r.state)return di;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=wf,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(fv),e.distcode=e.distdyn=new Int32Array(pv),e.sane=1,e.back=-1,La},"inflateResetKeep"),Wf=s(r=>{if(!r||!r.state)return di;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,zf(r)},"inflateReset"),Gf=s((r,e)=>{let t;if(!r||!r.state)return di;const n=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?di:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,Wf(r))},"inflateReset2"),Vf=s((r,e)=>{if(!r)return di;const t=new mv;r.state=t,t.window=null;const n=Gf(r,e);return n!==La&&(r.state=null),n},"inflateInit2"),vv=s(r=>Vf(r,gv),"inflateInit");let Kf=!0,Rd,Id;const yv=s(r=>{if(Kf){Rd=new Int32Array(512),Id=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(Jc(pf,r.lens,0,288,Rd,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;Jc(gf,r.lens,0,32,Id,0,r.work,{bits:5}),Kf=!1}r.lencode=Rd,r.lenbits=9,r.distcode=Id,r.distbits=5},"fixedtables"),Qf=s((r,e,t,n)=>{let i;const o=r.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(t-n,t-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(t-n,t),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),_v=s((r,e)=>{let t,n,i,o,a,l,u,d,_,R,A,P,M,k,B=0,U,H,re,Y,he,De,Ie,Ae;const Ye=new Uint8Array(4);let Pe,qe;const rt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return di;t=r.state,t.mode===mo&&(t.mode=xd),a=r.next_out,i=r.output,u=r.avail_out,o=r.next_in,n=r.input,l=r.avail_in,d=t.hold,_=t.bits,R=l,A=u,Ae=La;e:for(;;)switch(t.mode){case wf:if(t.wrap===0){t.mode=xd;break}for(;_<16;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(t.wrap&2&&d===35615){t.check=0,Ye[0]=d&255,Ye[1]=d>>>8&255,t.check=an(t.check,Ye,2,0),d=0,_=0,t.mode=bf;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((d&255)<<8)+(d>>8))%31){r.msg="incorrect header check",t.mode=Rr;break}if((d&15)!==_f){r.msg="unknown compression method",t.mode=Rr;break}if(d>>>=4,_-=4,Ie=(d&15)+8,t.wbits===0)t.wbits=Ie;else if(Ie>t.wbits){r.msg="invalid window size",t.mode=Rr;break}t.dmax=1<<t.wbits,r.adler=t.check=1,t.mode=d&512?If:mo,d=0,_=0;break;case bf:for(;_<16;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(t.flags=d,(t.flags&255)!==_f){r.msg="unknown compression method",t.mode=Rr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=Rr;break}t.head&&(t.head.text=d>>8&1),t.flags&512&&(Ye[0]=d&255,Ye[1]=d>>>8&255,t.check=an(t.check,Ye,2,0)),d=0,_=0,t.mode=Ef;case Ef:for(;_<32;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.head&&(t.head.time=d),t.flags&512&&(Ye[0]=d&255,Ye[1]=d>>>8&255,Ye[2]=d>>>16&255,Ye[3]=d>>>24&255,t.check=an(t.check,Ye,4,0)),d=0,_=0,t.mode=Sf;case Sf:for(;_<16;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.head&&(t.head.xflags=d&255,t.head.os=d>>8),t.flags&512&&(Ye[0]=d&255,Ye[1]=d>>>8&255,t.check=an(t.check,Ye,2,0)),d=0,_=0,t.mode=Cf;case Cf:if(t.flags&1024){for(;_<16;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.length=d,t.head&&(t.head.extra_len=d),t.flags&512&&(Ye[0]=d&255,Ye[1]=d>>>8&255,t.check=an(t.check,Ye,2,0)),d=0,_=0}else t.head&&(t.head.extra=null);t.mode=xf;case xf:if(t.flags&1024&&(P=t.length,P>l&&(P=l),P&&(t.head&&(Ie=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(o,o+P),Ie)),t.flags&512&&(t.check=an(t.check,n,P,o)),l-=P,o+=P,t.length-=P),t.length))break e;t.length=0,t.mode=Tf;case Tf:if(t.flags&2048){if(l===0)break e;P=0;do Ie=n[o+P++],t.head&&Ie&&t.length<65536&&(t.head.name+=String.fromCharCode(Ie));while(Ie&&P<l);if(t.flags&512&&(t.check=an(t.check,n,P,o)),l-=P,o+=P,Ie)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Af;case Af:if(t.flags&4096){if(l===0)break e;P=0;do Ie=n[o+P++],t.head&&Ie&&t.length<65536&&(t.head.comment+=String.fromCharCode(Ie));while(Ie&&P<l);if(t.flags&512&&(t.check=an(t.check,n,P,o)),l-=P,o+=P,Ie)break e}else t.head&&(t.head.comment=null);t.mode=Rf;case Rf:if(t.flags&512){for(;_<16;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(d!==(t.check&65535)){r.msg="header crc mismatch",t.mode=Rr;break}d=0,_=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=mo;break;case If:for(;_<32;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}r.adler=t.check=qf(d),d=0,_=0,t.mode=iu;case iu:if(t.havedict===0)return r.next_out=a,r.avail_out=u,r.next_in=o,r.avail_in=l,t.hold=d,t.bits=_,uv;r.adler=t.check=1,t.mode=mo;case mo:if(e===cv||e===nu)break e;case xd:if(t.last){d>>>=_&7,_-=_&7,t.mode=Ad;break}for(;_<3;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}switch(t.last=d&1,d>>>=1,_-=1,d&3){case 0:t.mode=Df;break;case 1:if(yv(t),t.mode=ou,e===nu){d>>>=2,_-=2;break e}break;case 2:t.mode=Of;break;case 3:r.msg="invalid block type",t.mode=Rr}d>>>=2,_-=2;break;case Df:for(d>>>=_&7,_-=_&7;_<32;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if((d&65535)!=(d>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Rr;break}if(t.length=d&65535,d=0,_=0,t.mode=Td,e===nu)break e;case Td:t.mode=Pf;case Pf:if(P=t.length,P){if(P>l&&(P=l),P>u&&(P=u),P===0)break e;i.set(n.subarray(o,o+P),a),l-=P,o+=P,u-=P,a+=P,t.length-=P;break}t.mode=mo;break;case Of:for(;_<14;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(t.nlen=(d&31)+257,d>>>=5,_-=5,t.ndist=(d&31)+1,d>>>=5,_-=5,t.ncode=(d&15)+4,d>>>=4,_-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Rr;break}t.have=0,t.mode=kf;case kf:for(;t.have<t.ncode;){for(;_<3;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.lens[rt[t.have++]]=d&7,d>>>=3,_-=3}for(;t.have<19;)t.lens[rt[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Pe={bits:t.lenbits},Ae=Jc(sv,t.lens,0,19,t.lencode,0,t.work,Pe),t.lenbits=Pe.bits,Ae){r.msg="invalid code lengths set",t.mode=Rr;break}t.have=0,t.mode=Nf;case Nf:for(;t.have<t.nlen+t.ndist;){for(;B=t.lencode[d&(1<<t.lenbits)-1],U=B>>>24,H=B>>>16&255,re=B&65535,!(U<=_);){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(re<16)d>>>=U,_-=U,t.lens[t.have++]=re;else{if(re===16){for(qe=U+2;_<qe;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(d>>>=U,_-=U,t.have===0){r.msg="invalid bit length repeat",t.mode=Rr;break}Ie=t.lens[t.have-1],P=3+(d&3),d>>>=2,_-=2}else if(re===17){for(qe=U+3;_<qe;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}d>>>=U,_-=U,Ie=0,P=3+(d&7),d>>>=3,_-=3}else{for(qe=U+7;_<qe;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}d>>>=U,_-=U,Ie=0,P=11+(d&127),d>>>=7,_-=7}if(t.have+P>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Rr;break}for(;P--;)t.lens[t.have++]=Ie}}if(t.mode===Rr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Rr;break}if(t.lenbits=9,Pe={bits:t.lenbits},Ae=Jc(pf,t.lens,0,t.nlen,t.lencode,0,t.work,Pe),t.lenbits=Pe.bits,Ae){r.msg="invalid literal/lengths set",t.mode=Rr;break}if(t.distbits=6,t.distcode=t.distdyn,Pe={bits:t.distbits},Ae=Jc(gf,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Pe),t.distbits=Pe.bits,Ae){r.msg="invalid distances set",t.mode=Rr;break}if(t.mode=ou,e===nu)break e;case ou:t.mode=au;case au:if(l>=6&&u>=258){r.next_out=a,r.avail_out=u,r.next_in=o,r.avail_in=l,t.hold=d,t.bits=_,rv(r,A),a=r.next_out,i=r.output,u=r.avail_out,o=r.next_in,n=r.input,l=r.avail_in,d=t.hold,_=t.bits,t.mode===mo&&(t.back=-1);break}for(t.back=0;B=t.lencode[d&(1<<t.lenbits)-1],U=B>>>24,H=B>>>16&255,re=B&65535,!(U<=_);){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(H&&(H&240)==0){for(Y=U,he=H,De=re;B=t.lencode[De+((d&(1<<Y+he)-1)>>Y)],U=B>>>24,H=B>>>16&255,re=B&65535,!(Y+U<=_);){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}d>>>=Y,_-=Y,t.back+=Y}if(d>>>=U,_-=U,t.back+=U,t.length=re,H===0){t.mode=Bf;break}if(H&32){t.back=-1,t.mode=mo;break}if(H&64){r.msg="invalid literal/length code",t.mode=Rr;break}t.extra=H&15,t.mode=Mf;case Mf:if(t.extra){for(qe=t.extra;_<qe;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.length+=d&(1<<t.extra)-1,d>>>=t.extra,_-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Ff;case Ff:for(;B=t.distcode[d&(1<<t.distbits)-1],U=B>>>24,H=B>>>16&255,re=B&65535,!(U<=_);){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if((H&240)==0){for(Y=U,he=H,De=re;B=t.distcode[De+((d&(1<<Y+he)-1)>>Y)],U=B>>>24,H=B>>>16&255,re=B&65535,!(Y+U<=_);){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}d>>>=Y,_-=Y,t.back+=Y}if(d>>>=U,_-=U,t.back+=U,H&64){r.msg="invalid distance code",t.mode=Rr;break}t.offset=re,t.extra=H&15,t.mode=Lf;case Lf:if(t.extra){for(qe=t.extra;_<qe;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}t.offset+=d&(1<<t.extra)-1,d>>>=t.extra,_-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Rr;break}t.mode=$f;case $f:if(u===0)break e;if(P=A-u,t.offset>P){if(P=t.offset-P,P>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Rr;break}P>t.wnext?(P-=t.wnext,M=t.wsize-P):M=t.wnext-P,P>t.length&&(P=t.length),k=t.window}else k=i,M=a-t.offset,P=t.length;P>u&&(P=u),u-=P,t.length-=P;do i[a++]=k[M++];while(--P);t.length===0&&(t.mode=au);break;case Bf:if(u===0)break e;i[a++]=t.length,u--,t.mode=au;break;case Ad:if(t.wrap){for(;_<32;){if(l===0)break e;l--,d|=n[o++]<<_,_+=8}if(A-=u,r.total_out+=A,t.total+=A,A&&(r.adler=t.check=t.flags?an(t.check,i,A,a-A):zc(t.check,i,A,a-A)),A=u,(t.flags?d:qf(d))!==t.check){r.msg="incorrect data check",t.mode=Rr;break}d=0,_=0}t.mode=Uf;case Uf:if(t.wrap&&t.flags){for(;_<32;){if(l===0)break e;l--,d+=n[o++]<<_,_+=8}if(d!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=Rr;break}d=0,_=0}t.mode=Hf;case Hf:Ae=lv;break e;case Rr:Ae=vf;break e;case jf:return yf;case hv:default:return di}return r.next_out=a,r.avail_out=u,r.next_in=o,r.avail_in=l,t.hold=d,t.bits=_,(t.wsize||A!==r.avail_out&&t.mode<Rr&&(t.mode<Ad||e!==mf))&&Qf(r,r.output,r.next_out,A-r.avail_out),R-=r.avail_in,A-=r.avail_out,r.total_in+=R,r.total_out+=A,t.total+=A,t.wrap&&A&&(r.adler=t.check=t.flags?an(t.check,i,A,r.next_out-A):zc(t.check,i,A,r.next_out-A)),r.data_type=t.bits+(t.last?64:0)+(t.mode===mo?128:0)+(t.mode===ou||t.mode===Td?256:0),(R===0&&A===0||e===mf)&&Ae===La&&(Ae=dv),Ae},"inflate$2"),wv=s(r=>{if(!r||!r.state)return di;let e=r.state;return e.window&&(e.window=null),r.state=null,La},"inflateEnd"),bv=s((r,e)=>{if(!r||!r.state)return di;const t=r.state;return(t.wrap&2)==0?di:(t.head=e,e.done=!1,La)},"inflateGetHeader"),Ev=s((r,e)=>{const t=e.length;let n,i,o;return!r||!r.state||(n=r.state,n.wrap!==0&&n.mode!==iu)?di:n.mode===iu&&(i=1,i=zc(i,e,t,0),i!==n.check)?vf:(o=Qf(r,e,t,t),o?(n.mode=jf,yf):(n.havedict=1,La))},"inflateSetDictionary");var Sv=Wf,Cv=Gf,xv=zf,Tv=vv,Av=Vf,Rv=_v,Iv=wv,Dv=bv,Pv=Ev,Ov="pako inflate (from Nodeca project)",vo={inflateReset:Sv,inflateReset2:Cv,inflateResetKeep:xv,inflateInit:Tv,inflateInit2:Av,inflate:Rv,inflateEnd:Iv,inflateGetHeader:Dv,inflateSetDictionary:Pv,inflateInfo:Ov};function kv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}s(kv,"GZheader");var Nv=kv;const Xf=Object.prototype.toString,{Z_NO_FLUSH:Mv,Z_FINISH:Fv,Z_OK:el,Z_STREAM_END:Dd,Z_NEED_DICT:Pd,Z_STREAM_ERROR:Lv,Z_DATA_ERROR:Yf,Z_MEM_ERROR:$v}=Oa;function tl(r){this.options=eu.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cf,this.strm.avail_out=0;let t=vo.inflateInit2(this.strm,e.windowBits);if(t!==el)throw new Error(Pa[t]);if(this.header=new Nv,vo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Yc.string2buf(e.dictionary):Xf.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=vo.inflateSetDictionary(this.strm,e.dictionary),t!==el)))throw new Error(Pa[t])}s(tl,"Inflate$1"),tl.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,l;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?Fv:Mv,Xf.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),o=vo.inflate(t,a),o===Pd&&i&&(o=vo.inflateSetDictionary(t,i),o===el?o=vo.inflate(t,a):o===Yf&&(o=Pd));t.avail_in>0&&o===Dd&&t.state.wrap>0&&r[t.next_in]!==0;)vo.inflateReset(t),o=vo.inflate(t,a);switch(o){case Lv:case Yf:case Pd:case $v:return this.onEnd(o),this.ended=!0,!1}if(l=t.avail_out,t.next_out&&(t.avail_out===0||o===Dd))if(this.options.to==="string"){let u=Yc.utf8border(t.output,t.next_out),d=t.next_out-u,_=Yc.buf2string(t.output,u);t.next_out=d,t.avail_out=n-d,d&&t.output.set(t.output.subarray(u,u+d),0),this.onData(_)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===el&&l===0)){if(o===Dd)return o=vo.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0},tl.prototype.onData=function(r){this.chunks.push(r)},tl.prototype.onEnd=function(r){r===el&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=eu.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function Od(r,e){const t=new tl(e);if(t.push(r),t.err)throw t.msg||Pa[t.err];return t.result}s(Od,"inflate$1");function Bv(r,e){return e=e||{},e.raw=!0,Od(r,e)}s(Bv,"inflateRaw$1");var Uv=tl,Hv=Od,jv=Bv,qv=Od,zv=Oa,Wv={Inflate:Uv,inflate:Hv,inflateRaw:jv,ungzip:qv,constants:zv};const{Deflate:Gv,deflate:Vv,deflateRaw:Kv,gzip:Qv}=ev,{Inflate:Xv,inflate:Yv,inflateRaw:Zv,ungzip:Jv}=Wv;var e0=Gv,t0=Vv,r0=Kv,n0=Qv,i0=Xv,o0=Yv,a0=Zv,Zf=Jv,s0=Oa,t_={Deflate:e0,deflate:t0,deflateRaw:r0,gzip:n0,Inflate:i0,inflate:o0,inflateRaw:a0,ungzip:Zf,constants:s0};class kd{constructor(e){this.bytes=e,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(e){const t=this.byteIndexCurrent;return this.byteIndexCurrent+=e,this.bytes.slice(t,this.byteIndexCurrent)}readByte(){const e=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,e}readString(e){const t=[],n=this.byteIndexCurrent+e;let i=this.byteIndexCurrent;for(;i<n;){const o=this.bytes[i++];if(o===0)break;let a=0,l=0;if((o&128)==0)a=o,l=0;else if((o&224)==192)a=o&31,l=1;else if((o&240)==224)a=o&15,l=2;else if((o&248)==240)a=o&7,l=3;else throw Error(`Invalid unicode, unknown multibyte encoding header ${o.toString(2)} at offset ${i}`);for(;l>0;){const u=this.bytes[i++];if((u&192)!=128)throw Error(`Invalid unicode, unexpected multibyte encoding trailer ${u.toString(2)} at offset ${i}`);a=a<<6|u&63,l--}t.push(String.fromCodePoint(a))}return this.byteIndexCurrent=n,t.join("")}}s(kd,"ByteStream");class Sn{constructor(e,t){this.value=e,this.id=`_${this.value}`,this.name=t}static Instances(){return Sn._instances==null&&(Sn._instances=new Jf),Sn._instances}}s(Sn,"TarFileTypeFlag");class Jf{constructor(){this.Normal=new Sn("0","Normal"),this.HardLink=new Sn("1","Hard Link"),this.SymbolicLink=new Sn("2","Symbolic Link"),this.CharacterSpecial=new Sn("3","Character Special"),this.BlockSpecial=new Sn("4","Block Special"),this.Directory=new Sn("5","Directory"),this.FIFO=new Sn("6","FIFO"),this.ContiguousFile=new Sn("7","Contiguous File"),this.LongFilePath=new Sn("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let e=0;e<this._All.length;e++){const t=this._All[e];this._All[t.id]=t}}}s(Jf,"TarFileTypeFlag_Instances");class su{constructor(e,t,n,i,o,a,l,u,d,_,R,A,P,M,k,B){this.fileName=e,this.fileMode=t,this.userIDOfOwner=n,this.userIDOfGroup=i,this.fileSizeInBytes=o,this.timeModifiedInUnixFormat=a,this.checksum=l,this.typeFlag=u,this.nameOfLinkedFile=d,this.uStarIndicator=_,this.uStarVersion=R,this.userNameOfOwner=A,this.groupNameOfOwner=P,this.deviceNumberMajor=M,this.deviceNumberMinor=k,this.filenamePrefix=B,this.fullFileName=B.length?B.endsWith("/")?B+e:`${B}/${e}`:e}static fromBytes(e){const t=new kd(e),n=t.readString(100).trim(),i=t.readString(8),o=t.readString(8),a=t.readString(8),l=t.readString(12),u=t.readBytes(12),d=t.readString(8),_=t.readString(1),R=t.readString(100),A=t.readString(6),P=t.readString(2),M=t.readString(32),k=t.readString(32),B=t.readString(8),U=t.readString(8),H=t.readString(155),re=t.readBytes(12),Y=parseInt(l.trim(),8),he=parseInt(d,8),De=Sn.Instances()._All,Ie=`_${_}`,Ae=De[Ie];return new su(n,i,o,a,Y,u,he,Ae,R,A,P,M,k,B,U,H)}}s(su,"TarFileEntryHeader");const ep=512;class cu{constructor(e,t){this.header=e,this.dataAsBytes=t}static fromBytes(e,t){const n=ep,i=su.fromBytes(e),o=i.fileSizeInBytes,l=Math.ceil(o/n)*n,u=t.readBytes(l).slice(0,o);return new cu(i,u)}}s(cu,"TarFileEntry");class lu{constructor(e){this.entries=e}static fromBytes(e){const t=new kd(e),n=[],i=ep;let o=0;for(;t.hasMoreBytes()==!0;){const l=t.readBytes(i);let u=!0;for(let d=0;d<l.length;d++)if(l[d]!=0){u=!1;break}if(u==!0){if(o++,o==2)break}else{o=0;const d=cu.fromBytes(l,t);n.push(d)}}const a=new lu(n);return a.consolidateLongPathEntries(),a}consolidateLongPathEntries(){var e;const t=Sn.Instances().LongFilePath.name,n=this.entries;for(let i=0;i<n.length;i++){const o=n[i];if(((e=o.header.typeFlag)==null?void 0:e.name)==t){const a=n[i+1];a.header.fileName=o.dataAsBytes.reduce((l,u)=>l+=String.fromCharCode(u),""),a.header.fileName=a.header.fileName.replace(/\0/g,""),n.splice(i,1),i--}}}}s(lu,"TarFile");const c0=s(r=>lu.fromBytes(r),"readTar"),Zo=(0,V.loadMessageBundle)(),uu=new TextDecoder,du=new TextEncoder;class tp{constructor(e,t=0){this.retainFor=t;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,t;const n=(t=this.strongRef)!=null?t:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}s(tp,"TimedRetainingRef");class rp{constructor(e,t){this.root=e,this.providerService=t,this._onDidChangeIndexingEnablement=new h.EventEmitter,this._onDidDownloadTar=new h.EventEmitter,this.ongoingRequests=new Map,this.indexingDisabled=!1,this.usageFile=h.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=h.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=h.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await yn(ni.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),t=await this.getIndexingEnabledRepos(),n=t.has("*")||e.every(i=>t.has(i));await yn(ni.EnabledSomeSearchIndexes,t.size>0),await yn(ni.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[h.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),h.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),h.commands.registerCommand("remoteHub.enableIndexing",async()=>{const e={title:Zo("search download prompt enable","Enable")},t={title:Zo("search download prompt enable always","Always Enable")},n={title:Zo("search download prompt configure","Configure")},i={title:Zo("search download prompt cancel","Cancel"),isCloseAffordance:!0},o=await h.window.showInformationMessage(Zo("search download prompt",`Indexing creates a copy of this repository in your browser's storage in order to provide enhanced text searches.

Without indexing, searches will use GitHub's text search, which is imprecise.

Do you want to enable creating local indexes for this repository on this browser? You should only enable indexing on machines you trust.`),{modal:!0,useCustom:!0},e,t,n,i);if(o===n&&await h.commands.executeCommand("workbench.action.openSettings","remoteHub.search.download"),o===e)return await this.markIndexingEnabledForRepos(...this.providerService.repositories.map(a=>a.name)),{triggerSearch:!0};if(o===t)return await this.markIndexingEnabledForRepos("*"),{triggerSearch:!0}}),h.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=s(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const a of o)if(i>10**a.power)return`${Math.round(i/10**a.power)} ${a.name}`;return"Unknown size"},"humanReadableSize"),t=await this.listTars();if(t.length===0){await h.window.showInformationMessage("No Search Indexes Found");return}const n=h.window.createQuickPick();n.canSelectMany=!0,n.items=t.map(({name:i,size:o,path:a})=>({label:i,path:a,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const a=h.workspace.fs.delete(o),l=h.window.setStatusBarMessage(`$(loading) Deleting ${i}`,a);await a,l.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),h.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>h.window.withProgress({location:h.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0,await Promise.all([h.workspace.fs.delete(this.root,{recursive:!0})]),this.updateContext()}))]}getTarFromMemory(e){var t;if(e===this.lastReadKey){const n=(t=this.lastReadValue)==null?void 0:t.deref();if(n)return n;$.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const t=await h.workspace.fs.readFile(e);return!t||!t.length?void 0:t}catch(t){(!(t instanceof h.FileSystemError)||t.code!==h.FileSystemError.FileNotFound.name)&&(h.window.showWarningMessage(Zo("diskReadUnexpectedError","Unexpected error reading index from disk, attempting to reload from network")),$.error(t,"Unexpected error reading tarball from disk"));return}}async getTarFromNetwork(e){try{if(!await this.isIndexingEnabledForRepo(e))throw Error("Unable to search without indexing allowed");const t=await this.providerService.getTarGz(e);if(t===void 0)throw Error("Unable to retrieve search index from provider");return t}finally{this.updateContext()}}async getTar(e,t){t===void 0&&({HEAD:{sha:t}}=await this.providerService.getMetadata(e)),e=this.providerService.getCanonicalUri(e);const n=this.getTarStorageUri(e,t),i=n.toString();try{let o=this.ongoingRequests.get(i);return o===void 0&&(o=this.getTarCore(e,t,n),this.ongoingRequests.set(i,o)),await o}finally{this.ongoingRequests.delete(i)}}async getCachedTar(e,t){return e=this.providerService.getCanonicalUri(e),this.getTarCore(e,t,this.getTarStorageUri(e,t),{skipDownload:!0})}async getTarCore(e,t,n,i){var o;const a=`${ge(e,{excludeScheme:!0})}/${t}`,l=new lt(`TarPit.getTar(${a})`),u=n.toString(),d=Date.now();let _,R;try{if(l.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),R=this.getTarFromMemory(u),R)return _=" \u2022 Got .tar from memory",R;l.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let A=!1,P=await this.getTarFromDisk(n);if(P==null?void 0:P.length)_=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){_=" \u2022 Skipped download";return}l.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),P=await this.getTarFromNetwork(e),A=!0,_=" \u2022 Got .tar from network",h.workspace.fs.writeFile(n,P).then(()=>$.debug(`Sucessfully wrote tarball to disk in ${Date.now()-d}ms`),B=>$.error(B,`Error writing tarball to disk in ${Date.now()-d}ms`))}if(!(P==null?void 0:P.length))throw new Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `GitHub Repositories: Delete Local Repository Data...`");l.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const M=Zf(P);l.logStep("Parsing .tar",{suffix:" \u2022 Parsing .tar..."}),R=c0(M),l.logStep("Fixing up .tar entries",{suffix:" \u2022 Fixing up .tar entries..."});const k=[];for(const B of R.entries)((o=B.header.typeFlag)==null?void 0:o.name)==="Normal"&&(B.header.fullFileName=B.header.fullFileName.replace(/^[^/]+\/?/,""),k.push(B));return R.entries=k,this.lastReadValue=new tp(R,Date.now()-d),this.lastReadKey=u,A&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:t}),0),R}catch(A){throw _=` \u2022 Failed; ${String(A)}`,A}finally{R&&(this.markCacheEntryUsed(`${a}`).catch(A=>$.log(`Error marking entry used: ${A}`)),this.cleanUpCache().catch(A=>$.log(`Error cleaning cache: ${A}`))),l.stop(_?{suffix:_}:void 0)}}getTarStorageUri(e,t){return h.Uri.joinPath(this.root,"tars",ge(e,{excludeScheme:!0}),t)}async readDir(e){try{return(await h.workspace.fs.readDirectory(e)).map(t=>h.Uri.joinPath(e,t[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const t=await this.getIndexingEnabledRepos();if(t.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);return n?t.has(n):!1}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],t=await h.window.showQuickPick(e.map(n=>({picked:!0,description:n==="*"?Zo("all","All Repositories"):"",label:n})),{canPickMany:!0,title:Zo("select repos where indexing is allowed","Select repositories that should be indexed")});t&&await this.resetIndexingAllowedRepos(t.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(uu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(t){t instanceof h.FileSystemError&&t.code!==h.FileSystemError.FileNotFound().code&&$.error(t,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(h.Uri.joinPath(this.root,"tars")).catch(()=>[]),t=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(t.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await h.workspace.fs.stat(o)).size})))}async resetIndexingAllowedRepos(e){await h.workspace.fs.writeFile(this.indexingAllowanceFile,du.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markIndexingEnabledForRepos(...e){let t;try{t=JSON.parse(uu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&$.error(n,"Error reading index allowance data."),t=[]}for(const n of e)t.includes(n)||t.push(n);this.indexingDisabled=!1,await h.workspace.fs.writeFile(this.indexingAllowanceFile,du.encode(JSON.stringify(t))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let t;try{t=JSON.parse(uu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&$.error(n,"Error reading usage data."),t={}}t[e]=Number(Date.now()),await h.workspace.fs.writeFile(this.usageFile,du.encode(JSON.stringify(t)))}async cleanUpCache(){var e,t;$.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(uu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(R){R instanceof h.FileSystemError&&R.code!==h.FileSystemError.FileNotFound().code&&$.error(R,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(R=>{var A;const P=/^([^/]*\/[^/]*)\//.exec(R.name);if(!P)throw Error("Unexpected repo entry");const M=P[1],k=(A=i[R.name])!=null?A:0;o.push({...R,lastUsed:k,repo:M})}),o.sort((R,A)=>A.lastUsed-R.lastUsed);let a=0;const l=[],u=new Map,d=((e=Ne.get("search.download.sizeLimit"))!=null?e:100)*1024*1024,_=(t=Ne.get("search.download.repoLimit"))!=null?t:4;o.forEach(R=>{var A,P;(R.lastUsed===0||a>d||((A=u.get(R.repo))!=null?A:0)>_)&&l.push(R),a+=R.size,u.set(R.repo,((P=u.get(R.repo))!=null?P:0)+1)}),await Promise.all(l.map(async R=>{try{await h.workspace.fs.delete(R.path,{recursive:!0}),delete i[R.name],$.log(`Deleted cache entry for ${R.name}`)}catch(A){$.log(`Deleting cache entry for ${R.name} failed; ${String(A)}`)}})),await h.workspace.fs.writeFile(this.usageFile,du.encode(JSON.stringify(i))),await this.updateContext()}}s(rp,"TarPit");const l0=(0,V.loadMessageBundle)();async function u0(r,e,t,n,i,o,a){return Nd("provideTextSearchResults",async()=>{const l=dg(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let u;try{u=await Nd("fetch tarball",()=>t.getTar(i.folder))}catch(B){return{limitHit:!1,message:{type:h.TextSearchCompleteMessageType.Warning,trusted:!0,text:l0("indexNotAvailable","Search index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(a.isCancellationRequested)return{limitHit:!1};const{maxResults:d,maxFileSize:_,includes:R,excludes:A}=i,P=await d0(i.folder,r,u,e);if(a.isCancellationRequested)return{limitHit:!0};let M=d;const k=hg(P,R,A,_);return Nd("searchFiles",async()=>{var B,U;let H=0;for(const re of P){if(!k.has(re.path))continue;const Y=fg(re.contents,re.path,l,{beforeContext:(B=i.beforeContext)!=null?B:0,afterContext:(U=i.afterContext)!=null?U:0,previewOptions:i.previewOptions,remainingResultQuota:M});for(const he of Y)o.report({...he,uri:h.Uri.joinPath(i.folder,he.uri.path)});if(M!==void 0&&(M-=Y.length,M<=0))return{limitHit:!0};if(H++,H%1e4==0&&(await new Promise(he=>setTimeout(he,0)),a.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}s(u0,"provideTextSearchResults");async function d0(r,e,t,n){const i=t.entries,o=e.getVirtualRootUri(r),a=await n.getChanges(o,{predicate:R=>R.fileType===h.FileType.File});if(a.length===0)return i.map(R=>({contents:R.dataAsBytes,path:R.header.fullFileName,size:R.dataAsBytes.byteLength}));const l=await Promise.all(eo(a,R=>{if(R.type===Mt.Created)return n.getContent(R.uri).then(A=>({path:e.getRelativeFilePath(o,R.uri),size:A.length,contents:A}))})),u=await Promise.all(eo(a,R=>{if(R.type===Mt.Changed)return n.getContent(R.uri).then(A=>({path:e.getRelativeFilePath(o,R.uri),size:A.length,contents:A}))})),d=new Set(ra(rr(u,R=>R.path),eo(a,R=>{if(R.type===Mt.Deleted)return e.getRelativeFilePath(o,R.uri)})));return[...eo(i,R=>{if(!d.has(R.header.fullFileName))return{contents:R.dataAsBytes,path:R.header.fullFileName,size:R.dataAsBytes.byteLength}}),...l,...u]}s(d0,"listAllFiles");function r_(r,e){const t=Date.now(),n=e();return Logger.log(`${r} time: ${Date.now()-t}`),n}s(r_,"timeSync");async function Nd(r,e){const t=Date.now(),n=await e();return $.log(`${r} time: ${Date.now()-t}`),n}s(Nd,"time");var h0=Object.defineProperty,f0=Object.getOwnPropertyDescriptor,Md=s((r,e,t,n)=>{for(var i=n>1?void 0:n?f0(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&h0(e,t,i),i},"github_fs_decorateClass");const Fd=(0,V.loadMessageBundle)(),p0=h.FileSystemError.FileNotFound().code,g0=/(\/|\\)/g,np=".vscode/.github-pull-request.rec";class rl{constructor(e,t,n,i){this.providerService=e,this.github=t,this.changeStore=n,this.tarPit=i,this._onDidChangeFile=new h.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(o=>{o.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([o.repository.uri])}),e.onDidRefresh(o=>this.onRefreshOrRepositoryChanged(o)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(t=>tr.getProviderId(t)===this.scheme).map(t=>this.providerService.getProviderUri(t)),e.length!==0){$.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(t=>t.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[t,n]of[...this.pendingUriRequests])e.some(i=>Be(n.uri,i))&&(this.pendingUriRequests.delete(t),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const t=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>Be(o,a))&&(this.implicitlyWatchedUris.delete(i),t.set(i,o));$.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${t.size}`);for(const i of e)t.set(ne(i),i);const n=[...t.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{$.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,t){const n=ne(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var t,n;const i=ne(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),a={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,a);const l=await this.github.getFileTree(e),u=await l.get(o);if(u==null?void 0:u.stat)return u==null?void 0:u.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:h.FileType.File,size:0,ctime:0,mtime:(t=l.timestamp)!=null?t:Date.now(),permissions:h.FilePermission.Readonly};if(o===np){const{ref:d}=this.providerService.getVirtualUriMetadata(e);if((d==null?void 0:d.type)===ht.PullRequest)return{type:h.FileType.File,size:0,ctime:0,mtime:(n=l.timestamp)!=null?n:Date.now(),permissions:h.FilePermission.Readonly}}throw h.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(a==null?void 0:a.outdated)&&setTimeout(()=>{$.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,t){this.implicitlyWatchedUris.set(ne(e),e);const n=await this.github.getFileTree(e),i=this.providerService.getRelativeFilePath(e),o=(await n.getChildren(i,t)).map(([a,{stat:{type:l}}])=>[a,l]);return i===""&&lt.stop("Time to root directory"),o}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){const t=ne(e);this.implicitlyWatchedUris.set(t,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(t,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(t),i instanceof h.FileSystemError&&i.code===p0){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===np){const{ref:a}=this.providerService.getVirtualUriMetadata(e);if((a==null?void 0:a.type)===ht.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(t),(n==null?void 0:n.outdated)&&setTimeout(()=>{$.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,t,n){throw h.FileSystemError.NoPermissions()}delete(e,t){throw h.FileSystemError.NoPermissions()}rename(e,t,n){throw h.FileSystemError.NoPermissions()}copy(e,t,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:t,maxResults:n,includes:i,excludes:o},a){const l=`${ne(t)}|${JSON.stringify({includes:i,excludes:o})}`;let u=this.fileSearchCache.get(l);if(u===void 0){const _=this.providerService.getRelativeFilePath(t);let R;await this.github.hasFileTree(t)&&(R=await this.github.getFileTree(t));let A;if(R===void 0||R.loading||!R.hasEntireTree?A=await this.github.getFileList(t,_):A=(await R.getChildren(_,{filter:h.FileType.File,recursive:!0})).map(([P])=>P),A.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(A=[...An(A,i,o)]),u=A.map(P=>Hn.prepareSlow(P)),this.fileSearchCache.set(l,u)}let d;return e.pattern===""?d=u.map(_=>h.Uri.joinPath(t,_.target)):(d=Hn.go(e.pattern.replace(g0,"/"),u,{allowTypo:!0,limit:n}).map(_=>h.Uri.joinPath(t,_.target)),Hn.cleanup()),n!==void 0&&n!==0&&n<d.length&&(d=d.slice(0,n)),d}async provideTextSearchResults(e,t,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(t.folder))try{return u0(this.providerService,this.changeStore,this.tarPit,e,t,n,i)}catch{o.push({text:Fd("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:h.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:Fd("flags not supported","Search flags are not supported by GitHub search. [Enable indexing]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:Fd("enable index","Currently using GitHub text search. [Enable indexing]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Information,trusted:!0});const a=await this.github.searchCodeQuery(e.pattern,t.folder,{maxResults:t.maxResults,context:{before:t.beforeContext,after:t.afterContext}});if(a.warnings&&a.warnings.forEach(u=>{o.push({text:u,trusted:!0,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let l;for(const u of a.matches)l=h.Uri.joinPath(t.folder,u.path),n.report({uri:l,ranges:u.ranges,preview:{text:u.preview,matches:u.matches}});return{limitHit:!1,message:o}}}s(rl,"GitHubFS"),Md([fn()],rl.prototype,"stat",1),Md([fn()],rl.prototype,"readDirectory",1),Md([fn()],rl.prototype,"readFile",1);var m0=__webpack_require__(1017);function hu(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&"version"in process?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}s(hu,"getUserAgent");var v0=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function ip(r){return Object.prototype.toString.call(r)==="[object Object]"}s(ip,"isObject");function op(r){var e,t;return ip(r)===!1?!1:(e=r.constructor,e===void 0?!0:(t=e.prototype,!(ip(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)))}s(op,"isPlainObject");function y0(r){return r?Object.keys(r).reduce((e,t)=>(e[t.toLowerCase()]=r[t],e),{}):{}}s(y0,"lowercaseKeys");function ap(r,e){const t=Object.assign({},r);return Object.keys(e).forEach(n=>{op(e[n])?n in r?t[n]=ap(r[n],e[n]):Object.assign(t,{[n]:e[n]}):Object.assign(t,{[n]:e[n]})}),t}s(ap,"mergeDeep");function sp(r){for(const e in r)r[e]===void 0&&delete r[e];return r}s(sp,"removeUndefinedProperties");function Ld(r,e,t){if(typeof e=="string"){let[i,o]=e.split(" ");t=Object.assign(o?{method:i,url:o}:{url:i},t)}else t=Object.assign({},e);t.headers=y0(t.headers),sp(t),sp(t.headers);const n=ap(r||{},t);return r&&r.mediaType.previews.length&&(n.mediaType.previews=r.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}s(Ld,"dist_web_merge");function _0(r,e){const t=/\?/.test(r)?"&":"?",n=Object.keys(e);return n.length===0?r:r+t+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}s(_0,"addQueryParameters");const w0=/\{[^}]+\}/g;function b0(r){return r.replace(/^\W+|\W+$/g,"").split(/,/)}s(b0,"removeNonChars");function E0(r){const e=r.match(w0);return e?e.map(b0).reduce((t,n)=>t.concat(n),[]):[]}s(E0,"extractUrlVariableNames");function cp(r,e){return Object.keys(r).filter(t=>!e.includes(t)).reduce((t,n)=>(t[n]=r[n],t),{})}s(cp,"omit");function lp(r){return r.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}s(lp,"encodeReserved");function ks(r){return encodeURIComponent(r).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}s(ks,"encodeUnreserved");function nl(r,e,t){return e=r==="+"||r==="#"?lp(e):ks(e),t?ks(t)+"="+e:e}s(nl,"encodeValue");function Ns(r){return r!=null}s(Ns,"isDefined");function $d(r){return r===";"||r==="&"||r==="?"}s($d,"isKeyOperator");function S0(r,e,t,n){var i=r[t],o=[];if(Ns(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(nl(e,i,$d(e)?t:""));else if(n==="*")Array.isArray(i)?i.filter(Ns).forEach(function(a){o.push(nl(e,a,$d(e)?t:""))}):Object.keys(i).forEach(function(a){Ns(i[a])&&o.push(nl(e,i[a],a))});else{const a=[];Array.isArray(i)?i.filter(Ns).forEach(function(l){a.push(nl(e,l))}):Object.keys(i).forEach(function(l){Ns(i[l])&&(a.push(ks(l)),a.push(nl(e,i[l].toString())))}),$d(e)?o.push(ks(t)+"="+a.join(",")):a.length!==0&&o.push(a.join(","))}else e===";"?Ns(i)&&o.push(ks(t)):i===""&&(e==="&"||e==="?")?o.push(ks(t)+"="):i===""&&o.push("");return o}s(S0,"getValues");function C0(r){return{expand:x0.bind(null,r)}}s(C0,"parseUrl");function x0(r,e){var t=["+","#",".","/",";","?","&"];return r.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let l="";const u=[];if(t.indexOf(i.charAt(0))!==-1&&(l=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(d){var _=/([^:\*]*)(?::(\d+)|(\*))?/.exec(d);u.push(S0(e,l,_[1],_[2]||_[3]))}),l&&l!=="+"){var a=",";return l==="?"?a="&":l!=="#"&&(a=l),(u.length!==0?l:"")+u.join(a)}else return u.join(",")}else return lp(o)})}s(x0,"expand");function up(r){let e=r.method.toUpperCase(),t=(r.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},r.headers),i,o=cp(r,["method","baseUrl","url","headers","request","mediaType"]);const a=E0(t);t=C0(t).expand(o),/^http/.test(t)||(t=r.baseUrl+t);const l=Object.keys(r).filter(_=>a.includes(_)).concat("baseUrl"),u=cp(o,l);if(!/application\/octet-stream/i.test(n.accept)&&(r.mediaType.format&&(n.accept=n.accept.split(/,/).map(_=>_.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${r.mediaType.format}`)).join(",")),r.mediaType.previews.length)){const _=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=_.concat(r.mediaType.previews).map(R=>{const A=r.mediaType.format?`.${r.mediaType.format}`:"+json";return`application/vnd.github.${R}-preview${A}`}).join(",")}return["GET","HEAD"].includes(e)?t=_0(t,u):"data"in u?i=u.data:Object.keys(u).length?i=u:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:t,headers:n},typeof i!="undefined"?{body:i}:null,r.request?{request:r.request}:null)}s(up,"parse");function T0(r,e,t){return up(Ld(r,e,t))}s(T0,"endpointWithDefaults");function dp(r,e){const t=Ld(r,e),n=T0.bind(null,t);return Object.assign(n,{DEFAULTS:t,defaults:dp.bind(null,t),merge:Ld.bind(null,t),parse:up})}s(dp,"withDefaults");const A0=`octokit-endpoint.js/6.0.12 ${hu()}`,R0=dp(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":A0},mediaType:{format:"",previews:[]}}),I0=xr.Readable,yo=Symbol("buffer"),Bd=Symbol("type");class $a{constructor(){this[Bd]="";const e=arguments[0],t=arguments[1],n=[];let i=0;if(e){const a=e,l=Number(a.length);for(let u=0;u<l;u++){const d=a[u];let _;d instanceof Buffer?_=d:ArrayBuffer.isView(d)?_=Buffer.from(d.buffer,d.byteOffset,d.byteLength):d instanceof ArrayBuffer?_=Buffer.from(d):d instanceof $a?_=d[yo]:_=Buffer.from(typeof d=="string"?d:String(d)),i+=_.length,n.push(_)}}this[yo]=Buffer.concat(n);let o=t&&t.type!==void 0&&String(t.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[Bd]=o)}get size(){return this[yo].length}get type(){return this[Bd]}text(){return Promise.resolve(this[yo].toString())}arrayBuffer(){const e=this[yo],t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(t)}stream(){const e=new I0;return e._read=function(){},e.push(this[yo]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,t=arguments[0],n=arguments[1];let i,o;t===void 0?i=0:t<0?i=Math.max(e+t,0):i=Math.min(t,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const a=Math.max(o-i,0),u=this[yo].slice(i,i+a),d=new $a([],{type:arguments[2]});return d[yo]=u,d}}s($a,"lib_Blob"),Object.defineProperties($a.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty($a.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function On(r,e,t){Error.call(this,r),this.message=r,this.type=e,t&&(this.code=this.errno=t.code),Error.captureStackTrace(this,this.constructor)}s(On,"lib_FetchError"),On.prototype=Object.create(Error.prototype),On.prototype.constructor=On,On.prototype.name="FetchError";let Ud;try{Ud=require("encoding").convert}catch(r){}const _o=Symbol("Body internals"),hp=xr.PassThrough;function sn(r){var e=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.size;let i=n===void 0?0:n;var o=t.timeout;let a=o===void 0?0:o;r==null?r=null:fp(r)?r=Buffer.from(r.toString()):il(r)||Buffer.isBuffer(r)||(Object.prototype.toString.call(r)==="[object ArrayBuffer]"?r=Buffer.from(r):ArrayBuffer.isView(r)?r=Buffer.from(r.buffer,r.byteOffset,r.byteLength):r instanceof xr||(r=Buffer.from(String(r)))),this[_o]={body:r,disturbed:!1,error:null},this.size=i,this.timeout=a,r instanceof xr&&r.on("error",function(l){const u=l.name==="AbortError"?l:new On(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[_o].error=u})}s(sn,"lib_Body"),sn.prototype={get body(){return this[_o].body},get bodyUsed(){return this[_o].disturbed},arrayBuffer(){return Ms.call(this).then(function(r){return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)})},blob(){let r=this.headers&&this.headers.get("content-type")||"";return Ms.call(this).then(function(e){return Object.assign(new $a([],{type:r.toLowerCase()}),{[yo]:e})})},json(){var r=this;return Ms.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(t){return sn.Promise.reject(new On(`invalid json response body at ${r.url} reason: ${t.message}`,"invalid-json"))}})},text(){return Ms.call(this).then(function(r){return r.toString()})},buffer(){return Ms.call(this)},textConverted(){var r=this;return Ms.call(this).then(function(e){return D0(e,r.headers)})}},Object.defineProperties(sn.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),sn.mixIn=function(r){for(const e of Object.getOwnPropertyNames(sn.prototype))if(!(e in r)){const t=Object.getOwnPropertyDescriptor(sn.prototype,e);Object.defineProperty(r,e,t)}};function Ms(){var r=this;if(this[_o].disturbed)return sn.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[_o].disturbed=!0,this[_o].error)return sn.Promise.reject(this[_o].error);let e=this.body;if(e===null)return sn.Promise.resolve(Buffer.alloc(0));if(il(e)&&(e=e.stream()),Buffer.isBuffer(e))return sn.Promise.resolve(e);if(!(e instanceof xr))return sn.Promise.resolve(Buffer.alloc(0));let t=[],n=0,i=!1;return new sn.Promise(function(o,a){let l;r.timeout&&(l=setTimeout(function(){i=!0,a(new On(`Response timeout while trying to fetch ${r.url} (over ${r.timeout}ms)`,"body-timeout"))},r.timeout)),e.on("error",function(u){u.name==="AbortError"?(i=!0,a(u)):a(new On(`Invalid response body while trying to fetch ${r.url}: ${u.message}`,"system",u))}),e.on("data",function(u){if(!(i||u===null)){if(r.size&&n+u.length>r.size){i=!0,a(new On(`content size at ${r.url} over limit: ${r.size}`,"max-size"));return}n+=u.length,t.push(u)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(t,n))}catch(u){a(new On(`Could not create Buffer from response body for ${r.url}: ${u.message}`,"system",u))}}})})}s(Ms,"lib_consumeBody");function D0(r,e){if(typeof Ud!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const t=e.get("content-type");let n="utf-8",i,o;return t&&(i=/charset=([^;]*)/i.exec(t)),o=r.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),Ud(r,"UTF-8",n).toString()}s(D0,"lib_convertBody");function fp(r){return typeof r!="object"||typeof r.append!="function"||typeof r.delete!="function"||typeof r.get!="function"||typeof r.getAll!="function"||typeof r.has!="function"||typeof r.set!="function"?!1:r.constructor.name==="URLSearchParams"||Object.prototype.toString.call(r)==="[object URLSearchParams]"||typeof r.sort=="function"}s(fp,"lib_isURLSearchParams");function il(r){return typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&typeof r.constructor.name=="string"&&/^(Blob|File)$/.test(r.constructor.name)&&/^(Blob|File)$/.test(r[Symbol.toStringTag])}s(il,"lib_isBlob");function pp(r){let e,t,n=r.body;if(r.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof xr&&typeof n.getBoundary!="function"&&(e=new hp,t=new hp,n.pipe(e),n.pipe(t),r[_o].body=e,n=t),n}s(pp,"lib_clone");function gp(r){return r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":fp(r)?"application/x-www-form-urlencoded;charset=UTF-8":il(r)?r.type||null:Buffer.isBuffer(r)||Object.prototype.toString.call(r)==="[object ArrayBuffer]"||ArrayBuffer.isView(r)?null:typeof r.getBoundary=="function"?`multipart/form-data;boundary=${r.getBoundary()}`:r instanceof xr?null:"text/plain;charset=UTF-8"}s(gp,"lib_extractContentType");function mp(r){const e=r.body;return e===null?0:il(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}s(mp,"lib_getTotalBytes");function P0(r,e){const t=e.body;t===null?r.end():il(t)?t.stream().pipe(r):Buffer.isBuffer(t)?(r.write(t),r.end()):t.pipe(r)}s(P0,"lib_writeToStream"),sn.Promise=global.Promise;const vp=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,Hd=/[^\t\x20-\x7e\x80-\xff]/;function ol(r){if(r=`${r}`,vp.test(r)||r==="")throw new TypeError(`${r} is not a legal HTTP header name`)}s(ol,"lib_validateName");function yp(r){if(r=`${r}`,Hd.test(r))throw new TypeError(`${r} is not a legal HTTP header value`)}s(yp,"lib_validateValue");function Fs(r,e){e=e.toLowerCase();for(const t in r)if(t.toLowerCase()===e)return t}s(Fs,"node_fetch_lib_find");const Lr=Symbol("map");class hi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[Lr]=Object.create(null),e instanceof hi){const t=e.raw(),n=Object.keys(t);for(const i of n)for(const o of t[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const t=e[Symbol.iterator];if(t!=null){if(typeof t!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,ol(e);const t=Fs(this[Lr],e);return t===void 0?null:this[Lr][t].join(", ")}forEach(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=jd(this),i=0;for(;i<n.length;){var o=n[i];const a=o[0],l=o[1];e.call(t,l,a,this),n=jd(this),i++}}set(e,t){e=`${e}`,t=`${t}`,ol(e),yp(t);const n=Fs(this[Lr],e);this[Lr][n!==void 0?n:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,ol(e),yp(t);const n=Fs(this[Lr],e);n!==void 0?this[Lr][n].push(t):this[Lr][e]=[t]}has(e){return e=`${e}`,ol(e),Fs(this[Lr],e)!==void 0}delete(e){e=`${e}`,ol(e);const t=Fs(this[Lr],e);t!==void 0&&delete this[Lr][t]}raw(){return this[Lr]}keys(){return zd(this,"key")}values(){return zd(this,"value")}[Symbol.iterator](){return zd(this,"key+value")}}s(hi,"lib_Headers"),hi.prototype.entries=hi.prototype[Symbol.iterator],Object.defineProperty(hi.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(hi.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function jd(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(r[Lr]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return r[Lr][n].join(", ")}:function(n){return[n.toLowerCase(),r[Lr][n].join(", ")]})}s(jd,"lib_getHeaders");const qd=Symbol("internal");function zd(r,e){const t=Object.create(Wd);return t[qd]={target:r,kind:e,index:0},t}s(zd,"lib_createHeadersIterator");const Wd=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==Wd)throw new TypeError("Value of `this` is not a HeadersIterator");var r=this[qd];const e=r.target,t=r.kind,n=r.index,i=jd(e,t),o=i.length;return n>=o?{value:void 0,done:!0}:(this[qd].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(Wd,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function O0(r){const e=Object.assign({__proto__:null},r[Lr]),t=Fs(r[Lr],"Host");return t!==void 0&&(e[t]=e[t][0]),e}s(O0,"lib_exportNodeCompatibleHeaders");function k0(r){const e=new hi;for(const t of Object.keys(r))if(!vp.test(t))if(Array.isArray(r[t]))for(const n of r[t])Hd.test(n)||(e[Lr][t]===void 0?e[Lr][t]=[n]:e[Lr][t].push(n));else Hd.test(r[t])||(e[Lr][t]=[r[t]]);return e}s(k0,"lib_createHeadersLenient");const Jo=Symbol("Response internals"),N0=as.STATUS_CODES;class Ti{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sn.call(this,e,t);const n=t.status||200,i=new hi(t.headers);if(e!=null&&!i.has("Content-Type")){const o=gp(e);o&&i.append("Content-Type",o)}this[Jo]={url:t.url,status:n,statusText:t.statusText||N0[n],headers:i,counter:t.counter}}get url(){return this[Jo].url||""}get status(){return this[Jo].status}get ok(){return this[Jo].status>=200&&this[Jo].status<300}get redirected(){return this[Jo].counter>0}get statusText(){return this[Jo].statusText}get headers(){return this[Jo].headers}clone(){return new Ti(pp(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}s(Ti,"lib_Response"),sn.mixIn(Ti.prototype),Object.defineProperties(Ti.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Ti.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const wo=Symbol("Request internals"),Gd=No.parse,M0=No.format,F0="destroy"in xr.Readable.prototype;function fu(r){return typeof r=="object"&&typeof r[wo]=="object"}s(fu,"lib_isRequest");function L0(r){const e=r&&typeof r=="object"&&Object.getPrototypeOf(r);return!!(e&&e.constructor.name==="AbortSignal")}s(L0,"lib_isAbortSignal");class ea{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;fu(e)?n=Gd(e.url):(e&&e.href?n=Gd(e.href):n=Gd(`${e}`),e={});let i=t.method||e.method||"GET";if(i=i.toUpperCase(),(t.body!=null||fu(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=t.body!=null?t.body:fu(e)&&e.body!==null?pp(e):null;sn.call(this,o,{timeout:t.timeout||e.timeout||0,size:t.size||e.size||0});const a=new hi(t.headers||e.headers||{});if(o!=null&&!a.has("Content-Type")){const u=gp(o);u&&a.append("Content-Type",u)}let l=fu(e)?e.signal:null;if("signal"in t&&(l=t.signal),l!=null&&!L0(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[wo]={method:i,redirect:t.redirect||e.redirect||"follow",headers:a,parsedURL:n,signal:l},this.follow=t.follow!==void 0?t.follow:e.follow!==void 0?e.follow:20,this.compress=t.compress!==void 0?t.compress:e.compress!==void 0?e.compress:!0,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent}get method(){return this[wo].method}get url(){return M0(this[wo].parsedURL)}get headers(){return this[wo].headers}get redirect(){return this[wo].redirect}get signal(){return this[wo].signal}clone(){return new ea(this)}}s(ea,"lib_Request"),sn.mixIn(ea.prototype),Object.defineProperty(ea.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(ea.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function $0(r){const e=r[wo].parsedURL,t=new hi(r[wo].headers);if(t.has("Accept")||t.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(r.signal&&r.body instanceof xr.Readable&&!F0)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(r.body==null&&/^(POST|PUT)$/i.test(r.method)&&(n="0"),r.body!=null){const o=mp(r);typeof o=="number"&&(n=String(o))}n&&t.set("Content-Length",n),t.has("User-Agent")||t.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),r.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip,deflate");let i=r.agent;return typeof i=="function"&&(i=i(e)),!t.has("Connection")&&!i&&t.set("Connection","close"),Object.assign({},e,{method:r.method,headers:O0(t),agent:i})}s($0,"lib_getNodeRequestOptions");function al(r){Error.call(this,r),this.type="aborted",this.message=r,Error.captureStackTrace(this,this.constructor)}s(al,"lib_AbortError"),al.prototype=Object.create(Error.prototype),al.prototype.constructor=al,al.prototype.name="AbortError";const _p=xr.PassThrough,B0=No.resolve;function ta(r,e){if(!ta.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return sn.Promise=ta.Promise,new ta.Promise(function(t,n){const i=new ea(r,e),o=$0(i),a=(o.protocol==="https:"?Pl:as).request,l=i.signal;let u=null;const d=s(function(){let k=new al("The user aborted a request.");n(k),i.body&&i.body instanceof xr.Readable&&i.body.destroy(k),!(!u||!u.body)&&u.body.emit("error",k)},"abort");if(l&&l.aborted){d();return}const _=s(function(){d(),P()},"abortAndFinalize"),R=a(o);let A;l&&l.addEventListener("abort",_);function P(){R.abort(),l&&l.removeEventListener("abort",_),clearTimeout(A)}s(P,"finalize"),i.timeout&&R.once("socket",function(M){A=setTimeout(function(){n(new On(`network timeout at: ${i.url}`,"request-timeout")),P()},i.timeout)}),R.on("error",function(M){n(new On(`request to ${i.url} failed, reason: ${M.message}`,"system",M)),P()}),R.on("response",function(M){clearTimeout(A);const k=k0(M.headers);if(ta.isRedirect(M.statusCode)){const Y=k.get("Location"),he=Y===null?null:B0(i.url,Y);switch(i.redirect){case"error":n(new On(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),P();return;case"manual":if(he!==null)try{k.set("Location",he)}catch(Ie){n(Ie)}break;case"follow":if(he===null)break;if(i.counter>=i.follow){n(new On(`maximum redirect reached at: ${i.url}`,"max-redirect")),P();return}const De={headers:new hi(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if(M.statusCode!==303&&i.body&&mp(i)===null){n(new On("Cannot follow redirect with body being a readable stream","unsupported-redirect")),P();return}(M.statusCode===303||(M.statusCode===301||M.statusCode===302)&&i.method==="POST")&&(De.method="GET",De.body=void 0,De.headers.delete("content-length")),t(ta(new ea(he,De))),P();return}}M.once("end",function(){l&&l.removeEventListener("abort",_)});let B=M.pipe(new _p);const U={url:i.url,status:M.statusCode,statusText:M.statusMessage,headers:k,size:i.size,timeout:i.timeout,counter:i.counter},H=k.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||H===null||M.statusCode===204||M.statusCode===304){u=new Ti(B,U),t(u);return}const re={flush:ln.Z_SYNC_FLUSH,finishFlush:ln.Z_SYNC_FLUSH};if(H=="gzip"||H=="x-gzip"){B=B.pipe(ln.createGunzip(re)),u=new Ti(B,U),t(u);return}if(H=="deflate"||H=="x-deflate"){M.pipe(new _p).once("data",function(he){(he[0]&15)==8?B=B.pipe(ln.createInflate()):B=B.pipe(ln.createInflateRaw()),u=new Ti(B,U),t(u)});return}if(H=="br"&&typeof ln.createBrotliDecompress=="function"){B=B.pipe(ln.createBrotliDecompress()),u=new Ti(B,U),t(u);return}u=new Ti(B,U),t(u)}),P0(R,i)})}s(ta,"lib_fetch"),ta.isRedirect=function(r){return r===301||r===302||r===303||r===307||r===308},ta.Promise=global.Promise;const U0=ta;class Vd extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}s(Vd,"Deprecation");var H0=__webpack_require__(447),wp=__webpack_require__.n(H0);const j0=wp()(r=>console.warn(r)),q0=wp()(r=>console.warn(r));class Zi extends Error{constructor(e,t,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=t;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return j0(new Vd("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),t}}),Object.defineProperty(this,"headers",{get(){return q0(new Vd("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}s(Zi,"RequestError");const z0="5.6.1";function W0(r){return r.arrayBuffer()}s(W0,"getBufferResponse");function bp(r){const e=r.request&&r.request.log?r.request.log:console;(op(r.body)||Array.isArray(r.body))&&(r.body=JSON.stringify(r.body));let t={},n,i;return(r.request&&r.request.fetch||U0)(r.url,Object.assign({method:r.method,body:r.body,headers:r.headers,redirect:r.redirect},r.request)).then(async a=>{i=a.url,n=a.status;for(const l of a.headers)t[l[0]]=l[1];if("deprecation"in t){const l=t.link&&t.link.match(/<([^>]+)>; rel="deprecation"/),u=l&&l.pop();e.warn(`[@octokit/request] "${r.method} ${r.url}" is deprecated. It is scheduled to be removed on ${t.sunset}${u?`. See ${u}`:""}`)}if(!(n===204||n===205)){if(r.method==="HEAD"){if(n<400)return;throw new Zi(a.statusText,n,{response:{url:i,status:n,headers:t,data:void 0},request:r})}if(n===304)throw new Zi("Not modified",n,{response:{url:i,status:n,headers:t,data:await Kd(a)},request:r});if(n>=400){const l=await Kd(a);throw new Zi(G0(l),n,{response:{url:i,status:n,headers:t,data:l},request:r})}return Kd(a)}}).then(a=>({status:n,url:i,headers:t,data:a})).catch(a=>{throw a instanceof Zi?a:new Zi(a.message,500,{request:r})})}s(bp,"fetchWrapper");async function Kd(r){const e=r.headers.get("content-type");return/application\/json/.test(e)?r.json():!e||/^text\/|charset=utf-8$/.test(e)?r.text():W0(r)}s(Kd,"getResponseData");function G0(r){return typeof r=="string"?r:"message"in r?Array.isArray(r.errors)?`${r.message}: ${r.errors.map(JSON.stringify).join(", ")}`:r.message:`Unknown error: ${JSON.stringify(r)}`}s(G0,"toErrorMessage");function Qd(r,e){const t=r.defaults(e);return Object.assign(s(function(i,o){const a=t.merge(i,o);if(!a.request||!a.request.hook)return bp(t.parse(a));const l=s((u,d)=>bp(t.parse(t.merge(u,d))),"request");return Object.assign(l,{endpoint:t,defaults:Qd.bind(null,t)}),a.request.hook(l,a)},"newApi"),{endpoint:t,defaults:Qd.bind(null,t)})}s(Qd,"dist_web_withDefaults");const pu=Qd(R0,{headers:{"user-agent":`octokit-request.js/${z0} ${hu()}`}}),V0="4.8.0";function K0(r){return`Request failed due to following response errors:
`+r.errors.map(e=>` - ${e.message}`).join(`
`)}s(K0,"_buildMessageForResponseErrors");class Ls extends Error{constructor(e,t,n){super(K0(n));this.request=e,this.headers=t,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}s(Ls,"GraphqlResponseError");const Q0=["method","baseUrl","url","headers","request","query","mediaType"],X0=["query","method","url"],Ep=/\/api\/v3\/?$/;function Y0(r,e,t){if(t){if(typeof e=="string"&&"query"in t)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const a in t)if(!!X0.includes(a))return Promise.reject(new Error(`[@octokit/graphql] "${a}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},t):e,i=Object.keys(n).reduce((a,l)=>Q0.includes(l)?(a[l]=n[l],a):(a.variables||(a.variables={}),a.variables[l]=n[l],a),{}),o=n.baseUrl||r.endpoint.DEFAULTS.baseUrl;return Ep.test(o)&&(i.url=o.replace(Ep,"/api/graphql")),r(i).then(a=>{if(a.data.errors){const l={};for(const u of Object.keys(a.headers))l[u]=a.headers[u];throw new Ls(i,l,a.data)}return a.data.data})}s(Y0,"graphql");function Xd(r,e){const t=r.defaults(e);return Object.assign(s((i,o)=>Y0(t,i,o),"newApi"),{defaults:Xd.bind(null,t),endpoint:pu.endpoint})}s(Xd,"graphql_dist_web_withDefaults");const o_=Xd(pu,{headers:{"user-agent":`octokit-graphql.js/${V0} ${hu()}`},method:"POST",url:"/graphql"});function Z0(r){return Xd(r,{method:"POST",url:"/graphql"})}s(Z0,"withCustomRequest");const J0=/^v1\./,ey=/^ghs_/,ty=/^ghu_/;async function ry(r){const e=r.split(/\./).length===3,t=J0.test(r)||ey.test(r),n=ty.test(r);return{type:"token",token:r,tokenType:e?"app":t?"installation":n?"user-to-server":"oauth"}}s(ry,"auth");function ny(r){return r.split(/\./).length===3?`bearer ${r}`:`token ${r}`}s(ny,"withAuthorizationPrefix");async function iy(r,e,t,n){const i=e.endpoint.merge(t,n);return i.headers.authorization=ny(r),e(i)}s(iy,"hook");const oy=s(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(ry.bind(null,e),{hook:iy.bind(null,e)})},"createTokenAuth"),Sp="3.5.1";class sl{constructor(e={}){const t=new v0.Collection,n={baseUrl:pu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:t.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${Sp} ${hu()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=pu.defaults(n),this.graphql=Z0(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=t,e.authStrategy){const{authStrategy:o,...a}=e,l=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:a},e.auth));t.wrap("request",l.hook),this.auth=l}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=oy(e.auth);t.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return s(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var t;const n=this.plugins;return t=s(class extends this{},"_a"),t.plugins=n.concat(e.filter(o=>!n.includes(o))),t}}s(sl,"Octokit"),sl.VERSION=Sp,sl.plugins=[];function ay(r,e){return r.reduce((n,i)=>{const o=e(i),a=n.get(o);return a===void 0?n.set(o,[i]):a.push(i),n},new Map)}s(ay,"groupBy");function sy(r){let e=0;for(const t of r){if(t===0)return!0;if(e++,e>8e3)break}return!1}s(sy,"isBinary");function Yd(r,e,t=n=>n){return[...r.reduce((i,o)=>{const a=e(o),l=i.get(a);if(l===void 0)i.set(a,o);else{const u=t(l,o);u!==void 0&&i.set(a,u)}return i},new Map).values()]}s(Yd,"uniqueBy");function Zd(r){const e="$memoize$";return function(...t){return this.hasOwnProperty(e)||Object.defineProperty(this,e,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,t)}),this[e]}}s(Zd,"memoize");class Jd{constructor(e,t){this.path=e,this.relativePath=t}}s(Jd,"TrieNode");class Cp{constructor(){this.root=new Jd("","")}get(e){var t;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(t=n.children)==null?void 0:t.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var t;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(t=n.children)==null?void 0:t.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var t;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const a=(t=n.children)==null?void 0:t.get(o);if(a===void 0)return i;n=a}if(n.children!==void 0){let o=s(function(a,l,u){for(const d of a.values()){const _=`${l?`${l}/`:""}${d.relativePath}`;d.data&&u.push([_,d.data]),d.children!==void 0&&o(d.children,_,u)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var t;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(t=n.children)==null?void 0:t.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,t){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const a of e.split("/")){let l=(n=i.children)==null?void 0:n.get(a);o=`${o?`${o}/`:""}${a}`,l===void 0&&(i.children===void 0&&(i.children=new Map),l=new Jd(o,a),i.children.set(a,l)),i=l}i.data=t}}s(Cp,"Trie");class eh{constructor(e,t,n,i,o){if(this.rootUri=e,this.sha=t,this.timestamp=n,this.provider=i,this.trie=new Cp,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const a=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&a.push(i.onDidTriggerContentCaching(l=>{(!l||ne(l.rootUri)===ne(this.rootUri)&&l.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(u=>this._isContentCached=u,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(l=>(this._hasEntireTree=(l==null?void 0:l.success)?l.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var u;return void((u=i.tryCachingContent)==null?void 0:u.call(i,this.trie.get.bind(this.trie)).then(d=>this._isContentCached=d,()=>this._isContentCached=!0))},0),$u("_codespaces.webeditor.connectWorkspace",{result:(l==null?void 0:l.success)?"Success":"Failure",errorMessage:this._hasEntireTree?"":"Unable to load entire tree",errorDetail:(l==null?void 0:l.success)===!1?l.error:void 0}),this._loading=void 0,this.preloading=void 0,this.treeSha=(l==null?void 0:l.success)?l.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=h.Disposable.from(...a)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var t;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:h.FileType.Directory,size:0,ctime:0,mtime:(t=this.timestamp)!=null?t:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,t){await this.ensureLoaded(e,!0);const n=(t==null?void 0:t.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(t==null?void 0:t.filter)===void 0?n:n.filter(([,i])=>i.stat.type===t.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,t=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(t)i=this.preloading.get(e);else{const o=ja(this.preloading,([a])=>e.startsWith(a)&&e.lastIndexOf("/")===(a?a.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return t&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),t&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,t=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new lt(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const a=await this.provider.getTree(e,t);if(a.truncated){$.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${a.sha};`,suffix:" \u2022 Fixing directories..."});for(const[u,d]of this.trie.getDescendants(""))d.stat.type===h.FileType.Directory&&(d.loadChildren=Zd(()=>this.load(u).then(()=>d.loadChildren=void 0)));return o=` \u2022 Tree=${a.sha} \u2022 Truncated`,{sha:a.sha,recursive:!1,success:!0}}let l;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${a.sha};`,suffix:" \u2022 Waiting for permissions..."}),l=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:u,item:d}of a.tree)if(u!==void 0){switch(u=e?`${e}/${u}`:u,d.stat.permissions=l,d.stat.type){case h.FileType.File:d.getContent=Zd(()=>this.provider.getContent(d));break;case h.FileType.Directory:t||(d.loadChildren=Zd(()=>this.load(u).then(()=>d.loadChildren=void 0)));break}this.trie.set(u,d)}return o=` \u2022 Tree=${a.sha}`,{sha:a.sha,recursive:t,success:!0}}catch(a){return o=`\u2022 Loading for path=${e} failed; ${String(a)}`,{error:a,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}s(eh,"FileTree");var cy=__webpack_require__(7769);const ly="github-pr-owner-number";function uy(r){return`branch.${r}.${ly}`}s(uy,"getMetadataKeyForBranch");const dy=(0,V.loadMessageBundle)(),xp=new TextDecoder;class Tp{constructor(e,t,n,i,o,a){this.providerService=e,this.rootUri=t,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=a,this._onDidChangeSelection=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._objects=new Map,this.disposable=h.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(d=>{const _=ne(this.rootUri);!d.some(R=>ne(R)===_)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:d})=>{ne(this.rootUri)===ne(d.uri)&&this.updateState(await d.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(d){n.inputBox.value=d}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:l,name:u}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${l}/${u}.git`,isReadOnly:i.accessLevel<Ze.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case Le.Branch:return{type:nn.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case Le.RemoteBranch:{const t=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<Ze.Write,i=this.remotes.findIndex(o=>o.name===t);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:t,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:nn.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case Le.Tag:return{type:nn.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case Le.Commit:return{type:nn.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const t=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:l=>l.fileType===h.FileType.File}),n=t.conflicts.map(l=>({uri:l.uri,status:th(l.type),originalUri:l.uri,renameUri:l.uri})),i=t.staged.map(l=>({uri:l.uri,status:th(l.type),originalUri:l.uri,renameUri:l.uri})),o=t.working.map(l=>({uri:l.uri,status:th(l.type),originalUri:l.uri,renameUri:l.uri})),a=Ne.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:a?i:[],workingTreeChanges:a?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===uy(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,t){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,t){const n=new lt(`IGit.getObjectDetails(${e}, ${t})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(t))}finally{n.stop()}}async detectObjectType(e){var t;const n=new lt(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!sy(i))return{mimetype:"text/plain"};const a=await(0,cy.fromBuffer)(i);return{mimetype:(t=a==null?void 0:a.mime)!=null?t:"application/octet-stream"}}finally{n.stop()}}async buffer(e,t){const n=new lt(`IGit.buffer(${e}, ${t})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(t))}finally{n.stop()}}async show(e,t){const n=new lt(`IGit.show(${e}, ${t})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(t));return xp.decode(i)}finally{n.stop()}}async getCommit(e){const t=new lt(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{t.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,t){const n=new lt(`IGit.apply(reverse=${t})`);try{return await this.changeStore.applyPatch(this.rootUri,e,t?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const t=new lt(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{t.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,t){return t?this.diffBetween("",e,t):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,t){return t?this.diffBetween("~",e,t):this.diffBetween("~",e)}async diffBetween(e,t,n){if(!n)throw new Error("Method not implemented.");const i=new lt(`IGit.diffBetween(${e}, ${t}, ${n})`);try{const[o,a]=await Promise.all([this.getContent(e,n),this.getContent(t,n)]);return Li(n,o,a)}finally{i.stop()}}async diffBlobs(e,t){const n=new lt(`IGit.diffBlobs(${e}, ${t})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(t),a=Li("untitled",i,o);return Promise.resolve(a)}finally{n.stop()}}async getBlobContent(e){const t=new lt(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return xp.decode(o)}finally{t.stop()}}async getContent(e,t){const n=new lt(`IGit.getContent(${e}, ${t})`);try{const i=this.pathToRelativeUri(t);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,t)}finally{n.stop()}}async hashObject(e){const t=new lt("IGit.hashObject");try{const n=ro(await da(e));return this._objects.set(n,e),n}finally{t.stop()}}async createBranch(e,t,n){const i=new lt(`IGit.createBranch(${e}, ${t}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);t&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,t){throw new Error("Method not implemented.")}async getBranch(e){const t=new lt(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:i.commitUrl}}}finally{t.stop()}}async getBranches(e){var t,n;const i=(n=(t=e.contains)!=null?t:e.pattern)!=null?n:"",o=new lt(`IGit.getBranches(${i})`);try{const{branches:a}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(a.length===0)throw new Error(`Unable to find branches for "${i}"`);return a.map(l=>({type:l.type,name:l.name,commit:l.commit}))}finally{o.stop()}}setBranchUpstream(e,t){throw new Error("Method not implemented.")}getMergeBase(e,t){throw new Error("Method not implemented.")}async status(){}async checkout(e){const t=new lt(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await Un(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:a}=this.providerService.getVirtualUriMetadata(this.rootUri),l=this.providerService.getRemoteUri(o.id,{repo:a,pullRequest:{id:i}});if(l!==void 0){const u=await this.providerService.createWorkspaceForRemoteUrl(l.toString());u!==void 0&&await Un(u)}}throw new Error("User aborted")}finally{t.stop()}}addRemote(e,t){var n;let i;const o=this.remotes.findIndex(a=>a.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:t,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const t=this.remotes.findIndex(n=>n.name===e);return t!==-1&&this.remotes.splice(t,1),Promise.resolve()}renameRemote(e,t){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:t}),Promise.resolve()}async fetch(e,t,n){const i=new lt("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const t=new lt("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:Mr.Merge})}finally{t.stop()}}push(e,t,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,t){const n=new lt("IGit.commit");try{if((t==null?void 0:t.amend)!==void 0||(t==null?void 0:t.empty)!==void 0||(t==null?void 0:t.signCommit)!==void 0||(t==null?void 0:t.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(t==null?void 0:t.all)===!1})).filter(o=>o.fileType===h.FileType.File);if(!i.length){h.window.showInformationMessage(dy("no changes to commit","There are no changes to commit."));return}if(Ne.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return tt(this.rootUri,py(e))}}s(Tp,"GitHubRepository");const hy=/^\/?([a-zA-Z])(?::\/)(.*)$/,fy=/\\/g;function py(r){r=h.Uri.file(r).fsPath.replace(fy,"/");const e=hy.exec(r);return e!==null&&([,,r]=e),r.startsWith("/")?r:`/${r}`}s(py,"normalizePath");function th(r){switch(r){case Mt.Changed:return oi.MODIFIED;case Mt.Created:return oi.INTENT_TO_ADD;case Mt.Deleted:return oi.DELETED}}s(th,"opTypeToStatus");var gy=Object.defineProperty,my=Object.getOwnPropertyDescriptor,Ap=s((r,e,t,n)=>{for(var i=n>1?void 0:n?my(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&gy(e,t,i),i},"github_provider_decorateClass");const $s=(0,V.loadMessageBundle)(),Rp=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,Ip=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,gu=["repo","workflow"],mu=1,Dp=Object.freeze({id:"github",name:"GitHub"});function Bs(r){const{scheme:e,metadata:t}=tr.decodeAuthority(r,a=>{if(a.v!==void 0)return a;if(typeof a.pr=="string")return{v:mu,ref:{type:ht.PullRequest,id:a.pr},idx:a.idx};if(typeof a.ref=="string")return{v:mu,ref:{type:ht.Tree,id:a.ref},idx:a.idx}}),[,n,i,...o]=r.path.split("/");return{scheme:e,provider:Dp,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:t==null?void 0:t.ref,idx:t==null?void 0:t.idx}}s(Bs,"getGitHubMetadata");function vy(r,e){const{repo:t}=e!=null?e:Bs(r);return r.with({path:`/${t.owner}/${t.name}`,query:"",fragment:""})}s(vy,"getGitHubRootUri");function rh(r,e,t){const{repo:{owner:n,name:i}}=r instanceof h.Uri?Bs(r):r;return h.Uri.parse(`github://${tr.encodeAuthority("github",{v:mu,ref:{type:ht.Commit,id:e}})}/${n}/${i}/${t}`)}s(rh,"getGitHubRevisionUri");class vu{constructor(e,t){this.providerService=e,this.tarPit=t,this.fileTreeCache=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),Bn&&(this.tarballProxyEndpoint=h.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"]))}get isReadonly(){return!1}get scheme(){return"github"}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(t=>tr.getProviderId(t)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(t=>t.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const t=new lt("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await h.authentication.getSession("github",gu,{forceNewSession:e}):await h.authentication.getSession("github",gu,{createIfNone:!0})}catch(o){$.error(o);try{const a=await h.authentication.getSession("github",gu,{createIfNone:!1});if(a!==void 0)return a}catch{}return new Promise(a=>{async function l(){const d=await h.authentication.getSession("github",gu,{createIfNone:!0});d!==void 0&&a(d)}s(l,"getSession");const u=h.authentication.onDidChangeSessions(async d=>{d.provider.id==="github"&&(u.dispose(),await l())})})}}s(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{t.stop()}}async getAuthentication(e){const t=await this.ensureAuthenticated();return{provider:Dp,session:t,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${t.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if(Bn){async function i(o,a){if(a.headers!==void 0){const{"user-agent":l,...u}=a.headers;l&&(a.headers=u)}return Zt(o,a)}s(i,"fetchCore"),this._octokitDefaults=sl.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=sl.defaults({auth:`token ${n.accessToken}`})}const t=new this._octokitDefaults(e);return($.logLevel===We.Debug||$.isDebugging)&&t.hook.wrap("request",async(n,i)=>{var o;const a=new lt(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let l;try{if(typeof i.query=="string"){const u=/(^[^({\n]+)/.exec(i.query);l=` ${(o=u==null?void 0:u[1].trim())!=null?o:i.query}`}}catch{}a.stop({message:l})}}),t}async graphql(e,t){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,t)}catch(n){throw this.handleRequestErrors(n),n}}async request(e,t){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,t)}catch(n){throw this.handleRequestErrors(n),n}}handleRequestErrors(e){var t,n;if(e instanceof Zi)switch(e.status){case 500:return e.response&&en.showGitHubStatus500Message(),!0;case 401:return en.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return en.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof Ls&&((n=(t=e.errors)==null?void 0:t[0])==null?void 0:n.type)==="FORBIDDEN")return en.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,t,n,i){return new Tp(this.providerService,e,t,n,i,this)}async createMetadata(e,t){var n,i,o,a,l,u;const d=new lt(`GitHub.createMetadata(${e.toString()}, ${t})`);let _;try{let{provider:R,name:A,repo:{owner:P,name:M},ref:k}=Bs(e);(!k||k.type===ht.Commit&&/HEAD/i.test(k.id))&&(k={type:ht.Commit,id:"HEAD"});const B=this.providerService.isInWorkspace(e);let U,H;Ne.get("experimental.prefetch")&&B&&(t?U=t:(k.type===ht.Commit||k.type===ht.Tree)&&(U=k.id),U&&(d.log({suffix:` \u2022 Prefetching tree for ${U}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(Ie=>H=Ie),repo:{owner:P,name:M},HEAD:{sha:U},timestamp:Date.now()}})));const re=await this.getRepositoryInfo(P,M,B,k.type===ht.PullRequest?{pr:Number(k.id)}:{ref:k.id});if(re===void 0)throw _=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let Y;if(t)Y=t;else if(k.type===ht.Commit||k.type===ht.Tree&&re.ref===void 0)Y=k.id;else if(Y=(i=(n=re.ref)==null?void 0:n.sha)!=null?i:re.defaultBranch.sha,Y===void 0)throw _=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let he;if(((o=re.ref)==null?void 0:o.prefix)==="refs/heads/")he={type:Le.Branch,name:re.ref.name,sha:Y,branch:{name:re.ref.name,sha:re.ref.sha}};else if(((a=re.ref)==null?void 0:a.prefix)==="refs/remotes/"){if(!re.ref.remote)throw _=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);he={type:Le.RemoteBranch,name:`${re.ref.remote.repo.owner}${re.ref.remote.repo.name!==M?`/${re.ref.remote.repo.name}`:""}:${re.ref.name}`,sha:Y,branch:{name:re.ref.name,sha:re.ref.sha,remote:re.ref.remote}}}else((l=re.ref)==null?void 0:l.prefix)==="refs/tags/"?he={type:Le.Tag,name:re.ref.name,sha:Y,detached:{type:Le.Tag,name:re.ref.name}}:he={type:Le.Commit,name:qt(Y),sha:Y,detached:{type:Le.Commit,name:qt(Y)}};if(U!==void 0&&U!==he.sha){const Ie=this.asFileTreeKey(e,U),Ae=this.fileTreeCache.get(Ie);Ae&&!mr(U)&&he.sha===((u=he.branch)==null?void 0:u.sha)?(d.log({suffix:` \u2022 Updating prefetched tree for ${U}, since HEAD was resolved; HEAD=${he.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,he.sha),Ae),this.fileTreeCache.delete(Ie)):(d.log({suffix:` \u2022 Removing prefetched tree for ${U}, since the HEAD changed; HEAD=${he.sha}`}),this.fileTreeCache.delete(Ie),Ae==null||Ae.dispose())}const De={version:ze.schemaVersion,timestamp:Date.now(),provider:R,name:A,repo:re.repo,user:re.user,accessLevel:re.accessLevel,HEAD:he,defaultBranch:re.defaultBranch,pullRequest:re.pullRequest};return _=` \u2022 HEAD=${he.sha}`,H==null||H(De),De}finally{d.stop(_?{suffix:_}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:$s("open repo from","Open Repository from {0}","GitHub"),placeholder:$s("pick repo","Choose a repository"),provideSources:async(e,t,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchRepositoriesQuery(n,{...i,user:o})).map(u=>({providerId:"github",name:u.repoWithOwner,icon:"$(repo)",description:`${u.fork?`$(repo-forked) ${u.fork}`:""}${u.stars>0?`${u.fork?" \u2022 ":""}$(star-full) ${u.stars}`:""}`,detail:u.description,url:u.url}))}},{name:"GitHub",icon:"$(github)",label:$s("open pr from","Open Pull Request from {0}","GitHub"),placeholder:$s("pick pr","Choose a pull request"),provideSources:async(e,t,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchPullRequestsQuery(n,{user:o})).map(u=>({providerId:"azurerepos",name:u.title,icon:"$(git-pull-request)",description:u.reasons.length!==0?u.reasons.sort().join(", "):void 0,detail:`${u.repoWithOwner} #${u.number}`,url:u.url}))}}]}canOpenRemoteUrl(e){const t=Rp.exec(e);if((t==null?void 0:t.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:a}=t.groups;return o?Pt.PullRequest:i?Pt.Commit:a?Pt.Branch:n?Pt.File:Pt.Repository}async createWorkspaceForRemoteUrl(e,t=ir.CurrentWindow){const n=Rp.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:a,commit:l,pull:u,tree:d,fragment:_}=n.groups;const R=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,d!=null?d:a);if(R===void 0)return;let A,P;if({owner:i,repo:o,ref:P,path:A}=R,d||a){if(A&&_&&a){const B=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(_);if(B==null?void 0:B.groups){const{start:U,end:H}=B.groups;A+=`:${U}${H!==void 0?`-${H}`:""}`}}}else l?P={type:ht.Commit,id:l}:u&&(P={type:ht.PullRequest,id:u});const M=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:P});return{name:(await this.getMetadata(M)).name,uri:M,location:t,filesToOpen:A?[A]:void 0}}createVirtualUri(e,{repo:t,ref:n,idx:i},o){const a=n!==void 0||i!==void 0?{v:mu}:void 0;return a&&(n&&(a.ref={...n,type:n.type===ht.Branch||n.type===ht.Tag?ht.Tree:n.type}),i&&(a.idx=i)),e.with({authority:tr.encodeAuthority("github",a),path:`/${t.owner}/${t.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const t=`https://github.com/${e.repo.owner}/${e.repo.name}`,n=e.path?"blob":"tree",i=e.path?`/${e.path}`:"";return e.clone?h.Uri.parse(`${t}.git`):e.pullRequest?h.Uri.parse(`${t}/pull/${e.pullRequest.id}`):e.branch?h.Uri.parse(`${t}/${n}/${e.branch}${i}`):e.tag?h.Uri.parse(`${t}/${n}/${e.tag}${i}`):e.sha?h.Uri.parse(`${t}/${n}/${e.sha}${i}`):h.Uri.parse(t)}getProviderRootUri(e){return vy(e)}getRelativeFilePath(e,t){const{path:n}=Bs(e),{path:i}=Bs(tt(e,t));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:t,name:n,repo:i,ref:o}=Bs(e);return{provider:t,name:n,repo:i,ref:o}}async getModeRefType(e,t){const{HEAD:n,pullRequest:i}=await(t!=null?t:this.getMetadata(e));switch(n.type){case Le.Branch:return i!==void 0?se.PullRequestBranch:se.Branch;case Le.RemoteBranch:return i!==void 0?se.PullRequestRemoteBranch:se.RemoteBranch;case Le.Tag:return se.Tag;case Le.Commit:return se.Commit}}async createBranch(e,t,n,i){try{const{repo:{owner:o,name:a}}=i!=null?i:await this.getMetadata(e);return t.startsWith("refs/heads/")||(t=`refs/heads/${t}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:a,ref:t,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof Zi&&o.status===422?o.message==="Reference already exists"?new Me(o,!0):new Me(o,!1):($.error(o),o)}}async createAndPushCommit(e,t,n,i,o){var a;const l=new lt(`GitHub.createAndPushCommit(${e.toString()}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);if(n=n.filter(d=>d.fileType===h.FileType.File),n.length===0)throw l.stop({message:"Aborted; No changes to commit"}),new Tt("No changes to commit");let u;try{const d=await this.getMetadata(e);let _;if(i!==void 0)_=i;else{if(d.HEAD.detached&&!d.HEAD.branch)throw new $e("Unable to commit; no current branch");_=d.HEAD.branch.name}let R;if(o)R=`${o.repo.owner}/${o.repo.name}`;else if(d.HEAD.type===Le.RemoteBranch&&d.HEAD.branch.remote.accessLevel>=Ze.Write){const{owner:U,name:H}=d.HEAD.branch.remote.repo;R=`${U}/${H}`}else R=`${d.repo.owner}/${d.repo.name}`;const A=[],P=[];for(const U of n)switch(U.type){case Mt.Created:case Mt.Changed:A.push({path:U.path,contents:wn(await U.content)});break;case Mt.Deleted:P.push({path:U.path});break}const M={branch:{branchName:_,repositoryNameWithOwner:R},message:{headline:t},fileChanges:{additions:A,deletions:P},expectedHeadOid:d.HEAD.sha},k=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,B=await this.graphql(k,{commitInput:M});if(u=B==null?void 0:B.createCommitOnBranch.commit.oid,!u)throw new Jt;return i===void 0&&!d.HEAD.detached&&u!==void 0&&await this.fastForwardTo(e,u,d),u}catch(d){if(d instanceof Ls){const _=(a=d.errors)==null?void 0:a[0];if((_==null?void 0:_.type)==="STALE_DATA"&&_.message.includes("Pull and try again"))throw new mt(d)}throw $.error(d),d}finally{l.stop(u?{message:`: Created and pushed commit ${u}`}:void 0)}}async createCommit(e,t,n,i){const o=new lt(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(l=>l.fileType===h.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),new Tt("No changes to commit");let a;try{const l=await this.getMetadata(e);let u,d,_;i?({repo:{owner:u,name:d}}=i,_=await this.getFileTree(this.createVirtualUri(e,i),l.HEAD.sha)):l.HEAD.type===Le.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ze.Write?({owner:u,name:d}=l.HEAD.branch.remote.accessLevel===Ze.WriteToPullRequest?l.repo:l.HEAD.branch.remote.repo,_=await this.getFileTree(this.createVirtualUri(e,{repo:l.HEAD.branch.remote.repo}),l.HEAD.sha)):({repo:{owner:u,name:d}}=l,_=await this.getFileTree(e,l.HEAD.sha));const R=await _.getTreeSha();if(!mr(R))throw new Error(`Unable to create commit based on tree sha ${R}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${l.HEAD.sha} based on tree ${R}`,suffix:" \u2022 Creating blobs..."});const A=[];async function P(U){var H;try{const re=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:u,repo:d,encoding:"base64",content:wn(await U.content),mediaType:{format:"raw"}});let Y;if(U.type===Mt.Changed){const he=await _.get(U.path);Y=(H=he==null?void 0:he.mode)!=null?H:"100644"}else Y="100644";A.push({path:U.path,mode:Y,type:"blob",sha:re.data.sha})}catch(re){throw $.error(re,`Failed to create blob for ${U.path}`),re}}s(P,"createOrUpdateBlob");const M=[];for(const U of n)switch(U.type){case Mt.Created:case Mt.Changed:{M.push(P.call(this,U));break}case Mt.Deleted:{A.push({path:U.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all(M),o.logStep("Creating tree",{message:`: Created ${M.length} blobs;`,suffix:` \u2022 Creating tree based on ${R}...`});const k=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:u,repo:d,base_tree:R,tree:A});return o.logStep("Creating commit",{message:`: Created tree ${k.data.sha};`,suffix:" \u2022 Creating commit..."}),a=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:u,repo:d,message:t,tree:k.data.sha,parents:[l.HEAD.sha]})).data.sha,a}catch(l){throw $.error(l),l}finally{o.stop(a?{message:`: Created commit ${a}`}:void 0)}}async createPullRequest(e,t,n,i,o){var a,l,u;const d=new lt(`GitHub.createPullRequest(${e.toString()}, ${t}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:_,name:R},HEAD:{branch:A},defaultBranch:P}=await this.getMetadata(e),M=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:_,repo:R,base:`refs/heads/${(a=A==null?void 0:A.name)!=null?a:P.name}`,head:o?`${o.repo.owner}:${t}`:t,title:n,draft:(l=i==null?void 0:i.draft)!=null?l:!1,maintainer_can_modify:(u=i==null?void 0:i.canMaintainerModify)!=null?u:!0});return{id:M.data.number.toString(),uri:h.Uri.parse(M.data.html_url)}}catch(_){throw $.error(_),_}finally{d.stop()}}async fetch(e,t){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,t);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,t,n){var i,o,a,l,u,d,_,R,A;const{force:P,to:M}={...n,force:t||(n==null?void 0:n.force)},k=new lt(`GitHub.fetch(${e.toString()}, force=${P}, to=${M})`);let B;try{const U=await this.getMetadata(e);if(U.HEAD.detached)return B=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:U};const H=await this.getBranchTips(e);if(!H)throw B=" \u2022 Unable to fetch branch tips",new Ut(t);if(!P&&!M&&((i=H.defaultBranch)==null?void 0:i.sha)!==void 0&&H.defaultBranch.sha===U.defaultBranch.sha&&((o=H.branch)==null?void 0:o.sha)!==void 0&&H.branch.sha===U.HEAD.branch.sha&&(U.HEAD.sha===U.HEAD.branch.sha||U.state!==void 0))return B=" \u2022 No changes detected",{fetched:!1,metadata:U};let re;if(((a=H.defaultBranch)==null?void 0:a.sha)!==void 0&&H.defaultBranch.sha!==U.defaultBranch.sha&&(re={defaultBranch:{...U.defaultBranch,sha:H.defaultBranch.sha}}),((l=H.branch)==null?void 0:l.sha)===void 0){if(B=" \u2022 Unable to find branch tip",P)throw new Ut(t);return re!==void 0?{fetched:!0,metadata:{...U,...re}}:{fetched:!1,metadata:U}}if(H.branch.sha!==U.HEAD.branch.sha&&(re={...re,HEAD:{...U.HEAD,branch:{...U.HEAD.branch,sha:H.branch.sha},detached:void 0}}),H.branch.sha===((u=n==null?void 0:n.to)!=null?u:U.HEAD.sha))return B=" \u2022 Up to date",U.state!==void 0||re!==void 0?{fetched:!0,metadata:{...U,...re,state:void 0}}:{fetched:!1,metadata:U};k.logStep("Fetching upstream changes");try{const Y=await this.getAheadBehindState(e,U,{base:(d=n==null?void 0:n.to)!=null?d:U.HEAD.sha,head:(A=(R=(_=re==null?void 0:re.HEAD)==null?void 0:_.branch)==null?void 0:R.sha)!=null?A:U.HEAD.branch.sha});return B=` \u2022 Changes detected; ${Y==null?void 0:Y.behind} commits behind`,{fetched:!0,metadata:{...U,...re,state:Y?{ahead:Y.ahead,behind:Y.behind,incomingChanges:Y.incomingChanges}:void 0}}}catch(Y){if(B=` \u2022 Failed fetching upstream changes; ${String(Y)}`,P)throw new Ut(t);return re!==void 0?{fetched:!0,metadata:{...U,...re}}:{fetched:!1,metadata:U}}}finally{k.stop(B?{suffix:B}:void 0)}}async fork(e){try{const{repo:{owner:t,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:t,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(a=>setTimeout(a,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(t){throw $.error(t),t}}async getBranches(e,t){var n,i,o;try{const{repo:{owner:a,name:l}}=await this.getMetadata(e),u=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,d=await this.graphql(u,{owner:a,repo:l,branchQuery:(n=t==null?void 0:t.query)!=null?n:"",cursor:t==null?void 0:t.cursor,limit:Math.min(100,(i=t==null?void 0:t.limit)!=null?i:100)});if(d===void 0)return{branches:[]};const _=(o=d.repository)==null?void 0:o.refs;if(_===void 0)return{branches:[]};const R=_.nodes.map(A=>({type:nn.Head,name:A.name,commit:A.target.oid,commitUrl:A.target.commitUrl}));return{paging:{cursor:_.pageInfo.endCursor,more:_.pageInfo.hasNextPage},branches:R}}catch(a){return{branches:[]}}}async getCommit(e,t){var n;try{const{HEAD:i,repo:{owner:o,name:a}}=await this.getMetadata(e),l=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;t.toUpperCase()==="HEAD"&&(t=i.sha);const u=await this.graphql(l,{owner:o,repo:a,ref:t});if(u===void 0)return;const d=(n=u.repository)==null?void 0:n.object;return d===void 0?void 0:{hash:d.oid,message:d.message,parents:d.parents.nodes.map(_=>_.oid),authorDate:new Date(d.author.date),authorEmail:d.author.email,authorName:d.author.name,commitDate:new Date(d.committer.date)}}catch(i){return}}async getCommits(e,t){var n,i,o;try{const{HEAD:a,repo:{owner:l,name:u}}=await this.getMetadata(e),d=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let _=t==null?void 0:t.ref;(_==null?void 0:_.toUpperCase())==="HEAD"&&(_=a.sha);const R=await this.graphql(d,{owner:l,repo:u,ref:_,cursor:t==null?void 0:t.cursor,path:t==null?void 0:t.path,limit:Math.min(100,(n=t==null?void 0:t.limit)!=null?n:100)});if(R===void 0)return;const A=(o=(i=R.repository)==null?void 0:i.object)==null?void 0:o.history;if(A===void 0)return;const P=A.nodes.map(M=>({hash:M.oid,message:M.message,parents:M.parents.nodes.map(k=>k.oid),authorDate:new Date(M.author.date),authorEmail:M.author.email,authorName:M.author.name,commitDate:new Date(M.committer.date)}));return{paging:{cursor:A.pageInfo.endCursor,more:A.pageInfo.hasNextPage},commits:P}}catch(a){return}}async getBlobContent(e,t){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:t});return _a(n.data.content)}catch(n){throw $.logLevel===We.Debug&&$.error(n),n}}async getFileContent(e,t,n){try{let i;if(t&&n&&!this.hasFileTree(e,t)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let a=(0,m0.dirname)(n);(a==="."||a==="/")&&(a=""),i=await(await this.getFileTree(o,t,{path:a,cache:!1,recursive:!1})).get(n)}else{const[o,{path:a}]=await Promise.all([this.getFileTree(e,t),n?{path:void 0}:this.providerService.getMetadata(e)]);i=await o.get(n!=null?n:a)}if((i==null?void 0:i.sha)===void 0)throw h.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw $.logLevel===We.Debug&&$.error(i),i}}async getFileList(e,t,n){const i=new lt(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:a},HEAD:{sha:l}}=await this.getMetadata(e),u=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:a,treeish:`${n!=null?n:l}${t?`:${t}`:""}`});return u.status!==200?[]:u.data}catch(o){return $.error(o),[]}finally{i.stop()}}hasFileTree(e,t){return t?this.fileTreeCache.has(this.asFileTreeKey(e,t)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,t,n){var i,o,a,l,u;const d=this.providerService.isInWorkspace(e);let _=(i=n==null?void 0:n.cache)!=null?i:d,R,A,P;if(_||!t){const U=(a=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?a:this.getMetadata(e);R=d?this.getFileTreePermissions(e,U):void 0;let H;({repo:A,HEAD:{sha:H},timestamp:P}=(l=n==null?void 0:n.prefetched)!=null?l:await U),t&&H!==t?(_=!1,P=Date.now()):t=H}else({repo:A}=(u=n==null?void 0:n.prefetched)!=null?u:this.providerService.getVirtualUriMetadata(e)),P=Date.now();const M=this.asFileTreeKey(e,t),k=this.providerService.getProviderRootUri(e),B=new lt(`GitHub.getFileTree(${M}): ${e.toString()}`,{log:!1,logLevel:We.Debug});try{let U=s(function(){var re;const Y=new lt(`GitHub.createFileTree(${M})`);let he,De;_&&d&&(he=new h.EventEmitter,De=h.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>he.fire()),this.tarPit.onDidDownloadTar(Ae=>he.fire({rootUri:this.providerService.getProviderRootUri(Ae.rootUri),sha:Ae.sha}))));const Ie={dispose:()=>De==null?void 0:De.dispose(),permissions:R,getContent:Ae=>this.getBlobContent(A,Ae.sha),getTree:async(Ae,Ye)=>{const Pe=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:A.owner,repo:A.name,recursive:Ye?"1":void 0,tree_sha:`${t}${Ae?`:${Ae}`:""}`});return Pe.data.truncated?{sha:Pe.data.sha,truncated:!0}:{sha:Pe.data.sha,truncated:!1,tree:rr(Pe.data.tree,qe=>{var rt;return{path:qe.path,item:{mode:qe.mode,sha:qe.sha,stat:{type:_y(qe.type),size:(rt=qe.size)!=null?rt:0,ctime:0,mtime:P,permissions:void 0}}}})}},onDidTriggerContentCaching:he==null?void 0:he.event,tryCachingContent:_&&d?async Ae=>{const Ye=Ne.get("experimental.fs.useTars");if(Ye!=="always"&&Ye!=="ifAvailable")return!1;const Pe=new lt(`FileTree.loadAllContent(${t})`);let qe;try{let rt;if(Ye==="ifAvailable"){if(Pe.logStep("Tar cache query"),rt=await this.tarPit.getCachedTar(k,t),rt===void 0)return qe=" \u2022 No cached Tar",!1}else Pe.logStep("Tar query"),rt=await this.tarPit.getTar(k,t);Pe.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const Nt of rt.entries){const cn=Ae(Nt.header.fullFileName);if(cn===void 0)continue;const Wn=Nt.dataAsBytes;cn.getContent=()=>Wn}return!0}catch(rt){return qe=` \u2022 Failed ${String(rt)}`,!1}finally{Pe.stop(qe?{suffix:qe}:void 0)}}:void 0};try{return new eh(k,t,P,Ie,{path:n==null?void 0:n.path,recursive:(re=n==null?void 0:n.recursive)!=null?re:_,preload:_||(n==null?void 0:n.recursive)})}catch(Ae){return $.error(Ae),new eh(k,t,P,void 0)}finally{Y.stop()}},"createFileTree"),H=this.fileTreeCache.get(M);return H!==void 0||(H=U.call(this),_&&this.fileTreeCache.set(M,H)),H}finally{B.stop()}}async getFileTreePermissions(e,t){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,t)).display===ie.Edit)return;const i=await this.providerService.getIndexMetadata(e);return Er.isActive(i)?h.FilePermission.Readonly:void 0}async getFork(e){var t,n,i;try{const{repo:{owner:o,name:a}}=await this.getMetadata(e),l=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,u=await this.graphql(l,{owner:o,repo:a});if(u===void 0)return;const[d]=(i=(n=(t=u.repository)==null?void 0:t.forks)==null?void 0:n.nodes)!=null?i:[];return d===void 0?void 0:{name:`${d.owner.login}/${d.name}`,repo:{owner:d.owner.login,name:d.name},url:d.url}}catch(o){return}}async getIncomingChanges(e){var t,n;return(n=(t=(await this.getMetadata(e)).state)==null?void 0:t.incomingChanges)!=null?n:[]}async compareCommits(e,t){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:t.base,head:t.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,t,n){var i,o,a,l,u;const{base:d,head:_}={base:t.HEAD.sha,head:(i=t.HEAD.branch)==null?void 0:i.sha,...n},R=new lt(`GitHub.getAheadBehindState(${e.toString()}, base=${d}, head=${_})`);let A,P;try{if(!_){A=` \u2022 Skipped; Unsupported HEAD type (${t.HEAD.type})`;return}const M=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:t.repo.owner,repo:t.repo.name,base:d,head:_}),k=[];for(const B of(o=M.data.files)!=null?o:[])switch(B.status){case"added":case"copied":k.push({uri:h.Uri.joinPath(e,B.filename),type:Mt.Created});break;case"removed":k.push({uri:h.Uri.joinPath(e,B.filename),type:Mt.Deleted});break;case"modified":k.push({uri:h.Uri.joinPath(e,B.filename),type:Mt.Changed});break;case"renamed":k.push({uri:h.Uri.joinPath(e,B.filename),type:Mt.Created}),k.push({uri:h.Uri.joinPath(e,B.previous_filename),type:Mt.Deleted});break;default:$.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${d}, head=${_}): Unknown file status encountered '${B.status}'`);break}return P={ahead:(a=M.data.behind_by)!=null?a:0,behind:(l=M.data.ahead_by)!=null?l:0,incomingChanges:k},P}catch(M){throw A=` \u2022 Failed; ${String(M)}`,$.error(M),M}finally{R.stop({suffix:A!=null?A:` \u2022 ${(u=P==null?void 0:P.behind)!=null?u:0} commits behind`})}}async getObjectDetails(e,t,n){var i;try{const o=await this.getFileTree(e,t);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const a=await o.get(n);if((a==null?void 0:a.mode)===void 0||(a==null?void 0:a.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${t}`);return{mode:a.mode,object:a.sha,size:(i=a.stat.size)!=null?i:0}}catch(o){throw $.error(o),o}}async getPullRequest(e,t){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,t)}async getPullRequestCore(e,t,n){var i,o,a,l,u,d,_;try{const R=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,A=await this.graphql(R,{owner:e,repo:t,number:Number(n)}),P=(i=A==null?void 0:A.repository)==null?void 0:i.pullRequest;return P?{author:{name:P.author.login,avatarUrl:P.author.avatarUrl,url:P.author.url},closedAt:P.closedAt?new Date(P.closedAt):void 0,mergedAt:P.mergedAt?new Date(P.mergedAt):void 0,id:P.number.toString(),repo:{name:P.repository.name,owner:P.repository.owner.login},state:nh(P.state),title:P.title,updatedAt:new Date(P.updatedAt),url:P.permalink,refs:{base:{owner:P.baseRepository.owner.login,repo:P.baseRepository.name,branch:P.baseRefName,sha:P.baseRefOid,exists:P.baseRef!=null},head:{owner:(u=(l=(o=P.headRepository)==null?void 0:o.owner.login)!=null?l:(a=P.headRepositoryOwner)==null?void 0:a.login)!=null?u:"<unknown>",repo:(_=(d=P.headRepository)==null?void 0:d.name)!=null?_:P.baseRepository.name,branch:P.headRefName,sha:P.headRefOid,exists:P.headRef!=null}}}:void 0}catch(R){$.error(R);return}}async getPullRequestForBranch(e,t,n){var i,o,a,l,u;try{const{repo:{owner:d,name:_}}=await this.getMetadata(e),R=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,A=await this.graphql(R,{owner:d,repo:_,branch:t,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:yy(n==null?void 0:n.include)}),P=(u=(l=(a=(o=A==null?void 0:A.repository)==null?void 0:o.refs.nodes[0])==null?void 0:a.associatedPullRequests)==null?void 0:l.nodes)==null?void 0:u.filter(k=>!k.repository.isFork||k.repository.owner.login===d);if(P==null||P.length===0)return;P.length>1&&P.sort((k,B)=>(k.repository.owner.login===d?-1:1)-(B.repository.owner.login===d?-1:1)||(k.state==="OPEN"?-1:1)-(B.state==="OPEN"?-1:1)||new Date(B.updatedAt).getTime()-new Date(k.updatedAt).getTime());const[M]=P;return{author:{name:M.author.login,avatarUrl:M.author.avatarUrl,url:M.author.url},closedAt:M.closedAt?new Date(M.closedAt):void 0,mergedAt:M.mergedAt?new Date(M.mergedAt):void 0,id:M.number.toString(),repo:{name:M.repository.name,owner:M.repository.owner.login},state:nh(M.state),title:M.title,updatedAt:new Date(M.updatedAt),url:M.permalink}}catch(d){$.error(d);return}}async getTags(e,t){var n,i,o;try{const{repo:{owner:a,name:l}}=await this.getMetadata(e),u=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,d=await this.graphql(u,{owner:a,repo:l,tagQuery:(n=t==null?void 0:t.query)!=null?n:"",cursor:t==null?void 0:t.cursor,limit:Math.min(100,(i=t==null?void 0:t.limit)!=null?i:100)});if(d===void 0)return{tags:[]};const _=(o=d.repository)==null?void 0:o.refs;if(_===void 0)return{tags:[]};const R=_.nodes.map(A=>({type:nn.Tag,name:A.name,commit:A.target.oid,commitUrl:A.target.commitUrl}));return{paging:{cursor:_.pageInfo.endCursor,more:_.pageInfo.hasNextPage},tags:R}}catch(a){return{tags:[]}}}async getTarGz(e){const{repo:{owner:t,name:n},HEAD:{sha:i}}=await this.getMetadata(e),o=await this.ensureAuthenticated();return h.window.withProgress({location:h.ProgressLocation.Notification,cancellable:!0,title:$s("fetching index","Fetching search index...")},async(a,l)=>{try{if(Bn){let _;try{const M=await this.tarballProxyEndpoint;M!==void 0&&(_=M.replace("{owner}",t).replace("{repo}",n).replace("{sha}",i))}catch{}if(!_)throw new Error("Workbench embedder must set `_tarballProxyEndpoints` in workbench construction options to enable GitHub fulltext search.");const A=await(await Ir(_,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"},l)).text(),P=await Ir(A,{},l);return new Uint8Array(await P.arrayBuffer())}const u=`https://api.github.com/repos/${t}/${n}/tarball/${i}`,d=await Ir(u,{headers:{Authorization:`Bearer ${o.accessToken}`}},l);return new Uint8Array(await d.arrayBuffer())}catch(u){throw $.error(u),u}})}async pushCommit(e,t,n,i){const o=new lt(`GitHub.pushCommit(${e.toString()}, sha=${t}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let a;try{const l=await this.getMetadata(e);let u,d;if(i?{repo:{owner:u,name:d}}=i:l.HEAD.type===Le.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ze.Write?{owner:u,name:d}=l.HEAD.branch.remote.repo:{repo:{owner:u,name:d}}=l,n===void 0&&l.HEAD.detached)throw new $e("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const _=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:u,repo:d,ref:`heads/${n!=null?n:l.HEAD.branch.name}`,sha:t});return n===void 0&&!l.HEAD.detached&&await this.fastForwardTo(e,t,l),a=_.data.ref,a}catch(l){throw l instanceof Zi&&l.status===422&&l.message.includes("Update is not a fast forward")?new mt(l):($.error(l),l)}finally{o.stop(a?{message:`: Pushed commit to ${a}`}:void 0)}}async queryRepositoryObject(e,t,n,i){var o,a;try{const{repo:{owner:l,name:u},HEAD:{sha:d},path:_}=await this.providerService.getMetadata(e),R=`query ${t}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,A=await this.graphql(R,{owner:l,repo:u,expression:i!=null?i:`${d}:${_}`});return(a=(o=A==null?void 0:A.repository)==null?void 0:o.object)!=null?a:void 0}catch(l){$.error(l);return}}async repositoryObjectExists(e,t){return await this.queryRepositoryObject(e,"exists","			__typename",t)!==void 0}async searchPullRequestsQuery(e,t){try{let n=s(function(l,u){return{number:l.number,title:l.title,repoWithOwner:l.repository.nameWithOwner,reasons:u?[u]:[],url:l.url}},"toResult");const i=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(t==null?void 0:t.user)&&(e+=` user:${t.user}`);const o=await this.graphql(i,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return o===void 0?[]:Yd([...o.assigned.nodes.map(l=>n(l,"assigned")),...o.reviewRequested.nodes.map(l=>n(l,"review requested")),...o.mentioned.nodes.map(l=>n(l,"mentioned")),...o.authored.nodes.map(l=>n(l,"authored")),...Yn(o.viewer.repositories.nodes,l=>l.pullRequests.nodes.map(u=>n(u)))],l=>l.url,(l,u)=>(u.reasons.length!==0&&l.reasons.push(...u.reasons),l))}catch(n){return[]}}async searchRepositoriesQuery(e,t){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(t==null?void 0:t.user)&&(e+=` user:${t.user}`),(t==null?void 0:t.sort)&&(e+=` sort:${t.sort}`),e+=" fork:true";const i=await this.graphql(n,{search:e.trim()});return i===void 0?[]:Yd((t==null?void 0:t.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],a=>a.url).map(a=>{var l,u,d;return{repoWithOwner:a.nameWithOwner,description:(l=a.description)!=null?l:void 0,url:a.url,fork:(d=(u=a.parent)==null?void 0:u.nameWithOwner)!=null?d:void 0,stars:a.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(e,t,n){var i,o,a;const{repo:{owner:l,name:u},HEAD:d,defaultBranch:_}=await this.getMetadata(t),R=[];((i=d.branch)==null?void 0:i.name)!==_.name&&R.push($s("Cant search branch","Unable to search {0} without index, falling back to {1}.",(a=(o=d.branch)==null?void 0:o.name)!=null?a:d.detached.name,_.name));try{const P=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${l}/${u}`}),M=new h.Range(0,0,0,0),k=[];let B=0,U;for(const H of P.data.items)for(const re of H.text_matches){if(B++,n.maxResults!==void 0&&B>n.maxResults)return{matches:k,limitHit:!0};U={path:H.path,ranges:[],preview:re.fragment,matches:[]};for(const Y of re.matches){let he=0,De=0,Ie=0;for(let Ae=0;Ae<Y.indices[1];Ae++)Ae===Y.indices[0]&&(De=Ie),re.fragment[Ae]===`
`?(he++,Ie=0):Ie++;U.ranges.push(M),U.matches.push(new h.Range(he,De,he,Ie))}k.push(U)}return{matches:k,limitHit:!1,warnings:R}}catch(A){return{matches:[],limitHit:!0}}}async switchTo(e,t,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let l;if(!(t!==void 0&&(typeof t=="string"?(t==null?void 0:t.startsWith("refs/heads/"))?(l={type:ht.Tree,id:t.substr(11)},t=t.substr(11)):(t==null?void 0:t.startsWith("refs/tags/"))?l={type:ht.Tree,id:t.substr(10)}:l={type:ht.Tree,id:t}:l={...t,type:t.type===ht.Branch||t.type===ht.Tag?ht.Tree:t.type},(a==null?void 0:a.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?ir.NewWindow:ir.CurrentWindow}}async sync(e,t,n){var i,o,a,l,u,d;const _=new lt(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let R;try{const{metadata:A}=await this.fetchCore(e,!0,{to:n.to});if(A.HEAD.detached){R=" \u2022 Skipped; detached HEAD";return}if(((o=(i=A==null?void 0:A.state)==null?void 0:i.behind)!=null?o:0)>0&&await t.hasChanges(e)){_.logStep("Fetching upstream changes");const P=[],M=(l=(a=A.state)==null?void 0:a.incomingChanges)!=null?l:[];if(M.length>0){const k=await t.getChanges(e);for(const B of k){const U=this.providerService.getRelativeFilePath(e,B.uri),H=M.find(re=>re.uri.path===U);if(H!==void 0){P.push({path:U,current:B,incomingType:H.type});break}}}if(P.length>0)switch(n.conflictResolution){case Mr.KeepCurrent:_.logStep("Syncing (keep) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const k of P)await t.keep(k.current.uri,{type:k.incomingType,providerUri:rh(A,A.HEAD.branch.sha,k.path)});break;case Mr.DiscardCurrent:_.logStep("Syncing (discard) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const k of P)await t.discard(k.current.uri);break;case Mr.Merge:_.logStep("Syncing (merge) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const k of P)await t.merge(k.current.uri,{type:k.incomingType,providerUri:rh(A,A.HEAD.branch.sha,k.path)},{providerUri:rh(A,A.HEAD.sha,k.path)});break;case Mr.Abort:default:throw _.logStep("Syncing (abort) upstream changes",{message:`: ${P.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,A),new gr}}R=` \u2022 to=${(u=n.to)!=null?u:A.HEAD.branch.sha}`,await this.fastForwardTo(e,(d=n.to)!=null?d:A.HEAD.branch.sha,A)}finally{_.stop(R?{suffix:R}:void 0)}}async fastForwardTo(e,t,n){if(n.HEAD.detached)throw new $e("Unable to fast-forward; no current branch");if(n.HEAD.sha===t&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),$.log(`Fast forward to ${t}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:t},state:t!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),t!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:t})}async getBranchTips(e,t){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);t===void 0&&(o.type===Le.RemoteBranch?t=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:t=o.branch?`refs/heads/${o.branch.name}`:"");const a=Ip.exec(t);if(a==null?void 0:a.groups)return this.getRemoteBranchTips(n,i,t);const l=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,u=await this.graphql(l,{owner:n,repo:i,ref:t});if((u==null?void 0:u.repository)==null)return;const{defaultBranchRef:d,ref:_}=u.repository;return!d&&!_?void 0:{defaultBranch:d?{sha:d.target.oid}:void 0,branch:_?{sha:_.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,t,n){try{const i=Ip.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:a,remoteRef:l}=i.groups;a||(a=t);const u=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,d=await this.graphql(u,{owner:e,repo:t,remoteOwner:o,remoteRepo:a,remoteRef:l});if((d==null?void 0:d.repository)==null||(d==null?void 0:d.remote)==null)return;const{repository:{defaultBranchRef:_},remote:{ref:R}}=d;return!_&&!R?void 0:{defaultBranch:_?{sha:_.target.oid}:void 0,branch:R?{sha:R.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,t,n,i){var o,a,l,u,d,_,R,A,P,M,k,B,U,H,re,Y;try{const he=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,De=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${he}
		}
	}
}`;let Ie,Ae;try{const rt=await this.graphql(De,{owner:e,repo:t,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((rt==null?void 0:rt.repository)==null)return;({repository:Ae,viewer:{login:Ie}}=rt)}catch(rt){if((i==null?void 0:i.pr)&&rt instanceof Ls&&((l=(a=rt.errors)==null?void 0:a[0])==null?void 0:l.type)==="NOT_FOUND"&&((u=rt.errors[0])==null?void 0:u.message.includes("Could not resolve to a PullRequest"))){({repository:Ae,viewer:{login:Ie}}=rt.data);try{const Nt=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${he}
			}
		}
	}
}`,{owner:e,repo:t,pr:i==null?void 0:i.pr});if(((_=(d=Nt==null?void 0:Nt.repository)==null?void 0:d.parent)==null?void 0:_.pullRequest)==null)throw rt;Ae.pullRequest=Nt.repository.parent.pullRequest}catch{throw rt}}else throw rt}const Ye=(R=Ae.defaultBranchRef)!=null?R:void 0;if((Ye==null?void 0:Ye.name)==null)return;const Pe=Ae.pullRequest;let qe;if(Ae==null?void 0:Ae.ref)qe={prefix:Ae.ref.prefix,name:Ae.ref.name,sha:Ae.ref.target.oid};else if(Pe==null?void 0:Pe.headRef){let rt=ih(Pe.headRepository.viewerPermission);rt<Ze.Write&&Pe.maintainerCanModify&&ih(Ae.viewerPermission)>=Ze.Write&&(rt=Ze.WriteToPullRequest),qe=Pe.headRepository.owner.login===e?{prefix:"refs/heads/",name:Pe==null?void 0:Pe.headRef.name,sha:(P=(A=Pe.mergeCommit)==null?void 0:A.oid)!=null?P:Pe==null?void 0:Pe.headRefOid}:{prefix:"refs/remotes/",name:Pe==null?void 0:Pe.headRef.name,sha:(k=(M=Pe.mergeCommit)==null?void 0:M.oid)!=null?k:Pe==null?void 0:Pe.headRefOid,remote:{name:`${Pe.headRepository.owner.login}/${Pe.headRepository.name}`,accessLevel:rt,repo:{owner:Pe.headRepository.owner.login,name:Pe.headRepository.name}}}}else(Pe==null?void 0:Pe.baseRef)?(qe={prefix:"refs/heads/",name:Pe==null?void 0:Pe.baseRef.name,sha:(U=(B=Pe.mergeCommit)==null?void 0:B.oid)!=null?U:Pe==null?void 0:Pe.baseRefOid},n&&($.log("Did not find a headRef for PR, falling back to baseRef",Pe.baseRef),en.showPullRequestHeadNotFoundMessage(`${e}/${t}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(qe={prefix:"refs/heads/",name:Ye.name,sha:Ye.target.oid});return{user:Ie,repo:{owner:Ae.owner.login,name:Ae.name},accessLevel:ih(Ae.viewerPermission),ref:qe,defaultBranch:{name:Ye.name,sha:Ye.target.oid},pullRequest:Pe?{id:Pe.number.toString(),state:nh(Pe.state),title:Pe.title}:void 0}}catch(he){if(he instanceof Ls)switch((re=(H=he.errors)==null?void 0:H[0])==null?void 0:re.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&((Y=he.errors[0])==null?void 0:Y.message.includes("Could not resolve to a PullRequest"))){const Ie=new xe(he,`${e}/${t}`,`#${i==null?void 0:i.pr}`);throw n&&en.showPullRequestNotFoundMessage(Ie.name,Ie.id),Ie}const De=new ct(he,`${e}/${t}`);throw n&&en.showRepositoryNotFoundMessage(De.name),De}case"FORBIDDEN":{const De=new Dt(he,`${e}/${t}`);throw n&&en.showRepositoryForbiddenMessage(De.name),De}}$.error(he,`Failed to get repository info for '${e}/${t}'`),!this.handleRequestErrors(he)&&n&&en.showUnableToOpenRepositoryMessage(he);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,t,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:t});return[e,t]=i.data.name_with_owner.split("/"),n?{owner:e,repo:t,ref:{type:ht.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:t}}catch(i){if(i instanceof Zi)switch(i.status){case 401:throw new St(i,()=>void this.reauthenticate());case 403:throw new Dt(i,`${e}/${t}`);case 404:throw new ct(i,`${e}/${t}`);case 409:throw new It(i,`${e}/${t}`)}return}}asFileTreeKey(e,t){return`${ce(this.providerService.getProviderRootUri(e))}:${t}`}}s(vu,"GitHubRepositoryProvider"),Ap([qr()],vu.prototype,"ensureAuthenticated",1),Ap([qr()],vu.prototype,"octokit",1);function nh(r){switch(r){case"OPEN":return Ot.Open;case"CLOSED":return Ot.Closed;case"MERGED":return Ot.Merged}}s(nh,"toPullRequestState");function yy(r){if(r!==void 0)return r.map(e=>{switch(e){case Ot.Open:return"OPEN";case Ot.Closed:return"CLOSED";case Ot.Merged:return"MERGED"}})}s(yy,"fromPullRequestStates");var Ba;(function(r){r.ADMIN="ADMIN",r.MAINTAIN="MAINTAIN",r.WRITE="WRITE",r.TRIAGE="TRIAGE",r.READ="READ",r.NONE="NONE"})(Ba||(Ba={}));function ih(r){switch(r){case Ba.ADMIN:return Ze.Admin;case Ba.MAINTAIN:return Ze.Maintain;case Ba.WRITE:return Ze.Write;case Ba.TRIAGE:return Ze.Triage;case Ba.READ:return Ze.Read;default:return Ze.None}}s(ih,"permissionToAccessLevel");function _y(r){switch(r&&(r=r.toLocaleLowerCase()),r){case"blob":return h.FileType.File;case"tree":return h.FileType.Directory;default:return h.FileType.Unknown}}s(_y,"typenameToFileType");const Pp=s(class{constructor(r,e,t){this.providerService=r,this.storageService=e,this.changeStore=t,this.lock=new ua("PendingRepositoryOpenActions"),this.disposable=h.Disposable.from(r.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(r){for(const e of r){const t=await this.getAndDelete(e);(t==null?void 0:t.applyChangeset)&&await this.applyPendingChangeset(e,t.applyChangeset),(t==null?void 0:t.filesToOpen)&&this.openPendingFiles(e.uri,t.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(r){await this.changeStore.hasChanges(r.uri)?await this.providerService.fetch(r.uri):await this.providerService.sync(r.uri,this.changeStore,{reason:"invoked"})}async get(r){return this.lock.synchronizeRead(()=>this.getCore(r.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(r){$.debug(`RepositoryOpenActionsService.getAndDelete(${r.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const t=await this.getCore(r.uri);if(t!==void 0)return await this.storeCore(r.uri,void 0),t},"PendingRepositoryOpenActions.getAndDelete")}catch(e){$.error(e,`Failed to get pending actions for ${r.uri.toString()}`);return}}async openPendingFiles(r,e){if(e.length!==0){$.log(`RepositoryOpenActionsService.openPendingFiles(${r.toString()})`,e.join(","));for(let t of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(t);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),t=t.substring(0,n.index));const a=h.Uri.joinPath(r,t);let l;try{l=await h.workspace.fs.stat(a)}catch{}if((l==null?void 0:l.type)===h.FileType.Directory)h.commands.executeCommand("revealInExplorer",a);else{let u;i!==void 0&&(u={selection:new h.Range(Number(i)-1,0,o!=null?o:i,0)}),h.commands.executeCommand("vscode.open",a,u)}}}}setChangesetToApply(r,e){return $.log(`RepositoryOpenActionsService.setChangesetToApply(${r.toString()})`),this.lock.synchronizeWrite(async()=>{const t=await this.getCore(r);await this.storeCore(r,{...t,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(r,e){return $.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${r.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const t=await this.getCore(r);await this.storeCore(r,{...t,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(r,e){$.log(`RepositoryOpenActionsService.applyPendingChangeset(${r.uri.toString()})`);try{await this.changeStore.applyChangeset(r.uri,e,{save:!0})}catch(t){$.error(t,`Failed to apply pending changeset for ${r.uri.toString()}`)}}async getCore(r){return this.fromStorage(await this.storageService.get(this.getStorageKey(r)))}storeCore(r,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(r)):this.storageService.store(this.getStorageKey(r),this.toStorage(e))}getStorageKey(r){return`actions/${ne(r)}`}fromStorage(r){if(!!r)try{const e=JSON.parse(r,(t,n)=>(t==="uri"||t.endsWith("Uri"))&&Ke(n)?h.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return $.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(r){const e={schemaVersion:Pp.storageSchemaVersion,...r};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let Op=Pp;Op.storageSchemaVersion=1;const fi=(0,V.loadMessageBundle)();class kp{constructor(e,t){this.providerService=e,this.changeStore=t,this._onDidChangeFileDecorations=new h.EventEmitter,this._decorations=new Map,this.disposable=h.Disposable.from(h.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),t.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const t=e.map(({uri:n})=>(this._decorations.delete(ne(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(t),0)}async provideFileDecoration(e,t){if(e.scheme!==tr.scheme)return;const n=ne(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(u=>ne(u.uri)===n));const l=await this.changeStore.getChange(e);if(l===void 0){if(a!==void 0)switch(a.type){case Mt.Created:i={badge:"\u2193A",color:new h.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:fi("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case Mt.Deleted:i={badge:"\u2193D",color:new h.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:fi("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case Mt.Changed:i={badge:"\u2193M",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(l.conflicts)i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:fi("decoration tooltip conflicts","Merge Conflicts ({0})",Tl(l.conflicts.status))};else if(a!==void 0)switch(a.type){case Mt.Created:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case Mt.Deleted:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case Mt.Changed:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(l.type){case Mt.Created:i={badge:"A",color:new h.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:fi("decoration tooltip added","Added")};break;case Mt.Changed:i={badge:"M",color:new h.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:fi("decoration tooltip modified","Modified")};break;case Mt.Deleted:i={badge:"D",color:new h.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:fi("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}s(kp,"ScmDecorationProvider");const wy=(0,V.loadMessageBundle)();class bo{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await h.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}s(bo,"CommandQuickPickItem");var yu;(function(r){async function e(t,n,i,o,a,l){let u;Array.isArray(a)?u=a:l===void 0&&(u=[],l=a);const d=h.window.createQuickPick(),_=new ns(500),R=[_],{defaultBranch:A,HEAD:P}=await t.getMetadata(n);async function M(re){var Y;const[he,De,Ie]=await Promise.all([t.getBranches(n,{query:re,limit:100}),t.getTags(n,{query:re,limit:100}),t.getSnapshots(n)]),Ae=new Set,Ye=new Set;for(const Nt of Ie)Ae.add(Nt.hash),Ye.add(Nt.branch.name);const Pe=((l==null?void 0:l.filterBranches)?he.branches.filter(l==null?void 0:l.filterBranches):he.branches).filter(Nt=>Nt.name!==A.name),qe=wy("indexedCommit","Open indexed commit"),rt=[{iconPath:new h.ThemeIcon("layers-active"),tooltip:qe}];return[...u,...((Y=P.branch)==null?void 0:Y.name)!==A.name?[{label:`$(git-branch) ${A.name} (default)`,description:`\u2022$(git-commit) ${qt(A.sha)}${Ye.has(A.name)||Ae.has(A.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:ht.Branch,name:void 0,sha:A.sha,buttons:Ye.has(A.name)||Ae.has(A.sha)?rt:void 0}]:[],...Pe.map(Nt=>({label:`$(git-branch) ${Nt.name}`,description:`\u2022$(git-commit) ${qt(Nt.commit)}${Ye.has(Nt.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:ht.Branch,name:Nt.name,sha:Nt.commit,buttons:Ye.has(Nt.name)?rt:void 0})),...De.tags.map(Nt=>({label:`$(tag) ${Nt.name}`,description:`\u2022$(git-commit) ${qt(Nt.commit)}${Ae.has(Nt.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:ht.Tag,name:Nt.name,sha:Nt.commit,buttons:Ae.has(Nt.commit)?rt:void 0}))]}s(M,"getItems");const k=M(void 0);let B,U=!1;async function H(re){B=void 0;const Y=d.activeItems;d.items=re!=null?re:await k,U&&Y.length!==0&&(d.activeItems=d.items.filter(he=>Y.some(De=>De.label===he.label))),d.busy=!1}s(H,"setItems");try{return await new Promise(Y=>{var he;R.push(d.onDidHide(()=>Y(void 0)),d.onDidChangeValue(De=>{if(U=!1,De=De.trim(),(l==null?void 0:l.allowResetToSha)&&P.branch&&mr(De)){H([{label:`Reset $(git-branch) ${P.branch.name} to $(git-commit) ${De}`,name:P.branch.name,sha:De,type:ht.Branch}]);return}d.busy=!0;const Ie=_.debounce(De?()=>M(De):()=>k);B===void 0&&(B=Ie.then(async Ae=>H(Ae)))}),d.onDidAccept(()=>{if(d.activeItems.length!==0){const[De]=d.activeItems;Y(De)}}),d.onDidTriggerItemButton(De=>{const Ie=De.item;Ie instanceof bo||(Ie.useIndex=!0),Y(Ie)})),d.title=o,d.placeholder=i,d.matchOnDescription=!0,d.ignoreFocusOut=(he=l==null?void 0:l.ignoreFocusOut)!=null?he:!0,d.busy=!0,d.show(),B=_.debounce(async()=>k,0).then(De=>H(De))})}finally{d.dispose(),R.forEach(re=>void re.dispose())}}s(e,"show"),r.show=e})(yu||(yu={}));function oh(r,e){switch(r){case Le.Branch:case Le.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case Le.Tag:return"$(tag)";case Le.Commit:return"$(git-commit)"}}s(oh,"headTypeToCodicon");function by(r){switch(r){case wt.Active:return"$(layers-active)";case wt.Match:return"$(layers-dot)";case wt.Indexed:return"$(layers)"}}s(by,"indexTypeToCodicon");function Ey(r,e){switch(r){case Le.Branch:case Le.RemoteBranch:return e?new h.ThemeIcon("git-pull-request"):new h.ThemeIcon("git-branch");case Le.Tag:return new h.ThemeIcon("tag");case Le.Commit:return new h.ThemeIcon("git-commit")}}s(Ey,"headTypeToThemeIcon");const je=(0,V.loadMessageBundle)(),Sy=new TextDecoder;class Np{constructor(e,t,n,i){this.providerService=e,this.changeStore=t,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new h.EventEmitter,this._onDidOpenRepository=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=h.Disposable.from(Ne.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:a})=>{const l=this.getScmProvider(this.providerService.getVirtualUri(a.uri));l!==void 0&&await this.updateStatusBarCommands(l,void 0)}),this.providerService.onDidSyncRepository(async({repository:a,syncing:l})=>{const u=this.getScmProvider(this.providerService.getVirtualUri(a.uri));u!==void 0&&await this.updateStatusBarCommands(u,{syncing:l})}),this.providerService.onDidRefresh(a=>{for(const l of a)this.update(l)}),this.changeStore.onDidChange(a=>this.update(a[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=Ne.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){Ne.changed(e,"staging")&&(this._staging=void 0,Ne.changed(e,"staging.enabled")&&this.refresh()),Ne.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const t of e.added){const n=await this.update(t.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const t of e.removed){const n=this._scmProviders.findIndex(i=>ne(i.sourceControl.rootUri)===ne(t.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),yn(ni.HasWriteableScmProvider,this._scmProviders.some(t=>!t.isReadonly))}registerCommands(){return[h.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),h.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),h.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e)}),h.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(Mp(e)){const o=e.resourceStates.filter(cl);if(o.length!==0){if(await sh(o))for(const a of o)await this.changeStore.discard(a.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const t=this.getSourceControlFrom(e);if((t==null?void 0:t.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(t.rootUri);await sh(n)?await this.changeStore.discardAll(t.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),h.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const t of e)!cl(t)||(this.telemetryService.sendEvent("command.discardChanges"),await sh([t])?await this.changeStore.discard(t.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),h.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const t=this.getSourceControlFrom(e);(t==null?void 0:t.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(t.rootUri))}),h.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const t of e)!cl(t)||(this.telemetryService.sendEvent("command.stageChanges"),await this.changeStore.stage(t.resourceUri))}),h.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const t=this.getSourceControlFrom(e);if((t==null?void 0:t.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(t.rootUri)}),h.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const t of e)!cl(t)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.changeStore.unstage(t.resourceUri))}),h.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const t of e)!cl(t)||(this.telemetryService.sendEvent("command.keepChanges"),await this.changeStore.keep(t.resourceUri))}),h.commands.registerCommand("remoteHub.openChanges",e=>{var t;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void h.commands.executeCommand(n.command,...(t=n.arguments)!=null?t:[])}),h.commands.registerCommand("remoteHub.openFile",async(...e)=>{var t;for(const n of e)if(ah(n)){const i=n,o=this.changeStore.resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:h.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await h.commands.executeCommand(o.command,...(t=o.arguments)!=null?t:[])}else if(n instanceof h.Uri){this.telemetryService.sendEvent("command.openFile");const i=n;await h.window.showTextDocument(i)}}),h.commands.registerCommand("remoteHub.createBranch",async e=>{await is("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),h.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var t;const n=(t=e==null?void 0:e.uri)!=null?t:await ll(this._scmProviders,je("choose repo for create branch placeholder","Choose which repository to create a new branch on"),je("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<Ze.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),h.window.showErrorMessage(je("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const P=await yu.show(this.providerService,n,je("choose branch for create placeholder","Choose which branch to create the new branch from"),je("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!P){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=P.sha,a=Boolean(P.useIndex)}let l;try{l=await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>_u(this.providerService,n,o,je("create branch","Please provide a new branch name"),je("create branch placeholder","New branch name"),je("create branch title","Create Branch \u2022 {0}",i.name)))}catch(P){$.error(P),h.window.showErrorMessage(je("unable to create branch","Unable to create the new branch."));return}if(!l){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const u=await this.providerService.switchTo(n,{type:ht.Branch,id:l});if(!u)return;const d=await this.changeStore.createChangeset(n);d&&await this.openActionsService.setChangesetToApply(u.uri,d);const _=je("switch to branch prompt open","Switch to Branch"),R=je("switch to branch prompt open in new window","Open in New Window"),A=await h.window.showInformationMessage(je("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,l),{modal:!0,useCustom:!0},_,R);!A||(u.location=A===R?ir.NewWindow:ir.CurrentWindow,a&&await Ne.setMode(u.uri,de.getIndexDefault(se.Branch)),await Un(u,{skipChangesPrompt:!0}))}),h.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let t;const n=h.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await h.window.showOpenDialog({openLabel:je("open patch","Open Patch"),title:je("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;t=Sy.decode(await h.workspace.fs.readFile(i[0]))}else t=n.document.getText();try{await this.changeStore.applyPatch(e.rootUri,t)}catch{h.window.showErrorMessage(je("invalid patch file","Invalid patch file"))}}),h.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const t=Array.isArray(e)?e:[e];for(const n of t){const i=this.getSourceControlFrom(n);if((i==null?void 0:i.rootUri)===void 0)return;let o;ah(n)&&(o=n.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const a=await this.changeStore.createPatch(i.rootUri,o),l=await h.workspace.openTextDocument({language:"diff",content:a});await h.window.showTextDocument(l)}}),h.commands.registerCommand("remoteHub.switchToBranch",async e=>{var t,n;const i=(t=e==null?void 0:e.uri)!=null?t:await ll(this._scmProviders,je("choose repo for switch branch placeholder","Choose which repository to switch branches on"),je("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=Ze.Write&&o.push(new bo(Kn({command:"remoteHub.createBranch",title:je("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new bo(Kn({command:"remoteHub.createBranchFrom",title:je("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),a.HEAD.type){case Le.Branch:o.push(new bo(Kn({command:"remoteHub.openOnRemote",title:je("open branch on remote command","$(globe) Open Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case Le.RemoteBranch:o.push(new bo(Kn({command:"remoteHub.openOnRemote",title:je("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case Le.Tag:o.push(new bo(Kn({command:"remoteHub.openOnRemote",title:je("open tag on remote command","$(globe) Open Tag on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case Le.Commit:o.push(new bo(Kn({command:"remoteHub.openOnRemote",title:je("open commit on remote command","$(globe) Open Commit on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const l=(n=a.HEAD.branch)==null?void 0:n.name,u=Boolean(l&&!await this.changeStore.hasChanges(i)),d=await yu.show(this.providerService,i,je("choose switch branch placeholder","Choose which branch to switch to"),je("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:u,filterBranches:l?_=>_.name!==l:void 0,ignoreFocusOut:!1});if(!d){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return d instanceof bo?void d.execute():u&&d.type===ht.Branch&&d.name===l&&d.sha?h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,this.changeStore,{to:d.sha})}catch(_){$.error(_),h.window.showErrorMessage(je("reset failed","Unable to reset the repository to commit '{0}'.",qt(d.sha)))}}):void h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const _=await this.providerService.switchTo(i,d.name?{type:d.type,id:d.name}:void 0);if(_!==void 0){if(d.useIndex){const R=await this.providerService.getModeRefType(_.uri);await Ne.setMode(_.uri,de.getIndexDefault(R))}return Un(_)}})}),h.commands.registerCommand("remoteHub.fetch",async e=>{var t;const n=(t=e==null?void 0:e.uri)!=null?t:await ll(this._scmProviders,je("choose repo for fetch placeholder","Choose which repository to fetch"),je("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){h.window.showErrorMessage(je("fetch failed","Unable to fetch repository"))}}}),h.commands.registerCommand("remoteHub.fetchAll",async e=>{const t=this.providerService.repositories;if(t.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of t)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&h.window.showErrorMessage(t.length?je("fetch all failed","Unable to fetch repositories"):je("fetch failed","Unable to fetch repository"))}),h.commands.registerCommand("remoteHub.pull",async e=>{var t;const n=(t=e==null?void 0:e.uri)!=null?t:await ll(this._scmProviders,je("choose repo for pull placeholder","Choose which repository to pull"),je("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),h.commands.registerCommand("remoteHub.sync",async e=>{var t;const n=(t=e==null?void 0:e.uri)!=null?t:await ll(this._scmProviders,je("choose repo for sync placeholder","Choose which repository to sync"),je("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),h.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),Ne.updateEffective("commitDirectlyWarning",Q.Off)})]}async sync(e,{pull:t,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,n))}catch(i){if(i instanceof gr){const o={title:je("sync confirm","Continue")},a={title:je("sync cancel","Cancel"),isCloseAffordance:!0};await h.window.showWarningMessage(t?je("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):je("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,a)===o?await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,{conflictResolution:Mr.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw $.error(i),this.telemetryService.sendException(i),h.window.showErrorMessage(je("sync failed","Unable to sync the repository.")),i}}async commitChanges(e){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.commitChangesCore(e))}catch(t){if(t instanceof Tt){h.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}$.error(t),h.window.showErrorMessage(je("commit unable","Unable to commit.")),this.telemetryService.sendException(t)}}async commitChangesCore(e){const t=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=new lt(`VirtualSourceControl.commitChanges(${t.toString()})`);let i;try{const o=await this.providerService.getMetadata(t);let a,l;const u=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const _=e.inputBox.value;if(await this.changeStore.hasMergeConflicts(t)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),i=": Aborted; Unresolved conflicts";return}const R=await this.providerService.getCommitOperations(t,this.changeStore,{staged:u});if(R.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),i=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!_){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),i=": Aborted; No message";return}let A,P;if(o.HEAD.type===Le.RemoteBranch?(P=o.HEAD.branch.remote.accessLevel<Ze.Write,A=P&&o.accessLevel<Ze.Write):(A=o.accessLevel<Ze.Write,P=A),l===void 0&&A&&(l=await this.providerService.getFork(t),l===void 0)){const M={title:je("fork confirm","Fork Repository")},k={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(je("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},M,k)!==M){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),i=": Aborted; Abandoned fork prompt";return}if(l=await h.window.withProgress({location:h.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",o.name)},()=>this.providerService.fork(t)),l===void 0){h.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),i=": Aborted; Fork failed";return}}if(l||P){if(l===void 0){const k={title:je("remote branch create branch prompt confirm","Commit to New Branch")},B={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(je("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},k,B)!==k){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),i=": Aborted; Abandoned commit to new branch prompt";return}}let M=0;try{const k=await this.providerService.getBranches(l?this.providerService.createVirtualUri(t,l):t,{query:"patch-"});for(const B of k.branches){const U=/^patch-(?<num>\d+)$/.exec(B.name);if(U==null?void 0:U.groups){const H=Number(U.groups.num);H>M&&(M=H)}}}catch{}if(a=await _u(this.providerService,t,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l,`patch-${M+1}`),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),i=": Aborted; Abandoned create branch prompt";return}}try{if(Ne.getUseNewCommitApi())await this.providerService.createAndPushCommit(t,_,R,a,l);else{n.logStep("Creating commit");const M=await this.providerService.createCommit(t,_,R,l);n.logStep("Pushing",{message:`: Created commit ${M}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(t,M,a,l)}}catch(M){if(M instanceof $e){const k={title:je("detached head prompt confirm","Commit to New Branch")},B={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(je("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},k,B)!==k){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),i=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(a=await _u(this.providerService,t,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),i=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(M instanceof mt){const k={title:je("push conflicts prompt pull","Pull")},B={title:je("push conflicts prompt sync","Sync (Pull & Push)")},U={title:je("cancel","Cancel"),isCloseAffordance:!0},H=await h.window.showErrorMessage(je("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},k,B,U);if(H!==k&&H!==B){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),i=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(t,{pull:H===k,conflictResolution:Mr.Merge}),H===k){i=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw $.error(M),i=`: Aborted; ${String(M)}`,M}break}if(e.inputBox.value="",l?await this.changeStore.discardAll(t,{staged:u}):await this.changeStore.acceptAll(t,{staged:u}),hh(Ha.HasCommitted,!0),!l&&!a)return;async function d(){if(l){const P={title:je("commit to fork confirm","Switch to Fork")},M={title:je("cancel","Cancel"),isCloseAffordance:!0},k=await h.window.showInformationMessage(je("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",o.name),{modal:!0,useCustom:!0},P,M);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(k===P)}),k===P){let B;a!==void 0?B={type:ht.Branch,id:a}:o.HEAD.branch!==void 0&&(B={type:ht.Branch,id:o.HEAD.branch.name}),Un({name:l.name,uri:this.providerService.createVirtualUri(t,{repo:l.repo,ref:B}),location:ir.CurrentWindow})}return}const _={title:je("commit to new branch confirm","Switch to Branch")},R={title:je("cancel","Cancel"),isCloseAffordance:!0},A=await h.window.showInformationMessage(je("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",a),{modal:!0,useCustom:!0},_,R);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(A===_)}),A===_&&Un({name:o.name,uri:this.providerService.createVirtualUri(t,{repo:o.repo,ref:a?{type:ht.Branch,id:a}:void 0}),location:ir.CurrentWindow})}s(d,"showSwitchToPrompt"),d.call(this)}finally{n.stop(i?{message:i}:void 0)}}async createPullRequest(e,t){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,t))}catch(n){if(n instanceof Tt){h.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}if(n instanceof Jt){h.window.showErrorMessage(je("commit unable","Unable to commit."));return}$.error(n),h.window.showErrorMessage(je("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,t){var n,i;const o=e.rootUri,a=(n=t==null?void 0:t.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(a),staging:String(this.staging.enabled)});const l=new lt(`VirtualSourceControl.createPullRequest(${o.toString()})`);let u;try{let d=s(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),u=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),_;const R=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(t==null?void 0:t.sha)){if(await this.changeStore.hasMergeConflicts(o)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),u=": Aborted; Unresolved conflicts";return}if(_=await this.providerService.getCommitOperations(o,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),_.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),u=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const A=e.inputBox.value;if(!A){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),u=": Aborted; No message";return}const P=await this.providerService.getMetadata(o);let M,k;P.HEAD.type===Le.RemoteBranch?(k=P.HEAD.branch.remote.accessLevel<Ze.Write,M=k&&P.accessLevel<Ze.Write):(M=P.accessLevel<Ze.Write,k=M);let B=t==null?void 0:t.fork;if(B===void 0&&M&&(B=await this.providerService.getFork(o),B===void 0)){const De={title:je("fork confirm","Fork Repository")},Ie={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(je("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},De,Ie)!==De){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),u=": Aborted; Abandoned fork prompt";return}if(B=await h.window.withProgress({location:h.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",P.name)},()=>this.providerService.fork(o)),B===void 0){h.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),u=": Aborted; Fork failed";return}}const U=await h.window.showInputBox({ignoreFocusOut:!0,placeHolder:je("create pr placeholder","Pull request title"),prompt:je("create pr prompt","Enter a title for the new pull request"),title:je("create pr title","New Pull Request"),value:A});if(!U){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),u=": Aborted; Abandoned title prompt";return}async function H(De){let Ie=0;try{const Ae=await this.providerService.getBranches(B?this.providerService.createVirtualUri(o,B):o,{query:"patch-"});for(const Ye of Ae.branches){const Pe=/^patch-(?<num>\d+)$/.exec(Ye.name);if(Pe==null?void 0:Pe.groups){const qe=Number(Pe.groups.num);qe>Ie&&(Ie=qe)}}}catch{}return _u(this.providerService,o,De,je("create pr branch prompt","Create a new branch for this pull request"),je("create pr branch placeholder","New branch name"),je("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",B?B.name:P.name),B,`patch-${Ie+1}`)}s(H,"createBranch");let re;if(Ne.getUseNewCommitApi()){if(re=await H.call(this,P.HEAD.sha),!re){d.call(this);return}(_==null?void 0:_.length)&&await this.providerService.createAndPushCommit(o,A,_,re,B)}else{let De;if((_==null?void 0:_.length)?(De=await this.providerService.createCommit(o,A,_,B),l.log({message:`: Created commit ${De}`})):(De=(i=t==null?void 0:t.sha)!=null?i:P.HEAD.sha,l.log({message:`: Using commit ${De}`})),re=await H.call(this,De),!re){d.call(this);return}}const Y=await this.providerService.createPullRequest(o,re,U,{draft:a},B);e.inputBox.value="",(_==null?void 0:_.length)&&(B?await this.changeStore.discardAll(o,{staged:R}):await this.changeStore.acceptAll(o,{staged:R}));async function he(){const De={title:je("created pr notification confirm","Switch to Pull Request")},Ie={title:je("cancel","Cancel"),isCloseAffordance:!0},Ae=await h.window.showInformationMessage(je("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',Y.id,Y.uri.toString(!0),P.provider.name,P.name),{modal:!0,useCustom:!0},De,Ie);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(Ae===De)}),Ae===De&&Un({name:P.name,uri:this.providerService.createVirtualUri(o,{repo:P.repo,ref:{type:ht.PullRequest,id:Y.id}}),location:ir.CurrentWindow})}s(he,"showSwitchToPrompt"),he.call(this)}finally{l.stop(u?{message:u}:void 0)}}async update(e){const t=h.workspace.getWorkspaceFolder(e);if(t===void 0)return;const n=await this.createOrUpdateScmProvider(e,t.name),i=await this.changeStore.getGroupedChanges(e,{predicate:u=>u.fileType===h.FileType.File}),o=await Promise.all(i.conflicts.map(async u=>({type:u.type,resourceUri:u.uri,command:await this.changeStore.resolveDiffCommand(u.uri,u.conflicts.incomingUri,je("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",we(u.uri)))}))),a=await Promise.all(i.staged.map(async u=>({type:u.type,resourceUri:u.uri,command:await this.changeStore.resolveDiffCommand(u.uri,this.providerService.getProviderUri(u.uri),je("diff title index","{0} (Index)",we(u.uri)))}))),l=await Promise.all(i.working.map(async u=>({type:u.type,resourceUri:u.uri,decorations:{strikeThrough:u.type===Mt.Deleted},command:await this.changeStore.resolveDiffCommand(u.uri,this.providerService.getProviderUri(u.uri),je("diff title working","{0} (Working Tree)",we(u.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?l:[...a,...l],n}async createOrUpdateScmProvider(e,t){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const a=n.HEAD.branch?n.HEAD.name:void 0;let l=this.getScmProvider(e);if(l===void 0){t=n.name,o=h.scm.createSourceControl(`remoteHub:${n.provider.id}`,t,e),o.quickDiffProvider={provideOriginalResource:d=>this.providerService.getProviderUri(d)};const u=this.providerService.createIGitRepository(e,o,n,this.changeStore);l={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:u,isReadonly:i},this.ensureMergeConflictsGroup(l),this.ensureStagedChangesGroup(l),this.ensureWorkingChangesGroup(l),this._scmProviders.push(l)}else o=l.sourceControl;return n.accessLevel>=Ze.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:je("scm input accept command title commit","Commit"),arguments:[o]},a?o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",a,n.provider.name):o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),Ne.get("commitDirectlyWarning")===Q.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=u=>{if(Ne.get("commitDirectlyWarning")===Q.Auto&&Qp(Ha.HasCommitted))return;const d=new h.MarkdownString(a?je("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",a,n.provider.name):je("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return d.isTrusted=!0,d.appendMarkdown(`&nbsp; [${je("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${je("scm input validation action tip","Hide")}')`),{message:d,type:h.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=je("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:je("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=je("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",t)),await this.updateStatusBarCommands(l,{syncing:!1},n),l}async updateStatusBarCommands(e,t,n){var i,o,a;const l=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(l);const{HEAD:u}=n,d=await this.providerService.getIndexMetadata(l),_=(d==null?void 0:d.type)===wt.Active,R=(d==null?void 0:d.type)===wt.Active,A=wt.hasIndex(d==null?void 0:d.type),P=await this.changeStore.hasChanges(l),M=oh(u.type),k=[];if(k.push(Kn({command:"remoteHub.switchToBranch",title:`${M} ${u.name}${P?"*":""}`,tooltip:`${qt(u.sha)}`,arguments:[{uri:l,commands:!0}]})),u.detached||((t==null?void 0:t.syncing)?k.push(Kn({command:"",title:"$(sync~spin)",tooltip:je("sync command syncing","Syncing Changes..."),arguments:[]})):k.push(Kn({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=n.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:_||R?je("sync index","Sync to latest indexed commit"):je("sync command","Sync (Pull & Push)"),arguments:[{uri:l}]}))),n.pullRequest&&k.push(Kn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:je("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),A){const B=this.providerService.getIndexProvider(l);B&&k.push(...await B.getStatusBarContributions(l))}e.sourceControl.statusBarCommands=k}ensureMergeConflictsGroup(e){const t="conflicts";let n=e.groups.find(i=>i.id===t);return n===void 0&&(n=e.sourceControl.createResourceGroup(t,je("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const t="staged";let n=e.groups.find(i=>i.id===t);return n===void 0&&(n=e.sourceControl.createResourceGroup(t,je("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const t="changes";let n=e.groups.find(i=>i.id===t);return n===void 0&&(n=e.sourceControl.createResourceGroup(t,je("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const t=ne(e);return this._scmProviders.find(n=>ne(n.sourceControl.rootUri)===t)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let t;if(Cy(e))t=e;else if(Mp(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));t=i==null?void 0:i.sourceControl}else if(ah(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(n)));t=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;t=this._scmProviders[0].sourceControl}return t}}s(Np,"VirtualSourceControl");function Cy(r){return"rootUri"in r&&"inputBox"in r}s(Cy,"isSourceControl");function Mp(r){return r!==void 0&&"id"in r&&"label"in r&&"resourceStates"in r&&Array.isArray(r.resourceStates)}s(Mp,"isSourceControlResourceGroup");function ah(r){return r!==void 0&&"resourceUri"in r&&r.resourceUri instanceof h.Uri}s(ah,"isSourceControlResourceState");function cl(r){return"type"in r}s(cl,"isTrackedChange");async function sh(r){var e,t,n;if(r.length===0)return!0;let i,o=je("discard","Discard Changes");if(r.length===1){const l=r[0];l.type===Mt.Created?(i=je("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,we((e=l.resourceUri)!=null?e:l.uri)),o=je("delete file","Delete file")):l.type===Mt.Deleted?(o=je("restore file","Restore file"),i=je("confirm restore","Are you sure you want to restore {0}?",we((t=l.resourceUri)!=null?t:l.uri))):i=je("confirm discard","Are you sure you want to discard changes in {0}?",we((n=l.resourceUri)!=null?n:l.uri))}else r.every(l=>l.type===Mt.Created)?i=je("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,r.length):r.every(l=>l.type===Mt.Deleted)?(o=je("restore files","Restore files"),i=je("confirm restore multiple","Are you sure you want to restore {0} files?",r.length)):i=je("confirm discard multiple","Are you sure you want to discard changes in {0} files?",r.length);return await h.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}s(sh,"confirmDiscard");async function ll(r,e,t){if(r.length===0)return;if(r.length===1)return r[0].sourceControl.rootUri;const n=await h.window.showQuickPick(r.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:t});if(!!n)return n.uri}s(ll,"getOrPickRootUri");async function _u(r,e,t,n,i,o,a,l){const u=new Set;let d;const _=h.window.createInputBox();_.ignoreFocusOut=!0;try{return await new Promise((R,A)=>{d=h.Disposable.from(_.onDidHide(()=>R(void 0)),_.onDidChangeValue(P=>{if(P=P.trim(),!P){_.validationMessage=je("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(u.has(P)){_.validationMessage=je("scm create branch prompt validation already exists","Branch '{0}' already exists",P);return}if(!Rt(P)){_.validationMessage=je("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",P);return}_.validationMessage=void 0}),_.onDidAccept(async()=>{const P=_.value;try{_.enabled=!1,_.busy=!0;const M=await r.createBranch(e,P,t,a);R(M)}catch(M){if(M instanceof Me){_.enabled=!0,_.busy=!1,_.validationMessage=M.duplicate?je("scm create branch prompt validation already exists","Branch '{0}' already exists",P):je("scm create branch prompt validation invalid","Invalid branch name '{0}'",P),u.add(P);return}A(M)}})),_.prompt=n,_.placeholder=i,_.title=o,l&&(_.value=l),_.show()})}finally{_.dispose(),d==null||d.dispose()}}s(_u,"createBranchWithPrompt");class wu{constructor(e,t){this.memento=e,this.scope=t,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const t=this.getScoped(e),n=new lt(`MementoStorage.get(${e}): scopedKey=${t}`,{logLevel:We.Debug});try{return await Promise.resolve(this.memento.get(t))}finally{n.stop()}}async getKeys(e){const t=this.getScoped(e),n=new lt(`MementoStorage.getKeys(${e}): scopedPrefix=${t}`,{logLevel:We.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(a=>a.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let t=this.memento.keys();return e&&(t=t.filter(n=>n.startsWith(e))),t}async store(e,t){const n=this.getScoped(e),i=new lt(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:We.Debug});try{return await this.storeCore(e,n,t)}finally{i.stop()}}async storeCore(e,t,n){await this.memento.update(t,n),this._onDidChange.fire({key:e})}async delete(e){const t=this.getScoped(e),n=new lt(`MementoStorage.delete(${e}): scopedKey=${t}`,{logLevel:We.Debug});try{return await this.storeCore(e,t,void 0)}finally{n.stop()}}async deleteKeys(e){const t=this.getScoped(e),n=new lt(`MementoStorage.deleteKeys(${e}): scopedPrefix=${t}`,{logLevel:We.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,a=this.getKeysCore(t);for(const l of a){const u=o!==0?l.substr(o):l;$.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${u}, scopedKey=${l}`);try{await this.storeCore(u,l,void 0)}catch(d){$.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${u}, scopedKey=${l}`),i.push(u)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new wu(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}s(wu,"MementoStorageService");class bu{constructor(e,t){this.storageUri=e,this.scope=t,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const t=this.getScoped(e),n=new lt(`ExtFileStorageService.get(${e}): scopedKey=${t}`,{logLevel:We.Debug});try{return await h.workspace.fs.readFile(h.Uri.joinPath(this.storageUri,t))}catch(i){return}finally{n.stop()}}async store(e,t){const n=this.getScoped(e),i=new lt(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:We.Debug});try{return await this.storeCore(e,n,t)}finally{i.stop()}}async storeCore(e,t,n){await h.workspace.fs.writeFile(h.Uri.joinPath(this.storageUri,t),n),this._onDidChange.fire({key:e})}async delete(e){const t=this.getScoped(e),n=new lt(`ExtFileStorageService.delete(${e}): scopedKey=${t}`,{logLevel:We.Debug});try{return await h.workspace.fs.delete(h.Uri.joinPath(this.storageUri,t))}finally{n.stop()}}with(e){return new bu(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}s(bu,"ExtFileStorageService");const br=(0,V.loadMessageBundle)();class Ji extends h.TimelineItem{static is(e){return e instanceof Ji}constructor(e,t,n,i,{dateType:o,showAuthor:a,dateFormatter:l}){var u;const d=n.message.indexOf(`
`),_=d!==-1?`${n.message.substring(0,d)} \u2026`:n.message,R=o==="authored"?n.authorDate:n.commitDate;super(_,(u=R==null?void 0:R.getTime())!=null?u:0);this.id=n.hash,this.contextValue=`vscode-vfs:${t}:file:commit`,this.command=i,a&&(this.description=n.authorName),this.detail=br("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,qt(n.hash),l.format(R),n.message),this.iconPath=new h.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=t,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}s(Ji,"CommitTimelineItem");class Ua extends h.TimelineItem{static is(e){return e instanceof Ua}constructor(e,t,n,i,o,{dateFormatter:a,staged:l}){const u=l?br("timeline staged changes","Staged Changes"):br("timeline uncommitted changes","Uncommitted Changes");super(u,n.timestamp);this.id=l?"index":"working",this.contextValue=`vscode-vfs:${t}:file:${this.id}`,this.command=o,this.iconPath=new h.ThemeIcon("git-commit"),l?this.detail=br("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,br("timeline you","You"),br("timeline index","Index"),a.format(new Date(n.timestamp)),uc(n.type)):this.detail=br("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,br("timeline you","You"),br("timeline working","Working Tree"),a.format(new Date(n.timestamp)),uc(n.type)),this.rootUri=e,this.providerId=t,this.hash=l?"~":"",this.parents=i,this.message=u}}s(Ua,"ChangeOperationTimelineItem");class Fp{constructor(e,t){this.providerService=e,this.changeStore=t,this._onDidChange=new h.EventEmitter,this.id="github-file-history",this.label=br("timeline.source","GitHub File History"),this.debouncer=new ns(500),this.disposable=h.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),t.onDidChange(this.onUrisChanged,this),Ne.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const t=ne(this.rootUri);!e.some(n=>ne(n)===t)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const t=ne(this.rootUri);(e.added.some(n=>ne(n.uri)===t)||e.removed.some(n=>ne(n.uri)===t))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||ne(this.rootUri)!==ne(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const t=ne(this.rootUri);e.some(n=>ne(n.rootUri)===t)&&this.fireChanged()}async provideTimeline(e,t,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const M of this.providerService.repositories)if(M.uri.path===this.rootUri.path){this.rootUri=M.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||n.isCancellationRequested)return{items:[]};const l=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:t.cursor,limit:typeof t.limit=="number"?t.limit:void 0});if(l===void 0||l.commits.length===0||n.isCancellationRequested)return{items:[]};const u=((i=l.paging)==null?void 0:i.more)?{cursor:l.paging.cursor}:void 0,d=new Intl.DateTimeFormat(h.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),_=Ne.getAny("git.timeline.date",void 0,"committed"),R=Ne.getAny("git.timeline.showAuthor",void 0,!0),A=l.commits.map(M=>new Ji(this.rootUri,a.provider.id,M,this.resolveDiffCommand(M,a,e,o),{dateType:_,showAuthor:R,dateFormatter:d})),P=t.cursor===void 0?await this.changeStore.getChange(e):void 0;if(P){const M=Boolean(P.staged&&Ne.get("staging.enabled")),k=new Ua(this.rootUri,a.provider.id,P,[l.commits[0].hash],await this.changeStore.resolveDiffCommand(P.uri,this.providerService.getProviderUri(P.uri),M?br("diff title index","{0} (Index)",we(P.uri)):br("diff title working","{0} (Working Tree)",we(P.uri))),{dateFormatter:d,staged:M});A.splice(0,0,k)}return{items:A,paging:u}}catch(o){return $.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=h.workspace.registerTimelineProvider([tr.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[h.commands.registerCommand("remoteHub.timeline.copyCommitId",(t,n,i)=>{!Ji.is(t)||h.env.clipboard.writeText(t.hash)}),h.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(t,n,i)=>{!Ji.is(t)||h.env.clipboard.writeText(t.message)}),h.commands.registerCommand("remoteHub.timeline.openDiff",async(t,n,i)=>{var o;!Ji.is(t)&&!Ua.is(t)||t.command!==void 0&&await h.commands.executeCommand(t.command.command,...(o=t.command.arguments)!=null?o:[])}),h.commands.registerCommand("remoteHub.timeline.openOnGitHub",async t=>{await this.openOnRemote(t)}),h.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async t=>{await this.openOnRemote(t)}),h.commands.registerCommand("remoteHub.timeline.selectForCompare",async(t,n,i)=>{!n||!Ji.is(t)&&!Ua.is(t)||(e={uri:n,left:t},await h.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),h.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(t,n,i)=>{if(!n||!e||!Ji.is(t)&&!Ua.is(t)||ne(n)!==ne(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(t.rootUri,n),l=await this.providerService.getMetadata(t.rootUri),u=we(n),d=o.parents[0];let _;d===void 0?_=br("timeline diff title ref","{0} ({1})",u,qt(t.hash)):o.hash===""?_=br("timeline diff title working","{0} (Working Tree)",u):o.hash==="~"?_=br("timeline diff title index","{0} (Index)",u):_=br("timeline diff title ref","{0} ({1})",u,qt(o.hash));let R=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:ht.Commit,id:d!=null?d:"0000000000000000000000000000000000000000"}},a);d===void 0&&(R=R.with({query:"~"}));const A=t.parents[0];let P;A===void 0?P=br("timeline diff title ref","{0} ({1})",u,qt(t.hash)):A==="~"&&t.hash===""?P=br("timeline diff title working","{0} (Working Tree)",u):t.hash==="~"?P=br("timeline diff title index","{0} (Index)",u):P=br("timeline diff title ref","{0} ({1})",u,qt(t.hash));const M=br("timeline diff title","{0} \u27F7 {1}",_,P),k=t.hash===""||t.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:ht.Commit,id:t.hash}},a);await h.commands.executeCommand("vscode.diff",R,k,M)})]}resolveDiffCommand(e,t,n,i,o){const a=we(n),l=e.parents[0];let u;l===void 0?u=br("timeline diff title ref","{0} ({1})",a,qt(e.hash)):e.hash===""?u=br("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?u=br("timeline diff title index","{0} (Index)",a):u=br("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,qt(l),qt(e.hash));let d=this.providerService.createProviderUri(n,{repo:t.repo,ref:{type:ht.Commit,id:l!=null?l:"0000000000000000000000000000000000000000"}},i);l===void 0&&(d=d.with({query:"~"}));const _=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:t.repo,ref:{type:ht.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[d,_,u,o]}}async openOnRemote(e){if(!Ji.is(e))return;const t=await this.providerService.getMetadata(e.rootUri);await is("remoteHub.openOnRemote",{provider:t.provider,repo:t.repo,sha:e.hash})}}s(Fp,"VirtualTimelineProvider");class Lp{constructor(e,t){this.providerService=e,this.telemetryService=t,this.disposable=h.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var t;const n=new lt(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const l of e.query.split("&")){const[u,d]=l.split("=");switch(u){case"url":i=decodeURIComponent(d);break;case"location":o=d===ir.CurrentWindow?ir.CurrentWindow:ir.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:ir.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),Un(a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[l,u]=a.split("=");if(l==="url"){i=decodeURIComponent(u);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((t=Cu())==null?void 0:t.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}case"/login":{ar.fire(e);break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}s(Lp,"RemoteUriHandler");const zn=(0,V.loadMessageBundle)(),ul=s(class{constructor(r,e,t,n){this.providerService=r,this.storageService=e,this.changeStore=t,this.workspaceId=n,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new ua("WorkspaceRepositories"),this.disposable=h.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const r=await h.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void h.window.showTextDocument(r)}onChangeStoreChanged(r){const e=Yd(r.map(t=>t.rootUri),t=>ne(t)).map(t=>this.providerService.getRepository(t)).filter(t=>Boolean(t));this.addOrUpdate(e)}onRepositoriesChanged(r){this.addOrUpdate(r.added)}onRepositoryChanged(r){this.addOrUpdate([r.repository])}async get(r){let e=await this.lock.synchronizeRead(async()=>{let t=this.cache.get("workspaceRepositories");return t===void 0&&(t=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",t)),t},"WorkspaceRepositories.get");if(r){const t=ne(r);e=e.filter(n=>ne(n.canonicalUri)===t)}return e}async getCore(){return this.fromStorage(await this.storageService.get(ul.storageKey))}async getByCanonicalUri(){let r=this.cache.get("groupedWorkspaceRepositories");return r===void 0&&(r=ay(await this.get(),e=>ne(e.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",r)),r}async getRecents(r=10){return(await this.get()).slice(0,r)}async getRemoteWorkspaceSourceProvider(){const r=await this.getRecents();if(r.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:zn("pick","Choose a recent repository"),provideSources:function(e,t,n,i){return r.map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:Si(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${tr.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${oh(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${Bp(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${by(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:ir.CurrentWindow}}))}}}refresh(){this.cache.clear()}async remove(r){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),t=`${r.workspaceId}/${ne(r.uri)}`,n=e.get(t);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const a={title:zn("remove remote repo prompt confirm","Yes")},l={title:zn("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await h.window.showWarningMessage(o.length===1?zn("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):zn("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},a,l)!==a)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(t);try{await this.storageService.store(ul.storageKey,this.toStorage(e))}catch(a){throw $.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(r){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const t of r){const[{HEAD:n,pullRequest:i},o]=await Promise.all([t.getMetadata(),t.getIndexMetadata()]),a=await this.changeStore.getChanges(t.uri);e.set(`${this.workspaceId}/${ne(t.uri)}`,{workspaceId:this.workspaceId,uri:t.uri,canonicalUri:t.canonicalUri,name:t.name,provider:t.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&wt.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:Ty(a),timestamp:Date.now()})}try{await this.storageService.store(ul.storageKey,this.toStorage(e)),yn(ni.HasRecentRepositories,e.size>0)}catch(t){throw $.error(t,"Failed to save workspace repositories"),t}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(r){if(!r)return new Map;try{const e=JSON.parse(r,(t,n)=>(t==="uri"||t.endsWith("Uri"))&&Ke(n)?h.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return $.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(r){const e={schemaVersion:ul.storageSchemaVersion,workspaceRepositories:[...r]};return JSON.stringify(e)}},"_WorkspaceRepositories");let ch=ul;ch.storageKey="workspaceRepositories",ch.storageSchemaVersion=1;function $p(r){return r!==void 0&&(r.added!==0||r.changed!==0||r.deleted!==0)}s($p,"hasChanges");function xy(r){return $p(r.changes)}s(xy,"hasUncommittedChanges");function Ty(r){let e=0,t=0,n=0;for(const i of r)switch(i.type){case Mt.Created:e++;break;case Mt.Changed:t++;break;case Mt.Deleted:n++;break}return e||t||n?{added:e,changed:t,deleted:n,timestamp:Date.now()}:void 0}s(Ty,"toChangesSummary");function Bp(r,{compact:e=!0,preamble:t,separator:n=", ",short:i=!1,single:o=!1}={}){if(!$p(r))return zn("no changes","Everything up to date");const{added:a,changed:l,deleted:u}=r;if(o){const _=a+l+u;return _===1?zn("summary change","{0} change",_):zn("changes changes","{0} changes",_)}let d=`${t!=null?t:""}`;return(a||!e)&&(d+=i?`+${a}`:a===1?zn("file added","{0} file added",a):zn("files added","{0} files added",a),(l||u||!e)&&(d+=n)),(l||!e)&&(d+=i?`~${l}`:l===1?zn("file changed","{0} file changed",l):zn("files changed","{0} files changed",l),(u||!e)&&(d+=n)),(u||!e)&&(d+=i?`-${u}`:u===1?zn("file deleted","{0} file deleted",u):zn("files deleted","{0} files deleted",u)),d}s(Bp,"formatChangesSummary");var Ay=Object.defineProperty,Ry=Object.getOwnPropertyDescriptor,Iy=s((r,e,t,n)=>{for(var i=n>1?void 0:n?Ry(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ay(e,t,i),i},"view_decorateClass"),Us;(function(r){r.Change="remoteHub:viewItem:change",r.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",r.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",r.Message="remoteHub:viewItem:message"})(Us||(Us={}));const Up=s(class{constructor(r,e){this.view=r,this.parent=e,this.splatted=!1}static is(r){return r instanceof Up}get id(){}toString(){return`${$.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var r,e;return((r=this.parent)==null?void 0:r.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(r=!1,e=!1,t){return this.splatted&&this.parent!==void 0&&this.parent!==t?this.parent.triggerChange(r,e):this.view.refreshNode(this,r,e)}},"_ViewNode");let Hs=Up;Iy([qr((r=!1,e=!1,t)=>JSON.stringify([r,e,t==null?void 0:t.toString()]))],Hs.prototype,"triggerChange",1);class Hp{constructor(e,t,n,i){this.id=e,this.name=t,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new h.EventEmitter,this.disposables=[];const o=!1;if($.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(l){var u;const d=await a.apply(this,[l]),_=l.getParent();return d.tooltip===void 0&&(d.tooltip=new h.MarkdownString(d.label!==void 0&&typeof d.label!="string"?d.label.label:(u=d.label)!=null?u:"")),typeof d.tooltip=="string"?d.tooltip=`${d.tooltip}

---
context: ${d.contextValue}
node: ${l.toString()}${_!==void 0?`
parent: ${_.toString()}`:""}`:d.tooltip.appendMarkdown(`

---

context: \`${d.contextValue}\`\\
node: \`${l.toString()}\`${_!==void 0?`\\
parent: \`${_.toString()}\``:""}`),d}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!Ne.changed(e,`views.${this.configKey}`)}dispose(){h.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=h.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(Ne.onDidChange(t=>{!this.filterConfigurationChanged(t)||(this._config=void 0,this.onConfigurationChanged(t))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var t,n;await((n=(t=this.root)==null?void 0:t.refresh)==null?void 0:n.call(t,e)),this.triggerNodeChange()}async refreshNode(e,t=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,t));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,t){if(this.tree!==void 0)try{await this.tree.reveal(e,t)}catch(n){$.error(n)}}async show(){try{await h.commands.executeCommand(`${this.id}.focus`)}catch(e){$.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=Ne.get("views")[this.configKey]),this._config}}s(Hp,"View");class jp extends Hs{constructor(e,t,n,i,o,a,l){super(e,t);this._message=n,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=l}getChildren(){return[]}getTreeItem(){var e;const t=new h.TreeItem(this._message,h.TreeItemCollapsibleState.None);return t.contextValue=(e=this._contextValue)!=null?e:Us.Message,t.description=this._description,t.tooltip=this._tooltip,t.iconPath=this._iconPath,t}}s(jp,"MessageNode");var Dy=Object.defineProperty,Py=Object.getOwnPropertyDescriptor,lh=s((r,e,t,n)=>{for(var i=n>1?void 0:n?Py(e,t):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Dy(e,t,i),i},"workspaceRepositoriesView_decorateClass");const Zr=(0,V.loadMessageBundle)(),qp=s(class extends Hs{constructor(r,e,t,n,i,o,a){super(r,e);this.changeStore=t,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(r,e,t){return`${dl.getId(r,e)}:${this.key}(${t.uri.toString()})`}get id(){return qp.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const r=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new h.TreeItem(r,h.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${Us.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(r,!0),e}async getDiffCommand(r,e=!1){if(e||this._command===void 0){const t=Boolean(this.operation.staged&&Ne.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,t?Zr("diff title index","{0} (Index)",we(this.operation.uri),this.workspaceRepository.ref.name):Zr("diff title working","{0} (Working Tree)",we(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:ht.Commit,id:this.operation.revision}},r);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,t?Zr("diff title changeset index","{0} (Index of {1})",we(this.operation.uri),this.workspaceRepository.ref.name):Zr("diff title changeset working","{0} (Working Tree of {1})",we(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var r;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await h.commands.executeCommand(e.command,...(r=e.arguments)!=null?r:[])}async openFile(){const r=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await h.window.showTextDocument(r)}async applyChanges(){const r=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(r!==void 0)try{await this.view.changeStore.applyChangeset(r.uri,this.workspaceRepository,this.operation)}catch(e){h.window.showErrorMessage(String(e))}}},"_FileChangeNode");let zp=qp;zp.key=":changes";const Wp=s(class extends Hs{constructor(r,e,t,n,i){super(r,e);this.canonical=t,this.workspaceRepository=n,this.root=i}static getId(r,e){return`${Eu.getId(r)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return Wp.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||h.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const r=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),e=await r.getChanges(this.workspaceRepository.uri);this._children=e.map(t=>new zp(this.view,this,r,this.canonical,this.workspaceRepository,t,this.canApplyChanges()))}return this._children}getTreeItem(){const r=this.workspaceRepository.workspaceId===this.view.workspaceId,e=xy(this.workspaceRepository),t=tr.isCanonicalUri(this.workspaceRepository.uri)?Zr("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new h.TreeItem(this.root?this.canonical.name:t,e?h.TreeItemCollapsibleState.Collapsed:h.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${Us.WorkspaceRepository}${r?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${Si(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=r?new h.ThemeIcon("check"):this.root?Kp(this.canonical.provider.id):Ey(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new h.MarkdownString(void 0,!0).appendMarkdown(Zr("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?Zr("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",Oy(this.workspaceRepository.ref.type),oh(this.workspaceRepository.ref.type),t,r?` \u2014 _${Zr("repositories view repository tooltip active","Active")}_ `:"",Si(this.workspaceRepository.timestamp,{ago:!0}),Bp(this.workspaceRepository.changes,{preamble:`${Zr("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=h.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(r=!1){r&&(this._children=void 0)}async applyAllChanges(){const r=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(r!==void 0)try{await this.view.changeStore.applyChangeset(r.uri,this.workspaceRepository)}catch(e){h.window.showErrorMessage(String(e))}}remove(){return this.view.workspaceRepositories.remove(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let dl=Wp;dl.key=":wsrepo",lh([qr()],dl.prototype,"refresh",1);const Gp=s(class extends Hs{constructor(r,e,t,n){super(r,e);this.canonical=t,this.workspaceRepositories=n}static getId(r){return`remoteHub${this.key}(${r.toString()})`}get id(){return Gp.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const r=this.workspaceRepositories;if(r.length===0)return this.view.message=void 0,[new jp(this.view,this,Zr("repositories view message empty","No GitHub repositories could be found."))];this.view.message=void 0,this.children=r.map(e=>new dl(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const r=this.workspaceRepositories.some(t=>t.workspaceId===this.view.workspaceId),e=new h.TreeItem(this.canonical.name,r?h.TreeItemCollapsibleState.Expanded:h.TreeItemCollapsibleState.Collapsed);return e.contextValue=Us.WorkspaceRepositories,e.iconPath=Kp(this.canonical.provider.id),e}refresh(r=!1){r&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let Eu=Gp;Eu.key=":wsrepos",lh([qr()],Eu.prototype,"refresh",1);class uh extends Hs{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.workspaceRepositories.getByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const t=[];for(const[n,i]of e){const o=h.Uri.parse(n);try{const{name:a,provider:l}=this.view.providerService.getVirtualUriMetadata(o),u={uri:o,name:a,provider:l,hasActive:i.some(d=>d.workspaceId===this.view.workspaceId)};i.length===1?t.push(new dl(this.view,this,u,i[0],!0)):t.push(new Eu(this.view,this,u,i))}catch(a){if(a instanceof er)continue;$.error(a)}}this.children=t}return this.children}getTreeItem(){return new h.TreeItem("Repositories",h.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}s(uh,"WorkspaceRepositoriesViewNode"),lh([qr()],uh.prototype,"refresh",1);class Vp extends Hp{constructor(e,t,n,i,o){super("remoteHub.views.workspaceRepositories",Zr("remote view title","GitHub Repositories"),e,o);this.workspaceRepositories=t,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),h.window.registerFileDecorationProvider({provideFileDecoration:(a,l)=>{if(!(a.scheme!=="remotehub-view"||a.authority!=="wsrepo"||!a.path.includes("/changes")))return{badge:"\u25CF",color:new h.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:Zr("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new uh(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[h.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),h.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),Un({name:e.name,uri:e.uri,location:ir.CurrentWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),Un({name:e.name,uri:e.uri,location:ir.NewWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),h.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),h.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const t=ne(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>ne(o.canonicalUri)===t);return await ky(n,Zr("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}s(Vp,"WorkspaceRepositoriesView");function Oy(r,e){switch(r){case Le.Branch:return e?Zr("type pr branch","Pull Request #{0}",e.id):Zr("type branch","Branch");case Le.RemoteBranch:return e?Zr("type pr remote branch","Pull Request #{0}",e.id):Zr("type remote branch","Remote Branch");case Le.Tag:return Zr("type tag","Tag");case Le.Commit:return Zr("type commit","Commit")}}s(Oy,"headTypeToString");function Kp(r){switch(r){case"github":return new h.ThemeIcon("github");case"azurerepos":return new h.ThemeIcon("azure-devops");default:return new h.ThemeIcon("vm")}}s(Kp,"providerToIconPath");async function ky(r,e){if(r.length!==0){if(r.length>1){const t=await h.window.showQuickPick(r.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return t?t.repository:void 0}return r[0]}}s(ky,"getRepository");const hl=(0,V.loadMessageBundle)();let Su;function Cu(){return Su}s(Cu,"getOpenActionsService");var Ha;(function(r){r.HasCommitted="has:committed",r.Version="version"})(Ha||(Ha={}));let dh;function Qp(r){return dh.globalState.get(r)}s(Qp,"getState");async function hh(r,e){return dh.globalState.update(r,e)}s(hh,"updateState");let fh=!1;function Xp(){return fh}s(Xp,"isInsiders");async function Ny(r){dh=r,ue.configure(r),$.configure(r,Ne.get("logLevel")),lt.start("Time to root directory",{log:!1});const e=r.extension.packageJSON.displayName,t="GitHub.remotehub",[,n]=r.extension.packageJSON.version.split(".");if(r.extension.id.toLowerCase()===t.toLowerCase()&&Number.parseInt(n)%2==1&&(fh=!0),r.extension.id.toLowerCase()==="github.remotehub-insiders"){fh=!0;const l=hl("review uncommitted changes","Review Uncommitted Changes"),u=hl("switch to pre-release","Switch to Pre-Releases");switch(await h.window.showWarningMessage(hl("deprecated","GitHub Repositories (Insiders) has been deprecated and will no longer be updated. To continue using nightly builds, commit all uncommitted changes across your repositories and switch to pre-releases of Remote Repositories."),l,u)){case l:await h.commands.executeCommand("remoteHub.views.workspaceRepositories.focus");break;case u:await h.commands.executeCommand("workbench.extensions.installExtension",t,{installPreReleaseVersion:!0}),await h.commands.executeCommand("workbench.extensions.uninstallExtension",r.extension.id);return;default:break}const _=h.extensions.getExtension(t);if(_!==void 0){const R=_.packageJSON.displayName;$.warn(`${e} was NOT activated because ${R} is also enabled`),setTimeout(()=>void h.window.showErrorMessage(hl("more than one version enabled warning","{0} cannot be used while {1} is also enabled. Please ensure that only one version is enabled.",e,R),hl("ok","OK")),0);return}}const i=pc.configure(r),o=new fa(r),a=r.extension.packageJSON.version;await hh(Ha.Version,a),await r.workspaceState.update(Ha.Version,a);try{const l=new wu(r.globalState),u=l.with(i),d=new bu(r.globalStorageUri,i),_=new ze(u),R=new tr(_,o),A=new Br(R,u,d,o,i);A.getWorkspacesWithChanges(),Su=new Op(R,l,A);const P=new Np(R,A,Su,o),M=new rp(r.globalStorageUri,R),k=new Rh(R,M),B=new ch(R,l,A,i);return r.subscriptions.push(Ne.onDidChange(U=>{!Ne.changed(U,"logLevel")||($.logLevel=Ne.get("logLevel"))}),R.onDidChangeRepositories(async U=>{for(const H of U.added)try{const re=await H.getMetadata(),{HEAD:Y,defaultBranch:he,name:De,provider:Ie,pullRequest:Ae}=re,Ye=Y.name.replace(/\//g,"\u2009\u2215\u2009");let Pe=" ";if(Ae!==void 0)Pe=` (PR ${Ae.id}) `;else if(Y.type===Le.Tag)Pe=` (${Ye}) `;else if(Y.type===Le.Commit)Pe=` (${Ye}) `;else if(Y.type===Le.Branch||Y.type===Le.RemoteBranch){const rt=Y.branch.name.replace(/\//g,"\u2009\u2215\u2009");Y.branch.name!==he.name&&(Pe=` (${rt})`)}const qe={uri:H.uri,type:"folder",label:`${De}${Pe}[${Ie.name}]`};h.commands.executeCommand("_workbench.addToRecentlyOpened",qe)}catch(re){$.error(re,"Failed to add repository to recently opened")}}),new kp(R,A),new Dl,new Lc(R,A),new Lp(R,o),...ga(R,A,B,r.extension.id,o),...$y(R,A,o),...My(R,A,P,M,r,o),new Fp(R,A),new Vp(R,B,A,i,o),M,B,P,Su,A,R,o),o.sendEvent("activate"),Promise.resolve(k)}catch(l){throw $.error(l),l}}s(Ny,"activate");function My(r,e,t,n,i,o){const a=Yp()?new Ch(r,o):void 0;return[Fy(r,e,a,t,n),...Ne.get("azureRepos.enabled")?[new wi(i),Ly(r,e,a)]:[]]}s(My,"registerProviders");function Fy(r,e,t,n,i){const o=new vu(r,i),a=new rl(r,o,e,i);async function l(){var d;try{let _=(d=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?d:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");_||($.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(B=>{const U=h.extensions.onDidChange(()=>{var H;_=(H=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?H:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),_&&(U.dispose(),B())})})),$.log("[ GHPR] Registering..."),yn(ni.HasPullRequestExtension,!0);const R=await _.activate();if(!R)throw new Error("Unable to get registration api");const A=R.registerGitProvider(n),P=r.onDidChangeRepositories(B=>M(B));async function M(B){const U=B.added.filter(H=>H.provider.id==="github");if(U.length!==0){$.log("[ GHPR] Checking for opened PRs...");for(const H of U){const re=await r.getBestRemoteUri(H.uri,et.PullRequest);if(!!re){P.dispose(),$.log("[ GHPR] Opened PR found; preloading"),h.commands.executeCommand("github.api.preloadPullRequest",re.toString());return}}$.log("[ GHPR] No opened PRs found")}}s(M,"onRepositoriesChanged"),$.log("[ GHPR] Registration complete");const k=r.repositories;return k.length&&M({added:k,removed:[]}),h.Disposable.from(A,P)}catch(_){return $.error(_,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}s(l,"registerWithGHPR");const u=l();return h.Disposable.from(r.register("github","GitHub",o,a,t),o,a,{dispose:async()=>{var d;return void((d=await u)==null?void 0:d.dispose())}})}s(Fy,"registerGitHub");function Ly(r,e,t){const n=new Ea(r),i=new Bi(r,n,e);return h.Disposable.from(r.register("azurerepos","Azure Repos",n,i,t),n,i)}s(Ly,"registerAzDO");function $y(r,e,t){if(!Yp())return[];t.publicLog2("codex.enableRichNav",{});const n=new fs(r,e);return[n,n.register(new nd(t)),...nd.createStatus()]}s($y,"registerNavigationServiceProviders");function Yp(){return h.env.uiKind===h.UIKind.Desktop||Ne.get("richNavigation.enabled")===!0}s(Yp,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();

var RR=Object.defineProperty;var l=(X,h)=>RR(X,"name",{value:h,configurable:!0});(()=>{var __webpack_modules__={3672:(X,h)=>{"use strict";var O=l(function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof F!="undefined")return F;throw new Error("unable to locate global object")},"getGlobal"),F=O();X.exports=h=F.fetch,F.fetch&&(h.default=F.fetch.bind(F)),h.Headers=F.Headers,h.Request=F.Request,h.Response=F.Response},9742:(X,h)=>{"use strict";h.byteLength=b,h.toByteArray=A,h.fromByteArray=V;for(var O=[],F=[],N=typeof Uint8Array!="undefined"?Uint8Array:Array,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q=0,q=P.length;Q<q;++Q)O[Q]=P[Q],F[P.charCodeAt(Q)]=Q;F["-".charCodeAt(0)]=62,F["_".charCodeAt(0)]=63;function U($){var j=$.length;if(j%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var ge=$.indexOf("=");ge===-1&&(ge=j);var me=ge===j?0:4-ge%4;return[ge,me]}l(U,"getLens");function b($){var j=U($),ge=j[0],me=j[1];return(ge+me)*3/4-me}l(b,"byteLength");function R($,j,ge){return(j+ge)*3/4-ge}l(R,"_byteLength");function A($){var j,ge=U($),me=ge[0],G=ge[1],ee=new N(R($,me,G)),te=0,z=G>0?me-4:me,E;for(E=0;E<z;E+=4)j=F[$.charCodeAt(E)]<<18|F[$.charCodeAt(E+1)]<<12|F[$.charCodeAt(E+2)]<<6|F[$.charCodeAt(E+3)],ee[te++]=j>>16&255,ee[te++]=j>>8&255,ee[te++]=j&255;return G===2&&(j=F[$.charCodeAt(E)]<<2|F[$.charCodeAt(E+1)]>>4,ee[te++]=j&255),G===1&&(j=F[$.charCodeAt(E)]<<10|F[$.charCodeAt(E+1)]<<4|F[$.charCodeAt(E+2)]>>2,ee[te++]=j>>8&255,ee[te++]=j&255),ee}l(A,"toByteArray");function S($){return O[$>>18&63]+O[$>>12&63]+O[$>>6&63]+O[$&63]}l(S,"tripletToBase64");function D($,j,ge){for(var me,G=[],ee=j;ee<ge;ee+=3)me=($[ee]<<16&16711680)+($[ee+1]<<8&65280)+($[ee+2]&255),G.push(S(me));return G.join("")}l(D,"encodeChunk");function V($){for(var j,ge=$.length,me=ge%3,G=[],ee=16383,te=0,z=ge-me;te<z;te+=ee)G.push(D($,te,te+ee>z?z:te+ee));return me===1?(j=$[ge-1],G.push(O[j>>2]+O[j<<4&63]+"==")):me===2&&(j=($[ge-2]<<8)+$[ge-1],G.push(O[j>>10]+O[j>>4&63]+O[j<<2&63]+"=")),G.join("")}l(V,"fromByteArray")},5186:(X,h,O)=>{var F=O(3698),N=O(2505),P=O(6417),Q=Function.bind,q=Q.bind(Q);function U(D,V,$){var j=q(P,null).apply(null,$?[V,$]:[V]);D.api={remove:j},D.remove=j,["before","error","after","wrap"].forEach(function(ge){var me=$?[V,ge,$]:[V,ge];D[ge]=D.api[ge]=q(N,null).apply(null,me)})}l(U,"bindApi");function b(){var D="h",V={registry:{}},$=F.bind(null,V,D);return U($,V,D),$}l(b,"HookSingular");function R(){var D={registry:{}},V=F.bind(null,D);return U(V,D),V}l(R,"HookCollection");var A=!1;function S(){return A||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),A=!0),R()}l(S,"Hook"),S.Singular=b.bind(),S.Collection=R.bind(),X.exports=S,X.exports.Hook=S,X.exports.Singular=S.Singular,X.exports.Collection=S.Collection},2505:X=>{X.exports=h;function h(O,F,N,P){var Q=P;O.registry[N]||(O.registry[N]=[]),F==="before"&&(P=l(function(q,U){return Promise.resolve().then(Q.bind(null,U)).then(q.bind(null,U))},"hook")),F==="after"&&(P=l(function(q,U){var b;return Promise.resolve().then(q.bind(null,U)).then(function(R){return b=R,Q(b,U)}).then(function(){return b})},"hook")),F==="error"&&(P=l(function(q,U){return Promise.resolve().then(q.bind(null,U)).catch(function(b){return Q(b,U)})},"hook")),O.registry[N].push({hook:P,orig:Q})}l(h,"addHook")},3698:X=>{X.exports=h;function h(O,F,N,P){if(typeof N!="function")throw new Error("method for before hook must be a function");return P||(P={}),Array.isArray(F)?F.reverse().reduce(function(Q,q){return h.bind(null,O,q,Q,P)},N)():Promise.resolve().then(function(){return O.registry[F]?O.registry[F].reduce(function(Q,q){return q.hook.bind(null,Q,P)},N)():N(P)})}l(h,"register")},6417:X=>{X.exports=h;function h(O,F,N){if(!!O.registry[F]){var P=O.registry[F].map(function(Q){return Q.orig}).indexOf(N);P!==-1&&O.registry[F].splice(P,1)}}l(h,"removeHook")},6744:(X,h,O)=>{"use strict";const F=O(3349),N=O(7529),P=O(8050),Q=O(4339),q=l((U,b={})=>{let R=[];if(Array.isArray(U))for(let A of U){let S=q.create(A,b);Array.isArray(S)?R.push(...S):R.push(S)}else R=[].concat(q.create(U,b));return b&&b.expand===!0&&b.nodupes===!0&&(R=[...new Set(R)]),R},"braces");q.parse=(U,b={})=>Q(U,b),q.stringify=(U,b={})=>F(typeof U=="string"?q.parse(U,b):U,b),q.compile=(U,b={})=>(typeof U=="string"&&(U=q.parse(U,b)),N(U,b)),q.expand=(U,b={})=>{typeof U=="string"&&(U=q.parse(U,b));let R=P(U,b);return b.noempty===!0&&(R=R.filter(Boolean)),b.nodupes===!0&&(R=[...new Set(R)]),R},q.create=(U,b={})=>U===""||U.length<3?[U]:b.expand!==!0?q.compile(U,b):q.expand(U,b),X.exports=q},7529:(X,h,O)=>{"use strict";const F=O(2664),N=O(3083),P=l((Q,q={})=>{let U=l((b,R={})=>{let A=N.isInvalidBrace(R),S=b.invalid===!0&&q.escapeInvalid===!0,D=A===!0||S===!0,V=q.escapeInvalid===!0?"\\":"",$="";if(b.isOpen===!0||b.isClose===!0)return V+b.value;if(b.type==="open")return D?V+b.value:"(";if(b.type==="close")return D?V+b.value:")";if(b.type==="comma")return b.prev.type==="comma"?"":D?b.value:"|";if(b.value)return b.value;if(b.nodes&&b.ranges>0){let j=N.reduce(b.nodes),ge=F(...j,{...q,wrap:!1,toRegex:!0});if(ge.length!==0)return j.length>1&&ge.length>1?`(${ge})`:ge}if(b.nodes)for(let j of b.nodes)$+=U(j,b);return $},"walk");return U(Q)},"compile");X.exports=P},6611:X=>{"use strict";X.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},8050:(X,h,O)=>{"use strict";const F=O(2664),N=O(3349),P=O(3083),Q=l((U="",b="",R=!1)=>{let A=[];if(U=[].concat(U),b=[].concat(b),!b.length)return U;if(!U.length)return R?P.flatten(b).map(S=>`{${S}}`):b;for(let S of U)if(Array.isArray(S))for(let D of S)A.push(Q(D,b,R));else for(let D of b)R===!0&&typeof D=="string"&&(D=`{${D}}`),A.push(Array.isArray(D)?Q(S,D,R):S+D);return P.flatten(A)},"append"),q=l((U,b={})=>{let R=b.rangeLimit===void 0?1e3:b.rangeLimit,A=l((S,D={})=>{S.queue=[];let V=D,$=D.queue;for(;V.type!=="brace"&&V.type!=="root"&&V.parent;)V=V.parent,$=V.queue;if(S.invalid||S.dollar){$.push(Q($.pop(),N(S,b)));return}if(S.type==="brace"&&S.invalid!==!0&&S.nodes.length===2){$.push(Q($.pop(),["{}"]));return}if(S.nodes&&S.ranges>0){let G=P.reduce(S.nodes);if(P.exceedsLimit(...G,b.step,R))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let ee=F(...G,b);ee.length===0&&(ee=N(S,b)),$.push(Q($.pop(),ee)),S.nodes=[];return}let j=P.encloseBrace(S),ge=S.queue,me=S;for(;me.type!=="brace"&&me.type!=="root"&&me.parent;)me=me.parent,ge=me.queue;for(let G=0;G<S.nodes.length;G++){let ee=S.nodes[G];if(ee.type==="comma"&&S.type==="brace"){G===1&&ge.push(""),ge.push("");continue}if(ee.type==="close"){$.push(Q($.pop(),ge,j));continue}if(ee.value&&ee.type!=="open"){ge.push(Q(ge.pop(),ee.value));continue}ee.nodes&&A(ee,S)}return ge},"walk");return P.flatten(A(U))},"expand");X.exports=q},4339:(X,h,O)=>{"use strict";const F=O(3349),{MAX_LENGTH:N,CHAR_BACKSLASH:P,CHAR_BACKTICK:Q,CHAR_COMMA:q,CHAR_DOT:U,CHAR_LEFT_PARENTHESES:b,CHAR_RIGHT_PARENTHESES:R,CHAR_LEFT_CURLY_BRACE:A,CHAR_RIGHT_CURLY_BRACE:S,CHAR_LEFT_SQUARE_BRACKET:D,CHAR_RIGHT_SQUARE_BRACKET:V,CHAR_DOUBLE_QUOTE:$,CHAR_SINGLE_QUOTE:j,CHAR_NO_BREAK_SPACE:ge,CHAR_ZERO_WIDTH_NOBREAK_SPACE:me}=O(6611),G=l((ee,te={})=>{if(typeof ee!="string")throw new TypeError("Expected a string");let z=te||{},E=typeof z.maxLength=="number"?Math.min(N,z.maxLength):N;if(ee.length>E)throw new SyntaxError(`Input length (${ee.length}), exceeds max characters (${E})`);let oe={type:"root",input:ee,nodes:[]},W=[oe],se=oe,le=oe,ue=0,Ie=ee.length,ze=0,Ve=0,Ce,tt={};const ut=l(()=>ee[ze++],"advance"),Ze=l($e=>{if($e.type==="text"&&le.type==="dot"&&(le.type="text"),le&&le.type==="text"&&$e.type==="text"){le.value+=$e.value;return}return se.nodes.push($e),$e.parent=se,$e.prev=le,le=$e,$e},"push");for(Ze({type:"bos"});ze<Ie;)if(se=W[W.length-1],Ce=ut(),!(Ce===me||Ce===ge)){if(Ce===P){Ze({type:"text",value:(te.keepEscaping?Ce:"")+ut()});continue}if(Ce===V){Ze({type:"text",value:"\\"+Ce});continue}if(Ce===D){ue++;let $e=!0,De;for(;ze<Ie&&(De=ut());){if(Ce+=De,De===D){ue++;continue}if(De===P){Ce+=ut();continue}if(De===V&&(ue--,ue===0))break}Ze({type:"text",value:Ce});continue}if(Ce===b){se=Ze({type:"paren",nodes:[]}),W.push(se),Ze({type:"text",value:Ce});continue}if(Ce===R){if(se.type!=="paren"){Ze({type:"text",value:Ce});continue}se=W.pop(),Ze({type:"text",value:Ce}),se=W[W.length-1];continue}if(Ce===$||Ce===j||Ce===Q){let $e=Ce,De;for(te.keepQuotes!==!0&&(Ce="");ze<Ie&&(De=ut());){if(De===P){Ce+=De+ut();continue}if(De===$e){te.keepQuotes===!0&&(Ce+=De);break}Ce+=De}Ze({type:"text",value:Ce});continue}if(Ce===A){Ve++;let $e=le.value&&le.value.slice(-1)==="$"||se.dollar===!0;se=Ze({type:"brace",open:!0,close:!1,dollar:$e,depth:Ve,commas:0,ranges:0,nodes:[]}),W.push(se),Ze({type:"open",value:Ce});continue}if(Ce===S){if(se.type!=="brace"){Ze({type:"text",value:Ce});continue}let $e="close";se=W.pop(),se.close=!0,Ze({type:$e,value:Ce}),Ve--,se=W[W.length-1];continue}if(Ce===q&&Ve>0){if(se.ranges>0){se.ranges=0;let $e=se.nodes.shift();se.nodes=[$e,{type:"text",value:F(se)}]}Ze({type:"comma",value:Ce}),se.commas++;continue}if(Ce===U&&Ve>0&&se.commas===0){let $e=se.nodes;if(Ve===0||$e.length===0){Ze({type:"text",value:Ce});continue}if(le.type==="dot"){if(se.range=[],le.value+=Ce,le.type="range",se.nodes.length!==3&&se.nodes.length!==5){se.invalid=!0,se.ranges=0,le.type="text";continue}se.ranges++,se.args=[];continue}if(le.type==="range"){$e.pop();let De=$e[$e.length-1];De.value+=le.value+Ce,le=De,se.ranges--;continue}Ze({type:"dot",value:Ce});continue}Ze({type:"text",value:Ce})}do if(se=W.pop(),se.type!=="root"){se.nodes.forEach(_e=>{_e.nodes||(_e.type==="open"&&(_e.isOpen=!0),_e.type==="close"&&(_e.isClose=!0),_e.nodes||(_e.type="text"),_e.invalid=!0)});let $e=W[W.length-1],De=$e.nodes.indexOf(se);$e.nodes.splice(De,1,...se.nodes)}while(W.length>0);return Ze({type:"eos"}),oe},"parse");X.exports=G},3349:(X,h,O)=>{"use strict";const F=O(3083);X.exports=(N,P={})=>{let Q=l((q,U={})=>{let b=P.escapeInvalid&&F.isInvalidBrace(U),R=q.invalid===!0&&P.escapeInvalid===!0,A="";if(q.value)return(b||R)&&F.isOpenOrClose(q)?"\\"+q.value:q.value;if(q.value)return q.value;if(q.nodes)for(let S of q.nodes)A+=Q(S);return A},"stringify");return Q(N)}},3083:(X,h)=>{"use strict";h.isInteger=O=>typeof O=="number"?Number.isInteger(O):typeof O=="string"&&O.trim()!==""?Number.isInteger(Number(O)):!1,h.find=(O,F)=>O.nodes.find(N=>N.type===F),h.exceedsLimit=(O,F,N=1,P)=>P===!1||!h.isInteger(O)||!h.isInteger(F)?!1:(Number(F)-Number(O))/Number(N)>=P,h.escapeNode=(O,F=0,N)=>{let P=O.nodes[F];!P||(N&&P.type===N||P.type==="open"||P.type==="close")&&P.escaped!==!0&&(P.value="\\"+P.value,P.escaped=!0)},h.encloseBrace=O=>O.type!=="brace"?!1:O.commas>>0+O.ranges>>0==0?(O.invalid=!0,!0):!1,h.isInvalidBrace=O=>O.type!=="brace"?!1:O.invalid===!0||O.dollar?!0:O.commas>>0+O.ranges>>0==0||O.open!==!0||O.close!==!0?(O.invalid=!0,!0):!1,h.isOpenOrClose=O=>O.type==="open"||O.type==="close"?!0:O.open===!0||O.close===!0,h.reduce=O=>O.reduce((F,N)=>(N.type==="text"&&F.push(N.value),N.type==="range"&&(N.type="text"),F),[]),h.flatten=(...O)=>{const F=[],N=l(P=>{for(let Q=0;Q<P.length;Q++){let q=P[Q];Array.isArray(q)?N(q,F):q!==void 0&&F.push(q)}return F},"flat");return N(O),F}},8764:(X,h,O)=>{"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const F=O(9742),N=O(645),P=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;h.Buffer=b,h.SlowBuffer=ee,h.INSPECT_MAX_BYTES=50;const Q=2147483647;h.kMaxLength=Q,b.TYPED_ARRAY_SUPPORT=q(),!b.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function q(){try{const T=new Uint8Array(1),m={foo:function(){return 42}};return Object.setPrototypeOf(m,Uint8Array.prototype),Object.setPrototypeOf(T,m),T.foo()===42}catch(T){return!1}}l(q,"typedArraySupport"),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(!!b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(!!b.isBuffer(this))return this.byteOffset}});function U(T){if(T>Q)throw new RangeError('The value "'+T+'" is invalid for option "size"');const m=new Uint8Array(T);return Object.setPrototypeOf(m,b.prototype),m}l(U,"createBuffer");function b(T,m,w){if(typeof T=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D(T)}return R(T,m,w)}l(b,"Buffer"),b.poolSize=8192;function R(T,m,w){if(typeof T=="string")return V(T,m);if(ArrayBuffer.isView(T))return j(T);if(T==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T);if(Ee(T,ArrayBuffer)||T&&Ee(T.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ee(T,SharedArrayBuffer)||T&&Ee(T.buffer,SharedArrayBuffer)))return ge(T,m,w);if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const M=T.valueOf&&T.valueOf();if(M!=null&&M!==T)return b.from(M,m,w);const Z=me(T);if(Z)return Z;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return b.from(T[Symbol.toPrimitive]("string"),m,w);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}l(R,"from"),b.from=function(T,m,w){return R(T,m,w)},Object.setPrototypeOf(b.prototype,Uint8Array.prototype),Object.setPrototypeOf(b,Uint8Array);function A(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}l(A,"assertSize");function S(T,m,w){return A(T),T<=0?U(T):m!==void 0?typeof w=="string"?U(T).fill(m,w):U(T).fill(m):U(T)}l(S,"alloc"),b.alloc=function(T,m,w){return S(T,m,w)};function D(T){return A(T),U(T<0?0:G(T)|0)}l(D,"allocUnsafe"),b.allocUnsafe=function(T){return D(T)},b.allocUnsafeSlow=function(T){return D(T)};function V(T,m){if((typeof m!="string"||m==="")&&(m="utf8"),!b.isEncoding(m))throw new TypeError("Unknown encoding: "+m);const w=te(T,m)|0;let M=U(w);const Z=M.write(T,m);return Z!==w&&(M=M.slice(0,Z)),M}l(V,"fromString");function $(T){const m=T.length<0?0:G(T.length)|0,w=U(m);for(let M=0;M<m;M+=1)w[M]=T[M]&255;return w}l($,"fromArrayLike");function j(T){if(Ee(T,Uint8Array)){const m=new Uint8Array(T);return ge(m.buffer,m.byteOffset,m.byteLength)}return $(T)}l(j,"fromArrayView");function ge(T,m,w){if(m<0||T.byteLength<m)throw new RangeError('"offset" is outside of buffer bounds');if(T.byteLength<m+(w||0))throw new RangeError('"length" is outside of buffer bounds');let M;return m===void 0&&w===void 0?M=new Uint8Array(T):w===void 0?M=new Uint8Array(T,m):M=new Uint8Array(T,m,w),Object.setPrototypeOf(M,b.prototype),M}l(ge,"fromArrayBuffer");function me(T){if(b.isBuffer(T)){const m=G(T.length)|0,w=U(m);return w.length===0||T.copy(w,0,0,m),w}if(T.length!==void 0)return typeof T.length!="number"||st(T.length)?U(0):$(T);if(T.type==="Buffer"&&Array.isArray(T.data))return $(T.data)}l(me,"fromObject");function G(T){if(T>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return T|0}l(G,"checked");function ee(T){return+T!=T&&(T=0),b.alloc(+T)}l(ee,"SlowBuffer"),b.isBuffer=l(function(m){return m!=null&&m._isBuffer===!0&&m!==b.prototype},"isBuffer"),b.compare=l(function(m,w){if(Ee(m,Uint8Array)&&(m=b.from(m,m.offset,m.byteLength)),Ee(w,Uint8Array)&&(w=b.from(w,w.offset,w.byteLength)),!b.isBuffer(m)||!b.isBuffer(w))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===w)return 0;let M=m.length,Z=w.length;for(let ce=0,ye=Math.min(M,Z);ce<ye;++ce)if(m[ce]!==w[ce]){M=m[ce],Z=w[ce];break}return M<Z?-1:Z<M?1:0},"compare"),b.isEncoding=l(function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),b.concat=l(function(m,w){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return b.alloc(0);let M;if(w===void 0)for(w=0,M=0;M<m.length;++M)w+=m[M].length;const Z=b.allocUnsafe(w);let ce=0;for(M=0;M<m.length;++M){let ye=m[M];if(Ee(ye,Uint8Array))ce+ye.length>Z.length?(b.isBuffer(ye)||(ye=b.from(ye)),ye.copy(Z,ce)):Uint8Array.prototype.set.call(Z,ye,ce);else if(b.isBuffer(ye))ye.copy(Z,ce);else throw new TypeError('"list" argument must be an Array of Buffers');ce+=ye.length}return Z},"concat");function te(T,m){if(b.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||Ee(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);const w=T.length,M=arguments.length>2&&arguments[2]===!0;if(!M&&w===0)return 0;let Z=!1;for(;;)switch(m){case"ascii":case"latin1":case"binary":return w;case"utf8":case"utf-8":return ot(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w*2;case"hex":return w>>>1;case"base64":return He(T).length;default:if(Z)return M?-1:ot(T).length;m=(""+m).toLowerCase(),Z=!0}}l(te,"byteLength"),b.byteLength=te;function z(T,m,w){let M=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((w===void 0||w>this.length)&&(w=this.length),w<=0)||(w>>>=0,m>>>=0,w<=m))return"";for(T||(T="utf8");;)switch(T){case"hex":return De(this,m,w);case"utf8":case"utf-8":return Ce(this,m,w);case"ascii":return Ze(this,m,w);case"latin1":case"binary":return $e(this,m,w);case"base64":return Ve(this,m,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _e(this,m,w);default:if(M)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),M=!0}}l(z,"slowToString"),b.prototype._isBuffer=!0;function E(T,m,w){const M=T[m];T[m]=T[w],T[w]=M}l(E,"swap"),b.prototype.swap16=l(function(){const m=this.length;if(m%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let w=0;w<m;w+=2)E(this,w,w+1);return this},"swap16"),b.prototype.swap32=l(function(){const m=this.length;if(m%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let w=0;w<m;w+=4)E(this,w,w+3),E(this,w+1,w+2);return this},"swap32"),b.prototype.swap64=l(function(){const m=this.length;if(m%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let w=0;w<m;w+=8)E(this,w,w+7),E(this,w+1,w+6),E(this,w+2,w+5),E(this,w+3,w+4);return this},"swap64"),b.prototype.toString=l(function(){const m=this.length;return m===0?"":arguments.length===0?Ce(this,0,m):z.apply(this,arguments)},"toString"),b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=l(function(m){if(!b.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:b.compare(this,m)===0},"equals"),b.prototype.inspect=l(function(){let m="";const w=h.INSPECT_MAX_BYTES;return m=this.toString("hex",0,w).replace(/(.{2})/g,"$1 ").trim(),this.length>w&&(m+=" ... "),"<Buffer "+m+">"},"inspect"),P&&(b.prototype[P]=b.prototype.inspect),b.prototype.compare=l(function(m,w,M,Z,ce){if(Ee(m,Uint8Array)&&(m=b.from(m,m.offset,m.byteLength)),!b.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(w===void 0&&(w=0),M===void 0&&(M=m?m.length:0),Z===void 0&&(Z=0),ce===void 0&&(ce=this.length),w<0||M>m.length||Z<0||ce>this.length)throw new RangeError("out of range index");if(Z>=ce&&w>=M)return 0;if(Z>=ce)return-1;if(w>=M)return 1;if(w>>>=0,M>>>=0,Z>>>=0,ce>>>=0,this===m)return 0;let ye=ce-Z,gt=M-w;const Wt=Math.min(ye,gt),Ut=this.slice(Z,ce),Kt=m.slice(w,M);for(let Rt=0;Rt<Wt;++Rt)if(Ut[Rt]!==Kt[Rt]){ye=Ut[Rt],gt=Kt[Rt];break}return ye<gt?-1:gt<ye?1:0},"compare");function oe(T,m,w,M,Z){if(T.length===0)return-1;if(typeof w=="string"?(M=w,w=0):w>2147483647?w=2147483647:w<-2147483648&&(w=-2147483648),w=+w,st(w)&&(w=Z?0:T.length-1),w<0&&(w=T.length+w),w>=T.length){if(Z)return-1;w=T.length-1}else if(w<0)if(Z)w=0;else return-1;if(typeof m=="string"&&(m=b.from(m,M)),b.isBuffer(m))return m.length===0?-1:W(T,m,w,M,Z);if(typeof m=="number")return m=m&255,typeof Uint8Array.prototype.indexOf=="function"?Z?Uint8Array.prototype.indexOf.call(T,m,w):Uint8Array.prototype.lastIndexOf.call(T,m,w):W(T,[m],w,M,Z);throw new TypeError("val must be string, number or Buffer")}l(oe,"bidirectionalIndexOf");function W(T,m,w,M,Z){let ce=1,ye=T.length,gt=m.length;if(M!==void 0&&(M=String(M).toLowerCase(),M==="ucs2"||M==="ucs-2"||M==="utf16le"||M==="utf-16le")){if(T.length<2||m.length<2)return-1;ce=2,ye/=2,gt/=2,w/=2}function Wt(Kt,Rt){return ce===1?Kt[Rt]:Kt.readUInt16BE(Rt*ce)}l(Wt,"read");let Ut;if(Z){let Kt=-1;for(Ut=w;Ut<ye;Ut++)if(Wt(T,Ut)===Wt(m,Kt===-1?0:Ut-Kt)){if(Kt===-1&&(Kt=Ut),Ut-Kt+1===gt)return Kt*ce}else Kt!==-1&&(Ut-=Ut-Kt),Kt=-1}else for(w+gt>ye&&(w=ye-gt),Ut=w;Ut>=0;Ut--){let Kt=!0;for(let Rt=0;Rt<gt;Rt++)if(Wt(T,Ut+Rt)!==Wt(m,Rt)){Kt=!1;break}if(Kt)return Ut}return-1}l(W,"arrayIndexOf"),b.prototype.includes=l(function(m,w,M){return this.indexOf(m,w,M)!==-1},"includes"),b.prototype.indexOf=l(function(m,w,M){return oe(this,m,w,M,!0)},"indexOf"),b.prototype.lastIndexOf=l(function(m,w,M){return oe(this,m,w,M,!1)},"lastIndexOf");function se(T,m,w,M){w=Number(w)||0;const Z=T.length-w;M?(M=Number(M),M>Z&&(M=Z)):M=Z;const ce=m.length;M>ce/2&&(M=ce/2);let ye;for(ye=0;ye<M;++ye){const gt=parseInt(m.substr(ye*2,2),16);if(st(gt))return ye;T[w+ye]=gt}return ye}l(se,"hexWrite");function le(T,m,w,M){return at(ot(m,T.length-w),T,w,M)}l(le,"utf8Write");function ue(T,m,w,M){return at(wt(m),T,w,M)}l(ue,"asciiWrite");function Ie(T,m,w,M){return at(He(m),T,w,M)}l(Ie,"base64Write");function ze(T,m,w,M){return at(Ue(m,T.length-w),T,w,M)}l(ze,"ucs2Write"),b.prototype.write=l(function(m,w,M,Z){if(w===void 0)Z="utf8",M=this.length,w=0;else if(M===void 0&&typeof w=="string")Z=w,M=this.length,w=0;else if(isFinite(w))w=w>>>0,isFinite(M)?(M=M>>>0,Z===void 0&&(Z="utf8")):(Z=M,M=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ce=this.length-w;if((M===void 0||M>ce)&&(M=ce),m.length>0&&(M<0||w<0)||w>this.length)throw new RangeError("Attempt to write outside buffer bounds");Z||(Z="utf8");let ye=!1;for(;;)switch(Z){case"hex":return se(this,m,w,M);case"utf8":case"utf-8":return le(this,m,w,M);case"ascii":case"latin1":case"binary":return ue(this,m,w,M);case"base64":return Ie(this,m,w,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ze(this,m,w,M);default:if(ye)throw new TypeError("Unknown encoding: "+Z);Z=(""+Z).toLowerCase(),ye=!0}},"write"),b.prototype.toJSON=l(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function Ve(T,m,w){return m===0&&w===T.length?F.fromByteArray(T):F.fromByteArray(T.slice(m,w))}l(Ve,"base64Slice");function Ce(T,m,w){w=Math.min(T.length,w);const M=[];let Z=m;for(;Z<w;){const ce=T[Z];let ye=null,gt=ce>239?4:ce>223?3:ce>191?2:1;if(Z+gt<=w){let Wt,Ut,Kt,Rt;switch(gt){case 1:ce<128&&(ye=ce);break;case 2:Wt=T[Z+1],(Wt&192)==128&&(Rt=(ce&31)<<6|Wt&63,Rt>127&&(ye=Rt));break;case 3:Wt=T[Z+1],Ut=T[Z+2],(Wt&192)==128&&(Ut&192)==128&&(Rt=(ce&15)<<12|(Wt&63)<<6|Ut&63,Rt>2047&&(Rt<55296||Rt>57343)&&(ye=Rt));break;case 4:Wt=T[Z+1],Ut=T[Z+2],Kt=T[Z+3],(Wt&192)==128&&(Ut&192)==128&&(Kt&192)==128&&(Rt=(ce&15)<<18|(Wt&63)<<12|(Ut&63)<<6|Kt&63,Rt>65535&&Rt<1114112&&(ye=Rt))}}ye===null?(ye=65533,gt=1):ye>65535&&(ye-=65536,M.push(ye>>>10&1023|55296),ye=56320|ye&1023),M.push(ye),Z+=gt}return ut(M)}l(Ce,"utf8Slice");const tt=4096;function ut(T){const m=T.length;if(m<=tt)return String.fromCharCode.apply(String,T);let w="",M=0;for(;M<m;)w+=String.fromCharCode.apply(String,T.slice(M,M+=tt));return w}l(ut,"decodeCodePointsArray");function Ze(T,m,w){let M="";w=Math.min(T.length,w);for(let Z=m;Z<w;++Z)M+=String.fromCharCode(T[Z]&127);return M}l(Ze,"asciiSlice");function $e(T,m,w){let M="";w=Math.min(T.length,w);for(let Z=m;Z<w;++Z)M+=String.fromCharCode(T[Z]);return M}l($e,"latin1Slice");function De(T,m,w){const M=T.length;(!m||m<0)&&(m=0),(!w||w<0||w>M)&&(w=M);let Z="";for(let ce=m;ce<w;++ce)Z+=Ye[T[ce]];return Z}l(De,"hexSlice");function _e(T,m,w){const M=T.slice(m,w);let Z="";for(let ce=0;ce<M.length-1;ce+=2)Z+=String.fromCharCode(M[ce]+M[ce+1]*256);return Z}l(_e,"utf16leSlice"),b.prototype.slice=l(function(m,w){const M=this.length;m=~~m,w=w===void 0?M:~~w,m<0?(m+=M,m<0&&(m=0)):m>M&&(m=M),w<0?(w+=M,w<0&&(w=0)):w>M&&(w=M),w<m&&(w=m);const Z=this.subarray(m,w);return Object.setPrototypeOf(Z,b.prototype),Z},"slice");function Qe(T,m,w){if(T%1!=0||T<0)throw new RangeError("offset is not uint");if(T+m>w)throw new RangeError("Trying to access beyond buffer length")}l(Qe,"checkOffset"),b.prototype.readUintLE=b.prototype.readUIntLE=l(function(m,w,M){m=m>>>0,w=w>>>0,M||Qe(m,w,this.length);let Z=this[m],ce=1,ye=0;for(;++ye<w&&(ce*=256);)Z+=this[m+ye]*ce;return Z},"readUIntLE"),b.prototype.readUintBE=b.prototype.readUIntBE=l(function(m,w,M){m=m>>>0,w=w>>>0,M||Qe(m,w,this.length);let Z=this[m+--w],ce=1;for(;w>0&&(ce*=256);)Z+=this[m+--w]*ce;return Z},"readUIntBE"),b.prototype.readUint8=b.prototype.readUInt8=l(function(m,w){return m=m>>>0,w||Qe(m,1,this.length),this[m]},"readUInt8"),b.prototype.readUint16LE=b.prototype.readUInt16LE=l(function(m,w){return m=m>>>0,w||Qe(m,2,this.length),this[m]|this[m+1]<<8},"readUInt16LE"),b.prototype.readUint16BE=b.prototype.readUInt16BE=l(function(m,w){return m=m>>>0,w||Qe(m,2,this.length),this[m]<<8|this[m+1]},"readUInt16BE"),b.prototype.readUint32LE=b.prototype.readUInt32LE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},"readUInt32LE"),b.prototype.readUint32BE=b.prototype.readUInt32BE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},"readUInt32BE"),b.prototype.readBigUInt64LE=$t(l(function(m){m=m>>>0,_t(m,"offset");const w=this[m],M=this[m+7];(w===void 0||M===void 0)&&Or(m,this.length-8);const Z=w+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,ce=this[++m]+this[++m]*2**8+this[++m]*2**16+M*2**24;return BigInt(Z)+(BigInt(ce)<<BigInt(32))},"readBigUInt64LE")),b.prototype.readBigUInt64BE=$t(l(function(m){m=m>>>0,_t(m,"offset");const w=this[m],M=this[m+7];(w===void 0||M===void 0)&&Or(m,this.length-8);const Z=w*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],ce=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+M;return(BigInt(Z)<<BigInt(32))+BigInt(ce)},"readBigUInt64BE")),b.prototype.readIntLE=l(function(m,w,M){m=m>>>0,w=w>>>0,M||Qe(m,w,this.length);let Z=this[m],ce=1,ye=0;for(;++ye<w&&(ce*=256);)Z+=this[m+ye]*ce;return ce*=128,Z>=ce&&(Z-=Math.pow(2,8*w)),Z},"readIntLE"),b.prototype.readIntBE=l(function(m,w,M){m=m>>>0,w=w>>>0,M||Qe(m,w,this.length);let Z=w,ce=1,ye=this[m+--Z];for(;Z>0&&(ce*=256);)ye+=this[m+--Z]*ce;return ce*=128,ye>=ce&&(ye-=Math.pow(2,8*w)),ye},"readIntBE"),b.prototype.readInt8=l(function(m,w){return m=m>>>0,w||Qe(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},"readInt8"),b.prototype.readInt16LE=l(function(m,w){m=m>>>0,w||Qe(m,2,this.length);const M=this[m]|this[m+1]<<8;return M&32768?M|4294901760:M},"readInt16LE"),b.prototype.readInt16BE=l(function(m,w){m=m>>>0,w||Qe(m,2,this.length);const M=this[m+1]|this[m]<<8;return M&32768?M|4294901760:M},"readInt16BE"),b.prototype.readInt32LE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},"readInt32LE"),b.prototype.readInt32BE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},"readInt32BE"),b.prototype.readBigInt64LE=$t(l(function(m){m=m>>>0,_t(m,"offset");const w=this[m],M=this[m+7];(w===void 0||M===void 0)&&Or(m,this.length-8);const Z=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(M<<24);return(BigInt(Z)<<BigInt(32))+BigInt(w+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24)},"readBigInt64LE")),b.prototype.readBigInt64BE=$t(l(function(m){m=m>>>0,_t(m,"offset");const w=this[m],M=this[m+7];(w===void 0||M===void 0)&&Or(m,this.length-8);const Z=(w<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(Z)<<BigInt(32))+BigInt(this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+M)},"readBigInt64BE")),b.prototype.readFloatLE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),N.read(this,m,!0,23,4)},"readFloatLE"),b.prototype.readFloatBE=l(function(m,w){return m=m>>>0,w||Qe(m,4,this.length),N.read(this,m,!1,23,4)},"readFloatBE"),b.prototype.readDoubleLE=l(function(m,w){return m=m>>>0,w||Qe(m,8,this.length),N.read(this,m,!0,52,8)},"readDoubleLE"),b.prototype.readDoubleBE=l(function(m,w){return m=m>>>0,w||Qe(m,8,this.length),N.read(this,m,!1,52,8)},"readDoubleBE");function ne(T,m,w,M,Z,ce){if(!b.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>Z||m<ce)throw new RangeError('"value" argument is out of bounds');if(w+M>T.length)throw new RangeError("Index out of range")}l(ne,"checkInt"),b.prototype.writeUintLE=b.prototype.writeUIntLE=l(function(m,w,M,Z){if(m=+m,w=w>>>0,M=M>>>0,!Z){const gt=Math.pow(2,8*M)-1;ne(this,m,w,M,gt,0)}let ce=1,ye=0;for(this[w]=m&255;++ye<M&&(ce*=256);)this[w+ye]=m/ce&255;return w+M},"writeUIntLE"),b.prototype.writeUintBE=b.prototype.writeUIntBE=l(function(m,w,M,Z){if(m=+m,w=w>>>0,M=M>>>0,!Z){const gt=Math.pow(2,8*M)-1;ne(this,m,w,M,gt,0)}let ce=M-1,ye=1;for(this[w+ce]=m&255;--ce>=0&&(ye*=256);)this[w+ce]=m/ye&255;return w+M},"writeUIntBE"),b.prototype.writeUint8=b.prototype.writeUInt8=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,1,255,0),this[w]=m&255,w+1},"writeUInt8"),b.prototype.writeUint16LE=b.prototype.writeUInt16LE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,2,65535,0),this[w]=m&255,this[w+1]=m>>>8,w+2},"writeUInt16LE"),b.prototype.writeUint16BE=b.prototype.writeUInt16BE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,2,65535,0),this[w]=m>>>8,this[w+1]=m&255,w+2},"writeUInt16BE"),b.prototype.writeUint32LE=b.prototype.writeUInt32LE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,4,4294967295,0),this[w+3]=m>>>24,this[w+2]=m>>>16,this[w+1]=m>>>8,this[w]=m&255,w+4},"writeUInt32LE"),b.prototype.writeUint32BE=b.prototype.writeUInt32BE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,4,4294967295,0),this[w]=m>>>24,this[w+1]=m>>>16,this[w+2]=m>>>8,this[w+3]=m&255,w+4},"writeUInt32BE");function vt(T,m,w,M,Z){Et(m,M,Z,T,w,7);let ce=Number(m&BigInt(4294967295));T[w++]=ce,ce=ce>>8,T[w++]=ce,ce=ce>>8,T[w++]=ce,ce=ce>>8,T[w++]=ce;let ye=Number(m>>BigInt(32)&BigInt(4294967295));return T[w++]=ye,ye=ye>>8,T[w++]=ye,ye=ye>>8,T[w++]=ye,ye=ye>>8,T[w++]=ye,w}l(vt,"wrtBigUInt64LE");function Ke(T,m,w,M,Z){Et(m,M,Z,T,w,7);let ce=Number(m&BigInt(4294967295));T[w+7]=ce,ce=ce>>8,T[w+6]=ce,ce=ce>>8,T[w+5]=ce,ce=ce>>8,T[w+4]=ce;let ye=Number(m>>BigInt(32)&BigInt(4294967295));return T[w+3]=ye,ye=ye>>8,T[w+2]=ye,ye=ye>>8,T[w+1]=ye,ye=ye>>8,T[w]=ye,w+8}l(Ke,"wrtBigUInt64BE"),b.prototype.writeBigUInt64LE=$t(l(function(m,w=0){return vt(this,m,w,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),b.prototype.writeBigUInt64BE=$t(l(function(m,w=0){return Ke(this,m,w,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),b.prototype.writeIntLE=l(function(m,w,M,Z){if(m=+m,w=w>>>0,!Z){const Wt=Math.pow(2,8*M-1);ne(this,m,w,M,Wt-1,-Wt)}let ce=0,ye=1,gt=0;for(this[w]=m&255;++ce<M&&(ye*=256);)m<0&&gt===0&&this[w+ce-1]!==0&&(gt=1),this[w+ce]=(m/ye>>0)-gt&255;return w+M},"writeIntLE"),b.prototype.writeIntBE=l(function(m,w,M,Z){if(m=+m,w=w>>>0,!Z){const Wt=Math.pow(2,8*M-1);ne(this,m,w,M,Wt-1,-Wt)}let ce=M-1,ye=1,gt=0;for(this[w+ce]=m&255;--ce>=0&&(ye*=256);)m<0&&gt===0&&this[w+ce+1]!==0&&(gt=1),this[w+ce]=(m/ye>>0)-gt&255;return w+M},"writeIntBE"),b.prototype.writeInt8=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,1,127,-128),m<0&&(m=255+m+1),this[w]=m&255,w+1},"writeInt8"),b.prototype.writeInt16LE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,2,32767,-32768),this[w]=m&255,this[w+1]=m>>>8,w+2},"writeInt16LE"),b.prototype.writeInt16BE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,2,32767,-32768),this[w]=m>>>8,this[w+1]=m&255,w+2},"writeInt16BE"),b.prototype.writeInt32LE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,4,2147483647,-2147483648),this[w]=m&255,this[w+1]=m>>>8,this[w+2]=m>>>16,this[w+3]=m>>>24,w+4},"writeInt32LE"),b.prototype.writeInt32BE=l(function(m,w,M){return m=+m,w=w>>>0,M||ne(this,m,w,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[w]=m>>>24,this[w+1]=m>>>16,this[w+2]=m>>>8,this[w+3]=m&255,w+4},"writeInt32BE"),b.prototype.writeBigInt64LE=$t(l(function(m,w=0){return vt(this,m,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),b.prototype.writeBigInt64BE=$t(l(function(m,w=0){return Ke(this,m,w,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ct(T,m,w,M,Z,ce){if(w+M>T.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("Index out of range")}l(ct,"checkIEEE754");function he(T,m,w,M,Z){return m=+m,w=w>>>0,Z||ct(T,m,w,4,34028234663852886e22,-34028234663852886e22),N.write(T,m,w,M,23,4),w+4}l(he,"writeFloat"),b.prototype.writeFloatLE=l(function(m,w,M){return he(this,m,w,!0,M)},"writeFloatLE"),b.prototype.writeFloatBE=l(function(m,w,M){return he(this,m,w,!1,M)},"writeFloatBE");function de(T,m,w,M,Z){return m=+m,w=w>>>0,Z||ct(T,m,w,8,17976931348623157e292,-17976931348623157e292),N.write(T,m,w,M,52,8),w+8}l(de,"writeDouble"),b.prototype.writeDoubleLE=l(function(m,w,M){return de(this,m,w,!0,M)},"writeDoubleLE"),b.prototype.writeDoubleBE=l(function(m,w,M){return de(this,m,w,!1,M)},"writeDoubleBE"),b.prototype.copy=l(function(m,w,M,Z){if(!b.isBuffer(m))throw new TypeError("argument should be a Buffer");if(M||(M=0),!Z&&Z!==0&&(Z=this.length),w>=m.length&&(w=m.length),w||(w=0),Z>0&&Z<M&&(Z=M),Z===M||m.length===0||this.length===0)return 0;if(w<0)throw new RangeError("targetStart out of bounds");if(M<0||M>=this.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("sourceEnd out of bounds");Z>this.length&&(Z=this.length),m.length-w<Z-M&&(Z=m.length-w+M);const ce=Z-M;return this===m&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(w,M,Z):Uint8Array.prototype.set.call(m,this.subarray(M,Z),w),ce},"copy"),b.prototype.fill=l(function(m,w,M,Z){if(typeof m=="string"){if(typeof w=="string"?(Z=w,w=0,M=this.length):typeof M=="string"&&(Z=M,M=this.length),Z!==void 0&&typeof Z!="string")throw new TypeError("encoding must be a string");if(typeof Z=="string"&&!b.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z);if(m.length===1){const ye=m.charCodeAt(0);(Z==="utf8"&&ye<128||Z==="latin1")&&(m=ye)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(w<0||this.length<w||this.length<M)throw new RangeError("Out of range index");if(M<=w)return this;w=w>>>0,M=M===void 0?this.length:M>>>0,m||(m=0);let ce;if(typeof m=="number")for(ce=w;ce<M;++ce)this[ce]=m;else{const ye=b.isBuffer(m)?m:b.from(m,Z),gt=ye.length;if(gt===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(ce=0;ce<M-w;++ce)this[ce+w]=ye[ce%gt]}return this},"fill");const qe={};function rt(T,m,w){qe[T]=l(class extends w{constructor(){super();Object.defineProperty(this,"message",{value:m.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${T}]`,this.stack,delete this.name}get code(){return T}set code(Z){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Z,writable:!0})}toString(){return`${this.name} [${T}]: ${this.message}`}},"NodeError")}l(rt,"E"),rt("ERR_BUFFER_OUT_OF_BOUNDS",function(T){return T?`${T} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),rt("ERR_INVALID_ARG_TYPE",function(T,m){return`The "${T}" argument must be of type number. Received type ${typeof m}`},TypeError),rt("ERR_OUT_OF_RANGE",function(T,m,w){let M=`The value of "${T}" is out of range.`,Z=w;return Number.isInteger(w)&&Math.abs(w)>2**32?Z=pt(String(w)):typeof w=="bigint"&&(Z=String(w),(w>BigInt(2)**BigInt(32)||w<-(BigInt(2)**BigInt(32)))&&(Z=pt(Z)),Z+="n"),M+=` It must be ${m}. Received ${Z}`,M},RangeError);function pt(T){let m="",w=T.length;const M=T[0]==="-"?1:0;for(;w>=M+4;w-=3)m=`_${T.slice(w-3,w)}${m}`;return`${T.slice(0,w)}${m}`}l(pt,"addNumericalSeparator");function Vt(T,m,w){_t(m,"offset"),(T[m]===void 0||T[m+w]===void 0)&&Or(m,T.length-(w+1))}l(Vt,"checkBounds");function Et(T,m,w,M,Z,ce){if(T>w||T<m){const ye=typeof m=="bigint"?"n":"";let gt;throw ce>3?m===0||m===BigInt(0)?gt=`>= 0${ye} and < 2${ye} ** ${(ce+1)*8}${ye}`:gt=`>= -(2${ye} ** ${(ce+1)*8-1}${ye}) and < 2 ** ${(ce+1)*8-1}${ye}`:gt=`>= ${m}${ye} and <= ${w}${ye}`,new qe.ERR_OUT_OF_RANGE("value",gt,T)}Vt(M,Z,ce)}l(Et,"checkIntBI");function _t(T,m){if(typeof T!="number")throw new qe.ERR_INVALID_ARG_TYPE(m,"number",T)}l(_t,"validateNumber");function Or(T,m,w){throw Math.floor(T)!==T?(_t(T,w),new qe.ERR_OUT_OF_RANGE(w||"offset","an integer",T)):m<0?new qe.ERR_BUFFER_OUT_OF_BOUNDS:new qe.ERR_OUT_OF_RANGE(w||"offset",`>= ${w?1:0} and <= ${m}`,T)}l(Or,"boundsError");const Gt=/[^+/0-9A-Za-z-_]/g;function sr(T){if(T=T.split("=")[0],T=T.trim().replace(Gt,""),T.length<2)return"";for(;T.length%4!=0;)T=T+"=";return T}l(sr,"base64clean");function ot(T,m){m=m||1/0;let w;const M=T.length;let Z=null;const ce=[];for(let ye=0;ye<M;++ye){if(w=T.charCodeAt(ye),w>55295&&w<57344){if(!Z){if(w>56319){(m-=3)>-1&&ce.push(239,191,189);continue}else if(ye+1===M){(m-=3)>-1&&ce.push(239,191,189);continue}Z=w;continue}if(w<56320){(m-=3)>-1&&ce.push(239,191,189),Z=w;continue}w=(Z-55296<<10|w-56320)+65536}else Z&&(m-=3)>-1&&ce.push(239,191,189);if(Z=null,w<128){if((m-=1)<0)break;ce.push(w)}else if(w<2048){if((m-=2)<0)break;ce.push(w>>6|192,w&63|128)}else if(w<65536){if((m-=3)<0)break;ce.push(w>>12|224,w>>6&63|128,w&63|128)}else if(w<1114112){if((m-=4)<0)break;ce.push(w>>18|240,w>>12&63|128,w>>6&63|128,w&63|128)}else throw new Error("Invalid code point")}return ce}l(ot,"utf8ToBytes");function wt(T){const m=[];for(let w=0;w<T.length;++w)m.push(T.charCodeAt(w)&255);return m}l(wt,"asciiToBytes");function Ue(T,m){let w,M,Z;const ce=[];for(let ye=0;ye<T.length&&!((m-=2)<0);++ye)w=T.charCodeAt(ye),M=w>>8,Z=w%256,ce.push(Z),ce.push(M);return ce}l(Ue,"utf16leToBytes");function He(T){return F.toByteArray(sr(T))}l(He,"base64ToBytes");function at(T,m,w,M){let Z;for(Z=0;Z<M&&!(Z+w>=m.length||Z>=T.length);++Z)m[Z+w]=T[Z];return Z}l(at,"blitBuffer");function Ee(T,m){return T instanceof m||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===m.name}l(Ee,"isInstance");function st(T){return T!==T}l(st,"numberIsNaN");const Ye=function(){const T="0123456789abcdef",m=new Array(256);for(let w=0;w<16;++w){const M=w*16;for(let Z=0;Z<16;++Z)m[M+Z]=T[w]+T[Z]}return m}();function $t(T){return typeof BigInt=="undefined"?xt:T}l($t,"defineBigIntMethod");function xt(){throw new Error("BigInt not supported")}l(xt,"BufferBigIntNotDefined")},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(X){const h=await strtok3.fromStream(X);try{return await fromTokenizer(h)}finally{await h.close()}}l(fromStream,"fromStream");async function fromBuffer(X){if(!(X instanceof Uint8Array||X instanceof ArrayBuffer||Buffer.isBuffer(X)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof X}\``);const h=X instanceof Buffer?X:Buffer.from(X);if(!(h&&h.length>1))return;const O=strtok3.fromBuffer(h);return fromTokenizer(O)}l(fromBuffer,"fromBuffer");function _check(X,h,O){O={offset:0,...O};for(const[F,N]of h.entries())if(O.mask){if(N!==(O.mask[F]&X[F+O.offset]))return!1}else if(N!==X[F+O.offset])return!1;return!0}l(_check,"_check");async function fromTokenizer(X){try{return _fromTokenizer(X)}catch(h){if(!(h instanceof strtok3.EndOfStreamError))throw h}}l(fromTokenizer,"fromTokenizer");async function _fromTokenizer(X){let h=Buffer.alloc(minimumBytes);const O=12,F=l((P,Q)=>_check(h,P,Q),"check"),N=l((P,Q)=>F(stringToBytes(P),Q),"checkString");if(X.fileInfo.size||(X.fileInfo.size=Number.MAX_SAFE_INTEGER),await X.peekBuffer(h,{length:O,mayBeLess:!0}),F([66,77]))return{ext:"bmp",mime:"image/bmp"};if(F([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(F([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(F([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(F([37,33]))return await X.peekBuffer(h,{length:24,mayBeLess:!0}),N("PS-Adobe-",{offset:2})&&N(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(F([31,160])||F([31,157]))return{ext:"Z",mime:"application/x-compress"};if(F([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(F([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(F([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(F([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(N("ID3")){await X.ignore(6);const P=await X.readToken(uint32SyncSafeToken);return X.position+P>X.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await X.ignore(P),fromTokenizer(X))}if(N("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((h[0]===67||h[0]===70)&&F([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(F([71,73,70]))return{ext:"gif",mime:"image/gif"};if(N("FLIF"))return{ext:"flif",mime:"image/flif"};if(N("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(N("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(N("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(N("FORM"))return{ext:"aif",mime:"audio/aiff"};if(N("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(F([80,75,3,4])){try{for(;X.position+30<X.fileInfo.size;){await X.readBuffer(h,{length:30});const P={compressedSize:h.readUInt32LE(18),uncompressedSize:h.readUInt32LE(22),filenameLength:h.readUInt16LE(26),extraFieldLength:h.readUInt16LE(28)};if(P.filename=await X.readToken(new Token.StringType(P.filenameLength,"utf-8")),await X.ignore(P.extraFieldLength),P.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(P.filename.endsWith(".rels")||P.filename.endsWith(".xml"))switch(P.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(P.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(P.filename.startsWith("3D/")&&P.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(P.filename==="mimetype"&&P.compressedSize===P.uncompressedSize)switch(await X.readToken(new Token.StringType(P.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(P.compressedSize===0){let Q=-1;for(;Q<0&&X.position<X.fileInfo.size;)await X.peekBuffer(h,{mayBeLess:!0}),Q=h.indexOf("504B0304",0,"hex"),await X.ignore(Q>=0?Q:h.length)}else await X.ignore(P.compressedSize)}}catch(P){if(!(P instanceof strtok3.EndOfStreamError))throw P}return{ext:"zip",mime:"application/zip"}}if(N("OggS")){await X.ignore(28);const P=Buffer.alloc(8);return await X.readBuffer(P),_check(P,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(P,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(P,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(P,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(P,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(P,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(F([80,75])&&(h[2]===3||h[2]===5||h[2]===7)&&(h[3]===4||h[3]===6||h[3]===8))return{ext:"zip",mime:"application/zip"};if(N("ftyp",{offset:4})&&(h[8]&96)!=0){const P=h.toString("binary",8,12).replace("\0"," ").trim();switch(P){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return P.startsWith("3g")?P.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(N("MThd"))return{ext:"mid",mime:"audio/midi"};if(N("wOFF")&&(F([0,1,0,0],{offset:4})||N("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(N("wOF2")&&(F([0,1,0,0],{offset:4})||N("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(F([212,195,178,161])||F([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(N("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(N("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(N("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(F([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(N("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(N("%PDF")){await X.ignore(1350);const P=10*1024*1024,Q=Buffer.alloc(Math.min(P,X.fileInfo.size));return await X.readBuffer(Q,{mayBeLess:!0}),Q.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(F([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(F([73,73,42,0]))return N("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:F([28,0,254,0],{offset:8})||F([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:F([8,0,0,0],{offset:4})&&(F([45,0,254,0],{offset:8})||F([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(h=Buffer.alloc(24),await X.peekBuffer(h),(F([16,251,134,1],{offset:4})||F([8,0,0,0],{offset:4}))&&F([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(F([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(N("MAC "))return{ext:"ape",mime:"audio/ape"};if(F([26,69,223,163])){async function P(){const R=await X.peekNumber(Token.UINT8);let A=128,S=0;for(;(R&A)==0;)++S,A>>=1;const D=Buffer.alloc(S+1);return await X.readBuffer(D),D}l(P,"readField");async function Q(){const R=await P(),A=await P();A[0]^=128>>A.length-1;const S=Math.min(6,A.length);return{id:R.readUIntBE(0,R.length),len:A.readUIntBE(A.length-S,S)}}l(Q,"readElement");async function q(R,A){for(;A>0;){const S=await Q();if(S.id===17026)return X.readToken(new Token.StringType(S.len,"utf-8"));await X.ignore(S.len),--A}}l(q,"readChildren");const U=await Q();switch(await q(1,U.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(F([82,73,70,70])){if(F([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(F([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(F([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(N("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(F([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(N("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(N("MSCF")||N("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(F([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(F([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(F([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(F([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(N("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(N("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(F([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(N("IMPM"))return{ext:"it",mime:"audio/x-it"};if(N("-lh0-",{offset:2})||N("-lh1-",{offset:2})||N("-lh2-",{offset:2})||N("-lh3-",{offset:2})||N("-lh4-",{offset:2})||N("-lh5-",{offset:2})||N("-lh6-",{offset:2})||N("-lh7-",{offset:2})||N("-lzs-",{offset:2})||N("-lz4-",{offset:2})||N("-lz5-",{offset:2})||N("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(F([0,0,1,186])){if(F([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(F([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(N("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(F([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(N("<?xml "))return{ext:"xml",mime:"application/xml"};if(F([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(F([82,97,114,33,26,7])&&(h[6]===0||h[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(N("solid "))return{ext:"stl",mime:"model/stl"};if(N("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(N("!<arch>"))return await X.ignore(8),await X.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(F([137,80,78,71,13,10,26,10])){await X.ignore(8);async function P(){return{length:await X.readToken(Token.INT32_BE),type:await X.readToken(new Token.StringType(4,"binary"))}}l(P,"readChunkHeader");do{const Q=await P();if(Q.length<0)return;switch(Q.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await X.ignore(Q.length+4)}}while(X.position+8<X.fileInfo.size);return{ext:"png",mime:"image/png"}}if(F([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(F([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(F([102,114,101,101],{offset:4})||F([109,100,97,116],{offset:4})||F([109,111,111,118],{offset:4})||F([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(F([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(N("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(F([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(F([48,38,178,117,142,102,207,17,166,217])){async function P(){const Q=Buffer.alloc(16);return await X.readBuffer(Q),{id:Q,size:Number(await X.readToken(Token.UINT64_LE))}}for(l(P,"readHeader"),await X.ignore(30);X.position+24<X.fileInfo.size;){const Q=await P();let q=Q.size-24;if(_check(Q.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const U=Buffer.alloc(16);if(q-=await X.readBuffer(U),_check(U,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(U,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await X.ignore(q)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(F([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((F([126,16,4])||F([126,24,4]))&&F([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(F([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(F([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await X.ignore(20),await X.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(F([255,10])||F([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(F([0,0,1,186])||F([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(F([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(F([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(F([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(F([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await X.peekBuffer(h,{length:Math.min(256,X.fileInfo.size),mayBeLess:!0}),N("BEGIN:")){if(N("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(N("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(N("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(N("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(N("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(F([4,0,0,0])&&h.length>=16){const P=h.readUInt32LE(12);if(P>12&&h.length>=P+16)try{const Q=h.slice(16,P+16).toString();if(JSON.parse(Q).files)return{ext:"asar",mime:"application/x-asar"}}catch(Q){}}if(F([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(N("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(F([71],{offset:4})&&(F([71],{offset:192})||F([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(F([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(F([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(F([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(F([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(F([76,80],{offset:34})&&(F([0,0,1],{offset:8})||F([1,0,2],{offset:8})||F([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(F([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await X.peekBuffer(h,{length:Math.min(512,X.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(h))return{ext:"tar",mime:"application/x-tar"};if(F([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(N("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(h.length>=2&&F([255,224],{offset:0,mask:[255,224]})){if(F([16],{offset:1,mask:[22]}))return F([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(F([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(F([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(F([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}l(_fromTokenizer,"_fromTokenizer");const stream=l(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const X=new stream.PassThrough;let h;stream.pipeline?h=stream.pipeline(readableStream,X,()=>{}):h=readableStream.pipe(X);const O=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const F=await fromBuffer(O);X.fileType=F}catch(F){reject(F)}resolve(h)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(X,h,O)=>{"use strict";const F=O(6597),N=O(1);async function P(q){const U=await F.fromFile(q);try{return await N.fromTokenizer(U)}finally{await U.close()}}l(P,"fromFile");const Q={fromFile:P};Object.assign(Q,N),Object.defineProperty(Q,"extensions",{get(){return N.extensions}}),Object.defineProperty(Q,"mimeTypes",{get(){return N.mimeTypes}}),X.exports=Q},9898:X=>{"use strict";X.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(X,h)=>{"use strict";h.stringToBytes=O=>[...O].map(F=>F.charCodeAt(0)),h.tarHeaderChecksumMatches=(O,F=0)=>{const N=parseInt(O.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(N))return!1;let P=8*32;for(let Q=F;Q<F+148;Q++)P+=O[Q];for(let Q=F+156;Q<F+512;Q++)P+=O[Q];return N===P},h.uint32SyncSafeToken={get:(O,F)=>O[F+3]&127|O[F+2]<<7|O[F+1]<<14|O[F]<<21,len:4}},2664:(X,h,O)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const F=O(1932),N=O(5702),P=l(z=>z!==null&&typeof z=="object"&&!Array.isArray(z),"isObject"),Q=l(z=>E=>z===!0?Number(E):String(E),"transform"),q=l(z=>typeof z=="number"||typeof z=="string"&&z!=="","isValidValue"),U=l(z=>Number.isInteger(+z),"isNumber"),b=l(z=>{let E=`${z}`,oe=-1;if(E[0]==="-"&&(E=E.slice(1)),E==="0")return!1;for(;E[++oe]==="0";);return oe>0},"zeros"),R=l((z,E,oe)=>typeof z=="string"||typeof E=="string"?!0:oe.stringify===!0,"stringify"),A=l((z,E,oe)=>{if(E>0){let W=z[0]==="-"?"-":"";W&&(z=z.slice(1)),z=W+z.padStart(W?E-1:E,"0")}return oe===!1?String(z):z},"pad"),S=l((z,E)=>{let oe=z[0]==="-"?"-":"";for(oe&&(z=z.slice(1),E--);z.length<E;)z="0"+z;return oe?"-"+z:z},"toMaxLen"),D=l((z,E)=>{z.negatives.sort((ue,Ie)=>ue<Ie?-1:ue>Ie?1:0),z.positives.sort((ue,Ie)=>ue<Ie?-1:ue>Ie?1:0);let oe=E.capture?"":"?:",W="",se="",le;return z.positives.length&&(W=z.positives.join("|")),z.negatives.length&&(se=`-(${oe}${z.negatives.join("|")})`),W&&se?le=`${W}|${se}`:le=W||se,E.wrap?`(${oe}${le})`:le},"toSequence"),V=l((z,E,oe,W)=>{if(oe)return N(z,E,{wrap:!1,...W});let se=String.fromCharCode(z);if(z===E)return se;let le=String.fromCharCode(E);return`[${se}-${le}]`},"toRange"),$=l((z,E,oe)=>{if(Array.isArray(z)){let W=oe.wrap===!0,se=oe.capture?"":"?:";return W?`(${se}${z.join("|")})`:z.join("|")}return N(z,E,oe)},"toRegex"),j=l((...z)=>new RangeError("Invalid range arguments: "+F.inspect(...z)),"rangeError"),ge=l((z,E,oe)=>{if(oe.strictRanges===!0)throw j([z,E]);return[]},"invalidRange"),me=l((z,E)=>{if(E.strictRanges===!0)throw new TypeError(`Expected step "${z}" to be a number`);return[]},"invalidStep"),G=l((z,E,oe=1,W={})=>{let se=Number(z),le=Number(E);if(!Number.isInteger(se)||!Number.isInteger(le)){if(W.strictRanges===!0)throw j([z,E]);return[]}se===0&&(se=0),le===0&&(le=0);let ue=se>le,Ie=String(z),ze=String(E),Ve=String(oe);oe=Math.max(Math.abs(oe),1);let Ce=b(Ie)||b(ze)||b(Ve),tt=Ce?Math.max(Ie.length,ze.length,Ve.length):0,ut=Ce===!1&&R(z,E,W)===!1,Ze=W.transform||Q(ut);if(W.toRegex&&oe===1)return V(S(z,tt),S(E,tt),!0,W);let $e={negatives:[],positives:[]},De=l(ne=>$e[ne<0?"negatives":"positives"].push(Math.abs(ne)),"push"),_e=[],Qe=0;for(;ue?se>=le:se<=le;)W.toRegex===!0&&oe>1?De(se):_e.push(A(Ze(se,Qe),tt,ut)),se=ue?se-oe:se+oe,Qe++;return W.toRegex===!0?oe>1?D($e,W):$(_e,null,{wrap:!1,...W}):_e},"fillNumbers"),ee=l((z,E,oe=1,W={})=>{if(!U(z)&&z.length>1||!U(E)&&E.length>1)return ge(z,E,W);let se=W.transform||(ut=>String.fromCharCode(ut)),le=`${z}`.charCodeAt(0),ue=`${E}`.charCodeAt(0),Ie=le>ue,ze=Math.min(le,ue),Ve=Math.max(le,ue);if(W.toRegex&&oe===1)return V(ze,Ve,!1,W);let Ce=[],tt=0;for(;Ie?le>=ue:le<=ue;)Ce.push(se(le,tt)),le=Ie?le-oe:le+oe,tt++;return W.toRegex===!0?$(Ce,null,{wrap:!1,options:W}):Ce},"fillLetters"),te=l((z,E,oe,W={})=>{if(E==null&&q(z))return[z];if(!q(z)||!q(E))return ge(z,E,W);if(typeof oe=="function")return te(z,E,1,{transform:oe});if(P(oe))return te(z,E,0,oe);let se={...W};return se.capture===!0&&(se.wrap=!0),oe=oe||se.step||1,U(oe)?U(z)&&U(E)?G(z,E,oe,se):ee(z,E,Math.max(Math.abs(oe),1),se):oe!=null&&!P(oe)?me(oe,se):te(z,E,1,oe)},"fill");X.exports=te},7360:function(X,h){var O,F,N;(function(P,Q){F=[],O=Q,N=typeof O=="function"?O.apply(h,F):O,N!==void 0&&(X.exports=N)})(this,l(function(){function Q(G){var ee={single:function(te,z,E){if(!te||(j(te)||(te=ee.getPreparedSearch(te)),!z))return null;j(z)||(z=ee.getPrepared(z));var oe=E&&E.allowTypo!==void 0?E.allowTypo:G&&G.allowTypo!==void 0?G.allowTypo:!0,W=oe?ee.algorithm:ee.algorithmNoTypo;return W(te,z,te[0])},go:function(te,z,E){if(!te)return R;te=ee.prepareSearch(te);var oe=te[0],W=E&&E.threshold||G&&G.threshold||-9007199254740991,se=E&&E.limit||G&&G.limit||9007199254740991,le=E&&E.allowTypo!==void 0?E.allowTypo:G&&G.allowTypo!==void 0?G.allowTypo:!0,ue=le?ee.algorithm:ee.algorithmNoTypo,Ie=0,ze=0,Ve=z.length;if(E&&E.keys)for(var Ce=E.scoreFn||V,tt=E.keys,ut=tt.length,Ze=Ve-1;Ze>=0;--Ze){for(var $e=z[Ze],De=new Array(ut),_e=ut-1;_e>=0;--_e){var Qe=tt[_e],ne=$($e,Qe);if(!ne){De[_e]=null;continue}j(ne)||(ne=ee.getPrepared(ne)),De[_e]=ue(te,ne,oe)}De.obj=$e;var vt=Ce(De);vt!==null&&(vt<W||(De.score=vt,Ie<se?(me.add(De),++Ie):(++ze,vt>me.peek().score&&me.replaceTop(De))))}else if(E&&E.key)for(var Qe=E.key,Ze=Ve-1;Ze>=0;--Ze){var $e=z[Ze],ne=$($e,Qe);if(!!ne){j(ne)||(ne=ee.getPrepared(ne));var Ke=ue(te,ne,oe);Ke!==null&&(Ke.score<W||(Ke={target:Ke.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ke.score,indexes:Ke.indexes,obj:$e},Ie<se?(me.add(Ke),++Ie):(++ze,Ke.score>me.peek().score&&me.replaceTop(Ke))))}}else for(var Ze=Ve-1;Ze>=0;--Ze){var ne=z[Ze];if(!!ne){j(ne)||(ne=ee.getPrepared(ne));var Ke=ue(te,ne,oe);Ke!==null&&(Ke.score<W||(Ie<se?(me.add(Ke),++Ie):(++ze,Ke.score>me.peek().score&&me.replaceTop(Ke))))}}if(Ie===0)return R;for(var ct=new Array(Ie),Ze=Ie-1;Ze>=0;--Ze)ct[Ze]=me.poll();return ct.total=Ie+ze,ct},goAsync:function(te,z,E){var oe=!1,W=new Promise(function(se,le){if(!te)return se(R);te=ee.prepareSearch(te);var ue=te[0],Ie=ge(),ze=z.length-1,Ve=E&&E.threshold||G&&G.threshold||-9007199254740991,Ce=E&&E.limit||G&&G.limit||9007199254740991,tt=E&&E.allowTypo!==void 0?E.allowTypo:G&&G.allowTypo!==void 0?G.allowTypo:!0,ut=tt?ee.algorithm:ee.algorithmNoTypo,Ze=0,$e=0;function De(){if(oe)return le("canceled");var _e=Date.now();if(E&&E.keys)for(var Qe=E.scoreFn||V,ne=E.keys,vt=ne.length;ze>=0;--ze){for(var Ke=z[ze],ct=new Array(vt),he=vt-1;he>=0;--he){var de=ne[he],qe=$(Ke,de);if(!qe){ct[he]=null;continue}j(qe)||(qe=ee.getPrepared(qe)),ct[he]=ut(te,qe,ue)}ct.obj=Ke;var rt=Qe(ct);if(rt!==null&&!(rt<Ve)&&(ct.score=rt,Ze<Ce?(Ie.add(ct),++Ze):(++$e,rt>Ie.peek().score&&Ie.replaceTop(ct)),ze%1e3==0&&Date.now()-_e>=10)){q?setImmediate(De):setTimeout(De);return}}else if(E&&E.key)for(var de=E.key;ze>=0;--ze){var Ke=z[ze],qe=$(Ke,de);if(!!qe){j(qe)||(qe=ee.getPrepared(qe));var pt=ut(te,qe,ue);if(pt!==null&&!(pt.score<Ve)&&(pt={target:pt.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:pt.score,indexes:pt.indexes,obj:Ke},Ze<Ce?(Ie.add(pt),++Ze):(++$e,pt.score>Ie.peek().score&&Ie.replaceTop(pt)),ze%1e3==0&&Date.now()-_e>=10)){q?setImmediate(De):setTimeout(De);return}}}else for(;ze>=0;--ze){var qe=z[ze];if(!!qe){j(qe)||(qe=ee.getPrepared(qe));var pt=ut(te,qe,ue);if(pt!==null&&!(pt.score<Ve)&&(Ze<Ce?(Ie.add(pt),++Ze):(++$e,pt.score>Ie.peek().score&&Ie.replaceTop(pt)),ze%1e3==0&&Date.now()-_e>=10)){q?setImmediate(De):setTimeout(De);return}}}if(Ze===0)return se(R);for(var Vt=new Array(Ze),Et=Ze-1;Et>=0;--Et)Vt[Et]=Ie.poll();Vt.total=Ze+$e,se(Vt)}l(De,"step"),q?setImmediate(De):De()});return W.cancel=function(){oe=!0},W},highlight:function(te,z,E){if(te===null)return null;z===void 0&&(z="<b>"),E===void 0&&(E="</b>");for(var oe="",W=0,se=!1,le=te.target,ue=le.length,Ie=te.indexes,ze=0;ze<ue;++ze){var Ve=le[ze];if(Ie[W]===ze){if(++W,se||(se=!0,oe+=z),W===Ie.length){oe+=Ve+E+le.substr(ze+1);break}}else se&&(se=!1,oe+=E);oe+=Ve}return oe},prepare:function(te){if(!!te)return{target:te,_targetLowerCodes:ee.prepareLowerCodes(te),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(te){if(!!te)return{target:te,_targetLowerCodes:ee.prepareLowerCodes(te),_nextBeginningIndexes:ee.prepareNextBeginningIndexes(te),score:null,indexes:null,obj:null}},prepareSearch:function(te){if(!!te)return ee.prepareLowerCodes(te)},getPrepared:function(te){if(te.length>999)return ee.prepare(te);var z=U.get(te);return z!==void 0||(z=ee.prepare(te),U.set(te,z)),z},getPreparedSearch:function(te){if(te.length>999)return ee.prepareSearch(te);var z=b.get(te);return z!==void 0||(z=ee.prepareSearch(te),b.set(te,z)),z},algorithm:function(te,z,E){for(var oe=z._targetLowerCodes,W=te.length,se=oe.length,le=0,ue=0,Ie=0,ze=0;;){var Ve=E===oe[ue];if(Ve){if(A[ze++]=ue,++le,le===W)break;E=te[Ie===0?le:Ie===le?le+1:Ie===le-1?le-1:le]}if(++ue,ue>=se)for(;;){if(le<=1)return null;if(Ie===0){--le;var Ce=te[le];if(E===Ce)continue;Ie=le}else{if(Ie===1)return null;--Ie,le=Ie,E=te[le+1];var Ce=te[le];if(E===Ce)continue}ze=le,ue=A[ze-1]+1;break}}var le=0,tt=0,ut=!1,Ze=0,$e=z._nextBeginningIndexes;$e===null&&($e=z._nextBeginningIndexes=ee.prepareNextBeginningIndexes(z.target));var De=ue=A[0]===0?0:$e[A[0]-1];if(ue!==se)for(;;)if(ue>=se){if(le<=0){if(++tt,tt>W-2)break;if(te[tt]===te[tt+1])continue;ue=De;continue}--le;var _e=S[--Ze];ue=$e[_e]}else{var Ve=te[tt===0?le:tt===le?le+1:tt===le-1?le-1:le]===oe[ue];if(Ve){if(S[Ze++]=ue,++le,le===W){ut=!0;break}++ue}else ue=$e[ue]}{if(ut)var Qe=S,ne=Ze;else var Qe=A,ne=ze;for(var vt=0,Ke=-1,ct=0;ct<W;++ct){var ue=Qe[ct];Ke!==ue-1&&(vt-=ue),Ke=ue}ut?tt!==0&&(vt+=-20):(vt*=1e3,Ie!==0&&(vt+=-20)),vt-=se-W,z.score=vt,z.indexes=new Array(ne);for(var ct=ne-1;ct>=0;--ct)z.indexes[ct]=Qe[ct];return z}},algorithmNoTypo:function(te,z,E){for(var oe=z._targetLowerCodes,W=te.length,se=oe.length,le=0,ue=0,Ie=0;;){var ze=E===oe[ue];if(ze){if(A[Ie++]=ue,++le,le===W)break;E=te[le]}if(++ue,ue>=se)return null}var le=0,Ve=!1,Ce=0,tt=z._nextBeginningIndexes;tt===null&&(tt=z._nextBeginningIndexes=ee.prepareNextBeginningIndexes(z.target));var ut=ue=A[0]===0?0:tt[A[0]-1];if(ue!==se)for(;;)if(ue>=se){if(le<=0)break;--le;var Ze=S[--Ce];ue=tt[Ze]}else{var ze=te[le]===oe[ue];if(ze){if(S[Ce++]=ue,++le,le===W){Ve=!0;break}++ue}else ue=tt[ue]}{if(Ve)var $e=S,De=Ce;else var $e=A,De=Ie;for(var _e=0,Qe=-1,ne=0;ne<W;++ne){var ue=$e[ne];Qe!==ue-1&&(_e-=ue),Qe=ue}Ve||(_e*=1e3),_e-=se-W,z.score=_e,z.indexes=new Array(De);for(var ne=De-1;ne>=0;--ne)z.indexes[ne]=$e[ne];return z}},prepareLowerCodes:function(te){for(var z=te.length,E=[],oe=te.toLowerCase(),W=0;W<z;++W)E[W]=oe.charCodeAt(W);return E},prepareBeginningIndexes:function(te){for(var z=te.length,E=[],oe=0,W=!1,se=!1,le=0;le<z;++le){var ue=te.charCodeAt(le),Ie=ue>=65&&ue<=90,ze=Ie||ue>=97&&ue<=122||ue>=48&&ue<=57,Ve=Ie&&!W||!se||!ze;W=Ie,se=ze,Ve&&(E[oe++]=le)}return E},prepareNextBeginningIndexes:function(te){for(var z=te.length,E=ee.prepareBeginningIndexes(te),oe=[],W=E[0],se=0,le=0;le<z;++le)W>le?oe[le]=W:(W=E[++se],oe[le]=W===void 0?z:W);return oe},cleanup:D,new:Q};return ee}l(Q,"fuzzysortNew");var q=typeof window=="undefined",U=new Map,b=new Map,R=[];R.total=0;var A=[],S=[];function D(){U.clear(),b.clear(),A=[],S=[]}l(D,"cleanup");function V(G){for(var ee=-9007199254740991,te=G.length-1;te>=0;--te){var z=G[te];if(z!==null){var E=z.score;E>ee&&(ee=E)}}return ee===-9007199254740991?null:ee}l(V,"defaultScoreFn");function $(G,ee){var te=G[ee];if(te!==void 0)return te;var z=ee;Array.isArray(ee)||(z=ee.split("."));for(var E=z.length,oe=-1;G&&++oe<E;)G=G[z[oe]];return G}l($,"getValue");function j(G){return typeof G=="object"}l(j,"isObj");var ge=l(function(){var G=[],ee=0,te={};function z(){for(var E=0,oe=G[E],W=1;W<ee;){var se=W+1;E=W,se<ee&&G[se].score<G[W].score&&(E=se),G[E-1>>1]=G[E],W=1+(E<<1)}for(var le=E-1>>1;E>0&&oe.score<G[le].score;le=(E=le)-1>>1)G[E]=G[le];G[E]=oe}return l(z,"n"),te.add=function(E){var oe=ee;G[ee++]=E;for(var W=oe-1>>1;oe>0&&E.score<G[W].score;W=(oe=W)-1>>1)G[oe]=G[W];G[oe]=E},te.poll=function(){if(ee!==0){var E=G[0];return G[0]=G[--ee],z(),E}},te.peek=function(E){if(ee!==0)return G[0]},te.replaceTop=function(E){G[0]=E,z()},te},"fastpriorityqueue"),me=ge();return Q()},"UMD"))},645:(X,h)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */h.read=function(O,F,N,P,Q){var q,U,b=Q*8-P-1,R=(1<<b)-1,A=R>>1,S=-7,D=N?Q-1:0,V=N?-1:1,$=O[F+D];for(D+=V,q=$&(1<<-S)-1,$>>=-S,S+=b;S>0;q=q*256+O[F+D],D+=V,S-=8);for(U=q&(1<<-S)-1,q>>=-S,S+=P;S>0;U=U*256+O[F+D],D+=V,S-=8);if(q===0)q=1-A;else{if(q===R)return U?NaN:($?-1:1)*(1/0);U=U+Math.pow(2,P),q=q-A}return($?-1:1)*U*Math.pow(2,q-P)},h.write=function(O,F,N,P,Q,q){var U,b,R,A=q*8-Q-1,S=(1<<A)-1,D=S>>1,V=Q===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=P?0:q-1,j=P?1:-1,ge=F<0||F===0&&1/F<0?1:0;for(F=Math.abs(F),isNaN(F)||F===1/0?(b=isNaN(F)?1:0,U=S):(U=Math.floor(Math.log(F)/Math.LN2),F*(R=Math.pow(2,-U))<1&&(U--,R*=2),U+D>=1?F+=V/R:F+=V*Math.pow(2,1-D),F*R>=2&&(U++,R/=2),U+D>=S?(b=0,U=S):U+D>=1?(b=(F*R-1)*Math.pow(2,Q),U=U+D):(b=F*Math.pow(2,D-1)*Math.pow(2,Q),U=0));Q>=8;O[N+$]=b&255,$+=j,b/=256,Q-=8);for(U=U<<Q|b,A+=Q;A>0;O[N+$]=U&255,$+=j,U/=256,A-=8);O[N+$-j]|=ge*128}},9924:X=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */X.exports=function(h){return typeof h=="number"?h-h==0:typeof h=="string"&&h.trim()!==""?Number.isFinite?Number.isFinite(+h):isFinite(+h):!1}},2307:(X,h,O)=>{X=O.nmd(X);var F=200,N="__lodash_hash_undefined__",P=1,Q=2,q=9007199254740991,U="[object Arguments]",b="[object Array]",R="[object AsyncFunction]",A="[object Boolean]",S="[object Date]",D="[object Error]",V="[object Function]",$="[object GeneratorFunction]",j="[object Map]",ge="[object Number]",me="[object Null]",G="[object Object]",ee="[object Promise]",te="[object Proxy]",z="[object RegExp]",E="[object Set]",oe="[object String]",W="[object Symbol]",se="[object Undefined]",le="[object WeakMap]",ue="[object ArrayBuffer]",Ie="[object DataView]",ze="[object Float32Array]",Ve="[object Float64Array]",Ce="[object Int8Array]",tt="[object Int16Array]",ut="[object Int32Array]",Ze="[object Uint8Array]",$e="[object Uint8ClampedArray]",De="[object Uint16Array]",_e="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,vt=/^(?:0|[1-9]\d*)$/,Ke={};Ke[ze]=Ke[Ve]=Ke[Ce]=Ke[tt]=Ke[ut]=Ke[Ze]=Ke[$e]=Ke[De]=Ke[_e]=!0,Ke[U]=Ke[b]=Ke[ue]=Ke[A]=Ke[Ie]=Ke[S]=Ke[D]=Ke[V]=Ke[j]=Ke[ge]=Ke[G]=Ke[z]=Ke[E]=Ke[oe]=Ke[le]=!1;var ct=typeof O.g=="object"&&O.g&&O.g.Object===Object&&O.g,he=typeof self=="object"&&self&&self.Object===Object&&self,de=ct||he||Function("return this")(),qe=h&&!h.nodeType&&h,rt=qe&&!0&&X&&!X.nodeType&&X,pt=rt&&rt.exports===qe,Vt=pt&&ct.process,Et=function(){try{return Vt&&Vt.binding&&Vt.binding("util")}catch(L){}}(),_t=Et&&Et.isTypedArray;function Or(L,Y){for(var xe=-1,je=L==null?0:L.length,zt=0,mt=[];++xe<je;){var Xt=L[xe];Y(Xt,xe,L)&&(mt[zt++]=Xt)}return mt}l(Or,"arrayFilter");function Gt(L,Y){for(var xe=-1,je=Y.length,zt=L.length;++xe<je;)L[zt+xe]=Y[xe];return L}l(Gt,"arrayPush");function sr(L,Y){for(var xe=-1,je=L==null?0:L.length;++xe<je;)if(Y(L[xe],xe,L))return!0;return!1}l(sr,"arraySome");function ot(L,Y){for(var xe=-1,je=Array(L);++xe<L;)je[xe]=Y(xe);return je}l(ot,"baseTimes");function wt(L){return function(Y){return L(Y)}}l(wt,"baseUnary");function Ue(L,Y){return L.has(Y)}l(Ue,"cacheHas");function He(L,Y){return L==null?void 0:L[Y]}l(He,"getValue");function at(L){var Y=-1,xe=Array(L.size);return L.forEach(function(je,zt){xe[++Y]=[zt,je]}),xe}l(at,"mapToArray");function Ee(L,Y){return function(xe){return L(Y(xe))}}l(Ee,"overArg");function st(L){var Y=-1,xe=Array(L.size);return L.forEach(function(je){xe[++Y]=je}),xe}l(st,"setToArray");var Ye=Array.prototype,$t=Function.prototype,xt=Object.prototype,T=de["__core-js_shared__"],m=$t.toString,w=xt.hasOwnProperty,M=function(){var L=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||"");return L?"Symbol(src)_1."+L:""}(),Z=xt.toString,ce=RegExp("^"+m.call(w).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ye=pt?de.Buffer:void 0,gt=de.Symbol,Wt=de.Uint8Array,Ut=xt.propertyIsEnumerable,Kt=Ye.splice,Rt=gt?gt.toStringTag:void 0,en=Object.getOwnPropertySymbols,oo=ye?ye.isBuffer:void 0,Ga=Ee(Object.keys,Object),Ka=co(de,"DataView"),tn=co(de,"Map"),Be=co(de,"Promise"),Ni=co(de,"Set"),Qa=co(de,"WeakMap"),ao=co(Object,"create"),so=li(Ka),Ac=li(tn),Za=li(Be),Tc=li(Ni),kc=li(Qa),Xa=gt?gt.prototype:void 0,Ya=Xa?Xa.valueOf:void 0;function si(L){var Y=-1,xe=L==null?0:L.length;for(this.clear();++Y<xe;){var je=L[Y];this.set(je[0],je[1])}}l(si,"Hash");function zo(){this.__data__=ao?ao(null):{},this.size=0}l(zo,"hashClear");function Fu(L){var Y=this.has(L)&&delete this.__data__[L];return this.size-=Y?1:0,Y}l(Fu,"hashDelete");function Pu(L){var Y=this.__data__;if(ao){var xe=Y[L];return xe===N?void 0:xe}return w.call(Y,L)?Y[L]:void 0}l(Pu,"hashGet");function Nu(L){var Y=this.__data__;return ao?Y[L]!==void 0:w.call(Y,L)}l(Nu,"hashHas");function Ja(L,Y){var xe=this.__data__;return this.size+=this.has(L)?0:1,xe[L]=ao&&Y===void 0?N:Y,this}l(Ja,"hashSet"),si.prototype.clear=zo,si.prototype.delete=Fu,si.prototype.get=Pu,si.prototype.has=Nu,si.prototype.set=Ja;function on(L){var Y=-1,xe=L==null?0:L.length;for(this.clear();++Y<xe;){var je=L[Y];this.set(je[0],je[1])}}l(on,"ListCache");function $u(){this.__data__=[],this.size=0}l($u,"listCacheClear");function Ap(L){var Y=this.__data__,xe=es(Y,L);if(xe<0)return!1;var je=Y.length-1;return xe==je?Y.pop():Kt.call(Y,xe,1),--this.size,!0}l(Ap,"listCacheDelete");function Mu(L){var Y=this.__data__,xe=es(Y,L);return xe<0?void 0:Y[xe][1]}l(Mu,"listCacheGet");function Bu(L){return es(this.__data__,L)>-1}l(Bu,"listCacheHas");function Uu(L,Y){var xe=this.__data__,je=es(xe,L);return je<0?(++this.size,xe.push([L,Y])):xe[je][1]=Y,this}l(Uu,"listCacheSet"),on.prototype.clear=$u,on.prototype.delete=Ap,on.prototype.get=Mu,on.prototype.has=Bu,on.prototype.set=Uu;function cr(L){var Y=-1,xe=L==null?0:L.length;for(this.clear();++Y<xe;){var je=L[Y];this.set(je[0],je[1])}}l(cr,"MapCache");function nr(){this.size=0,this.__data__={hash:new si,map:new(tn||on),string:new si}}l(nr,"mapCacheClear");function Pt(L){var Y=xn(this,L).delete(L);return this.size-=Y?1:0,Y}l(Pt,"mapCacheDelete");function yn(L){return xn(this,L).get(L)}l(yn,"mapCacheGet");function Lu(L){return xn(this,L).has(L)}l(Lu,"mapCacheHas");function Ou(L,Y){var xe=xn(this,L),je=xe.size;return xe.set(L,Y),this.size+=xe.size==je?0:1,this}l(Ou,"mapCacheSet"),cr.prototype.clear=nr,cr.prototype.delete=Pt,cr.prototype.get=yn,cr.prototype.has=Lu,cr.prototype.set=Ou;function qo(L){var Y=-1,xe=L==null?0:L.length;for(this.__data__=new cr;++Y<xe;)this.add(L[Y])}l(qo,"SetCache");function Tp(L){return this.__data__.set(L,N),this}l(Tp,"setCacheAdd");function Ic(L){return this.__data__.has(L)}l(Ic,"setCacheHas"),qo.prototype.add=qo.prototype.push=Tp,qo.prototype.has=Ic;function bn(L){var Y=this.__data__=new on(L);this.size=Y.size}l(bn,"Stack");function Dc(){this.__data__=new on,this.size=0}l(Dc,"stackClear");function jo(L){var Y=this.__data__,xe=Y.delete(L);return this.size=Y.size,xe}l(jo,"stackDelete");function kp(L){return this.__data__.get(L)}l(kp,"stackGet");function Ip(L){return this.__data__.has(L)}l(Ip,"stackHas");function Vo(L,Y){var xe=this.__data__;if(xe instanceof on){var je=xe.__data__;if(!tn||je.length<F-1)return je.push([L,Y]),this.size=++xe.size,this;xe=this.__data__=new cr(je)}return xe.set(L,Y),this.size=xe.size,this}l(Vo,"stackSet"),bn.prototype.clear=Dc,bn.prototype.delete=jo,bn.prototype.get=kp,bn.prototype.has=Ip,bn.prototype.set=Vo;function Hu(L,Y){var xe=Zo(L),je=!xe&&Gu(L),zt=!xe&&!je&&os(L),mt=!xe&&!je&&!zt&&cs(L),Xt=xe||je||zt||mt,ir=Xt?ot(L.length,String):[],xr=ir.length;for(var er in L)(Y||w.call(L,er))&&!(Xt&&(er=="length"||zt&&(er=="offset"||er=="parent")||mt&&(er=="buffer"||er=="byteLength"||er=="byteOffset")||lo(er,xr)))&&ir.push(er);return ir}l(Hu,"arrayLikeKeys");function es(L,Y){for(var xe=L.length;xe--;)if(Bc(L[xe][0],Y))return xe;return-1}l(es,"assocIndexOf");function Fc(L,Y,xe){var je=Y(L);return Zo(L)?je:Gt(je,xe(L))}l(Fc,"baseGetAllKeys");function Go(L){return L==null?L===void 0?se:me:Rt&&Rt in Object(L)?ns(L):Mc(L)}l(Go,"baseGetTag");function ts(L){return $i(L)&&Go(L)==U}l(ts,"baseIsArguments");function Wu(L,Y,xe,je,zt){return L===Y?!0:L==null||Y==null||!$i(L)&&!$i(Y)?L!==L&&Y!==Y:Ko(L,Y,xe,je,Wu,zt)}l(Wu,"baseIsEqual");function Ko(L,Y,xe,je,zt,mt){var Xt=Zo(L),ir=Zo(Y),xr=Xt?b:ci(L),er=ir?b:ci(Y);xr=xr==U?G:xr,er=er==U?G:er;var Hr=xr==G,Kr=er==G,fr=xr==er;if(fr&&os(L)){if(!os(Y))return!1;Xt=!0,Hr=!1}if(fr&&!Hr)return mt||(mt=new bn),Xt||cs(L)?Pc(L,Y,xe,je,zt,mt):rs(L,Y,xr,xe,je,zt,mt);if(!(xe&P)){var Wr=Hr&&w.call(L,"__wrapped__"),Qr=Kr&&w.call(Y,"__wrapped__");if(Wr||Qr){var Nn=Wr?L.value():L,Re=Qr?Y.value():Y;return mt||(mt=new bn),zt(Nn,Re,xe,je,mt)}}return fr?(mt||(mt=new bn),ju(L,Y,xe,je,zt,mt)):!1}l(Ko,"baseIsEqualDeep");function _n(L){if(!uo(L)||$c(L))return!1;var Y=as(L)?ce:ne;return Y.test(li(L))}l(_n,"baseIsNative");function zu(L){return $i(L)&&ss(L.length)&&!!Ke[Go(L)]}l(zu,"baseIsTypedArray");function qu(L){if(!Dp(L))return Ga(L);var Y=[];for(var xe in Object(L))w.call(L,xe)&&xe!="constructor"&&Y.push(xe);return Y}l(qu,"baseKeys");function Pc(L,Y,xe,je,zt,mt){var Xt=xe&P,ir=L.length,xr=Y.length;if(ir!=xr&&!(Xt&&xr>ir))return!1;var er=mt.get(L);if(er&&mt.get(Y))return er==Y;var Hr=-1,Kr=!0,fr=xe&Q?new qo:void 0;for(mt.set(L,Y),mt.set(Y,L);++Hr<ir;){var Wr=L[Hr],Qr=Y[Hr];if(je)var Nn=Xt?je(Qr,Wr,Hr,Y,L,mt):je(Wr,Qr,Hr,L,Y,mt);if(Nn!==void 0){if(Nn)continue;Kr=!1;break}if(fr){if(!sr(Y,function(Re,ui){if(!Ue(fr,ui)&&(Wr===Re||zt(Wr,Re,xe,je,mt)))return fr.push(ui)})){Kr=!1;break}}else if(!(Wr===Qr||zt(Wr,Qr,xe,je,mt))){Kr=!1;break}}return mt.delete(L),mt.delete(Y),Kr}l(Pc,"equalArrays");function rs(L,Y,xe,je,zt,mt,Xt){switch(xe){case Ie:if(L.byteLength!=Y.byteLength||L.byteOffset!=Y.byteOffset)return!1;L=L.buffer,Y=Y.buffer;case ue:return!(L.byteLength!=Y.byteLength||!mt(new Wt(L),new Wt(Y)));case A:case S:case ge:return Bc(+L,+Y);case D:return L.name==Y.name&&L.message==Y.message;case z:case oe:return L==Y+"";case j:var ir=at;case E:var xr=je&P;if(ir||(ir=st),L.size!=Y.size&&!xr)return!1;var er=Xt.get(L);if(er)return er==Y;je|=Q,Xt.set(L,Y);var Hr=Pc(ir(L),ir(Y),je,zt,mt,Xt);return Xt.delete(L),Hr;case W:if(Ya)return Ya.call(L)==Ya.call(Y)}return!1}l(rs,"equalByTag");function ju(L,Y,xe,je,zt,mt){var Xt=xe&P,ir=Nc(L),xr=ir.length,er=Nc(Y),Hr=er.length;if(xr!=Hr&&!Xt)return!1;for(var Kr=xr;Kr--;){var fr=ir[Kr];if(!(Xt?fr in Y:w.call(Y,fr)))return!1}var Wr=mt.get(L);if(Wr&&mt.get(Y))return Wr==Y;var Qr=!0;mt.set(L,Y),mt.set(Y,L);for(var Nn=Xt;++Kr<xr;){fr=ir[Kr];var Re=L[fr],ui=Y[fr];if(je)var Lc=Xt?je(ui,Re,fr,Y,L,mt):je(Re,ui,fr,L,Y,mt);if(!(Lc===void 0?Re===ui||zt(Re,ui,xe,je,mt):Lc)){Qr=!1;break}Nn||(Nn=fr=="constructor")}if(Qr&&!Nn){var pr=L.constructor,$n=Y.constructor;pr!=$n&&"constructor"in L&&"constructor"in Y&&!(typeof pr=="function"&&pr instanceof pr&&typeof $n=="function"&&$n instanceof $n)&&(Qr=!1)}return mt.delete(L),mt.delete(Y),Qr}l(ju,"equalObjects");function Nc(L){return Fc(L,Ku,Qo)}l(Nc,"getAllKeys");function xn(L,Y){var xe=L.__data__;return Vu(Y)?xe[typeof Y=="string"?"string":"hash"]:xe.map}l(xn,"getMapData");function co(L,Y){var xe=He(L,Y);return _n(xe)?xe:void 0}l(co,"getNative");function ns(L){var Y=w.call(L,Rt),xe=L[Rt];try{L[Rt]=void 0;var je=!0}catch(mt){}var zt=Z.call(L);return je&&(Y?L[Rt]=xe:delete L[Rt]),zt}l(ns,"getRawTag");var Qo=en?function(L){return L==null?[]:(L=Object(L),Or(en(L),function(Y){return Ut.call(L,Y)}))}:Qu,ci=Go;(Ka&&ci(new Ka(new ArrayBuffer(1)))!=Ie||tn&&ci(new tn)!=j||Be&&ci(Be.resolve())!=ee||Ni&&ci(new Ni)!=E||Qa&&ci(new Qa)!=le)&&(ci=l(function(L){var Y=Go(L),xe=Y==G?L.constructor:void 0,je=xe?li(xe):"";if(je)switch(je){case so:return Ie;case Ac:return j;case Za:return ee;case Tc:return E;case kc:return le}return Y},"getTag"));function lo(L,Y){return Y=Y==null?q:Y,!!Y&&(typeof L=="number"||vt.test(L))&&L>-1&&L%1==0&&L<Y}l(lo,"isIndex");function Vu(L){var Y=typeof L;return Y=="string"||Y=="number"||Y=="symbol"||Y=="boolean"?L!=="__proto__":L===null}l(Vu,"isKeyable");function $c(L){return!!M&&M in L}l($c,"isMasked");function Dp(L){var Y=L&&L.constructor,xe=typeof Y=="function"&&Y.prototype||xt;return L===xe}l(Dp,"isPrototype");function Mc(L){return Z.call(L)}l(Mc,"objectToString");function li(L){if(L!=null){try{return m.call(L)}catch(Y){}try{return L+""}catch(Y){}}return""}l(li,"toSource");function Bc(L,Y){return L===Y||L!==L&&Y!==Y}l(Bc,"eq");var Gu=ts(function(){return arguments}())?ts:function(L){return $i(L)&&w.call(L,"callee")&&!Ut.call(L,"callee")},Zo=Array.isArray;function is(L){return L!=null&&ss(L.length)&&!as(L)}l(is,"isArrayLike");var os=oo||Uc;function Fp(L,Y){return Wu(L,Y)}l(Fp,"isEqual");function as(L){if(!uo(L))return!1;var Y=Go(L);return Y==V||Y==$||Y==R||Y==te}l(as,"isFunction");function ss(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=q}l(ss,"isLength");function uo(L){var Y=typeof L;return L!=null&&(Y=="object"||Y=="function")}l(uo,"isObject");function $i(L){return L!=null&&typeof L=="object"}l($i,"isObjectLike");var cs=_t?wt(_t):zu;function Ku(L){return is(L)?Hu(L):qu(L)}l(Ku,"keys");function Qu(){return[]}l(Qu,"stubArray");function Uc(){return!1}l(Uc,"stubFalse"),X.exports=Fp},850:(X,h,O)=>{"use strict";const F=O(7170),N=O(6744),P=O(9444),Q=O(8702),q=l(b=>b===""||b==="./","isEmptyString"),U=l((b,R,A)=>{R=[].concat(R),b=[].concat(b);let S=new Set,D=new Set,V=new Set,$=0,j=l(G=>{V.add(G.output),A&&A.onResult&&A.onResult(G)},"onResult");for(let G=0;G<R.length;G++){let ee=P(String(R[G]),{...A,onResult:j},!0),te=ee.state.negated||ee.state.negatedExtglob;te&&$++;for(let z of b){let E=ee(z,!0);!(te?!E.isMatch:E.isMatch)||(te?S.add(E.output):(S.delete(E.output),D.add(E.output)))}}let me=($===R.length?[...V]:[...D]).filter(G=>!S.has(G));if(A&&me.length===0){if(A.failglob===!0)throw new Error(`No matches found for "${R.join(", ")}"`);if(A.nonull===!0||A.nullglob===!0)return A.unescape?R.map(G=>G.replace(/\\/g,"")):R}return me},"micromatch");U.match=U,U.matcher=(b,R)=>P(b,R),U.isMatch=(b,R,A)=>P(R,A)(b),U.any=U.isMatch,U.not=(b,R,A={})=>{R=[].concat(R).map(String);let S=new Set,D=[],$=U(b,R,{...A,onResult:l(j=>{A.onResult&&A.onResult(j),D.push(j.output)},"onResult")});for(let j of D)$.includes(j)||S.add(j);return[...S]},U.contains=(b,R,A)=>{if(typeof b!="string")throw new TypeError(`Expected a string: "${F.inspect(b)}"`);if(Array.isArray(R))return R.some(S=>U.contains(b,S,A));if(typeof R=="string"){if(q(b)||q(R))return!1;if(b.includes(R)||b.startsWith("./")&&b.slice(2).includes(R))return!0}return U.isMatch(b,R,{...A,contains:!0})},U.matchKeys=(b,R,A)=>{if(!Q.isObject(b))throw new TypeError("Expected the first argument to be an object");let S=U(Object.keys(b),R,A),D={};for(let V of S)D[V]=b[V];return D},U.some=(b,R,A)=>{let S=[].concat(b);for(let D of[].concat(R)){let V=P(String(D),A);if(S.some($=>V($)))return!0}return!1},U.every=(b,R,A)=>{let S=[].concat(b);for(let D of[].concat(R)){let V=P(String(D),A);if(!S.every($=>V($)))return!1}return!0},U.all=(b,R,A)=>{if(typeof b!="string")throw new TypeError(`Expected a string: "${F.inspect(b)}"`);return[].concat(R).every(S=>P(S,A)(b))},U.capture=(b,R,A)=>{let S=Q.isWindows(A),V=P.makeRe(String(b),{...A,capture:!0}).exec(S?Q.toPosixSlashes(R):R);if(V)return V.slice(1).map($=>$===void 0?"":$)},U.makeRe=(...b)=>P.makeRe(...b),U.scan=(...b)=>P.scan(...b),U.parse=(b,R)=>{let A=[];for(let S of[].concat(b||[]))for(let D of N(String(S),R))A.push(P.parse(D,R));return A},U.braces=(b,R)=>{if(typeof b!="string")throw new TypeError("Expected a string");return R&&R.nobrace===!0||!/\{.*\}/.test(b)?[b]:N(b,R)},U.braceExpand=(b,R)=>{if(typeof b!="string")throw new TypeError("Expected a string");return U.braces(b,{...R,expand:!0})},X.exports=U},447:(X,h,O)=>{var F=O(2479);X.exports=F(N),X.exports.strict=F(P),N.proto=N(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return N(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return P(this)},configurable:!0})});function N(Q){var q=l(function(){return q.called?q.value:(q.called=!0,q.value=Q.apply(this,arguments))},"f");return q.called=!1,q}l(N,"once");function P(Q){var q=l(function(){if(q.called)throw new Error(q.onceError);return q.called=!0,q.value=Q.apply(this,arguments)},"f"),U=Q.name||"Function wrapped with `once`";return q.onceError=U+" shouldn't be called more than once",q.called=!1,q}l(P,"onceStrict")},6470:(X,h,O)=>{"use strict";var F=O(4155);function N(U){if(typeof U!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(U))}l(N,"assertPath");function P(U,b){for(var R="",A=0,S=-1,D=0,V,$=0;$<=U.length;++$){if($<U.length)V=U.charCodeAt($);else{if(V===47)break;V=47}if(V===47){if(!(S===$-1||D===1))if(S!==$-1&&D===2){if(R.length<2||A!==2||R.charCodeAt(R.length-1)!==46||R.charCodeAt(R.length-2)!==46){if(R.length>2){var j=R.lastIndexOf("/");if(j!==R.length-1){j===-1?(R="",A=0):(R=R.slice(0,j),A=R.length-1-R.lastIndexOf("/")),S=$,D=0;continue}}else if(R.length===2||R.length===1){R="",A=0,S=$,D=0;continue}}b&&(R.length>0?R+="/..":R="..",A=2)}else R.length>0?R+="/"+U.slice(S+1,$):R=U.slice(S+1,$),A=$-S-1;S=$,D=0}else V===46&&D!==-1?++D:D=-1}return R}l(P,"normalizeStringPosix");function Q(U,b){var R=b.dir||b.root,A=b.base||(b.name||"")+(b.ext||"");return R?R===b.root?R+A:R+U+A:A}l(Q,"_format");var q={resolve:l(function(){for(var b="",R=!1,A,S=arguments.length-1;S>=-1&&!R;S--){var D;S>=0?D=arguments[S]:(A===void 0&&(A=F.cwd()),D=A),N(D),D.length!==0&&(b=D+"/"+b,R=D.charCodeAt(0)===47)}return b=P(b,!R),R?b.length>0?"/"+b:"/":b.length>0?b:"."},"resolve"),normalize:l(function(b){if(N(b),b.length===0)return".";var R=b.charCodeAt(0)===47,A=b.charCodeAt(b.length-1)===47;return b=P(b,!R),b.length===0&&!R&&(b="."),b.length>0&&A&&(b+="/"),R?"/"+b:b},"normalize"),isAbsolute:l(function(b){return N(b),b.length>0&&b.charCodeAt(0)===47},"isAbsolute"),join:l(function(){if(arguments.length===0)return".";for(var b,R=0;R<arguments.length;++R){var A=arguments[R];N(A),A.length>0&&(b===void 0?b=A:b+="/"+A)}return b===void 0?".":q.normalize(b)},"join"),relative:l(function(b,R){if(N(b),N(R),b===R||(b=q.resolve(b),R=q.resolve(R),b===R))return"";for(var A=1;A<b.length&&b.charCodeAt(A)===47;++A);for(var S=b.length,D=S-A,V=1;V<R.length&&R.charCodeAt(V)===47;++V);for(var $=R.length,j=$-V,ge=D<j?D:j,me=-1,G=0;G<=ge;++G){if(G===ge){if(j>ge){if(R.charCodeAt(V+G)===47)return R.slice(V+G+1);if(G===0)return R.slice(V+G)}else D>ge&&(b.charCodeAt(A+G)===47?me=G:G===0&&(me=0));break}var ee=b.charCodeAt(A+G),te=R.charCodeAt(V+G);if(ee!==te)break;ee===47&&(me=G)}var z="";for(G=A+me+1;G<=S;++G)(G===S||b.charCodeAt(G)===47)&&(z.length===0?z+="..":z+="/..");return z.length>0?z+R.slice(V+me):(V+=me,R.charCodeAt(V)===47&&++V,R.slice(V))},"relative"),_makeLong:l(function(b){return b},"_makeLong"),dirname:l(function(b){if(N(b),b.length===0)return".";for(var R=b.charCodeAt(0),A=R===47,S=-1,D=!0,V=b.length-1;V>=1;--V)if(R=b.charCodeAt(V),R===47){if(!D){S=V;break}}else D=!1;return S===-1?A?"/":".":A&&S===1?"//":b.slice(0,S)},"dirname"),basename:l(function(b,R){if(R!==void 0&&typeof R!="string")throw new TypeError('"ext" argument must be a string');N(b);var A=0,S=-1,D=!0,V;if(R!==void 0&&R.length>0&&R.length<=b.length){if(R.length===b.length&&R===b)return"";var $=R.length-1,j=-1;for(V=b.length-1;V>=0;--V){var ge=b.charCodeAt(V);if(ge===47){if(!D){A=V+1;break}}else j===-1&&(D=!1,j=V+1),$>=0&&(ge===R.charCodeAt($)?--$==-1&&(S=V):($=-1,S=j))}return A===S?S=j:S===-1&&(S=b.length),b.slice(A,S)}else{for(V=b.length-1;V>=0;--V)if(b.charCodeAt(V)===47){if(!D){A=V+1;break}}else S===-1&&(D=!1,S=V+1);return S===-1?"":b.slice(A,S)}},"basename"),extname:l(function(b){N(b);for(var R=-1,A=0,S=-1,D=!0,V=0,$=b.length-1;$>=0;--$){var j=b.charCodeAt($);if(j===47){if(!D){A=$+1;break}continue}S===-1&&(D=!1,S=$+1),j===46?R===-1?R=$:V!==1&&(V=1):R!==-1&&(V=-1)}return R===-1||S===-1||V===0||V===1&&R===S-1&&R===A+1?"":b.slice(R,S)},"extname"),format:l(function(b){if(b===null||typeof b!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof b);return Q("/",b)},"format"),parse:l(function(b){N(b);var R={root:"",dir:"",base:"",ext:"",name:""};if(b.length===0)return R;var A=b.charCodeAt(0),S=A===47,D;S?(R.root="/",D=1):D=0;for(var V=-1,$=0,j=-1,ge=!0,me=b.length-1,G=0;me>=D;--me){if(A=b.charCodeAt(me),A===47){if(!ge){$=me+1;break}continue}j===-1&&(ge=!1,j=me+1),A===46?V===-1?V=me:G!==1&&(G=1):V!==-1&&(G=-1)}return V===-1||j===-1||G===0||G===1&&V===j-1&&V===$+1?j!==-1&&($===0&&S?R.base=R.name=b.slice(1,j):R.base=R.name=b.slice($,j)):($===0&&S?(R.name=b.slice(1,V),R.base=b.slice(1,j)):(R.name=b.slice($,V),R.base=b.slice($,j)),R.ext=b.slice(V,j)),$>0?R.dir=b.slice(0,$-1):S&&(R.dir="/"),R},"parse"),sep:"/",delimiter:":",win32:null,posix:null};q.posix=q,X.exports=q},7279:(X,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.EndOfStreamError=h.defaultMessages=void 0,h.defaultMessages="End-Of-Stream";class O extends Error{constructor(){super(h.defaultMessages)}}l(O,"EndOfStreamError"),h.EndOfStreamError=O},5167:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.StreamReader=h.EndOfStreamError=void 0;const F=O(7279);var N=O(7279);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return N.EndOfStreamError}});class P{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((b,R)=>{this.reject=R,this.resolve=b})}}l(P,"Deferred");const Q=1*1024*1024;class q{constructor(b){if(this.s=b,this.request=null,this.endOfStream=!1,this.peekQueue=[],!b.read||!b.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new F.EndOfStreamError)),this.s.once("error",R=>this.reject(R)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(b,R,A){const S=await this.read(b,R,A);return this.peekQueue.push(b.subarray(R,R+S)),S}async read(b,R,A){if(A===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new F.EndOfStreamError;let S=A,D=0;for(;this.peekQueue.length>0&&S>0;){const V=this.peekQueue.pop();if(!V)throw new Error("peekData should be defined");const $=Math.min(V.length,S);b.set(V.subarray(0,$),R+D),D+=$,S-=$,$<V.length&&this.peekQueue.push(V.subarray($))}for(;S>0&&!this.endOfStream;){const V=Math.min(S,Q),$=await this._read(b,R+D,V);if(D+=$,$<V)break;S-=$}return D}async _read(b,R,A){if(this.request)throw new Error("Concurrent read operation?");const S=this.s.read(A);return S?(b.set(S,R),S.length):(this.request={buffer:b,offset:R,length:A,deferred:new P},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const b=this.s.read(this.request.length);b?(this.request.buffer.set(b,this.request.offset),this.request.deferred.resolve(b.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(b){this.endOfStream=!0,this.request&&(this.request.deferred.reject(b),this.request=null)}}l(q,"StreamReader"),h.StreamReader=q},9444:(X,h,O)=>{"use strict";X.exports=O(6087)},1006:(X,h,O)=>{"use strict";const F=O(6470),N="\\\\/",P=`[^${N}]`,Q="\\.",q="\\+",U="\\?",b="\\/",R="(?=.)",A="[^/]",S=`(?:${b}|$)`,D=`(?:^|${b})`,V=`${Q}{1,2}${S}`,$=`(?!${Q})`,j=`(?!${D}${V})`,ge=`(?!${Q}{0,1}${S})`,me=`(?!${V})`,G=`[^.${b}]`,ee=`${A}*?`,te={DOT_LITERAL:Q,PLUS_LITERAL:q,QMARK_LITERAL:U,SLASH_LITERAL:b,ONE_CHAR:R,QMARK:A,END_ANCHOR:S,DOTS_SLASH:V,NO_DOT:$,NO_DOTS:j,NO_DOT_SLASH:ge,NO_DOTS_SLASH:me,QMARK_NO_DOT:G,STAR:ee,START_ANCHOR:D},z={...te,SLASH_LITERAL:`[${N}]`,QMARK:P,STAR:`${P}*?`,DOTS_SLASH:`${Q}{1,2}(?:[${N}]|$)`,NO_DOT:`(?!${Q})`,NO_DOTS:`(?!(?:^|[${N}])${Q}{1,2}(?:[${N}]|$))`,NO_DOT_SLASH:`(?!${Q}{0,1}(?:[${N}]|$))`,NO_DOTS_SLASH:`(?!${Q}{1,2}(?:[${N}]|$))`,QMARK_NO_DOT:`[^.${N}]`,START_ANCHOR:`(?:^|[${N}])`,END_ANCHOR:`(?:[${N}]|$)`},E={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};X.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:E,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:F.sep,extglobChars(oe){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${oe.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(oe){return oe===!0?z:te}}},3376:(X,h,O)=>{"use strict";const F=O(1006),N=O(8702),{MAX_LENGTH:P,POSIX_REGEX_SOURCE:Q,REGEX_NON_SPECIAL_CHARS:q,REGEX_SPECIAL_CHARS_BACKREF:U,REPLACEMENTS:b}=F,R=l((D,V)=>{if(typeof V.expandRange=="function")return V.expandRange(...D,V);D.sort();const $=`[${D.join("-")}]`;try{new RegExp($)}catch(j){return D.map(ge=>N.escapeRegex(ge)).join("..")}return $},"expandRange"),A=l((D,V)=>`Missing ${D}: "${V}" - use "\\\\${V}" to match literal characters`,"syntaxError"),S=l((D,V)=>{if(typeof D!="string")throw new TypeError("Expected a string");D=b[D]||D;const $={...V},j=typeof $.maxLength=="number"?Math.min(P,$.maxLength):P;let ge=D.length;if(ge>j)throw new SyntaxError(`Input length: ${ge}, exceeds maximum allowed length: ${j}`);const me={type:"bos",value:"",output:$.prepend||""},G=[me],ee=$.capture?"":"?:",te=N.isWindows(V),z=F.globChars(te),E=F.extglobChars(z),{DOT_LITERAL:oe,PLUS_LITERAL:W,SLASH_LITERAL:se,ONE_CHAR:le,DOTS_SLASH:ue,NO_DOT:Ie,NO_DOT_SLASH:ze,NO_DOTS_SLASH:Ve,QMARK:Ce,QMARK_NO_DOT:tt,STAR:ut,START_ANCHOR:Ze}=z,$e=l(He=>`(${ee}(?:(?!${Ze}${He.dot?ue:oe}).)*?)`,"globstar"),De=$.dot?"":Ie,_e=$.dot?Ce:tt;let Qe=$.bash===!0?$e($):ut;$.capture&&(Qe=`(${Qe})`),typeof $.noext=="boolean"&&($.noextglob=$.noext);const ne={input:D,index:-1,start:0,dot:$.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:G};D=N.removePrefix(D,ne),ge=D.length;const vt=[],Ke=[],ct=[];let he=me,de;const qe=l(()=>ne.index===ge-1,"eos"),rt=ne.peek=(He=1)=>D[ne.index+He],pt=ne.advance=()=>D[++ne.index]||"",Vt=l(()=>D.slice(ne.index+1),"remaining"),Et=l((He="",at=0)=>{ne.consumed+=He,ne.index+=at},"consume"),_t=l(He=>{ne.output+=He.output!=null?He.output:He.value,Et(He.value)},"append"),Or=l(()=>{let He=1;for(;rt()==="!"&&(rt(2)!=="("||rt(3)==="?");)pt(),ne.start++,He++;return He%2==0?!1:(ne.negated=!0,ne.start++,!0)},"negate"),Gt=l(He=>{ne[He]++,ct.push(He)},"increment"),sr=l(He=>{ne[He]--,ct.pop()},"decrement"),ot=l(He=>{if(he.type==="globstar"){const at=ne.braces>0&&(He.type==="comma"||He.type==="brace"),Ee=He.extglob===!0||vt.length&&(He.type==="pipe"||He.type==="paren");He.type!=="slash"&&He.type!=="paren"&&!at&&!Ee&&(ne.output=ne.output.slice(0,-he.output.length),he.type="star",he.value="*",he.output=Qe,ne.output+=he.output)}if(vt.length&&He.type!=="paren"&&(vt[vt.length-1].inner+=He.value),(He.value||He.output)&&_t(He),he&&he.type==="text"&&He.type==="text"){he.value+=He.value,he.output=(he.output||"")+He.value;return}He.prev=he,G.push(He),he=He},"push"),wt=l((He,at)=>{const Ee={...E[at],conditions:1,inner:""};Ee.prev=he,Ee.parens=ne.parens,Ee.output=ne.output;const st=($.capture?"(":"")+Ee.open;Gt("parens"),ot({type:He,value:at,output:ne.output?"":le}),ot({type:"paren",extglob:!0,value:pt(),output:st}),vt.push(Ee)},"extglobOpen"),Ue=l(He=>{let at=He.close+($.capture?")":""),Ee;if(He.type==="negate"){let st=Qe;He.inner&&He.inner.length>1&&He.inner.includes("/")&&(st=$e($)),(st!==Qe||qe()||/^\)+$/.test(Vt()))&&(at=He.close=`)$))${st}`),He.inner.includes("*")&&(Ee=Vt())&&/^\.[^\\/.]+$/.test(Ee)&&(at=He.close=`)${Ee})${st})`),He.prev.type==="bos"&&(ne.negatedExtglob=!0)}ot({type:"paren",extglob:!0,value:de,output:at}),sr("parens")},"extglobClose");if($.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(D)){let He=!1,at=D.replace(U,(Ee,st,Ye,$t,xt,T)=>$t==="\\"?(He=!0,Ee):$t==="?"?st?st+$t+(xt?Ce.repeat(xt.length):""):T===0?_e+(xt?Ce.repeat(xt.length):""):Ce.repeat(Ye.length):$t==="."?oe.repeat(Ye.length):$t==="*"?st?st+$t+(xt?Qe:""):Qe:st?Ee:`\\${Ee}`);return He===!0&&($.unescape===!0?at=at.replace(/\\/g,""):at=at.replace(/\\+/g,Ee=>Ee.length%2==0?"\\\\":Ee?"\\":"")),at===D&&$.contains===!0?(ne.output=D,ne):(ne.output=N.wrapOutput(at,ne,V),ne)}for(;!qe();){if(de=pt(),de==="\0")continue;if(de==="\\"){const Ee=rt();if(Ee==="/"&&$.bash!==!0||Ee==="."||Ee===";")continue;if(!Ee){de+="\\",ot({type:"text",value:de});continue}const st=/^\\+/.exec(Vt());let Ye=0;if(st&&st[0].length>2&&(Ye=st[0].length,ne.index+=Ye,Ye%2!=0&&(de+="\\")),$.unescape===!0?de=pt():de+=pt(),ne.brackets===0){ot({type:"text",value:de});continue}}if(ne.brackets>0&&(de!=="]"||he.value==="["||he.value==="[^")){if($.posix!==!1&&de===":"){const Ee=he.value.slice(1);if(Ee.includes("[")&&(he.posix=!0,Ee.includes(":"))){const st=he.value.lastIndexOf("["),Ye=he.value.slice(0,st),$t=he.value.slice(st+2),xt=Q[$t];if(xt){he.value=Ye+xt,ne.backtrack=!0,pt(),!me.output&&G.indexOf(he)===1&&(me.output=le);continue}}}(de==="["&&rt()!==":"||de==="-"&&rt()==="]")&&(de=`\\${de}`),de==="]"&&(he.value==="["||he.value==="[^")&&(de=`\\${de}`),$.posix===!0&&de==="!"&&he.value==="["&&(de="^"),he.value+=de,_t({value:de});continue}if(ne.quotes===1&&de!=='"'){de=N.escapeRegex(de),he.value+=de,_t({value:de});continue}if(de==='"'){ne.quotes=ne.quotes===1?0:1,$.keepQuotes===!0&&ot({type:"text",value:de});continue}if(de==="("){Gt("parens"),ot({type:"paren",value:de});continue}if(de===")"){if(ne.parens===0&&$.strictBrackets===!0)throw new SyntaxError(A("opening","("));const Ee=vt[vt.length-1];if(Ee&&ne.parens===Ee.parens+1){Ue(vt.pop());continue}ot({type:"paren",value:de,output:ne.parens?")":"\\)"}),sr("parens");continue}if(de==="["){if($.nobracket===!0||!Vt().includes("]")){if($.nobracket!==!0&&$.strictBrackets===!0)throw new SyntaxError(A("closing","]"));de=`\\${de}`}else Gt("brackets");ot({type:"bracket",value:de});continue}if(de==="]"){if($.nobracket===!0||he&&he.type==="bracket"&&he.value.length===1){ot({type:"text",value:de,output:`\\${de}`});continue}if(ne.brackets===0){if($.strictBrackets===!0)throw new SyntaxError(A("opening","["));ot({type:"text",value:de,output:`\\${de}`});continue}sr("brackets");const Ee=he.value.slice(1);if(he.posix!==!0&&Ee[0]==="^"&&!Ee.includes("/")&&(de=`/${de}`),he.value+=de,_t({value:de}),$.literalBrackets===!1||N.hasRegexChars(Ee))continue;const st=N.escapeRegex(he.value);if(ne.output=ne.output.slice(0,-he.value.length),$.literalBrackets===!0){ne.output+=st,he.value=st;continue}he.value=`(${ee}${st}|${he.value})`,ne.output+=he.value;continue}if(de==="{"&&$.nobrace!==!0){Gt("braces");const Ee={type:"brace",value:de,output:"(",outputIndex:ne.output.length,tokensIndex:ne.tokens.length};Ke.push(Ee),ot(Ee);continue}if(de==="}"){const Ee=Ke[Ke.length-1];if($.nobrace===!0||!Ee){ot({type:"text",value:de,output:de});continue}let st=")";if(Ee.dots===!0){const Ye=G.slice(),$t=[];for(let xt=Ye.length-1;xt>=0&&(G.pop(),Ye[xt].type!=="brace");xt--)Ye[xt].type!=="dots"&&$t.unshift(Ye[xt].value);st=R($t,$),ne.backtrack=!0}if(Ee.comma!==!0&&Ee.dots!==!0){const Ye=ne.output.slice(0,Ee.outputIndex),$t=ne.tokens.slice(Ee.tokensIndex);Ee.value=Ee.output="\\{",de=st="\\}",ne.output=Ye;for(const xt of $t)ne.output+=xt.output||xt.value}ot({type:"brace",value:de,output:st}),sr("braces"),Ke.pop();continue}if(de==="|"){vt.length>0&&vt[vt.length-1].conditions++,ot({type:"text",value:de});continue}if(de===","){let Ee=de;const st=Ke[Ke.length-1];st&&ct[ct.length-1]==="braces"&&(st.comma=!0,Ee="|"),ot({type:"comma",value:de,output:Ee});continue}if(de==="/"){if(he.type==="dot"&&ne.index===ne.start+1){ne.start=ne.index+1,ne.consumed="",ne.output="",G.pop(),he=me;continue}ot({type:"slash",value:de,output:se});continue}if(de==="."){if(ne.braces>0&&he.type==="dot"){he.value==="."&&(he.output=oe);const Ee=Ke[Ke.length-1];he.type="dots",he.output+=de,he.value+=de,Ee.dots=!0;continue}if(ne.braces+ne.parens===0&&he.type!=="bos"&&he.type!=="slash"){ot({type:"text",value:de,output:oe});continue}ot({type:"dot",value:de,output:oe});continue}if(de==="?"){if(!(he&&he.value==="(")&&$.noextglob!==!0&&rt()==="("&&rt(2)!=="?"){wt("qmark",de);continue}if(he&&he.type==="paren"){const st=rt();let Ye=de;if(st==="<"&&!N.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(he.value==="("&&!/[!=<:]/.test(st)||st==="<"&&!/<([!=]|\w+>)/.test(Vt()))&&(Ye=`\\${de}`),ot({type:"text",value:de,output:Ye});continue}if($.dot!==!0&&(he.type==="slash"||he.type==="bos")){ot({type:"qmark",value:de,output:tt});continue}ot({type:"qmark",value:de,output:Ce});continue}if(de==="!"){if($.noextglob!==!0&&rt()==="("&&(rt(2)!=="?"||!/[!=<:]/.test(rt(3)))){wt("negate",de);continue}if($.nonegate!==!0&&ne.index===0){Or();continue}}if(de==="+"){if($.noextglob!==!0&&rt()==="("&&rt(2)!=="?"){wt("plus",de);continue}if(he&&he.value==="("||$.regex===!1){ot({type:"plus",value:de,output:W});continue}if(he&&(he.type==="bracket"||he.type==="paren"||he.type==="brace")||ne.parens>0){ot({type:"plus",value:de});continue}ot({type:"plus",value:W});continue}if(de==="@"){if($.noextglob!==!0&&rt()==="("&&rt(2)!=="?"){ot({type:"at",extglob:!0,value:de,output:""});continue}ot({type:"text",value:de});continue}if(de!=="*"){(de==="$"||de==="^")&&(de=`\\${de}`);const Ee=q.exec(Vt());Ee&&(de+=Ee[0],ne.index+=Ee[0].length),ot({type:"text",value:de});continue}if(he&&(he.type==="globstar"||he.star===!0)){he.type="star",he.star=!0,he.value+=de,he.output=Qe,ne.backtrack=!0,ne.globstar=!0,Et(de);continue}let He=Vt();if($.noextglob!==!0&&/^\([^?]/.test(He)){wt("star",de);continue}if(he.type==="star"){if($.noglobstar===!0){Et(de);continue}const Ee=he.prev,st=Ee.prev,Ye=Ee.type==="slash"||Ee.type==="bos",$t=st&&(st.type==="star"||st.type==="globstar");if($.bash===!0&&(!Ye||He[0]&&He[0]!=="/")){ot({type:"star",value:de,output:""});continue}const xt=ne.braces>0&&(Ee.type==="comma"||Ee.type==="brace"),T=vt.length&&(Ee.type==="pipe"||Ee.type==="paren");if(!Ye&&Ee.type!=="paren"&&!xt&&!T){ot({type:"star",value:de,output:""});continue}for(;He.slice(0,3)==="/**";){const m=D[ne.index+4];if(m&&m!=="/")break;He=He.slice(3),Et("/**",3)}if(Ee.type==="bos"&&qe()){he.type="globstar",he.value+=de,he.output=$e($),ne.output=he.output,ne.globstar=!0,Et(de);continue}if(Ee.type==="slash"&&Ee.prev.type!=="bos"&&!$t&&qe()){ne.output=ne.output.slice(0,-(Ee.output+he.output).length),Ee.output=`(?:${Ee.output}`,he.type="globstar",he.output=$e($)+($.strictSlashes?")":"|$)"),he.value+=de,ne.globstar=!0,ne.output+=Ee.output+he.output,Et(de);continue}if(Ee.type==="slash"&&Ee.prev.type!=="bos"&&He[0]==="/"){const m=He[1]!==void 0?"|$":"";ne.output=ne.output.slice(0,-(Ee.output+he.output).length),Ee.output=`(?:${Ee.output}`,he.type="globstar",he.output=`${$e($)}${se}|${se}${m})`,he.value+=de,ne.output+=Ee.output+he.output,ne.globstar=!0,Et(de+pt()),ot({type:"slash",value:"/",output:""});continue}if(Ee.type==="bos"&&He[0]==="/"){he.type="globstar",he.value+=de,he.output=`(?:^|${se}|${$e($)}${se})`,ne.output=he.output,ne.globstar=!0,Et(de+pt()),ot({type:"slash",value:"/",output:""});continue}ne.output=ne.output.slice(0,-he.output.length),he.type="globstar",he.output=$e($),he.value+=de,ne.output+=he.output,ne.globstar=!0,Et(de);continue}const at={type:"star",value:de,output:Qe};if($.bash===!0){at.output=".*?",(he.type==="bos"||he.type==="slash")&&(at.output=De+at.output),ot(at);continue}if(he&&(he.type==="bracket"||he.type==="paren")&&$.regex===!0){at.output=de,ot(at);continue}(ne.index===ne.start||he.type==="slash"||he.type==="dot")&&(he.type==="dot"?(ne.output+=ze,he.output+=ze):$.dot===!0?(ne.output+=Ve,he.output+=Ve):(ne.output+=De,he.output+=De),rt()!=="*"&&(ne.output+=le,he.output+=le)),ot(at)}for(;ne.brackets>0;){if($.strictBrackets===!0)throw new SyntaxError(A("closing","]"));ne.output=N.escapeLast(ne.output,"["),sr("brackets")}for(;ne.parens>0;){if($.strictBrackets===!0)throw new SyntaxError(A("closing",")"));ne.output=N.escapeLast(ne.output,"("),sr("parens")}for(;ne.braces>0;){if($.strictBrackets===!0)throw new SyntaxError(A("closing","}"));ne.output=N.escapeLast(ne.output,"{"),sr("braces")}if($.strictSlashes!==!0&&(he.type==="star"||he.type==="bracket")&&ot({type:"maybe_slash",value:"",output:`${se}?`}),ne.backtrack===!0){ne.output="";for(const He of ne.tokens)ne.output+=He.output!=null?He.output:He.value,He.suffix&&(ne.output+=He.suffix)}return ne},"parse");S.fastpaths=(D,V)=>{const $={...V},j=typeof $.maxLength=="number"?Math.min(P,$.maxLength):P,ge=D.length;if(ge>j)throw new SyntaxError(`Input length: ${ge}, exceeds maximum allowed length: ${j}`);D=b[D]||D;const me=N.isWindows(V),{DOT_LITERAL:G,SLASH_LITERAL:ee,ONE_CHAR:te,DOTS_SLASH:z,NO_DOT:E,NO_DOTS:oe,NO_DOTS_SLASH:W,STAR:se,START_ANCHOR:le}=F.globChars(me),ue=$.dot?oe:E,Ie=$.dot?W:E,ze=$.capture?"":"?:",Ve={negated:!1,prefix:""};let Ce=$.bash===!0?".*?":se;$.capture&&(Ce=`(${Ce})`);const tt=l(De=>De.noglobstar===!0?Ce:`(${ze}(?:(?!${le}${De.dot?z:G}).)*?)`,"globstar"),ut=l(De=>{switch(De){case"*":return`${ue}${te}${Ce}`;case".*":return`${G}${te}${Ce}`;case"*.*":return`${ue}${Ce}${G}${te}${Ce}`;case"*/*":return`${ue}${Ce}${ee}${te}${Ie}${Ce}`;case"**":return ue+tt($);case"**/*":return`(?:${ue}${tt($)}${ee})?${Ie}${te}${Ce}`;case"**/*.*":return`(?:${ue}${tt($)}${ee})?${Ie}${Ce}${G}${te}${Ce}`;case"**/.*":return`(?:${ue}${tt($)}${ee})?${G}${te}${Ce}`;default:{const _e=/^(.*?)\.(\w+)$/.exec(De);if(!_e)return;const Qe=ut(_e[1]);return Qe?Qe+G+_e[2]:void 0}}},"create"),Ze=N.removePrefix(D,Ve);let $e=ut(Ze);return $e&&$.strictSlashes!==!0&&($e+=`${ee}?`),$e},X.exports=S},6087:(X,h,O)=>{"use strict";const F=O(6470),N=O(3921),P=O(3376),Q=O(8702),q=O(1006),U=l(R=>R&&typeof R=="object"&&!Array.isArray(R),"isObject"),b=l((R,A,S=!1)=>{if(Array.isArray(R)){const ee=R.map(z=>b(z,A,S));return l(z=>{for(const E of ee){const oe=E(z);if(oe)return oe}return!1},"arrayMatcher")}const D=U(R)&&R.tokens&&R.input;if(R===""||typeof R!="string"&&!D)throw new TypeError("Expected pattern to be a non-empty string");const V=A||{},$=Q.isWindows(A),j=D?b.compileRe(R,A):b.makeRe(R,A,!1,!0),ge=j.state;delete j.state;let me=l(()=>!1,"isIgnored");if(V.ignore){const ee={...A,ignore:null,onMatch:null,onResult:null};me=b(V.ignore,ee,S)}const G=l((ee,te=!1)=>{const{isMatch:z,match:E,output:oe}=b.test(ee,j,A,{glob:R,posix:$}),W={glob:R,state:ge,regex:j,posix:$,input:ee,output:oe,match:E,isMatch:z};return typeof V.onResult=="function"&&V.onResult(W),z===!1?(W.isMatch=!1,te?W:!1):me(ee)?(typeof V.onIgnore=="function"&&V.onIgnore(W),W.isMatch=!1,te?W:!1):(typeof V.onMatch=="function"&&V.onMatch(W),te?W:!0)},"matcher");return S&&(G.state=ge),G},"picomatch");b.test=(R,A,S,{glob:D,posix:V}={})=>{if(typeof R!="string")throw new TypeError("Expected input to be a string");if(R==="")return{isMatch:!1,output:""};const $=S||{},j=$.format||(V?Q.toPosixSlashes:null);let ge=R===D,me=ge&&j?j(R):R;return ge===!1&&(me=j?j(R):R,ge=me===D),(ge===!1||$.capture===!0)&&($.matchBase===!0||$.basename===!0?ge=b.matchBase(R,A,S,V):ge=A.exec(me)),{isMatch:Boolean(ge),match:ge,output:me}},b.matchBase=(R,A,S,D=Q.isWindows(S))=>(A instanceof RegExp?A:b.makeRe(A,S)).test(F.basename(R)),b.isMatch=(R,A,S)=>b(A,S)(R),b.parse=(R,A)=>Array.isArray(R)?R.map(S=>b.parse(S,A)):P(R,{...A,fastpaths:!1}),b.scan=(R,A)=>N(R,A),b.compileRe=(R,A,S=!1,D=!1)=>{if(S===!0)return R.output;const V=A||{},$=V.contains?"":"^",j=V.contains?"":"$";let ge=`${$}(?:${R.output})${j}`;R&&R.negated===!0&&(ge=`^(?!${ge}).*$`);const me=b.toRegex(ge,A);return D===!0&&(me.state=R),me},b.makeRe=(R,A={},S=!1,D=!1)=>{if(!R||typeof R!="string")throw new TypeError("Expected a non-empty string");let V={negated:!1,fastpaths:!0};return A.fastpaths!==!1&&(R[0]==="."||R[0]==="*")&&(V.output=P.fastpaths(R,A)),V.output||(V=P(R,A)),b.compileRe(V,A,S,D)},b.toRegex=(R,A)=>{try{const S=A||{};return new RegExp(R,S.flags||(S.nocase?"i":""))}catch(S){if(A&&A.debug===!0)throw S;return/$^/}},b.constants=q,X.exports=b},3921:(X,h,O)=>{"use strict";const F=O(8702),{CHAR_ASTERISK:N,CHAR_AT:P,CHAR_BACKWARD_SLASH:Q,CHAR_COMMA:q,CHAR_DOT:U,CHAR_EXCLAMATION_MARK:b,CHAR_FORWARD_SLASH:R,CHAR_LEFT_CURLY_BRACE:A,CHAR_LEFT_PARENTHESES:S,CHAR_LEFT_SQUARE_BRACKET:D,CHAR_PLUS:V,CHAR_QUESTION_MARK:$,CHAR_RIGHT_CURLY_BRACE:j,CHAR_RIGHT_PARENTHESES:ge,CHAR_RIGHT_SQUARE_BRACKET:me}=O(1006),G=l(z=>z===R||z===Q,"isPathSeparator"),ee=l(z=>{z.isPrefix!==!0&&(z.depth=z.isGlobstar?1/0:1)},"depth"),te=l((z,E)=>{const oe=E||{},W=z.length-1,se=oe.parts===!0||oe.scanToEnd===!0,le=[],ue=[],Ie=[];let ze=z,Ve=-1,Ce=0,tt=0,ut=!1,Ze=!1,$e=!1,De=!1,_e=!1,Qe=!1,ne=!1,vt=!1,Ke=!1,ct=!1,he=0,de,qe,rt={value:"",depth:0,isGlob:!1};const pt=l(()=>Ve>=W,"eos"),Vt=l(()=>ze.charCodeAt(Ve+1),"peek"),Et=l(()=>(de=qe,ze.charCodeAt(++Ve)),"advance");for(;Ve<W;){qe=Et();let ot;if(qe===Q){ne=rt.backslashes=!0,qe=Et(),qe===A&&(Qe=!0);continue}if(Qe===!0||qe===A){for(he++;pt()!==!0&&(qe=Et());){if(qe===Q){ne=rt.backslashes=!0,Et();continue}if(qe===A){he++;continue}if(Qe!==!0&&qe===U&&(qe=Et())===U){if(ut=rt.isBrace=!0,$e=rt.isGlob=!0,ct=!0,se===!0)continue;break}if(Qe!==!0&&qe===q){if(ut=rt.isBrace=!0,$e=rt.isGlob=!0,ct=!0,se===!0)continue;break}if(qe===j&&(he--,he===0)){Qe=!1,ut=rt.isBrace=!0,ct=!0;break}}if(se===!0)continue;break}if(qe===R){if(le.push(Ve),ue.push(rt),rt={value:"",depth:0,isGlob:!1},ct===!0)continue;if(de===U&&Ve===Ce+1){Ce+=2;continue}tt=Ve+1;continue}if(oe.noext!==!0&&(qe===V||qe===P||qe===N||qe===$||qe===b)===!0&&Vt()===S){if($e=rt.isGlob=!0,De=rt.isExtglob=!0,ct=!0,qe===b&&Ve===Ce&&(Ke=!0),se===!0){for(;pt()!==!0&&(qe=Et());){if(qe===Q){ne=rt.backslashes=!0,qe=Et();continue}if(qe===ge){$e=rt.isGlob=!0,ct=!0;break}}continue}break}if(qe===N){if(de===N&&(_e=rt.isGlobstar=!0),$e=rt.isGlob=!0,ct=!0,se===!0)continue;break}if(qe===$){if($e=rt.isGlob=!0,ct=!0,se===!0)continue;break}if(qe===D){for(;pt()!==!0&&(ot=Et());){if(ot===Q){ne=rt.backslashes=!0,Et();continue}if(ot===me){Ze=rt.isBracket=!0,$e=rt.isGlob=!0,ct=!0;break}}if(se===!0)continue;break}if(oe.nonegate!==!0&&qe===b&&Ve===Ce){vt=rt.negated=!0,Ce++;continue}if(oe.noparen!==!0&&qe===S){if($e=rt.isGlob=!0,se===!0){for(;pt()!==!0&&(qe=Et());){if(qe===S){ne=rt.backslashes=!0,qe=Et();continue}if(qe===ge){ct=!0;break}}continue}break}if($e===!0){if(ct=!0,se===!0)continue;break}}oe.noext===!0&&(De=!1,$e=!1);let _t=ze,Or="",Gt="";Ce>0&&(Or=ze.slice(0,Ce),ze=ze.slice(Ce),tt-=Ce),_t&&$e===!0&&tt>0?(_t=ze.slice(0,tt),Gt=ze.slice(tt)):$e===!0?(_t="",Gt=ze):_t=ze,_t&&_t!==""&&_t!=="/"&&_t!==ze&&G(_t.charCodeAt(_t.length-1))&&(_t=_t.slice(0,-1)),oe.unescape===!0&&(Gt&&(Gt=F.removeBackslashes(Gt)),_t&&ne===!0&&(_t=F.removeBackslashes(_t)));const sr={prefix:Or,input:z,start:Ce,base:_t,glob:Gt,isBrace:ut,isBracket:Ze,isGlob:$e,isExtglob:De,isGlobstar:_e,negated:vt,negatedExtglob:Ke};if(oe.tokens===!0&&(sr.maxDepth=0,G(qe)||ue.push(rt),sr.tokens=ue),oe.parts===!0||oe.tokens===!0){let ot;for(let wt=0;wt<le.length;wt++){const Ue=ot?ot+1:Ce,He=le[wt],at=z.slice(Ue,He);oe.tokens&&(wt===0&&Ce!==0?(ue[wt].isPrefix=!0,ue[wt].value=Or):ue[wt].value=at,ee(ue[wt]),sr.maxDepth+=ue[wt].depth),(wt!==0||at!=="")&&Ie.push(at),ot=He}if(ot&&ot+1<z.length){const wt=z.slice(ot+1);Ie.push(wt),oe.tokens&&(ue[ue.length-1].value=wt,ee(ue[ue.length-1]),sr.maxDepth+=ue[ue.length-1].depth)}sr.slashes=le,sr.parts=Ie}return sr},"scan");X.exports=te},8702:(X,h,O)=>{"use strict";var F=O(4155);const N=O(6470),P=F.platform==="win32",{REGEX_BACKSLASH:Q,REGEX_REMOVE_BACKSLASH:q,REGEX_SPECIAL_CHARS:U,REGEX_SPECIAL_CHARS_GLOBAL:b}=O(1006);h.isObject=R=>R!==null&&typeof R=="object"&&!Array.isArray(R),h.hasRegexChars=R=>U.test(R),h.isRegexChar=R=>R.length===1&&h.hasRegexChars(R),h.escapeRegex=R=>R.replace(b,"\\$1"),h.toPosixSlashes=R=>R.replace(Q,"/"),h.removeBackslashes=R=>R.replace(q,A=>A==="\\"?"":A),h.supportsLookbehinds=()=>{const R=F.version.slice(1).split(".").map(Number);return R.length===3&&R[0]>=9||R[0]===8&&R[1]>=10},h.isWindows=R=>R&&typeof R.windows=="boolean"?R.windows:P===!0||N.sep==="\\",h.escapeLast=(R,A,S)=>{const D=R.lastIndexOf(A,S);return D===-1?R:R[D-1]==="\\"?h.escapeLast(R,A,D-1):`${R.slice(0,D)}\\${R.slice(D)}`},h.removePrefix=(R,A={})=>{let S=R;return S.startsWith("./")&&(S=S.slice(2),A.prefix="./"),S},h.wrapOutput=(R,A={},S={})=>{const D=S.contains?"":"^",V=S.contains?"":"$";let $=`${D}(?:${R})${V}`;return A.negated===!0&&($=`(?:^(?!${$}).*$)`),$}},4155:X=>{var h=X.exports={},O,F;function N(){throw new Error("setTimeout has not been defined")}l(N,"defaultSetTimout");function P(){throw new Error("clearTimeout has not been defined")}l(P,"defaultClearTimeout"),function(){try{typeof setTimeout=="function"?O=setTimeout:O=N}catch(j){O=N}try{typeof clearTimeout=="function"?F=clearTimeout:F=P}catch(j){F=P}}();function Q(j){if(O===setTimeout)return setTimeout(j,0);if((O===N||!O)&&setTimeout)return O=setTimeout,setTimeout(j,0);try{return O(j,0)}catch(ge){try{return O.call(null,j,0)}catch(me){return O.call(this,j,0)}}}l(Q,"runTimeout");function q(j){if(F===clearTimeout)return clearTimeout(j);if((F===P||!F)&&clearTimeout)return F=clearTimeout,clearTimeout(j);try{return F(j)}catch(ge){try{return F.call(null,j)}catch(me){return F.call(this,j)}}}l(q,"runClearTimeout");var U=[],b=!1,R,A=-1;function S(){!b||!R||(b=!1,R.length?U=R.concat(U):A=-1,U.length&&D())}l(S,"cleanUpNextTick");function D(){if(!b){var j=Q(S);b=!0;for(var ge=U.length;ge;){for(R=U,U=[];++A<ge;)R&&R[A].run();A=-1,ge=U.length}R=null,b=!1,q(j)}}l(D,"drainQueue"),h.nextTick=function(j){var ge=new Array(arguments.length-1);if(arguments.length>1)for(var me=1;me<arguments.length;me++)ge[me-1]=arguments[me];U.push(new V(j,ge)),U.length===1&&!b&&Q(D)};function V(j,ge){this.fun=j,this.array=ge}l(V,"Item"),V.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={};function $(){}l($,"noop"),h.on=$,h.addListener=$,h.once=$,h.off=$,h.removeListener=$,h.removeAllListeners=$,h.emit=$,h.prependListener=$,h.prependOnceListener=$,h.listeners=function(j){return[]},h.binding=function(j){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(j){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},842:(X,h,O)=>{"use strict";var F=O(8764).Buffer;Object.defineProperty(h,"__esModule",{value:!0}),h.AbstractTokenizer=void 0;const N=O(5167);class P{constructor(q){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=q||{}}async readToken(q,U=this.position){const b=F.alloc(q.len);if(await this.readBuffer(b,{position:U})<q.len)throw new N.EndOfStreamError;return q.get(b,0)}async peekToken(q,U=this.position){const b=F.alloc(q.len);if(await this.peekBuffer(b,{position:U})<q.len)throw new N.EndOfStreamError;return q.get(b,0)}async readNumber(q){if(await this.readBuffer(this.numBuffer,{length:q.len})<q.len)throw new N.EndOfStreamError;return q.get(this.numBuffer,0)}async peekNumber(q){if(await this.peekBuffer(this.numBuffer,{length:q.len})<q.len)throw new N.EndOfStreamError;return q.get(this.numBuffer,0)}async ignore(q){if(this.fileInfo.size!==void 0){const U=this.fileInfo.size-this.position;if(q>U)return this.position+=U,U}return this.position+=q,q}async close(){}normalizeOptions(q,U){if(U&&U.position!==void 0&&U.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return U?{mayBeLess:U.mayBeLess===!0,offset:U.offset?U.offset:0,length:U.length?U.length:q.length-(U.offset?U.offset:0),position:U.position?U.position:this.position}:{mayBeLess:!1,offset:0,length:q.length,position:this.position}}}l(P,"AbstractTokenizer"),h.AbstractTokenizer=P},778:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.BufferTokenizer=void 0;const F=O(5167),N=O(842);class P extends N.AbstractTokenizer{constructor(q,U){super(U);this.uint8Array=q,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:q.length}async readBuffer(q,U){if(U&&U.position){if(U.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=U.position}const b=await this.peekBuffer(q,U);return this.position+=b,b}async peekBuffer(q,U){const b=this.normalizeOptions(q,U),R=Math.min(this.uint8Array.length-b.position,b.length);if(!b.mayBeLess&&R<b.length)throw new F.EndOfStreamError;return q.set(this.uint8Array.subarray(b.position,b.position+R),b.offset),R}async close(){}}l(P,"BufferTokenizer"),h.BufferTokenizer=P},7859:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromFile=h.FileTokenizer=void 0;const F=O(842),N=O(5167),P=O(7209);class Q extends F.AbstractTokenizer{constructor(b,R){super(R);this.fd=b}async readBuffer(b,R){const A=this.normalizeOptions(b,R);this.position=A.position;const S=await P.read(this.fd,b,A.offset,A.length,A.position);if(this.position+=S.bytesRead,S.bytesRead<A.length&&(!R||!R.mayBeLess))throw new N.EndOfStreamError;return S.bytesRead}async peekBuffer(b,R){const A=this.normalizeOptions(b,R),S=await P.read(this.fd,b,A.offset,A.length,A.position);if(!A.mayBeLess&&S.bytesRead<A.length)throw new N.EndOfStreamError;return S.bytesRead}async close(){return P.close(this.fd)}}l(Q,"FileTokenizer"),h.FileTokenizer=Q;async function q(U){const b=await P.stat(U);if(!b.isFile)throw new Error(`File not a file: ${U}`);const R=await P.open(U,"r");return new Q(R,{path:U,size:b.size})}l(q,"fromFile"),h.fromFile=q},7209:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.readFile=h.writeFileSync=h.writeFile=h.read=h.open=h.close=h.stat=h.createReadStream=h.pathExists=void 0;const F=O(4059);h.pathExists=F.existsSync,h.createReadStream=F.createReadStream;async function N(A){return new Promise((S,D)=>{F.stat(A,(V,$)=>{V?D(V):S($)})})}l(N,"stat"),h.stat=N;async function P(A){return new Promise((S,D)=>{F.close(A,V=>{V?D(V):S()})})}l(P,"close"),h.close=P;async function Q(A,S){return new Promise((D,V)=>{F.open(A,S,($,j)=>{$?V($):D(j)})})}l(Q,"open"),h.open=Q;async function q(A,S,D,V,$){return new Promise((j,ge)=>{F.read(A,S,D,V,$,(me,G,ee)=>{me?ge(me):j({bytesRead:G,buffer:ee})})})}l(q,"read"),h.read=q;async function U(A,S){return new Promise((D,V)=>{F.writeFile(A,S,$=>{$?V($):D()})})}l(U,"writeFile"),h.writeFile=U;function b(A,S){F.writeFileSync(A,S)}l(b,"writeFileSync"),h.writeFileSync=b;async function R(A){return new Promise((S,D)=>{F.readFile(A,(V,$)=>{V?D(V):S($)})})}l(R,"readFile"),h.readFile=R},599:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ReadStreamTokenizer=void 0;const F=O(842),N=O(5167),P=256e3;class Q extends F.AbstractTokenizer{constructor(U,b){super(b);this.streamReader=new N.StreamReader(U)}async getFileInfo(){return this.fileInfo}async readBuffer(U,b){const R=this.normalizeOptions(U,b),A=R.position-this.position;if(A>0)return await this.ignore(A),this.readBuffer(U,b);if(A<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(R.length===0)return 0;const S=await this.streamReader.read(U,R.offset,R.length);if(this.position+=S,(!b||!b.mayBeLess)&&S<R.length)throw new N.EndOfStreamError;return S}async peekBuffer(U,b){const R=this.normalizeOptions(U,b);let A=0;if(R.position){const S=R.position-this.position;if(S>0){const D=new Uint8Array(R.length+S);return A=await this.peekBuffer(D,{mayBeLess:R.mayBeLess}),U.set(D.subarray(S),R.offset),A-S}else if(S<0)throw new Error("Cannot peek from a negative offset in a stream")}if(R.length>0){try{A=await this.streamReader.peek(U,R.offset,R.length)}catch(S){if(b&&b.mayBeLess&&S instanceof N.EndOfStreamError)return 0;throw S}if(!R.mayBeLess&&A<R.length)throw new N.EndOfStreamError}return A}async ignore(U){const b=Math.min(P,U),R=new Uint8Array(b);let A=0;for(;A<U;){const S=U-A,D=await this.readBuffer(R,{length:Math.min(b,S)});if(D<0)return D;A+=D}return A}}l(Q,"ReadStreamTokenizer"),h.ReadStreamTokenizer=Q},5849:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromBuffer=h.fromStream=h.EndOfStreamError=void 0;const F=O(599),N=O(778);var P=O(5167);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return P.EndOfStreamError}});function Q(U,b){return b=b||{},new F.ReadStreamTokenizer(U,b)}l(Q,"fromStream"),h.fromStream=Q;function q(U,b){return new N.BufferTokenizer(U,b)}l(q,"fromBuffer"),h.fromBuffer=q},6597:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromStream=h.fromBuffer=h.EndOfStreamError=h.fromFile=void 0;const F=O(7209),N=O(5849);var P=O(7859);Object.defineProperty(h,"fromFile",{enumerable:!0,get:function(){return P.fromFile}});var Q=O(5849);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return Q.EndOfStreamError}}),Object.defineProperty(h,"fromBuffer",{enumerable:!0,get:function(){return Q.fromBuffer}});async function q(U,b){if(b=b||{},U.path){const R=await F.stat(U.path);b.path=U.path,b.size=R.size}return N.fromStream(U,b)}l(q,"fromStream"),h.fromStream=q},5702:(X,h,O)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const F=O(9924),N=l((G,ee,te)=>{if(F(G)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(ee===void 0||G===ee)return String(G);if(F(ee)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let z={relaxZeros:!0,...te};typeof z.strictZeros=="boolean"&&(z.relaxZeros=z.strictZeros===!1);let E=String(z.relaxZeros),oe=String(z.shorthand),W=String(z.capture),se=String(z.wrap),le=G+":"+ee+"="+E+oe+W+se;if(N.cache.hasOwnProperty(le))return N.cache[le].result;let ue=Math.min(G,ee),Ie=Math.max(G,ee);if(Math.abs(ue-Ie)===1){let ut=G+"|"+ee;return z.capture?`(${ut})`:z.wrap===!1?ut:`(?:${ut})`}let ze=ge(G)||ge(ee),Ve={min:G,max:ee,a:ue,b:Ie},Ce=[],tt=[];if(ze&&(Ve.isPadded=ze,Ve.maxLen=String(Ve.max).length),ue<0){let ut=Ie<0?Math.abs(Ie):1;tt=U(ut,Math.abs(ue),Ve,z),ue=Ve.a=0}return Ie>=0&&(Ce=U(ue,Ie,Ve,z)),Ve.negatives=tt,Ve.positives=Ce,Ve.result=P(tt,Ce,z),z.capture===!0?Ve.result=`(${Ve.result})`:z.wrap!==!1&&Ce.length+tt.length>1&&(Ve.result=`(?:${Ve.result})`),N.cache[le]=Ve,Ve.result},"toRegexRange");function P(G,ee,te){let z=b(G,ee,"-",!1,te)||[],E=b(ee,G,"",!1,te)||[],oe=b(G,ee,"-?",!0,te)||[];return z.concat(oe).concat(E).join("|")}l(P,"collatePatterns");function Q(G,ee){let te=1,z=1,E=D(G,te),oe=new Set([ee]);for(;G<=E&&E<=ee;)oe.add(E),te+=1,E=D(G,te);for(E=V(ee+1,z)-1;G<E&&E<=ee;)oe.add(E),z+=1,E=V(ee+1,z)-1;return oe=[...oe],oe.sort(A),oe}l(Q,"splitToRanges");function q(G,ee,te){if(G===ee)return{pattern:G,count:[],digits:0};let z=R(G,ee),E=z.length,oe="",W=0;for(let se=0;se<E;se++){let[le,ue]=z[se];le===ue?oe+=le:le!=="0"||ue!=="9"?oe+=j(le,ue,te):W++}return W&&(oe+=te.shorthand===!0?"\\d":"[0-9]"),{pattern:oe,count:[W],digits:E}}l(q,"rangeToPattern");function U(G,ee,te,z){let E=Q(G,ee),oe=[],W=G,se;for(let le=0;le<E.length;le++){let ue=E[le],Ie=q(String(W),String(ue),z),ze="";if(!te.isPadded&&se&&se.pattern===Ie.pattern){se.count.length>1&&se.count.pop(),se.count.push(Ie.count[0]),se.string=se.pattern+$(se.count),W=ue+1;continue}te.isPadded&&(ze=me(ue,te,z)),Ie.string=ze+Ie.pattern+$(Ie.count),oe.push(Ie),W=ue+1,se=Ie}return oe}l(U,"splitToPatterns");function b(G,ee,te,z,E){let oe=[];for(let W of G){let{string:se}=W;!z&&!S(ee,"string",se)&&oe.push(te+se),z&&S(ee,"string",se)&&oe.push(te+se)}return oe}l(b,"filterPatterns");function R(G,ee){let te=[];for(let z=0;z<G.length;z++)te.push([G[z],ee[z]]);return te}l(R,"zip");function A(G,ee){return G>ee?1:ee>G?-1:0}l(A,"compare");function S(G,ee,te){return G.some(z=>z[ee]===te)}l(S,"contains");function D(G,ee){return Number(String(G).slice(0,-ee)+"9".repeat(ee))}l(D,"countNines");function V(G,ee){return G-G%Math.pow(10,ee)}l(V,"countZeros");function $(G){let[ee=0,te=""]=G;return te||ee>1?`{${ee+(te?","+te:"")}}`:""}l($,"toQuantifier");function j(G,ee,te){return`[${G}${ee-G==1?"":"-"}${ee}]`}l(j,"toCharacterClass");function ge(G){return/^-?(0+)\d/.test(G)}l(ge,"hasPadding");function me(G,ee,te){if(!ee.isPadded)return G;let z=Math.abs(ee.maxLen-String(G).length),E=te.relaxZeros!==!1;switch(z){case 0:return"";case 1:return E?"0?":"0";case 2:return E?"0{0,2}":"00";default:return E?`0{0,${z}}`:`0{${z}}`}}l(me,"padZeros"),N.cache={},N.clearCache=()=>N.cache={},X.exports=N},3416:(X,h,O)=>{"use strict";var F=O(8764).Buffer;Object.defineProperty(h,"__esModule",{value:!0}),h.AnsiStringType=h.StringType=h.BufferType=h.Uint8ArrayType=h.IgnoreType=h.Float80_LE=h.Float80_BE=h.Float64_LE=h.Float64_BE=h.Float32_LE=h.Float32_BE=h.Float16_LE=h.Float16_BE=h.INT64_BE=h.UINT64_BE=h.INT64_LE=h.UINT64_LE=h.INT32_LE=h.INT32_BE=h.INT24_BE=h.INT24_LE=h.INT16_LE=h.INT16_BE=h.INT8=h.UINT32_BE=h.UINT32_LE=h.UINT24_BE=h.UINT24_LE=h.UINT16_BE=h.UINT16_LE=h.UINT8=void 0;const N=O(645);function P(A){return new DataView(A.buffer,A.byteOffset)}l(P,"dv"),h.UINT8={len:1,get(A,S){return P(A).getUint8(S)},put(A,S,D){return P(A).setUint8(S,D),S+1}},h.UINT16_LE={len:2,get(A,S){return P(A).getUint16(S,!0)},put(A,S,D){return P(A).setUint16(S,D,!0),S+2}},h.UINT16_BE={len:2,get(A,S){return P(A).getUint16(S)},put(A,S,D){return P(A).setUint16(S,D),S+2}},h.UINT24_LE={len:3,get(A,S){const D=P(A);return D.getUint8(S)+(D.getUint16(S+1,!0)<<8)},put(A,S,D){const V=P(A);return V.setUint8(S,D&255),V.setUint16(S+1,D>>8,!0),S+3}},h.UINT24_BE={len:3,get(A,S){const D=P(A);return(D.getUint16(S)<<8)+D.getUint8(S+2)},put(A,S,D){const V=P(A);return V.setUint16(S,D>>8),V.setUint8(S+2,D&255),S+3}},h.UINT32_LE={len:4,get(A,S){return P(A).getUint32(S,!0)},put(A,S,D){return P(A).setUint32(S,D,!0),S+4}},h.UINT32_BE={len:4,get(A,S){return P(A).getUint32(S)},put(A,S,D){return P(A).setUint32(S,D),S+4}},h.INT8={len:1,get(A,S){return P(A).getInt8(S)},put(A,S,D){return P(A).setInt8(S,D),S+2}},h.INT16_BE={len:2,get(A,S){return P(A).getInt16(S)},put(A,S,D){return P(A).setInt16(S,D),S+2}},h.INT16_LE={len:2,get(A,S){return P(A).getInt16(S,!0)},put(A,S,D){return P(A).setInt16(S,D,!0),S+2}},h.INT24_LE={len:3,get(A,S){const D=h.UINT24_LE.get(A,S);return D>8388607?D-16777216:D},put(A,S,D){const V=P(A);return V.setUint8(S,D&255),V.setUint16(S+1,D>>8,!0),S+3}},h.INT24_BE={len:3,get(A,S){const D=h.UINT24_BE.get(A,S);return D>8388607?D-16777216:D},put(A,S,D){const V=P(A);return V.setUint16(S,D>>8),V.setUint8(S+2,D&255),S+3}},h.INT32_BE={len:4,get(A,S){return P(A).getInt32(S)},put(A,S,D){return P(A).setInt32(S,D),S+4}},h.INT32_LE={len:4,get(A,S){return P(A).getInt32(S,!0)},put(A,S,D){return P(A).setInt32(S,D,!0),S+4}},h.UINT64_LE={len:8,get(A,S){return P(A).getBigUint64(S,!0)},put(A,S,D){return P(A).setBigUint64(S,D,!0),S+8}},h.INT64_LE={len:8,get(A,S){return P(A).getBigInt64(S,!0)},put(A,S,D){return P(A).setBigInt64(S,D,!0),S+8}},h.UINT64_BE={len:8,get(A,S){return P(A).getBigUint64(S)},put(A,S,D){return P(A).setBigUint64(S,D),S+8}},h.INT64_BE={len:8,get(A,S){return P(A).getBigInt64(S)},put(A,S,D){return P(A).setBigInt64(S,D),S+8}},h.Float16_BE={len:2,get(A,S){return N.read(A,S,!1,10,this.len)},put(A,S,D){return N.write(A,D,S,!1,10,this.len),S+this.len}},h.Float16_LE={len:2,get(A,S){return N.read(A,S,!0,10,this.len)},put(A,S,D){return N.write(A,D,S,!0,10,this.len),S+this.len}},h.Float32_BE={len:4,get(A,S){return P(A).getFloat32(S)},put(A,S,D){return P(A).setFloat32(S,D),S+4}},h.Float32_LE={len:4,get(A,S){return P(A).getFloat32(S,!0)},put(A,S,D){return P(A).setFloat32(S,D,!0),S+4}},h.Float64_BE={len:8,get(A,S){return P(A).getFloat64(S)},put(A,S,D){return P(A).setFloat64(S,D),S+8}},h.Float64_LE={len:8,get(A,S){return P(A).getFloat64(S,!0)},put(A,S,D){return P(A).setFloat64(S,D,!0),S+8}},h.Float80_BE={len:10,get(A,S){return N.read(A,S,!1,63,this.len)},put(A,S,D){return N.write(A,D,S,!1,63,this.len),S+this.len}},h.Float80_LE={len:10,get(A,S){return N.read(A,S,!0,63,this.len)},put(A,S,D){return N.write(A,D,S,!0,63,this.len),S+this.len}};class Q{constructor(S){this.len=S}get(S,D){}}l(Q,"IgnoreType"),h.IgnoreType=Q;class q{constructor(S){this.len=S}get(S,D){return S.subarray(D,D+this.len)}}l(q,"Uint8ArrayType"),h.Uint8ArrayType=q;class U{constructor(S){this.len=S}get(S,D){return S.slice(D,D+this.len)}}l(U,"BufferType"),h.BufferType=U;class b{constructor(S,D){this.len=S,this.encoding=D}get(S,D){return F.from(S).toString(this.encoding,D,D+this.len)}}l(b,"StringType"),h.StringType=b;class R{constructor(S){this.len=S}static decode(S,D,V){let $="";for(let j=D;j<V;++j)$+=R.codePointToString(R.singleByteDecoder(S[j]));return $}static inRange(S,D,V){return D<=S&&S<=V}static codePointToString(S){return S<=65535?String.fromCharCode(S):(S-=65536,String.fromCharCode((S>>10)+55296,(S&1023)+56320))}static singleByteDecoder(S){if(R.inRange(S,0,127))return S;const D=R.windows1252[S-128];if(D===null)throw Error("invaliding encoding");return D}get(S,D=0){return R.decode(S,D,D+this.len)}}l(R,"AnsiStringType"),h.AnsiStringType=R,R.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},5102:()=>{},189:function(X,h,O){"use strict";var F=this&&this.__spreadArrays||function(){for(var b=0,R=0,A=arguments.length;R<A;R++)b+=arguments[R].length;for(var S=Array(b),D=0,R=0;R<A;R++)for(var V=arguments[R],$=0,j=V.length;$<j;$++,D++)S[D]=V[$];return S};Object.defineProperty(h,"__esModule",{value:!0}),h.config=h.loadMessageBundle=void 0;var N=O(1926),P=O(800),Q=O(800);Object.defineProperty(h,"MessageFormat",{enumerable:!0,get:function(){return Q.MessageFormat}}),Object.defineProperty(h,"BundleFormat",{enumerable:!0,get:function(){return Q.BundleFormat}});function q(b){return function(R,A){for(var S=[],D=2;D<arguments.length;D++)S[D-2]=arguments[D];if(typeof R=="number")throw new Error("Browser implementation does currently not support externalized strings.");return P.localize.apply(void 0,F([R,A],S))}}l(q,"loadMessageBundle"),h.loadMessageBundle=q;function U(b){return P.setPseudo((b==null?void 0:b.locale.toLowerCase())==="pseudo"),q}l(U,"config"),h.config=U,N.default.install(Object.freeze({loadMessageBundle:q,config:U}))},800:(X,h,O)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.config=h.loadMessageBundle=h.localize=h.format=h.setPseudo=h.isPseudo=h.isDefined=h.BundleFormat=h.MessageFormat=void 0;var F=O(1926),N;(function(D){D.file="file",D.bundle="bundle",D.both="both"})(N=h.MessageFormat||(h.MessageFormat={}));var P;(function(D){D.standalone="standalone",D.languagePack="languagePack"})(P=h.BundleFormat||(h.BundleFormat={}));var Q;(function(D){function V($){var j=$;return j&&q(j.key)&&q(j.comment)}l(V,"is"),D.is=V})(Q||(Q={}));function q(D){return typeof D!="undefined"}l(q,"isDefined"),h.isDefined=q,h.isPseudo=!1;function U(D){h.isPseudo=D}l(U,"setPseudo"),h.setPseudo=U;function b(D,V){var $;return h.isPseudo&&(D="\uFF3B"+D.replace(/[aouei]/g,"$&$&")+"\uFF3D"),V.length===0?$=D:$=D.replace(/\{(\d+)\}/g,function(j,ge){var me=ge[0],G=V[me],ee=j;return typeof G=="string"?ee=G:(typeof G=="number"||typeof G=="boolean"||G===void 0||G===null)&&(ee=String(G)),ee}),$}l(b,"format"),h.format=b;function R(D,V){for(var $=[],j=2;j<arguments.length;j++)$[j-2]=arguments[j];return b(V,$)}l(R,"localize"),h.localize=R;function A(D){return F.default().loadMessageBundle(D)}l(A,"loadMessageBundle"),h.loadMessageBundle=A;function S(D){return F.default().config(D)}l(S,"config"),h.config=S},1926:(X,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var O;function F(){if(O===void 0)throw new Error("No runtime abstraction layer installed");return O}l(F,"RAL"),function(N){function P(Q){if(Q===void 0)throw new Error("No runtime abstraction layer provided");O=Q}l(P,"install"),N.install=P}(F||(F={})),h.default=F},6822:(X,h,O)=>{"use strict";X.exports=O(189)},2479:X=>{X.exports=h;function h(O,F){if(O&&F)return h(O)(F);if(typeof O!="function")throw new TypeError("need wrapper function");return Object.keys(O).forEach(function(P){N[P]=O[P]}),N;function N(){for(var P=new Array(arguments.length),Q=0;Q<P.length;Q++)P[Q]=arguments[Q];var q=O.apply(this,P),U=P[P.length-1];return typeof q=="function"&&q!==U&&Object.keys(U).forEach(function(b){q[b]=U[b]}),q}l(N,"wrapper")}l(h,"wrappy")},1932:()=>{},7170:()=>{},4059:()=>{}},__webpack_module_cache__={};function __webpack_require__(X){var h=__webpack_module_cache__[X];if(h!==void 0)return h.exports;var O=__webpack_module_cache__[X]={id:X,loaded:!1,exports:{}};return __webpack_modules__[X].call(O.exports,O,O.exports,__webpack_require__),O.loaded=!0,O.exports}l(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=X=>{var h=X&&X.__esModule?()=>X.default:()=>X;return __webpack_require__.d(h,{a:h}),h}})(),(()=>{__webpack_require__.d=(X,h)=>{for(var O in h)__webpack_require__.o(h,O)&&!__webpack_require__.o(X,O)&&Object.defineProperty(X,O,{enumerable:!0,get:h[O]})}})(),(()=>{__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(X){if(typeof window=="object")return window}}()})(),(()=>{__webpack_require__.o=(X,h)=>Object.prototype.hasOwnProperty.call(X,h)})(),(()=>{__webpack_require__.r=X=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(X,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=X=>(X.paths=[],X.children||(X.children=[]),X)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>Wo,activate:()=>bR,getOpenActionsService:()=>Iu,getState:()=>Ky,isInsiders:()=>Qy,updateState:()=>Sp});var X={};__webpack_require__.r(X),__webpack_require__.d(X,{max:()=>Lc,min:()=>ui});const h=require("vscode");var O=__webpack_require__(189),F;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(F||(F={}));var N;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(N||(N={})),function(t){function e(r){return r===t.None||r===t.Latest||r===t.Match||r===t.TipPlusLatest?r:t.None}l(e,"sanitize"),t.sanitize=e}(N||(N={}));var P;(function(t){t.Browse="browse",t.Edit="edit"})(P||(P={})),function(t){function e(n){return n===t.Browse||n===t.Edit?n:t.Edit}l(e,"sanitize"),t.sanitize=e;function r(n){return n===t.Browse?t.Edit:t.Browse}l(r,"toggle"),t.toggle=r}(P||(P={}));var Q;(function(t){function e(r,n){return r.display===n.display&&r.index===n.index}l(e,"equals"),t.equals=e})(Q||(Q={}));var q;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(q||(q={}));var U;(function(t){const e=new Map([[q.Branch,N.None],[q.RemoteBranch,N.None],[q.PullRequestBranch,N.Match],[q.PullRequestRemoteBranch,N.Match],[q.Commit,N.Match],[q.Tag,N.Match]]),r=new Map([[q.Branch,P.Edit],[q.RemoteBranch,P.Edit],[q.PullRequestBranch,P.Browse],[q.PullRequestRemoteBranch,P.Browse],[q.Commit,P.Browse],[q.Tag,P.Browse]]);function n(o){var a,s;return{display:(a=r.get(o))!=null?a:P.Edit,index:(s=e.get(o))!=null?s:N.None}}l(n,"getDefault"),t.getDefault=n;function i(o){switch(o){case q.Branch:case q.RemoteBranch:return{display:P.Browse,index:N.Latest};case q.PullRequestBranch:case q.PullRequestRemoteBranch:return{display:P.Browse,index:N.Match};case q.Commit:case q.Tag:return{display:P.Browse,index:N.Match};default:return{display:P.Edit,index:N.None}}}l(i,"getIndexDefault"),t.getIndexDefault=i})(U||(U={}));const b=null;var R=__webpack_require__(2307),A=__webpack_require__.n(R);const S="remoteHub",D="modes",V="indexMemento";class ${constructor(){this._onDidChange=new h.EventEmitter,this._onDidChangeAny=new h.EventEmitter,this.memoryState=new Map}static configure(e){j.state=e.workspaceState,e.subscriptions.push(h.workspace.onDidChangeConfiguration(j.onConfigurationChanged,j))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(S)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(D),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const r of this.memoryState.entries())this.modes[r[0]]=r[1];this._state.update(D,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(V),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,r,n){return n===void 0?h.workspace.getConfiguration(e===void 0?void 0:S,r).get(e===void 0?S:e):h.workspace.getConfiguration(e===void 0?void 0:S,r).get(e===void 0?S:e,n)}getMode(e,r,n){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:P.sanitize(a.display),index:N.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(r===q.Branch||r===q.RemoteBranch)switch((i=h.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:P.Edit,index:N.None};case"latest":return{display:P.Browse,index:N.Latest};case"tipPlusLatest":return{display:P.Edit,index:N.TipPlusLatest}}if(!n)return U.getDefault(r)}setMode(e,r){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,r),Promise.resolve()):(this.modes[n]=r,this._state.update(D,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,r){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=r,this._state.update(V,this.indexMemento))}getAny(e,r,n){return n===void 0?h.workspace.getConfiguration(void 0,r).get(e):h.workspace.getConfiguration(void 0,r).get(e,n)}changed(e,r,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${S}.${r}`,n))!=null?i:!0}inspect(e,r){return h.workspace.getConfiguration(e===void 0?void 0:S,r).inspect(e===void 0?S:e)}inspectAny(e,r){return h.workspace.getConfiguration(void 0,r).inspect(e)}async migrate(e,r,n){const i=j.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,h.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,r,n){const i=j.inspect(e);if(i===void 0)return;const o=j.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,r,n){return h.workspace.getConfiguration(S).update(e,r,n)}updateAny(e,r,n,i){return h.workspace.getConfiguration(void 0,n===h.ConfigurationTarget.Global?void 0:i).update(e,r,n)}updateEffective(e,r){const n=j.inspect(e);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):j.update(e,r,h.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):j.update(e,r,h.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):j.update(e,A()(r,n.defaultValue)?void 0:r,h.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=Qy()),e}}l($,"Configuration");const j=new $,ge="";var me;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(me||(me={}));var G;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(G||(G={}));const ee="GitHub Repositories",te="[RemoteHub]",z=l(class{static configure(t,e){this._isDebugging=t.extensionMode===h.ExtensionMode.Development,this.logLevel=e}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,r;this._logLevel=t,this.level=this.toOrderedLevel(t),t===me.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:h.window.createOutputChannel(ee)}static toOrderedLevel(t){switch(t){case me.Off:return 0;case me.Error:return 1;case me.Warn:return 2;case me.Info:return 3;case me.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){z.isDebugging&&console.log(this.timestamp,te,t!=null?t:ge,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:ge}${this.toLoggableParams(!0,e)}`)}static error(t,e,...r){if(!(this.level<1&&!z.isDebugging)){if(e===void 0){const n=t instanceof Error?t.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}z.isDebugging&&console.error(this.timestamp,te,e!=null?e:ge,...r,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:ge}${this.toLoggableParams(!1,r)}
${String(t)}`)}}static log(t,...e){z.isDebugging&&console.log(this.timestamp,te,t!=null?t:ge,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:ge}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){z.isDebugging&&console.warn(this.timestamp,te,t!=null?t:ge,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:ge}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof h.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,r,n;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:ge}else i=(n=(r=t.constructor)==null?void 0:r.name)!=null?n:ge;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,ge)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!z.isDebugging)return ge;const r=e.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:ge}},"_Logger");let E=z;E.level=0,E._logLevel=me.Off;const oe=47;function W(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}l(W,"asKey");function se(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}l(se,"asFileKey");function le(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}l(le,"asFileStorageKey");function ue(t){const e=t.path;let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===oe){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(r,n)}l(ue,"basename");function Ie(t){const e=t.path;if(e.length===1)return"/";let r,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===oe){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}l(Ie,"dirname");function ze(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}l(ze,"getParent");function Ve(t,e){const r=typeof e=="string"?e:e.path;return r.startsWith(t.path)?h.Uri.joinPath(t,r.substr(t.path.length)):h.Uri.joinPath(t,r)}l(Ve,"joinRelativePath");function Ce(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),tt(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):tt(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}l(Ce,"isChild");function tt(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}l(tt,"isDescendent");function ut(t){return t&&typeof t=="object"&&"scheme"in t}l(ut,"isSerializedUri");const Ze=l(class{constructor(t){this.storageService=t,this._onDidChange=new h.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(t){const e=W(t),r=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw E.error(n,`Failed to delete repository metadata for ${e}`),n}!r||setTimeout(()=>this._onDidChange.fire({uri:t}),0)}async get(t){this.assertMatchingScheme(t);const e=W(t),r=this.cache.get(e);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw E.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(t,e,r,n){this.assertMatchingScheme(t);const i=(await this.get(t)).revision!==e?"revision":void 0,o=W(t);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${t.toString()}`);const a={revision:e,cachedMetadata:r};this.cache.set(o,a);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(s){throw this.cache.delete(o),E.error(s,`Failed to save repository metadata for ${o}`),s}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:t,reason:i}),0)}refresh(){this.cache.clear()}validate(t){var e,r,n,i,o,a,s,c;return typeof t.version=="number"&&t.version>=Ze.schemaVersion&&typeof t.timestamp=="number"&&typeof((e=t.provider)==null?void 0:e.id)=="string"&&typeof t.provider.name=="string"&&typeof t.name=="string"&&t.repo&&typeof t.user=="string"&&typeof t.accessLevel=="number"&&typeof((r=t.HEAD)==null?void 0:r.type)=="number"&&typeof((n=t.HEAD)==null?void 0:n.name)=="string"&&typeof((i=t.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=t.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((a=t.HEAD.detached)==null?void 0:a.type)=="number"||typeof((s=t.HEAD.branch)==null?void 0:s.name)=="string")&&typeof((c=t.defaultBranch)==null?void 0:c.name)=="string"&&typeof t.defaultBranch.sha=="string"}assertMatchingScheme(t){if(t.scheme!==Pt.scheme)throw new Error(`Uri scheme '${t.scheme}' must match configured scheme '${Pt.scheme}'; uri=${t.toString()}`)}getStorageKey(t){return`metadata/${t}`}fromStorage(t){if(!t)return;const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&ut(n)?h.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(t){const e={schemaVersion:Ze.storageSchemaVersion,revision:t};return JSON.stringify(e)}},"_MetadataStore");let $e=Ze;$e.schemaVersion=6,$e.storageSchemaVersion=1;var De;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})(De||(De={}));var _e;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(_e||(_e={}));class Qe extends Error{constructor(e,r){super(typeof e=="string"?e:e.message);this.reauthenticate=r;var n;this.original=typeof e!="string"?e:void 0,(n=Error.captureStackTrace)==null||n.call(Error,this,Qe)}}l(Qe,"InvalidCredentialsError");class ne extends Error{constructor(e,r,n){super(e.message);this.original=e,this.name=r,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,ne)}}l(ne,"PullRequestNotFoundError");class vt extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,vt)}}l(vt,"RepositoryForbiddenError");class Ke extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Ke)}}l(Ke,"RepositoryNotFoundError");class ct extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,ct)}}l(ct,"RepositoryEmptyError");class he extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,he)}}l(he,"DetachedHEADError");class de extends Error{constructor(e,r){super(e.message);this.original=e,this.duplicate=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,de)}}l(de,"InvalidBranchNameError");class qe extends Error{constructor(e){super(e.message);this.original=e;var r;(r=Error.captureStackTrace)==null||r.call(Error,this,qe)}}l(qe,"MergeConflictError");class rt extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,rt)}}l(rt,"NothingToCommitError");class pt extends Error{constructor(e=!1){super(e?"Unable to sync the repository":"Unable to fetch the repository");var r;(r=Error.captureStackTrace)==null||r.call(Error,this,pt)}}l(pt,"SyncOrFetchError");class Vt extends Error{constructor(){super("Sync operation will result in conflicts");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,Vt)}}l(Vt,"SyncConflictsError");class Et extends Error{constructor(){super("Failed to create and push commit");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,Et)}}l(Et,"CommitFailedError");class _t extends Error{constructor(e){var r;const n=typeof e=="string"?e:Pt.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(r=Error.captureStackTrace)==null||r.call(Error,this,_t)}}l(_t,"ProviderNotFoundError");const Or=/^[0-9a-f]{40}$/i;function Gt(t){return t!==void 0&&Or.test(t)}l(Gt,"isSha");const sr=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function ot(t){return sr.test(t)}l(ot,"isValidBranchName");function wt(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}l(wt,"shortenRef");var Ue;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(Ue||(Ue={}));class He{constructor(e,r,n,i,o){this.providerService=e,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}l(He,"VirtualRepository");var at;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(at||(at={}));var Ee;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(Ee||(Ee={}));var st;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(st||(st={}));var Ye;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(Ye||(Ye={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}l(e,"hasIndex"),t.hasIndex=e}(Ye||(Ye={}));var $t;(function(t){function e(r){return r!==void 0&&r.type===3}l(e,"isActive"),t.isActive=e})($t||($t={}));var xt;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(xt||(xt={}));var T;(function(t){function e(r){const n=Pt.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(Gt(n.idx))return{type:2,sha:n.idx}}}l(e,"decode"),t.decode=e})(T||(T={}));function*m(t,e){for(const r of t)yield*e(r)}l(m,"flatMap");function*w(t,e){for(const r of t)e(r)&&(yield r)}l(w,"filter");function*M(t,e){for(const r of t){const n=e(r);n!=null&&(yield n)}}l(M,"filterMap");function Z(t,e){for(const r of t)if(e(r))return r}l(Z,"find");function ce(t,e){let r="";const n=t[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=e}return r}l(ce,"join");function*ye(t,e){for(const r of t)yield e(r)}l(ye,"map");function gt(t,e){for(const r of t)if(e(r))return!0;return!1}l(gt,"some");function*Wt(...t){for(const e of t)for(const r of e)yield r}l(Wt,"union");function*Ut(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}l(Ut,"unique");const Kt="";function Rt(...t){if(t.length===1){const e=t[0];return e===void 0?Kt:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}l(Rt,"defaultResolver");function en(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:Rt)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];const u=l(()=>i.apply(this,a),"run");return c===void 0?c=u():c=c.then(u,u),this[s]=c,c}}}l(en,"serialize");function oo(t){const e=performance.now()*.001;let r=Math.floor(e),n=Math.floor(e%1*1e9);return t!==void 0&&(r=r-t[0],n=n-t[1],n<0&&(r--,n+=1e9)),[r,n]}l(oo,"hrtime");let Ga=0;function Ka(){return Ga===Number.MAX_SAFE_INTEGER&&(Ga=0),++Ga}l(Ka,"getNextInstanceId");const tn=l(class{constructor(t,e,...r){this.context=t,this.instance=`[${Ka().toString().padStart(5)}] `;var n,i,o,a,s,c;let u;if(typeof(e==null?void 0:e.log)=="boolean"?u=e.log?{}:void 0:u=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:me.Info,this.time=oo(),u){if(!E.enabled(this.logLevel))return;r.length?Ni(this.logLevel,`${this.instance}${(o=u.prefix)!=null?o:""}${t}${(a=u.message)!=null?a:""}`,...r):Ni(this.logLevel,`${this.instance}${(s=u.prefix)!=null?s:""}${t}${(c=u.message)!=null?c:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:oo(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=oo()}stop(t){this.restart(t)}logCore(t,e,r){var n,i,o,a,s,c,u;if(!E.enabled(this.logLevel))return;let d="";if(this.step){const[_,v]=oo(this.step.time),y=_*1e3+Math.floor(v/1e6);d=`${this.step.label?`${this.step.label} took `:""}${y} ms`}if(!r){Ni(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${d?` ${d}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[f,p]=oo(this.time),g=f*1e3+Math.floor(p/1e6);Ni(g>500?me.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${t}${(s=e==null?void 0:e.message)!=null?s:""}${(c=e==null?void 0:e.took)!=null?c:" took "}${g} ms${d?` (${d})`:""}${(u=e==null?void 0:e.suffix)!=null?u:""}`)}static start(t,e,...r){var n;(n=tn.watches.get(t))==null||n.log(),tn.watches.set(t,new tn(t,e,...r))}static log(t,e){var r;(r=tn.watches.get(t))==null||r.log(e)}static stop(t,e){var r;(r=tn.watches.get(t))==null||r.stop(e),tn.watches.delete(t)}},"_Stopwatch");let Be=tn;Be.watches=new Map;function Ni(t,e,...r){switch(t){case me.Warn:E.warn(e,...r);break;case me.Info:E.log(e,...r);break;default:E.debug(e,...r);break}}l(Ni,"log");const Qa=new TextDecoder,ao=new TextEncoder;async function so(t){const e=typeof t=="string"?ao.encode(t):t;let r;if(globalThis.crypto.subtle)r=await globalThis.crypto.subtle.digest({name:"sha-1"},e);else{const n=new Xa;n.update(e),r=n.digest()}return globalThis.btoa(encodeURIComponent(Qa.decode(r)))}l(so,"sha1");var Ac;(function(t){t[t.BLOCK_SIZE=64]="BLOCK_SIZE"})(Ac||(Ac={}));function Za(t,e,r=32){const n=r-e,i=~((1<<n)-1);return(t<<e|(i&t)>>>n)>>>0}l(Za,"leftRotate");function Tc(t,e=0,r=t.byteLength,n=0){for(let i=0;i<r;i++)t[e+i]=n}l(Tc,"fill");const kc=l(class{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._finished=!1}update(t){const e=this._buff;let r=this._buffLen,n=0;const i=t.byteLength;for(;n<i;){const o=Math.min(64-r,i-n);for(let a=0;a<o;a++)e[r++]=t[n++];r>=64&&(this._step(),r-=64,this._totalLen+=64)}this._buffLen=r}digest(){this._finished||(this._finished=!0,this._totalLen+=this._buffLen,this._wrapUp());const t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this._h0,!1),e.setUint32(4,this._h1,!1),e.setUint32(8,this._h2,!1),e.setUint32(12,this._h3,!1),e.setUint32(16,this._h4,!1),t}_wrapUp(){this._buff[this._buffLen++]=128,Tc(this._buff,this._buffLen),this._buffLen>56&&(this._step(),Tc(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=kc._bigBlock32,e=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,e.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,Za(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let r=this._h0,n=this._h1,i=this._h2,o=this._h3,a=this._h4,s,c,u;for(let d=0;d<80;d++)d<20?(s=n&i|~n&o,c=1518500249):d<40?(s=n^i^o,c=1859775393):d<60?(s=n&i|n&o|i&o,c=2400959708):(s=n^i^o,c=3395469782),u=Za(r,5)+s+a+c+t.getUint32(d*4,!1)&4294967295,a=o,o=i,i=Za(n,30),n=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+i&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},"_SHA1Computer");let Xa=kc;Xa._bigBlock32=new DataView(new ArrayBuffer(320));function Ya(t){const e=globalThis.atob(t),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.charCodeAt(i);return n}l(Ya,"fromBase64");const{fromCharCode:si}=String;function zo(t){let e;if(typeof t=="string")e=t;else{e="";for(let r=0,{length:n}=t;r<n;r++)e+=si(t[r])}return globalThis.btoa(e)}l(zo,"toBase64");const Fu=new TextDecoder,Pu=new TextEncoder,Nu=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Ja(t){const e=Pu.encode(t),r=new Array(e.length);for(let n=0;n<e.length;++n)r[n]=Nu[e[n]];return r.join("")}l(Ja,"encodeUtf8Hex");function on(t){const e=t.match(/(\w{2})/g);if(e===null)return"";const r=new Uint8Array(e.map(n=>parseInt(n,16)));return Fu.decode(r)}l(on,"decodeUtf8Hex");function $u(t,e){if(t===e)return-1;let r=0;for(;t[r]===e[r];)r++;return r}l($u,"indexOfDifference");var Ap=__webpack_require__(5102),Mu=Object.defineProperty,Bu=Object.getOwnPropertyDescriptor,Uu=l((t,e,r,n)=>{for(var i=n>1?void 0:n?Bu(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Mu(e,r,i),i},"__decorateClass"),cr;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(cr||(cr={}));const nr=l(class{constructor(t,e){this.metadataStore=t,this.telemetryService=e,this._providers=new Map,this._onDidChangeProviders=new h.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new h.EventEmitter,this._onDidChangeRepository=new h.EventEmitter,this._onDidSyncRepository=new h.EventEmitter,this._onDidRefresh=new h.EventEmitter,this._onWillRefresh=new h.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=h.Disposable.from(h.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),t.onDidChange(r=>this.onMetadataChanged(r)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(W(t.uri));!e||(E.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const r=W(e.uri);if(e.uri.scheme!==nr.scheme||this._repositories.has(r))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(r,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new He(this,e.uri,i,o,n);this._repositories.set(r,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const r=W(e.uri);if(e.uri.scheme!==nr.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}xi(Vn.HasVirtualFolders,this._repositories.size!==0),xi(Vn.VirtualFolderProviders,ce(Ut(ye(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...ye(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}register(t,e,r,n,i){var o;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const a={id:t,name:e,provider:r,fs:n,index:i};return this._providers.set(t,a),this._onDidChangeProviders.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(o=h.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const s=[];for(const[c,u]of[...this._repositories])(u==null?void 0:u.provider.id)===t&&(this._repositories.delete(c),s.push(u));this._onDidChangeRepositories.fire({added:[],removed:s}),this._onDidChangeProviders.fire({added:[],removed:[a]})}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const r of this._providers.values())t.push(...ye(this.getRepositories(r.id),n=>n.uri)),r.index!==void 0&&e.push(r.index);this._onWillRefresh.fire(t),this.metadataStore.refresh(),e.forEach(r=>r.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const r=h.workspace.getWorkspaceFolder(t);if(!r||r.uri.scheme!==nr.scheme)return;const n=this._repositories.get(W(r.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(t){return w(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}getOpenUris(t,e){const r=new Map,n=h.workspace.textDocuments;if(n.length===0)return r;for(const i of n)i.uri.scheme===t&&e.some(o=>tt(i.uri,o))&&r.set(W(i.uri),i.uri);return r}hasProvider(t,e){const r=typeof t=="string"?t:nr.getProviderId(t),n=this._providers.get(r);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(t){var e;return Boolean((e=this.getProvider(t))==null?void 0:e.provider.isReadonly)}getProvider(t){const e=typeof t=="string"?t:nr.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.provider;if(r)return r;throw new _t(t)}getFileSystemProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.fs;if(r)return r;throw new _t(t)}getRemoteWorkspaceSourceProviders(t){var e,r,n,i;return t?(i=(n=(e=this.getProvider(t))==null?void 0:(r=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...m(this._providers.values(),o=>{var a,s,c;return(c=(s=(a=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:s.call(a))!=null?c:[]})]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new _t(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const r=this.getProvider(e),n=r==null?void 0:r.provider.canOpenRemoteUrl(t);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(t);if(n!==void 0)return{provider:r,urlType:n}}}async createWorkspaceForRemoteUrl(t,e,r=Bt.CurrentWindow){var n;const i=this.canOpenRemoteUrl(t,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(t,r)}createProviderUri(t,e,r){return this.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(nr.baseVirtualWorkspaceUri,e,r))}createRelativeProviderUri(t,e){return this.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const r=this.getProviderRootUri(t);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===nr.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return this.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,r){return this.getRepositoryProvider(t).createVirtualUri(nr.baseVirtualWorkspaceUri,e,r)}async getBestRemoteUri(t,e){const{provider:r,repo:n,ref:i}=this.getVirtualUriMetadata(t);if(e===Ee.Repository)return this.getRemoteUri(r.id,{repo:n});if(e===Ee.Clone)return this.getRemoteUri(r.id,{repo:n,clone:!0});if(e===Ee.PullRequest||e===void 0&&(i==null?void 0:i.type)===Ue.PullRequest){if((i==null?void 0:i.type)===Ue.PullRequest)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===Ee.PullRequest&&o)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:o.id}})}if(e===Ee.Branch||e===void 0&&(i==null?void 0:i.type)===Ue.Branch){if((i==null?void 0:i.type)===Ue.Branch)return this.getRemoteUri(r.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===_e.Branch||o.type===_e.RemoteBranch&&e===Ee.Branch)return this.getRemoteUri(r.id,{repo:n,branch:o.branch.name})}if(e===Ee.Tag||e===void 0&&(i==null?void 0:i.type)===Ue.Tag){if((i==null?void 0:i.type)===Ue.Tag)return this.getRemoteUri(r.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===_e.Tag)return this.getRemoteUri(r.id,{repo:n,tag:o.detached.name})}if(e===Ee.Commit||e===void 0&&((i==null?void 0:i.type)===Ue.Commit||(i==null?void 0:i.type)===Ue.Tree&&Gt(i.id))){if((i==null?void 0:i.type)===Ue.Commit||(i==null?void 0:i.type)===Ue.Tree&&Gt(i.id))return this.getRemoteUri(r.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===Ee.Commit||o.type===_e.Commit)return this.getRemoteUri(r.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(r.id,{repo:n})}getCanonicalUri(t){let{authority:e}=t;const r=e.indexOf(nr.authoritySeparator);return r!==-1&&(e=e.substr(0,r)),t.with({authority:e})}getRemoteUri(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:n.call(r,e)}getProviderUri(t){return t.scheme!==nr.scheme?t:t.with({scheme:nr.getProviderId(t)})}getProviderRootUri(t){return t=this.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=this.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualUri(t){return t.scheme===nr.scheme?t:t.with({scheme:nr.scheme})}getVirtualCanonicalRootUri(t){const e=this.getVirtualUri(this.getProviderRootUri(t));let{authority:r}=e;const n=r.indexOf(nr.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),e.with({authority:r})}getVirtualRootUri(t){return this.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=h.workspace.getWorkspaceFolder(this.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,r,n){var i,o;return(o=(i=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:o.call(i,t,e,r,n)}async getCommitOperations(t,e,r){let n;return(r==null?void 0:r.staged)?(n=await e.getStagedChanges(t),n.length===0&&r.staged==="auto"&&(n=await e.getChanges(t))):n=await e.getChanges(t),n.map(o=>{const a=this.getRelativeFilePath(t,o.uri);switch(o.type){case ht.Created:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(s=>s!=null?s:new Uint8Array)};case ht.Changed:return{type:o.type,path:a,fileType:o.fileType,content:e.readFile(o.uri).then(s=>s!=null?s:new Uint8Array)};case ht.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getProvider(t);return(e==null?void 0:e.index)?e.index.getIndexMetadata(t):void 0}getModeConfig(t,e,r){return j.getMode(this.getVirtualRootUri(t),e,Boolean(r))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;return(e=this.getProvider(t))==null?void 0:e.index}async getMetadataCore(t){const e=W(t);let r=this.pendingMetadataRequests.get(e);if(r)return r;let{revision:n,cachedMetadata:i}=await this.metadataStore.get(t);if(i!==void 0)return i;const o=this.getProvider(t);if(!o)throw new _t(t);const a=T.decode(t);(a==null?void 0:a.type)===xt.SHA&&(n=a.sha),r=o.provider.createMetadata(t,n),this.pendingMetadataRequests.set(e,r);try{const s=await r;return await this.updateMetadataCore(t,s,{silent:!0}),s}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const r=new Be(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e)}finally{r.stop()}}updateMetadataCore(t,e,r){return this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e,r)}async clone(t){const e=await this.getBestRemoteUri(t,Ee.Clone);if(!e)throw new Error("No url found for clone");if(kn)return void h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const r=l(async n=>{try{await n.activate(),await h.commands.executeCommand("git.clone",e.toString(!0))}catch(i){E.error(i,"Unable to clone repository")}},"cloneRepository");if(h.workspace.isTrusted){const n=h.extensions.getExtension("vscode.git");if(n)await r(n);else throw new Error("Git extension not found")}else{const n=h.extensions.onDidChange(async()=>{const o=h.extensions.getExtension("vscode.git");o&&(await r(o),n.dispose())});await h.workspace.requestWorkspaceTrust()||n.dispose()}}createBranch(t,e,r,n){return this.getRepositoryProvider(t).createBranch(t,e,r,n)}createCommit(t,e,r,n){return this.getRepositoryProvider(t).createCommit(t,e,r,n)}createAndPushCommit(t,e,r,n,i){return this.getRepositoryProvider(t).createAndPushCommit(t,e,r,n,i)}createPullRequest(t,e,r,n,i){return this.getRepositoryProvider(t).createPullRequest(t,e,r,n,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.getCommits(t,e)}compareCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.compareCommits(t,e)}getFileContent(t,e,r){return this.getRepositoryProvider(t).getFileContent(t,e,r)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,r,n;return(n=(r=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:r.call(e,t))!=null?n:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var r,n;return(n=(r=this.getIndexProvider(t))==null?void 0:r.getSnapshots(t,e))!=null?n:Promise.resolve([])}async getTarGz(t){var e,r;return(r=(e=this.getRepositoryProvider(t)).getTarGz)==null?void 0:r.call(e,t)}pushCommit(t,e,r,n){return this.getRepositoryProvider(t).pushCommit(t,e,r,n)}switchTo(t,e,r){return this.getRepositoryProvider(t).switchTo(t,e,r)}async sync(t,e,r){const n=this._repositories.get(W(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const i=this.getProvider(t);if(i===void 0)throw new _t(t);let{to:o,reason:a,...s}=r!=null?r:{};return o===void 0&&i.index&&(o=await i.index.resolveIndexRef(t,a==="user")),await i.provider.sync(t,e,{conflictResolution:0,...s,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}provideFileSearchResults(t,e,r){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,r)}provideTextSearchResults(t,e,r,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,r,n)}static decodeAuthority(t,e){const[r,n]=t.authority.split(nr.authoritySeparator);let i;if(n)try{const o=JSON.parse(on(n));i=e?e(o):o}catch{}return{scheme:r,metadata:i}}static encodeAuthority(t,e){const r=e?`${nr.authoritySeparator}${Ja(JSON.stringify(e))}`:"";return`${t}${r}`}static getProviderId(t){const{authority:e}=t,r=e.indexOf(nr.authoritySeparator);return r!==-1?e.substr(0,r):e}static isCanonicalUri(t){return t.authority.indexOf(nr.authoritySeparator)===-1}},"_VirtualProviderService");let Pt=nr;Pt.scheme="vscode-vfs",Pt.authoritySeparator="+",Pt.baseVirtualWorkspaceUri=h.Uri.parse(`${nr.scheme}://`),Uu([en()],Pt.prototype,"getMetadataCore",1);function yn(){}l(yn,"Diff"),yn.prototype={diff:l(function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function a(v){return i?(setTimeout(function(){i(void 0,v)},0),!0):v}l(a,"done"),e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var s=r.length,c=e.length,u=1,d=s+c,f=[{newPos:-1,components:[]}],p=this.extractCommon(f[0],r,e,0);if(f[0].newPos+1>=s&&p+1>=c)return a([{value:this.join(r),count:r.length}]);function g(){for(var v=-1*u;v<=u;v+=2){var y=void 0,x=f[v-1],C=f[v+1],k=(C?C.newPos:0)-v;x&&(f[v-1]=void 0);var I=x&&x.newPos+1<s,B=C&&0<=k&&k<c;if(!I&&!B){f[v]=void 0;continue}if(!I||B&&x.newPos<C.newPos?(y=Ou(C),o.pushComponent(y.components,void 0,!0)):(y=x,y.newPos++,o.pushComponent(y.components,!0,void 0)),k=o.extractCommon(y,r,e,v),y.newPos+1>=s&&k+1>=c)return a(Lu(o,y.components,r,e,o.useLongestToken));f[v]=y}u++}if(l(g,"execEditLength"),i)l(function v(){setTimeout(function(){if(u>d)return i();g()||v()},0)},"exec")();else for(;u<=d;){var _=g();if(_)return _}},"diff"),pushComponent:l(function(e,r,n){var i=e[e.length-1];i&&i.added===r&&i.removed===n?e[e.length-1]={count:i.count+1,added:r,removed:n}:e.push({count:1,added:r,removed:n})},"pushComponent"),extractCommon:l(function(e,r,n,i){for(var o=r.length,a=n.length,s=e.newPos,c=s-i,u=0;s+1<o&&c+1<a&&this.equals(r[s+1],n[c+1]);)s++,c++,u++;return u&&e.components.push({count:u}),e.newPos=s,c},"extractCommon"),equals:l(function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},"equals"),removeEmpty:l(function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},"removeEmpty"),castInput:l(function(e){return e},"castInput"),tokenize:l(function(e){return e.split("")},"tokenize"),join:l(function(e){return e.join("")},"join")};function Lu(t,e,r,n,i){for(var o=0,a=e.length,s=0,c=0;o<a;o++){var u=e[o];if(u.removed){if(u.value=t.join(n.slice(c,c+u.count)),c+=u.count,o&&e[o-1].added){var f=e[o-1];e[o-1]=e[o],e[o]=f}}else{if(!u.added&&i){var d=r.slice(s,s+u.count);d=d.map(function(g,_){var v=n[c+_];return v.length>g.length?v:g}),u.value=t.join(d)}else u.value=t.join(r.slice(s,s+u.count));s+=u.count,u.added||(c+=u.count)}}var p=e[a-1];return a>1&&typeof p.value=="string"&&(p.added||p.removed)&&t.equals("",p.value)&&(e[a-2].value+=p.value,e.pop()),e}l(Lu,"buildValues");function Ou(t){return{newPos:t.newPos,components:t.components.slice(0)}}l(Ou,"clonePath");var qo=new yn;function Tp(t,e,r){return qo.diff(t,e,r)}l(Tp,"diffChars");function Ic(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}l(Ic,"generateOptions");var bn=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Dc=/\S/,jo=new yn;jo.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Dc.test(t)&&!Dc.test(e)},jo.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&bn.test(e[r])&&bn.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};function kp(t,e,r){return r=Ic(r,{ignoreWhitespace:!0}),jo.diff(t,e,r)}l(kp,"diffWords");function Ip(t,e,r){return jo.diff(t,e,r)}l(Ip,"diffWordsWithSpace");var Vo=new yn;Vo.tokenize=function(t){var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Hu(t,e,r){return Vo.diff(t,e,r)}l(Hu,"diffLines");function es(t,e,r){var n=Ic(r,{ignoreWhitespace:!0});return Vo.diff(t,e,n)}l(es,"diffTrimmedLines");var Fc=new yn;Fc.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function Go(t,e,r){return Fc.diff(t,e,r)}l(Go,"diffSentences");var ts=new yn;ts.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function Wu(t,e,r){return ts.diff(t,e,r)}l(Wu,"diffCss");function Ko(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ko=l(function(e){return typeof e},"_typeof"):Ko=l(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),Ko(t)}l(Ko,"_typeof");function _n(t){return zu(t)||qu(t)||Pc(t)||ju()}l(_n,"_toConsumableArray");function zu(t){if(Array.isArray(t))return rs(t)}l(zu,"_arrayWithoutHoles");function qu(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}l(qu,"_iterableToArray");function Pc(t,e){if(!!t){if(typeof t=="string")return rs(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rs(t,e)}}l(Pc,"_unsupportedIterableToArray");function rs(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}l(rs,"_arrayLikeToArray");function ju(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}l(ju,"_nonIterableSpread");var Nc=Object.prototype.toString,xn=new yn;xn.useLongestToken=!0,xn.tokenize=Vo.tokenize,xn.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,a){return typeof a=="undefined"?r:a}:n;return typeof t=="string"?t:JSON.stringify(ns(t,null,null,i),i,"  ")},xn.equals=function(t,e){return yn.prototype.equals.call(xn,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function co(t,e,r){return xn.diff(t,e,r)}l(co,"diffJson");function ns(t,e,r,n,i){e=e||[],r=r||[],n&&(t=n(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return r[o];var a;if(Nc.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),r.push(a),o=0;o<t.length;o+=1)a[o]=ns(t[o],e,r,n,i);return e.pop(),r.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),Ko(t)==="object"&&t!==null){e.push(t),a={},r.push(a);var s=[],c;for(c in t)t.hasOwnProperty(c)&&s.push(c);for(s.sort(),o=0;o<s.length;o+=1)c=s[o],a[c]=ns(t[c],e,r,n,c);e.pop(),r.pop()}else a=t;return a}l(ns,"canonicalize");var Qo=new yn;Qo.tokenize=function(t){return t.slice()},Qo.join=Qo.removeEmpty=function(t){return t};function ci(t,e,r){return Qo.diff(t,e,r)}l(ci,"diffArrays");function lo(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.split(/\r\n|[\n\v\f\r\x85]/),n=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var u={};for(i.push(u);o<r.length;){var d=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var f=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);f&&(u.index=f[1]),o++}for(s(u),s(u),u.hunks=[];o<r.length;){var p=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(p))break;if(/^@@/.test(p))u.hunks.push(c());else{if(p&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(p));o++}}}l(a,"parseIndex");function s(u){var d=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(d){var f=d[1]==="---"?"old":"new",p=d[2].split("	",2),g=p[0].replace(/\\\\/g,"\\");/^".*"$/.test(g)&&(g=g.substr(1,g.length-2)),u[f+"FileName"]=g,u[f+"Header"]=(p[1]||"").trim(),o++}}l(s,"parseFileHeader");function c(){var u=o,d=r[o++],f=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),p={oldStart:+f[1],oldLines:typeof f[2]=="undefined"?1:+f[2],newStart:+f[3],newLines:typeof f[4]=="undefined"?1:+f[4],lines:[],linedelimiters:[]};p.oldLines===0&&(p.oldStart+=1),p.newLines===0&&(p.newStart+=1);for(var g=0,_=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var v=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(v==="+"||v==="-"||v===" "||v==="\\")p.lines.push(r[o]),p.linedelimiters.push(n[o]||`
`),v==="+"?g++:v==="-"?_++:v===" "&&(g++,_++);else break}if(!g&&p.newLines===1&&(p.newLines=0),!_&&p.oldLines===1&&(p.oldLines=0),e.strict){if(g!==p.newLines)throw new Error("Added line count did not match for hunk at line "+(u+1));if(_!==p.oldLines)throw new Error("Removed line count did not match for hunk at line "+(u+1))}return p}for(l(c,"parseHunk");o<r.length;)a();return i}l(lo,"parsePatch");function Vu(t,e,r){var n=!0,i=!1,o=!1,a=1;return l(function s(){if(n&&!o){if(i?a++:n=!1,t+a<=r)return a;o=!0}if(!i)return o||(n=!0),e<=t-a?-a++:(i=!0,s())},"iterator")}l(Vu,"distanceIterator");function $c(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=lo(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=r.compareLine||function(Ae,Ne,Pe,Xe){return Ne===Xe},s=0,c=r.fuzzFactor||0,u=0,d=0,f,p;function g(Ae,Ne){for(var Pe=0;Pe<Ae.lines.length;Pe++){var Xe=Ae.lines[Pe],it=Xe.length>0?Xe[0]:" ",ft=Xe.length>0?Xe.substr(1):Xe;if(it===" "||it==="-"){if(!a(Ne+1,n[Ne],it,ft)&&(s++,s>c))return!1;Ne++}}return!0}l(g,"hunkFits");for(var _=0;_<o.length;_++){for(var v=o[_],y=n.length-v.oldLines,x=0,C=d+v.oldStart-1,k=Vu(C,u,y);x!==void 0;x=k())if(g(v,C+x)){v.offset=d+=x;break}if(x===void 0)return!1;u=v.offset+v.oldStart+v.oldLines}for(var I=0,B=0;B<o.length;B++){var J=o[B],re=J.oldStart+J.offset+I-1;I+=J.newLines-J.oldLines;for(var K=0;K<J.lines.length;K++){var we=J.lines[K],ie=we.length>0?we[0]:" ",pe=we.length>0?we.substr(1):we,Se=J.linedelimiters[K];if(ie===" ")re++;else if(ie==="-")n.splice(re,1),i.splice(re,1);else if(ie==="+")n.splice(re,0,pe),i.splice(re,0,Se),re++;else if(ie==="\\"){var Je=J.lines[K-1]?J.lines[K-1][0]:null;Je==="+"?f=!0:Je==="-"&&(p=!0)}}}if(f)for(;!n[n.length-1];)n.pop(),i.pop();else p&&(n.push(""),i.push(`
`));for(var ae=0;ae<n.length-1;ae++)n[ae]=n[ae]+i[ae];return n.join("")}l($c,"applyPatch");function Dp(t,e){typeof t=="string"&&(t=lo(t));var r=0;function n(){var i=t[r++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var s=$c(a,i,e);e.patched(i,s,function(c){if(c)return e.complete(c);n()})})}l(n,"processIndex"),n()}l(Dp,"applyPatches");function Mc(t,e,r,n,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var s=Hu(r,n,a);s.push({value:"",lines:[]});function c(x){return x.map(function(C){return" "+C})}l(c,"contextLines");for(var u=[],d=0,f=0,p=[],g=1,_=1,v=l(function(C){var k=s[C],I=k.lines||k.value.replace(/\n$/,"").split(`
`);if(k.lines=I,k.added||k.removed){var B;if(!d){var J=s[C-1];d=g,f=_,J&&(p=a.context>0?c(J.lines.slice(-a.context)):[],d-=p.length,f-=p.length)}(B=p).push.apply(B,_n(I.map(function(ae){return(k.added?"+":"-")+ae}))),k.added?_+=I.length:g+=I.length}else{if(d)if(I.length<=a.context*2&&C<s.length-2){var re;(re=p).push.apply(re,_n(c(I)))}else{var K,we=Math.min(I.length,a.context);(K=p).push.apply(K,_n(c(I.slice(0,we))));var ie={oldStart:d,oldLines:g-d+we,newStart:f,newLines:_-f+we,lines:p};if(C>=s.length-2&&I.length<=a.context){var pe=/\n$/.test(r),Se=/\n$/.test(n),Je=I.length==0&&p.length>ie.oldLines;!pe&&Je&&r.length>0&&p.splice(ie.oldLines,0,"\\ No newline at end of file"),(!pe&&!Je||!Se)&&p.push("\\ No newline at end of file")}u.push(ie),d=0,f=0,p=[]}g+=I.length,_+=I.length}},"_loop"),y=0;y<s.length;y++)v(y);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:u}}l(Mc,"structuredPatch");function li(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}l(li,"formatPatch");function Bc(t,e,r,n,i,o,a){return li(Mc(t,e,r,n,i,o,a))}l(Bc,"createTwoFilesPatch");function Gu(t,e,r,n,i,o){return Bc(t,t,e,r,n,i,o)}l(Gu,"createPatch");function Zo(t,e){return t.length!==e.length?!1:is(t,e)}l(Zo,"arrayEqual");function is(t,e){if(e.length>t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}l(is,"arrayStartsWith");function os(t){var e=ir(t.lines),r=e.oldLines,n=e.newLines;r!==void 0?t.oldLines=r:delete t.oldLines,n!==void 0?t.newLines=n:delete t.newLines}l(os,"calcLineCount");function Fp(t,e,r){t=as(t,r),e=as(e,r);var n={};(t.index||e.index)&&(n.index=t.index||e.index),(t.newFileName||e.newFileName)&&(ss(t)?ss(e)?(n.oldFileName=uo(n,t.oldFileName,e.oldFileName),n.newFileName=uo(n,t.newFileName,e.newFileName),n.oldHeader=uo(n,t.oldHeader,e.oldHeader),n.newHeader=uo(n,t.newHeader,e.newHeader)):(n.oldFileName=t.oldFileName,n.newFileName=t.newFileName,n.oldHeader=t.oldHeader,n.newHeader=t.newHeader):(n.oldFileName=e.oldFileName||t.oldFileName,n.newFileName=e.newFileName||t.newFileName,n.oldHeader=e.oldHeader||t.oldHeader,n.newHeader=e.newHeader||t.newHeader)),n.hunks=[];for(var i=0,o=0,a=0,s=0;i<t.hunks.length||o<e.hunks.length;){var c=t.hunks[i]||{oldStart:1/0},u=e.hunks[o]||{oldStart:1/0};if($i(c,u))n.hunks.push(cs(c,a)),i++,s+=c.newLines-c.oldLines;else if($i(u,c))n.hunks.push(cs(u,s)),o++,a+=u.newLines-u.oldLines;else{var d={oldStart:Math.min(c.oldStart,u.oldStart),oldLines:0,newStart:Math.min(c.newStart+a,u.oldStart+s),newLines:0,lines:[]};Ku(d,c.oldStart,c.lines,u.oldStart,u.lines),o++,i++,n.hunks.push(d)}}return n}l(Fp,"merge");function as(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return lo(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return Mc(void 0,void 0,e,t)}return t}l(as,"loadPatch");function ss(t){return t.newFileName&&t.newFileName!==t.oldFileName}l(ss,"fileNameChanged");function uo(t,e,r){return e===r?e:(t.conflict=!0,{mine:e,theirs:r})}l(uo,"selectField");function $i(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}l($i,"hunkBefore");function cs(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}l(cs,"cloneHunk");function Ku(t,e,r,n,i){var o={offset:e,lines:r,index:0},a={offset:n,lines:i,index:0};for(Y(t,o,a),Y(t,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var s=o.lines[o.index],c=a.lines[a.index];if((s[0]==="-"||s[0]==="+")&&(c[0]==="-"||c[0]==="+"))Qu(t,o,a);else if(s[0]==="+"&&c[0]===" "){var u;(u=t.lines).push.apply(u,_n(je(o)))}else if(c[0]==="+"&&s[0]===" "){var d;(d=t.lines).push.apply(d,_n(je(a)))}else s[0]==="-"&&c[0]===" "?Uc(t,o,a):c[0]==="-"&&s[0]===" "?Uc(t,a,o,!0):s===c?(t.lines.push(s),o.index++,a.index++):L(t,je(o),je(a))}xe(t,o),xe(t,a),os(t)}l(Ku,"mergeLines");function Qu(t,e,r){var n=je(e),i=je(r);if(mt(n)&&mt(i)){if(is(n,i)&&Xt(r,n,n.length-i.length)){var o;(o=t.lines).push.apply(o,_n(n));return}else if(is(i,n)&&Xt(e,i,i.length-n.length)){var a;(a=t.lines).push.apply(a,_n(i));return}}else if(Zo(n,i)){var s;(s=t.lines).push.apply(s,_n(n));return}L(t,n,i)}l(Qu,"mutualChange");function Uc(t,e,r,n){var i=je(e),o=zt(r,i);if(o.merged){var a;(a=t.lines).push.apply(a,_n(o.merged))}else L(t,n?o:i,n?i:o)}l(Uc,"removal");function L(t,e,r){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:r})}l(L,"conflict");function Y(t,e,r){for(;e.offset<r.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n),e.offset++}}l(Y,"insertLeading");function xe(t,e){for(;e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r)}}l(xe,"insertTrailing");function je(t){for(var e=[],r=t.lines[t.index][0];t.index<t.lines.length;){var n=t.lines[t.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])e.push(n),t.index++;else break}return e}l(je,"collectChange");function zt(t,e){for(var r=[],n=[],i=0,o=!1,a=!1;i<e.length&&t.index<t.lines.length;){var s=t.lines[t.index],c=e[i];if(c[0]==="+")break;if(o=o||s[0]!==" ",n.push(c),i++,s[0]==="+")for(a=!0;s[0]==="+";)r.push(s),s=t.lines[++t.index];c.substr(1)===s.substr(1)?(r.push(s),t.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return r;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:r}}l(zt,"collectContext");function mt(t){return t.reduce(function(e,r){return e&&r[0]==="-"},!0)}l(mt,"allRemoves");function Xt(t,e,r){for(var n=0;n<r;n++){var i=e[e.length-r+n].substr(1);if(t.lines[t.index+n]!==" "+i)return!1}return t.index+=r,!0}l(Xt,"skipRemoveSuperset");function ir(t){var e=0,r=0;return t.forEach(function(n){if(typeof n!="string"){var i=ir(n.mine),o=ir(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:r}}l(ir,"calcOldNewLineCount");function xr(t){for(var e=[],r,n,i=0;i<t.length;i++)r=t[i],r.added?n=1:r.removed?n=-1:n=0,e.push([n,r.value]);return e}l(xr,"convertChangesToDMP");function er(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(Hr(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}l(er,"convertChangesToXML");function Hr(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}l(Hr,"escapeHTML");var Kr=/[^a-zA-Z0-9]/,fr=/\s/,Wr=/[\r\n]/,Qr=/\n\r?\n$/,Nn=/^\r?\n\r?\n/,Re;(function(t){t[t.DIFF_DELETE=-1]="DIFF_DELETE",t[t.DIFF_INSERT=1]="DIFF_INSERT",t[t.DIFF_EQUAL=0]="DIFF_EQUAL"})(Re||(Re={}));function ui(t,e){return t<e?t:e}l(ui,"min");function Lc(t,e){return t>e?t:e}l(Lc,"max");var pr=X,$n=function(){function t(){this.diffs=[],this.start1=0,this.start2=0,this.length1=0,this.length2=0}return l(t,"PatchObject"),t.prototype.toString=function(){var e,r;this.length1===0?e=this.start1+",0":this.length1===1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?r=this.start2+",0":this.length2===1?r=this.start2+1:r=this.start2+1+","+this.length2;for(var n=["@@ -"+e+" +"+r+` @@
`],i,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case Re.DIFF_INSERT:i="+";break;case Re.DIFF_DELETE:i="-";break;case Re.DIFF_EQUAL:i=" ";break}n[o+1]=i+encodeURI(this.diffs[o][1])+`
`}return n.join("").replace(/%20/g," ")},t}(),Xy=function(){function t(){this.diffTimeout=1,this.diffEditCost=4,this.matchThreshold=.5,this.matchDistance=1e3,this.patchDeleteThreshold=.5,this.patchMargin=4,this.matchMaxBits=32}return l(t,"DiffMatchPatch"),t.prototype.diff_main=function(e,r,n,i){typeof i=="undefined"&&(this.diffTimeout<=0?i=Number.MAX_VALUE:i=Date.now()+this.diffTimeout*1e3);var o=i;if(e==null||r==null)throw new Error("Null input. (diff_main)");if(e===r)return e?[[Re.DIFF_EQUAL,e]]:[];typeof n=="undefined"&&(n=!0);var a=n,s=this.diff_commonPrefix(e,r),c=e.substring(0,s);e=e.substring(s),r=r.substring(s),s=this.diff_commonSuffix(e,r);var u=e.substring(e.length-s);e=e.substring(0,e.length-s),r=r.substring(0,r.length-s);var d=this.diff_compute_(e,r,a,o);return c&&d.unshift([Re.DIFF_EQUAL,c]),u&&d.push([Re.DIFF_EQUAL,u]),this.diff_cleanupMerge(d),d},t.prototype.diff_commonPrefix=function(e,r){if(!e||!r||e.charAt(0)!==r.charAt(0))return 0;for(var n=0,i=pr.min(e.length,r.length),o=i,a=0;n<o;)e.substring(a,o)===r.substring(a,o)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},t.prototype.diff_commonSuffix=function(e,r){if(!e||!r||e.charAt(e.length-1)!==r.charAt(r.length-1))return 0;for(var n=0,i=pr.min(e.length,r.length),o=i,a=0;n<o;)e.substring(e.length-o,e.length-a)===r.substring(r.length-o,r.length-a)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},t.prototype.diff_cleanupSemantic=function(e){for(var r=!1,n=[],i=0,o=null,a=0,s=0,c=0,u=0,d=0;a<e.length;)e[a][0]===Re.DIFF_EQUAL?(n[i++]=a,s=u,c=d,u=0,d=0,o=e[a][1]):(e[a][0]===Re.DIFF_INSERT?u+=e[a][1].length:d+=e[a][1].length,o&&o.length<=pr.max(s,c)&&o.length<=pr.max(u,d)&&(e.splice(n[i-1],0,[Re.DIFF_DELETE,o]),e[n[i-1]+1][0]=Re.DIFF_INSERT,i--,i--,a=i>0?n[i-1]:-1,s=0,c=0,u=0,d=0,o=null,r=!0)),a++;for(r&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]===Re.DIFF_DELETE&&e[a][0]===Re.DIFF_INSERT){var f=e[a-1][1],p=e[a][1],g=this.diff_commonOverlap_(f,p),_=this.diff_commonOverlap_(p,f);g>=_?(g>=f.length/2||g>=p.length/2)&&(e.splice(a,0,[Re.DIFF_EQUAL,p.substring(0,g)]),e[a-1][1]=f.substring(0,f.length-g),e[a+1][1]=p.substring(g),a++):(_>=f.length/2||_>=p.length/2)&&(e.splice(a,0,[Re.DIFF_EQUAL,f.substring(0,_)]),e[a-1][0]=Re.DIFF_INSERT,e[a-1][1]=p.substring(0,p.length-_),e[a+1][0]=Re.DIFF_DELETE,e[a+1][1]=f.substring(_),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){for(var r=1;r<e.length-1;){if(e[r-1][0]===Re.DIFF_EQUAL&&e[r+1][0]===Re.DIFF_EQUAL){var n=e[r-1][1],i=e[r][1],o=e[r+1][1],a=this.diff_commonSuffix(n,i);if(a){var s=i.substring(i.length-a);n=n.substring(0,n.length-a),i=s+i.substring(0,i.length-a),o=s+o}for(var c=n,u=i,d=o,f=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);i.charAt(0)===o.charAt(0);){n+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var p=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);p>=f&&(f=p,c=n,u=i,d=o)}e[r-1][1]!==c&&(c?e[r-1][1]=c:(e.splice(r-1,1),r--),e[r][1]=u,d?e[r+1][1]=d:(e.splice(r+1,1),r--))}r++}},t.prototype.diff_cleanupEfficiency=function(e){for(var r=!1,n=[],i=0,o=null,a=0,s=!1,c=!1,u=!1,d=!1;a<e.length;)e[a][0]===Re.DIFF_EQUAL?(e[a][1].length<this.diffEditCost&&(u||d)?(n[i++]=a,s=u,c=d,o=e[a][1]):(i=0,o=null),u=d=!1):(e[a][0]===Re.DIFF_DELETE?d=!0:u=!0,o&&(s&&c&&u&&d||o.length<this.diffEditCost/2&&Number(s)+Number(c)+Number(u)+Number(d)===3)&&(e.splice(n[i-1],0,[Re.DIFF_DELETE,o]),e[n[i-1]+1][0]=Re.DIFF_INSERT,i--,o=null,s&&c?(u=d=!0,i=0):(i--,a=i>0?n[i-1]:-1,u=d=!1),r=!0)),a++;r&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push([Re.DIFF_EQUAL,""]);for(var r=0,n=0,i=0,o="",a="",s;r<e.length;)switch(e[r][0]){case Re.DIFF_INSERT:i++,a+=e[r][1],r++;break;case Re.DIFF_DELETE:n++,o+=e[r][1],r++;break;case Re.DIFF_EQUAL:n+i>1?(n!==0&&i!==0&&(s=this.diff_commonPrefix(a,o),s!==0&&(r-n-i>0&&e[r-n-i-1][0]===Re.DIFF_EQUAL?e[r-n-i-1][1]+=a.substring(0,s):(e.splice(0,0,[Re.DIFF_EQUAL,a.substring(0,s)]),r++),a=a.substring(s),o=o.substring(s)),s=this.diff_commonSuffix(a,o),s!==0&&(e[r][1]=a.substring(a.length-s)+e[r][1],a=a.substring(0,a.length-s),o=o.substring(0,o.length-s))),r-=n+i,e.splice(r,n+i),o.length&&(e.splice(r,0,[Re.DIFF_DELETE,o]),r++),a.length&&(e.splice(r,0,[Re.DIFF_INSERT,a]),r++),r++):r!==0&&e[r-1][0]===Re.DIFF_EQUAL?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,i=0,n=0,o="",a="";break}e[e.length-1][1]===""&&e.pop();var c=!1;for(r=1;r<e.length-1;)e[r-1][0]===Re.DIFF_EQUAL&&e[r+1][0]===Re.DIFF_EQUAL&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)===e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),c=!0):e[r][1].substring(0,e[r+1][1].length)===e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),c=!0)),r++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,r){var n=0,i=0,o=0,a=0,s;for(s=0;s<e.length&&(e[s][0]!==Re.DIFF_INSERT&&(n+=e[s][1].length),e[s][0]!==Re.DIFF_DELETE&&(i+=e[s][1].length),!(n>r));s++)o=n,a=i;return e.length!==s&&e[s][0]===Re.DIFF_DELETE?a:a+(r-o)},t.prototype.diff_prettyHtml=function(e){for(var r=[],n=/&/g,i=/</g,o=/>/g,a=/\n/g,s=0;s<e.length;s++){var c=e[s][0],u=e[s][1],d=u.replace(n,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(c){case Re.DIFF_INSERT:r[s]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case Re.DIFF_DELETE:r[s]='<del style="background:#ffe6e6;">'+d+"</del>";break;case Re.DIFF_EQUAL:r[s]="<span>"+d+"</span>";break}}return r.join("")},t.prototype.diff_text1=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==Re.DIFF_INSERT&&(r[n]=e[n][1]);return r.join("")},t.prototype.diff_text2=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==Re.DIFF_DELETE&&(r[n]=e[n][1]);return r.join("")},t.prototype.diff_levenshtein=function(e){for(var r=0,n=0,i=0,o=0;o<e.length;o++){var a=e[o][0],s=e[o][1];switch(a){case Re.DIFF_INSERT:n+=s.length;break;case Re.DIFF_DELETE:i+=s.length;break;case Re.DIFF_EQUAL:r+=pr.max(n,i),n=0,i=0;break}}return r+=pr.max(n,i),r},t.prototype.diff_toDelta=function(e){for(var r=[],n=0;n<e.length;n++)switch(e[n][0]){case Re.DIFF_INSERT:r[n]="+"+encodeURI(e[n][1]);break;case Re.DIFF_DELETE:r[n]="-"+e[n][1].length;break;case Re.DIFF_EQUAL:r[n]="="+e[n][1].length;break}return r.join("	").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,r){for(var n=[],i=0,o=0,a=r.split(/\t/g),s=0;s<a.length;s++){var c=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{n[i++]=[Re.DIFF_INSERT,decodeURI(c)]}catch(f){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var u=parseInt(c,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(o,o+=u);a[s].charAt(0)==="="?n[i++]=[Re.DIFF_EQUAL,d]:n[i++]=[Re.DIFF_DELETE,d];break;default:if(a[s])throw new Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(o!==e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+")");return n},t.prototype.diff_linesToChars=function(e,r){var n=[],i={};n[0]="";var o=this.diff_linesToCharsMunge_(e,n,i,4e4),a=this.diff_linesToCharsMunge_(r,n,i,65535);return{chars1:o,chars2:a,lineArray:n}},t.prototype.diff_charsToLines=function(e,r){for(var n=0;n<e.length;n++){for(var i=e[n][1],o=[],a=0;a<i.length;a++)o[a]=r[i.charCodeAt(a)];e[n][1]=o.join("")}},t.prototype.match_main=function(e,r,n){if(e==null||r==null||n==null)throw new Error("Null input. (match_main)");return n=pr.max(0,pr.min(n,e.length)),e===r?0:e.length?e.substring(n,n+r.length)===r?n:this.match_bitap_(e,r,n):-1},t.prototype.patch_make=function(e,r,n){var i,o;if(typeof e=="string"&&typeof r=="string"&&typeof n=="undefined")i=e,o=this.diff_main(i,r,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&typeof e=="object"&&typeof r=="undefined"&&typeof n=="undefined")o=e,i=this.diff_text1(o);else if(typeof e=="string"&&r&&typeof r=="object"&&typeof n=="undefined")i=e,o=r;else if(typeof e=="string"&&typeof r=="string"&&n&&typeof n=="object")i=e,o=n;else throw new Error("Unknown call format to patch_make");if(o.length===0)return[];for(var a=[],s=new $n,c=0,u=0,d=0,f=i,p=i,g=0;g<o.length;g++){var _=o[g][0],v=o[g][1];switch(!c&&_!==Re.DIFF_EQUAL&&(s.start1=u,s.start2=d),_){case Re.DIFF_INSERT:s.diffs[c++]=o[g],s.length2+=v.length,p=p.substring(0,d)+v+p.substring(d);break;case Re.DIFF_DELETE:s.length1+=v.length,s.diffs[c++]=o[g],p=p.substring(0,d)+p.substring(d+v.length);break;case Re.DIFF_EQUAL:v.length<=2*this.patchMargin&&c&&o.length!==g+1?(s.diffs[c++]=o[g],s.length1+=v.length,s.length2+=v.length):v.length>=2*this.patchMargin&&c&&(this.patch_addContext_(s,f),a.push(s),s=new $n,c=0,f=p,u=d);break}_!==Re.DIFF_INSERT&&(u+=v.length),_!==Re.DIFF_DELETE&&(d+=v.length)}return c&&(this.patch_addContext_(s,f),a.push(s)),a},t.prototype.patch_deepCopy=function(e){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],o=new $n,a=0;a<i.diffs.length;a++)o.diffs[a]=[i.diffs[a][0],i.diffs[a][1]];o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,r[n]=o}return r},t.prototype.patch_apply=function(e,r){if(e.length===0)return[r,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);r=n+r+n,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var s=e[a].start2+i,c=this.diff_text1(e[a].diffs),u=void 0,d=-1;if(c.length>this.matchMaxBits?(u=this.match_main(r,c.substring(0,this.matchMaxBits),s),u!==-1&&(d=this.match_main(r,c.substring(c.length-this.matchMaxBits),s+c.length-this.matchMaxBits),(d===-1||u>=d)&&(u=-1))):u=this.match_main(r,c,s),u===-1)o[a]=!1,i-=e[a].length2-e[a].length1;else{o[a]=!0,i=u-s;var f=void 0;if(d===-1?f=r.substring(u,u+c.length):f=r.substring(u,d+this.matchMaxBits),c===f)r=r.substring(0,u)+this.diff_text2(e[a].diffs)+r.substring(u+c.length);else{var p=this.diff_main(c,f,!1);if(c.length>this.matchMaxBits&&this.diff_levenshtein(p)/c.length>this.patchDeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(p);for(var g=0,_=0,v=0;v<e[a].diffs.length;v++){var y=e[a].diffs[v];y[0]!==Re.DIFF_EQUAL&&(_=this.diff_xIndex(p,g)),y[0]===Re.DIFF_INSERT?r=r.substring(0,u+_)+y[1]+r.substring(u+_):y[0]===Re.DIFF_DELETE&&(r=r.substring(0,u+_)+r.substring(u+this.diff_xIndex(p,g+y[1].length))),y[0]!==Re.DIFF_DELETE&&(g+=y[1].length)}}}}}return r=r.substring(n.length,r.length-n.length),[r,o]},t.prototype.patch_addPadding=function(e){for(var r=this.patchMargin,n="",i=1;i<=r;i++)n+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=r,e[i].start2+=r;var o=e[0],a=o.diffs;if(a.length===0||a[0][0]!==Re.DIFF_EQUAL)a.unshift([Re.DIFF_EQUAL,n]),o.start1-=r,o.start2-=r,o.length1+=r,o.length2+=r;else if(r>a[0][1].length){var s=r-a[0][1].length;a[0][1]=n.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(o=e[e.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==Re.DIFF_EQUAL)a.push([Re.DIFF_EQUAL,n]),o.length1+=r,o.length2+=r;else if(r>a[a.length-1][1].length){var s=r-a[a.length-1][1].length;a[a.length-1][1]+=n.substring(0,s),o.length1+=s,o.length2+=s}return n},t.prototype.patch_splitMax=function(e){for(var r=this.matchMaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=r)){var i=e[n];e.splice(n--,1);for(var o=i.start1,a=i.start2,s="";i.diffs.length!==0;){var c=new $n,u=!0;for(c.start1=o-s.length,c.start2=a-s.length,s!==""&&(c.length1=c.length2=s.length,c.diffs.push([Re.DIFF_EQUAL,s]));i.diffs.length!==0&&c.length1<r-this.patchMargin;){var d=i.diffs[0][0],f=i.diffs[0][1];d===Re.DIFF_INSERT?(c.length2+=f.length,a+=f.length,c.diffs.push(i.diffs.shift()),u=!1):d===Re.DIFF_DELETE&&c.diffs.length===1&&c.diffs[0][0]===Re.DIFF_EQUAL&&f.length>2*r?(c.length1+=f.length,o+=f.length,u=!1,c.diffs.push([d,f]),i.diffs.shift()):(f=f.substring(0,r-c.length1-this.patchMargin),c.length1+=f.length,o+=f.length,d===Re.DIFF_EQUAL?(c.length2+=f.length,a+=f.length):u=!1,c.diffs.push([d,f]),f===i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(f.length))}s=this.diff_text2(c.diffs),s=s.substring(s.length-this.patchMargin);var p=this.diff_text1(i.diffs).substring(0,this.patchMargin);p!==""&&(c.length1+=p.length,c.length2+=p.length,c.diffs.length!==0&&c.diffs[c.diffs.length-1][0]===Re.DIFF_EQUAL?c.diffs[c.diffs.length-1][1]+=p:c.diffs.push([Re.DIFF_EQUAL,p])),u||e.splice(++n,0,c)}}},t.prototype.patch_toText=function(e){for(var r=[],n=0;n<e.length;n++)r[n]=e[n];return r.join("")},t.prototype.patch_fromText=function(e){var r=[];if(!e)return r;for(var n=e.split(`
`),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var a=n[i].match(o);if(!a)throw new Error("Invalid patch string: "+n[i]);var s=new $n;r.push(s),s.start1=parseInt(a[1],10),a[2]===""?(s.start1--,s.length1=1):a[2]==="0"?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),a[4]===""?(s.start2--,s.length2=1):a[4]==="0"?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),i++;for(var c=void 0,u=void 0,d=void 0;i<n.length;){c=n[i].charAt(0),d=n[i].substring(1);try{u=decodeURI(d)}catch(f){throw new Error("Illegal escape in patch_fromText: "+d)}if(c==="-")s.diffs.push([Re.DIFF_DELETE,u]);else if(c==="+")s.diffs.push([Re.DIFF_INSERT,u]);else if(c===" ")s.diffs.push([Re.DIFF_EQUAL,u]);else{if(c==="@")break;if(c!=="")throw new Error('Invalid patch mode "'+c+'" in: '+u)}i++}}return r},t.prototype.diff_compute_=function(e,r,n,i){var o;if(!e)return[[Re.DIFF_INSERT,r]];if(!r)return[[Re.DIFF_DELETE,e]];var a=e.length>r.length?e:r,s=e.length>r.length?r:e,c=a.indexOf(s);if(c!==-1)return o=[[Re.DIFF_INSERT,a.substring(0,c)],[Re.DIFF_EQUAL,s],[Re.DIFF_INSERT,a.substring(c+s.length)]],e.length>r.length&&(o[0][0]=Re.DIFF_DELETE,o[2][0]=Re.DIFF_DELETE),o;if(s.length===1)return[[Re.DIFF_DELETE,e],[Re.DIFF_INSERT,r]];var u=this.diff_halfMatch_(e,r);if(u){var d=u[0],f=u[1],p=u[2],g=u[3],_=u[4],v=this.diff_main(d,p,n,i),y=this.diff_main(f,g,n,i);return v.concat([[Re.DIFF_EQUAL,_]],y)}return n&&e.length>100&&r.length>100?this.diff_lineMode_(e,r,i):this.diff_bisect_(e,r,i)},t.prototype.diff_lineMode_=function(e,r,n){var i=this.diff_linesToChars(e,r);e=i.chars1,r=i.chars2;var o=i.lineArray,a=this.diff_main(e,r,!1,n);this.diff_charsToLines(a,o),this.diff_cleanupSemantic(a),a.push([Re.DIFF_EQUAL,""]);for(var s=0,c=0,u=0,d="",f="";s<a.length;){switch(a[s][0]){case Re.DIFF_INSERT:u++,f+=a[s][1];break;case Re.DIFF_DELETE:c++,d+=a[s][1];break;case Re.DIFF_EQUAL:if(c>=1&&u>=1){a.splice(s-c-u,c+u),s=s-c-u;for(var p=this.diff_main(d,f,!1,n),g=p.length-1;g>=0;g--)a.splice(s,0,p[g]);s=s+p.length}u=0,c=0,d="",f="";break}s++}return a.pop(),a},t.prototype.diff_bisect_=function(e,r,n){for(var i=e.length,o=r.length,a=Math.ceil((i+o)/2),s=a,c=2*a,u=new Array(c),d=new Array(c),f=0;f<c;f++)u[f]=-1,d[f]=-1;u[s+1]=0,d[s+1]=0;for(var p=i-o,g=p%2!=0,_=0,v=0,y=0,x=0,C=0;C<a&&!(Date.now()>n);C++){for(var k=-C+_;k<=C-v;k+=2){var I=s+k,B=void 0;k===-C||k!==C&&u[I-1]<u[I+1]?B=u[I+1]:B=u[I-1]+1;for(var J=B-k;B<i&&J<o&&e.charAt(B)===r.charAt(J);)B++,J++;if(u[I]=B,B>i)v+=2;else if(J>o)_+=2;else if(g){var re=s+p-k;if(re>=0&&re<c&&d[re]!==-1){var K=i-d[re];if(B>=K)return this.diff_bisectSplit_(e,r,B,J,n)}}}for(var we=-C+y;we<=C-x;we+=2){var re=s+we,K=void 0;we===-C||we!==C&&d[re-1]<d[re+1]?K=d[re+1]:K=d[re-1]+1;for(var ie=K-we;K<i&&ie<o&&e.charAt(i-K-1)===r.charAt(o-ie-1);)K++,ie++;if(d[re]=K,K>i)x+=2;else if(ie>o)y+=2;else if(!g){var I=s+p-we;if(I>=0&&I<c&&u[I]!==-1){var B=u[I],J=s+B-I;if(K=i-K,B>=K)return this.diff_bisectSplit_(e,r,B,J,n)}}}}return[[Re.DIFF_DELETE,e],[Re.DIFF_INSERT,r]]},t.prototype.diff_bisectSplit_=function(e,r,n,i,o){var a=e.substring(0,n),s=r.substring(0,i),c=e.substring(n),u=r.substring(i),d=this.diff_main(a,s,!1,o),f=this.diff_main(c,u,!1,o);return d.concat(f)},t.prototype.diff_linesToCharsMunge_=function(e,r,n,i){for(var o="",a=0,s=-1,c=r.length;s<e.length-1;){s=e.indexOf(`
`,a),s===-1&&(s=e.length-1);var u=e.substring(a,s+1);(n.hasOwnProperty?n.hasOwnProperty(u):n[u]!==void 0)?o+=String.fromCharCode(n[u]):(c===i&&(u=e.substring(a),s=e.length),o+=String.fromCharCode(c),n[u]=c,r[c++]=u),a=s+1}return o},t.prototype.diff_commonOverlap_=function(e,r){var n=e.length,i=r.length;if(n===0||i===0)return 0;n>i?e=e.substring(n-i):n<i&&(r=r.substring(0,n));var o=pr.min(n,i);if(e===r)return o;for(var a=0,s=1;;){var c=e.substring(o-s),u=r.indexOf(c);if(u===-1)return a;s+=u,(u===0||e.substring(o-s)===r.substring(0,s))&&(a=s,s++)}},t.prototype.diff_halfMatch_=function(e,r){if(this.diffTimeout<=0)return null;var n=e.length>r.length?e:r,i=e.length>r.length?r:e;if(n.length<4||i.length*2<n.length)return null;var o=this.diff_halfMatchI_(n,i,Math.ceil(n.length/4)),a=this.diff_halfMatchI_(n,i,Math.ceil(n.length/2)),s;if(!o&&!a)return null;a?o?s=o[4].length>a[4].length?o:a:s=a:s=o;var c,u,d,f,p=s[4];return e.length>r.length?(c=s[0],u=s[1],d=s[2],f=s[3]):(d=s[0],f=s[1],c=s[2],u=s[3]),[c,u,d,f,p]},t.prototype.diff_halfMatchI_=function(e,r,n){for(var i=e.substring(n,n+Math.floor(e.length/4)),o="",a,s,c,u,d=r.indexOf(i,0);d!==-1;){var f=this.diff_commonPrefix(e.substring(n),r.substring(d)),p=this.diff_commonSuffix(e.substring(0,n),r.substring(0,d));o.length<p+f&&(o=r.substring(d-p,d)+r.substring(d,d+f),a=e.substring(0,n-p),s=e.substring(n+f),c=r.substring(0,d-p),u=r.substring(d+f)),d=r.indexOf(i,d+1)}return o.length*2>=e.length?[a,s,c,u,o]:null},t.prototype.diff_cleanupSemanticScore_=function(e,r){if(!e||!r)return 6;var n=e.charAt(e.length-1),i=r.charAt(0),o=n.match(Kr),a=i.match(Kr),s=o&&n.match(fr),c=a&&i.match(fr),u=s&&n.match(Wr),d=c&&i.match(Wr),f=u&&e.match(Qr),p=d&&r.match(Nn);return f||p?5:u||d?4:o&&!s&&c?3:s||c?2:o||a?1:0},t.prototype.match_bitap_=function(e,r,n){if(r.length>this.matchMaxBits)throw new Error("Pattern too long for this browser");var i=this.match_alphabet_(r),o=this.matchThreshold,a=e.indexOf(r,n);a!==-1&&(o=pr.min(this.match_bitapScore_(0,a,r,n),o),a=e.lastIndexOf(r,n+r.length),a!==-1&&(o=pr.min(this.match_bitapScore_(0,a,r,n),o)));var s=1<<r.length-1;a=-1;for(var c,u,d=r.length+e.length,f,p=0;p<r.length;p++){for(c=0,u=d;c<u;)this.match_bitapScore_(p,n+u,r,n)<=o?c=u:d=u,u=Math.floor((d-c)/2+c);d=u;var g=pr.max(1,n-u+1),_=pr.min(n+u,e.length)+r.length,v=Array(_+2);v[_+1]=(1<<p)-1;for(var y=_;y>=g;y--){var x=i[e.charAt(y-1)];if(p===0?v[y]=(v[y+1]<<1|1)&x:v[y]=(v[y+1]<<1|1)&x|((f[y+1]|f[y])<<1|1)|f[y+1],v[y]&s){var C=this.match_bitapScore_(p,y-1,r,n);if(C<=o)if(o=C,a=y-1,a>n)g=pr.max(1,2*n-a);else break}}if(this.match_bitapScore_(p+1,n,r,n)>o)break;f=v}return a},t.prototype.match_bitapScore_=function(e,r,n,i){var o=e/n.length,a=Math.abs(i-r);return this.matchDistance?o+a/this.matchDistance:a?1:o},t.prototype.match_alphabet_=function(e){for(var r={},n=0;n<e.length;n++)r[e.charAt(n)]=0;for(var n=0;n<e.length;n++)r[e.charAt(n)]|=1<<e.length-n-1;return r},t.prototype.patch_addContext_=function(e,r){if(r.length!==0){if(e.start2==null)throw Error("patch not initialized");for(var n=r.substring(e.start2,e.start2+e.length1),i=0;r.indexOf(n)!==r.lastIndexOf(n)&&n.length<this.matchMaxBits-this.patchMargin-this.patchMargin;)i+=this.patchMargin,n=r.substring(e.start2-i,e.start2+e.length1+i);i+=this.patchMargin;var o=r.substring(e.start2-i,e.start2);o&&e.diffs.unshift([Re.DIFF_EQUAL,o]);var a=r.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push([Re.DIFF_EQUAL,a]),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},t}();function Zu(t,e){let r={};for(let o=0;o<e.length;o++){const a=e[o];r[a]?r[a].push(o):r[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const a=t[o],s=r[a]||[];let c=0,u=i[0];for(let d=0;d<s.length;d++){const f=s[d];let p;for(p=c;p<i.length&&!(i[p].buffer2index<f&&(p===i.length-1||i[p+1].buffer2index>f));p++);if(p<i.length){const g={buffer1index:o,buffer2index:f,chain:i[p]};if(c===i.length?i.push(u):i[c]=u,c=p+1,u=g,c===i.length)break}}i[c]=u}return i[i.length-1]}l(Zu,"LCS");function Yy(t,e){const r=Zu(t,e);let n=[],i=t.length,o=e.length,a={common:[]};function s(){a.common.length&&(a.common.reverse(),n.push(a),a={common:[]})}l(s,"processCommon");for(let c=r;c!==null;c=c.chain){let u={buffer1:[],buffer2:[]};for(;--i>c.buffer1index;)u.buffer1.push(t[i]);for(;--o>c.buffer2index;)u.buffer2.push(e[o]);(u.buffer1.length||u.buffer2.length)&&(s(),u.buffer1.reverse(),u.buffer2.reverse(),n.push(u)),i>=0&&a.common.push(t[i])}return s(),n.reverse(),n}l(Yy,"diffComm");function Pp(t,e){const r=Zu(t,e);let n=[],i=t.length,o=e.length;for(let a=r;a!==null;a=a.chain){const s=i-a.buffer1index-1,c=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(s||c)&&n.push({buffer1:[i+1,s],buffer1Content:t.slice(i+1,i+1+s),buffer2:[o+1,c],buffer2Content:e.slice(o+1,o+1+c)})}return n.reverse(),n}l(Pp,"diffIndices");function AR(t,e){const r=Zu(t,e);let n=[],i=t.length,o=e.length;function a(s,c,u){let d=[];for(let f=0;f<u;f++)d.push(s[c+f]);return{offset:c,length:u,chunk:d}}l(a,"chunkDescription");for(let s=r;s!==null;s=s.chain){const c=i-s.buffer1index-1,u=o-s.buffer2index-1;i=s.buffer1index,o=s.buffer2index,(c||u)&&n.push({buffer1:a(t,s.buffer1index+1,c),buffer2:a(e,s.buffer2index+1,u)})}return n.reverse(),n}l(AR,"diffPatch");function Jy(t,e,r){let n=[];function i(c,u){n.push({ab:u,oStart:c.buffer1[0],oLength:c.buffer1[1],abStart:c.buffer2[0],abLength:c.buffer2[1]})}l(i,"addHunk"),Pp(e,t).forEach(c=>i(c,"a")),Pp(e,r).forEach(c=>i(c,"b")),n.sort((c,u)=>c.oStart-u.oStart);let o=[],a=0;function s(c){c>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:c-a,bufferContent:e.slice(a,c)}),a=c)}for(l(s,"advanceTo");n.length;){let c=n.shift(),u=c.oStart,d=c.oStart+c.oLength,f=[c];for(s(u);n.length;){const p=n[0],g=p.oStart;if(g>d)break;d=Math.max(d,g+p.oLength),f.push(n.shift())}if(f.length===1){if(c.abLength>0){const p=c.ab==="a"?t:r;o.push({stable:!0,buffer:c.ab,bufferStart:c.abStart,bufferLength:c.abLength,bufferContent:p.slice(c.abStart,c.abStart+c.abLength)})}}else{let p={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;f.length;){c=f.shift();const C=c.oStart,k=C+c.oLength,I=c.abStart,B=I+c.abLength;let J=p[c.ab];J[0]=Math.min(I,J[0]),J[1]=Math.max(B,J[1]),J[2]=Math.min(C,J[2]),J[3]=Math.max(k,J[3])}const g=p.a[0]+(u-p.a[2]),_=p.a[1]+(d-p.a[3]),v=p.b[0]+(u-p.b[2]),y=p.b[1]+(d-p.b[3]);let x={stable:!1,aStart:g,aLength:_-g,aContent:t.slice(g,_),oStart:u,oLength:d-u,oContent:e.slice(u,d),bStart:v,bLength:y-v,bContent:r.slice(v,y)};o.push(x)}a=d}return s(e.length),o}l(Jy,"diff3MergeRegions");function Xu(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof t=="string",a=typeof e=="string",s=typeof r=="string";o&&(t=t.split(n.stringSeparator)),a&&(e=e.split(n.stringSeparator)),s&&(r=r.split(n.stringSeparator));let c=[];const u=Jy(t,e,r);let d=[];function f(){d.length&&c.push({ok:d}),d=[]}l(f,"flushOk");function p(g,_){if(g.length!==_.length)return!1;for(let v=0;v<g.length;v++)if(g[v]!==_[v])return!1;return!0}return l(p,"isFalseConflict"),u.forEach(g=>{g.stable?d.push(...g.bufferContent):n.excludeFalseConflicts&&p(g.aContent,g.bContent)?d.push(...g.aContent):(f(),c.push({conflict:{a:g.aContent,aIndex:g.aStart,o:g.oContent,oIndex:g.oStart,b:g.bContent,bIndex:g.bStart}}))}),f(),c}l(Xu,"diff3Merge");function TR(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=Xu(t,e,r,n);let a=!1,s=[];return o.forEach(c=>{c.ok?s=s.concat(c.ok):c.conflict&&(a=!0,s.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),s=s.concat(c.conflict.a),s.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),s=s.concat(c.conflict.o),s.push("======="),s=s.concat(c.conflict.b),s.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:a,result:s}}l(TR,"mergeDiff3");function eb(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=Xu(t,e,r,n);let a=!1,s=[];for(let c=0;c<o.length;c++){const u=o[c];u.ok?s=s.concat(u.ok):(a=!0,s=s.concat([`
<<<<<<<<<
`],u.conflict.a,[`
=========
`],u.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:s}}l(eb,"node_diff3_merge");function kR(t,e,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=Xu(t,e,r,n);let a=!1,s=[];for(let c=0;c<o.length;c++){const u=o[c];if(u.ok)s=s.concat(u.ok);else{const d=Yy(u.conflict.a,u.conflict.b);for(let f=0;f<d.length;f++){let p=d[f];p.common?s=s.concat(p.common):(a=!0,s=s.concat([`
<<<<<<<<<
`],p.buffer1,[`
=========
`],p.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:s}}l(kR,"mergeDigIn");function IR(t,e){let r=[],n=0;function i(o){for(;n<o;)r.push(t[n]),n++}l(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let s=0;s<a.buffer2.chunk.length;s++)r.push(a.buffer2.chunk[s]);n+=a.buffer1.length}return i(t.length),r}l(IR,"patch");function DR(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}l(DR,"stripPatch");function FR(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}l(FR,"invertPatch");const Yu=new Xy;Yu.diffTimeout=0;function Ju(t,e,r){return j.get("diff.useDiffMatchPatch")===!0?Yu.patch_toText(Yu.patch_make(e,r)):Gu(t,e,r)}l(Ju,"diffs_createPatch");function Np(t,e,r){return $c(t,e,r)}l(Np,"diffs_applyPatch");function tb(t,e){const r=[];for(const n of lo(t,e))r.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),r.push(n);return r}l(tb,"reversePatch");function $p(t,e,r){let n=`
`;const i=t.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const c=i.filter(u=>u===`\r
`).length;n=c>i.length-c?`\r
`:`
`}const o=eb(t,e,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),a=o.result;let s=!1;if(o.conflict){let c;const u=[];let d=0;for(const g of a)g===`
<<<<<<<<<
`?c={start:d,separator:d,end:d}:g===`
=========
`?c.separator=d:g===`
>>>>>>>>>
`&&(c.end=d,u.push(c)),d++;let f=0,p=0;for(const g of u)a.splice(g.start-f,1),f++,p=g.end-g.separator+1,a.splice(g.separator-f,p),f+=p;u.length&&(s=!0)}return{conflicts:s,mergedContent:a.join(n)}}l($p,"diffs_merge");function rb(t){return t!==void 0&&typeof t.then=="function"}l(rb,"isPromise");const nb="";function ib(...t){if(t.length===1){const e=t[0];return e===void 0?nb:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}l(ib,"gate_defaultResolver");function Er(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:ib)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let c=this[s];if(c===void 0){let u;try{if(u=i.apply(this,a),u==null||!rb(u))return u;this[s]=c=u.then(d=>(this[s]=void 0,d)).catch(d=>{throw this[s]=void 0,d})}catch(d){throw this[s]=void 0,d}}return c}}}l(Er,"gate");let ed=0;function ob(){return ed===Number.MAX_SAFE_INTEGER&&(ed=0),String(++ed)}l(ob,"getNextLockId");class Mp{constructor(){this.id=ob()}async synchronize(e){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await e()}finally{r()}}}l(Mp,"Lock");class ls{constructor(e){this.lock=new Mp,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,r){let n;const i=new Be(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:me.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>n=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,r){let n;const i=new Be(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:me.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}l(ls,"ReaderWriterLock");class Bp{constructor(){this.locks=new Map}async synchronizeRead(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new ls(String(e)),this.locks.set(e,i)),i.synchronizeRead(r,n)}async synchronizeWrite(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new ls(String(e)),this.locks.set(e,i)),i.synchronizeWrite(r,n)}}l(Bp,"KeyedReaderWriterLock");var ab=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,cb=l((t,e,r,n)=>{for(var i=n>1?void 0:n?sb(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&ab(e,r,i),i},"changeStore_decorateClass");const an=(0,O.loadMessageBundle)(),lb=h.FileSystemError.FileNotFound().code,Up=`===================================================================
`,Mn=new TextDecoder,ub=new TextEncoder;var ht;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(ht||(ht={}));function db(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}l(db,"isOperation");function us(t,e,r){return{type:t.type,rootUri:e,uri:r!=null?r:t.uri}}l(us,"toEvent");const Xo=l(class{constructor(t,e,r,n,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=r,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new Bp,this.scopedStores=new Map,o===void 0&&(Xo._instance=this,this.disposable=h.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function r(n){const i=await h.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void h.window.showTextDocument(i)}if(l(r,"exportCore"),t===void 0)for(const n of(e=h.workspace.workspaceFolders)!=null?e:[])await r.call(this,n.uri);else return r.call(this,t)}async getWorkspaceProvidersWithChanges(){var t,e;const r=new Map;for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])if(n.uri.scheme===Pt.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async getWorkspacesWithChanges(){var t;const e=new Be("ChangeStore.getWorkspacesWithChanges()");try{const r=[];for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])n.uri.scheme===Pt.scheme&&await this.hasChanges(n.uri)&&r.push(n.uri);return r.length>0?r:void 0}finally{e.stop()}}async acceptAll(t,e){const r=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;E.log(r);const n=[];await this.lock.synchronizeWrite(W(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let a=[];const s=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(c=>c.staged));for(const c of i){if(s&&!c.staged){a.push(c);continue}c.fileType===h.FileType.File&&await this.discardWorkingContent(t,c.uri);let u;if(c.type===2&&c.fileType===h.FileType.Directory&&(i.some(d=>Ce(d.uri,c.uri))||(u={type:3,rootUri:t,uri:c.uri})),n.push(u!=null?u:us(c,t)),c.type===2){let d=c.uri;for(;;){const{parent:f}=this.findParent(d,i,p=>p.type===2);if(f){o.push(f),d=f.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(c=>o.includes(c)?(n.push(us(c,t)),!1):!0)),await this.saveWorkingOperations(t,a)},r),n.length!==0&&this._onDidChange.fire(n)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.discard(${t.toString()})`;E.log(r);const n=[];await this.lock.synchronizeWrite(W(e),async()=>this.discardCore(e,t,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(t,e,r){E.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(t);if(n.length===0)return;const i=se(e),o=n.findIndex(c=>se(c.uri)===i);if(o===-1)return;const[a]=n.splice(o,1);let s;switch(a.type){case 2:s=3;break;case 3:s=2;break;default:s=a.type;break}if(r.push({type:s,rootUri:t,uri:e}),a.type===2){let c=a.uri;for(;;){const{parent:u,parentIndex:d}=this.findNewParentWithOnlyChild(c,n);if(u){n.splice(d,1),r.push({type:3,rootUri:t,uri:u.uri}),c=u.uri;continue}break}}await this.saveWorkingOperations(t,n),a.fileType===h.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).discardAll(t,e);const n=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;E.log(n);const i=[];await this.lock.synchronizeWrite(W(t),async()=>{const o=await this.getWorkingOperations(t),a=[];let s=[];const c=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(u=>u.staged));for(const u of o){if(c&&!u.staged){s.push(u);continue}u.fileType===h.FileType.File&&await this.discardWorkingContent(t,u.uri);let d;switch(u.type){case 2:d=3;break;case 3:d=2;break;default:d=u.type;break}if(i.push({type:d,rootUri:t,uri:u.uri}),u.type===2){let f=u.uri;for(;;){const{parent:p}=this.findNewParentWithOnlyChild(f,o);if(p){a.push(p),f=p.uri;continue}break}}}s.length>0&&a.length>0&&(s=s.filter(u=>a.includes(u)?(i.push({type:3,rootUri:t,uri:u.uri}),!1):!0)),await this.saveWorkingOperations(t,s)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.stage(${t.toString()})`;E.log(r);const n=[];await this.lock.synchronizeWrite(W(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!0,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;E.log(e);const r=[];await this.lock.synchronizeWrite(W(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>us(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.unstage(${t.toString()})`;E.log(r);const n=[];await this.lock.synchronizeWrite(W(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;E.log(e);const r=[];await this.lock.synchronizeWrite(W(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>us(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const r=W(t),n=this.cache.get(r);return n!==void 0?n.length!==0:this.lock.synchronizeRead(r,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).maybeHasChanges(t,e);const n=W(t),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=se(e);return i.some(a=>se(a.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const r=this.providerService.getVirtualRootUri(t);if(r!==void 0)return this.lock.synchronizeRead(W(r),async()=>{const{operation:n}=await this.getWorkingOperation(t,r);return n},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getChanges(t,e):this.lock.synchronizeRead(W(t),async()=>{let n=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(a=>{var s;return(!i||a.conflicts===void 0)&&((s=o==null?void 0:o(a))!=null?s:!0)})}return n},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getGroupedChanges(t,e):this.lock.synchronizeRead(W(t),async()=>{var n,i;const o=await this.getWorkingOperations(t),a={conflicts:[],staged:[],working:[]};for(const s of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,s))!=null?i:!0)||(s.conflicts?a.conflicts.push(s):s.staged?a.staged.push(s):a.working.push(s));return a},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const r=W(e),n=this.cache.get(r);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(r,async()=>{const i=Mn.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(W(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,r,n){var i;let o;db(r)?o=r:n=n!=null?n:r,E.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const a=this.getScopedChangeStore(e.workspaceId),s=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,s,{...n,getIncomingContent:async c=>{const u=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,c),e.workspaceId);return Mn.decode(await h.workspace.fs.readFile(u))},merge:async(c,u,d)=>{try{const f=this.providerService.getProviderUri(c),p=Mn.decode(await h.workspace.fs.readFile(f)),g=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,u),e.workspaceId),_=Mn.decode(await h.workspace.fs.readFile(g));return{...$p(d,p,_),baseUri:f,incomingUri:g}}catch(f){throw new Error(`Unable to apply patch to ${u}: ${String(f)}`)}}})}async applyPatch(t,e,r){if(E.log(`ChangeStore.applyPatch(${t.toString()})`,r==null?void 0:r.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,r)}async applyPatchCore(t,e,r={}){const n=`ChangeStore.applyPatchCore(${t.toString()})`;E.debug(n,r==null?void 0:r.save);const i=new h.WorkspaceEdit,o=[],a=new Map;async function s(p){var g;const _=W(p),v=h.workspace.textDocuments.find(y=>W(y.uri)===_);return(g=v==null?void 0:v.getText())!=null?g:Mn.decode(await h.workspace.fs.readFile(p))}l(s,"getContent");async function c(p){try{const g=await h.workspace.fs.stat(p);return Boolean(g)}catch{return!1}}l(c,"exists");async function u(p,g,_){let v=Np("",_,{fuzzFactor:0});if(v===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${g}`);v=await r.getIncomingContent(g)}i.createFile(p,{overwrite:!0}),i.replace(p,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),v)}l(u,"applyCreate");async function d(p,g,_,v){const y=await s(p);let x=Np(y,_,{fuzzFactor:1});if(x===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${g}; Resulted in conflicts`);const C={title:an("apply patch failed prompt confirm","Merge")},k={title:an("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await h.window.showWarningMessage(an("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,g),{modal:!0,useCustom:!0},C,k)!==C)return;const B=await r.merge(p,g,y);x=B.mergedContent,B.conflicts&&a.set(W(p),{type:v,baseUri:B.baseUri,incomingUri:B.incomingUri})}i.replace(p,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),x)}l(d,"applyModification");const f=(r==null?void 0:r.reverse)?tb(e,{}):lo(e,{});for(const p of f)if(p.oldFileName==="/dev/null"){if(!p.newFileName)continue;const g=p.newFileName.startsWith("b/")?p.newFileName.substr(2):p.newFileName,_=this.providerService.createRelativeVirtualUri(t,g);o.push(W(_)),!await c(_)?await u(_,g,p):await d(_,g,p,2)}else if(p.newFileName==="/dev/null"){if(!p.oldFileName)continue;const g=p.oldFileName.startsWith("a/")?p.oldFileName.substr(2):p.oldFileName,_=this.providerService.createRelativeVirtualUri(t,g);await c(_)&&i.deleteFile(_)}else if(p.oldFileName===p.newFileName){if(!p.newFileName)continue;const g=this.providerService.createRelativeVirtualUri(t,p.newFileName);o.push(W(g)),!await c(g)?await u(g,p.newFileName,p):await d(g,p.newFileName,p,1)}else throw new Error(`Unable to apply patch to ${p.oldFileName}; Renames aren't currently supported`);if(await h.workspace.applyEdit(i),r.save&&o.length)for(const p of o){const g=h.workspace.textDocuments.find(_=>W(_.uri)===p);await(g==null?void 0:g.save())}a.size&&setTimeout(async()=>{const p=[];await this.lock.synchronizeWrite(W(t),async()=>{const g=await this.getWorkingOperations(t);if(g.length===0)return;let _=-1;for(const v of g){_++;const y=a.get(W(v.uri));y!==void 0&&await this.spliceOperation(v.uri,_,{...v,conflicts:{baseUri:y.baseUri,incomingUri:y.incomingUri,status:[v.type,y.type]},timestamp:Date.now()},p)}},n),p.length!==0&&this._onDidChange.fire(p)},0)}async createChangeset(t){E.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,r){if(E.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((r==null?void 0:r.staged)&&(o=o.filter(s=>s.staged)),o.length===0)return"";const a=[];for(const s of o){const c=await this.createPatchCore(t,s);a.push(c)}return a.join("")}const{operation:n}=await this.getWorkingOperation(e,t);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(r==null?void 0:r.staged)&&n.staged?"":await this.createPatchCore(t,n)}async createPatchCore(t,e){const r=this.providerService.getRelativeFilePath(t,e.uri),n=`diff --git a/${r} b/${r}`;if(e.type===2){let c=await this.getContent(e.uri),u;!c.endsWith(`
`)&&!c.endsWith(`\r
`)?u=`
\\ No newline at end of file`:u="";let d=0;return c=c.replace(/\r?\n/g,f=>(d++,`${f}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${d} @@
+${c}${u}`}if(e.type===3){let c=Mn.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),u=0;return c=c.replace(/\r?\n/g,d=>(u++,`${d}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${u} +0,0 @@
-${c}`}const i=await this.getContent(e.uri),o=Mn.decode(await h.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),a=Ju(r,o,i),s=a.indexOf(Up);return`${n}
${a.substr(s+Up.length)}`}async keep(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=`ChangeStore.keep(${t.toString()})`;E.log(n,e);const i=[];await this.lock.synchronizeWrite(W(r),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(t,r);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,c]=o.conflicts.status;switch(c){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,a,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(r,t,i);break;case 1:await this.spliceOperation(t,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case 1:switch(o.type){case 3:await this.spliceOperation(t,a,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(r,t,i);case 1:await this.spliceOperation(t,a,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const s=e!==void 0?await h.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,a,{...o,type:1,originalHash:s!==void 0?await so(s):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,r){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const i=`ChangeStore.merge(${t.toString()})`;E.log(i,e,r);const o=[];await this.lock.synchronizeWrite(W(n),async()=>{const{operation:a,index:s}=await this.getWorkingOperation(t,n);if(a===void 0)return;switch(e.type){case 1:switch(a.type){case 3:return void this.spliceOperation(t,s,{...a,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(a.type){case 3:case 1:return;case 2:break}break;case 3:switch(a.type){case 3:return this.discardCore(n,t,o);case 1:return void this.spliceOperation(t,s,{...a,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[a.type,e.type]},timestamp:Date.now()},o);case 2:return}}const c=await this.getWorkingContent(n,t),u=await h.workspace.fs.readFile(r.providerUri),d=await h.workspace.fs.readFile(e.providerUri),f=$p(Mn.decode(c),Mn.decode(u),Mn.decode(d));await this.writeFileCore(n,t,o,ub.encode(f.mergedContent),d!=null?d:new Uint8Array(0),f.conflicts?{baseUri:r.providerUri,incomingUri:e.providerUri,status:[a.type,e.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(t,e,r,n){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(e):((i==null?void 0:i.type)===2&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,r,n]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return r===this.workspaceId?t:t.with({fragment:r})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;E.log(`ChangeStore.getScopedChangeStore(${e})`);let r=this.scopedStores.get(e);return r===void 0&&(r=e===this.workspaceId?new Xo.ScopedChangeStore(this,e,this.workspaceId):new Xo.ScopedChangeStore(new Xo(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,r)),r}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const n=W(r),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:a}=await this.getWorkingOperation(t,r);if(a!==void 0){if(a.type===3)throw h.FileSystemError.FileNotFound(`The ${a.fileType===h.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const r=new Be(`ChangeStore.readFile(${t.toString()})`);try{const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const i=W(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){r.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,t)},r.context)}finally{r.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.createDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(W(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:2,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.deleteDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(W(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:3,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return e;const n=new Be(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=W(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=Ve(r,t),s=await this.getWorkingOperations(r);for(const c of s)switch(c.type){case 1:break;case 2:{if(Ce(c.uri,a)){const u=this.providerService.getRelativeFilePath(t,c.uri);e.push([u,c.fileType])}break}case 3:{if(Ce(c.uri,a)){const u=this.providerService.getRelativeFilePath(t,c.uri),d=e.findIndex(([f])=>f===u);d!==-1&&e.splice(d,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new Be(`ChangeStore.writeFile(${t.toString()})`,{},e.length,n);try{const a=[];if(await this.lock.synchronizeWrite(W(i),async()=>this.writeFileCore(i,t,a,e,r,n),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(t,e,r,n,i,o){const a=new Be(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:s,index:c},u,d]=await Promise.all([this.getWorkingOperation(e,t),so(n),so(i)]);if(u===d&&(s==null?void 0:s.type)===1)return this.discardCore(t,e,r);if(u===(s==null?void 0:s.hash)&&d===(s==null?void 0:s.originalHash))return;const[{HEAD:f}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,n)]);await this.spliceOperation(e,c,s===void 0?{type:1,uri:e,fileType:h.FileType.File,revision:f.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1}:{...s,revision:f.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1},r)}finally{a.stop()}}async createFile(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=new Be(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(W(r),async()=>{const[{operation:o,index:a},s,c]=await Promise.all([this.getWorkingOperation(t,r),so(e),this.providerService.getMetadata(t),this.saveWorkingContent(r,t,e)]);await this.spliceOperation(t,a,o===void 0?{type:2,uri:t,fileType:h.FileType.File,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s,originalHash:s}:{...o,type:2,revision:c.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Be(`ChangeStore.deleteFile(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(W(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const[a]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:3,uri:t,fileType:h.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}findParent(t,e,r){const n=ze(t),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&r(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const r=se(t);return this.findParent(t,e,(n,i)=>n.type===2&&!i.some(o=>Ce(o.uri,n.uri)&&se(o.uri)!==r))}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const r=se(t);let n=-1;const i=e.find((o,a)=>se(o.uri)!==r?!1:(n=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(t){const e=W(t);let r=this.cache.get(e);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,r)),r}async saveWorkingOperations(t,e){E.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const r=W(t);this.cache.set(r,e);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(e))}catch(n){throw this.cache.delete(r),E.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(r){throw E.error(r),this.telemetryService.sendException(r),r}}async discardWorkingContent(t,e){E.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(r){if(r instanceof h.FileSystemError&&r.code===lb)return;throw E.error(r),this.telemetryService.sendException(r),r}}async saveWorkingContent(t,e,r){E.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,r.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),r)}catch(n){throw E.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(t,e){return`changestore/${le(e)}`}async spliceOperation(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(us(r,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&ut(n)?typeof n=="string"?h.Uri.parse(n):h.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw E.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:Xo.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let ds=Xo;ds.operationsStorageSchemaVersion=1,ds.ScopedChangeStore=class{constructor(t,e,r){this.changeStore=t,this.scope=e,this.workspaceId=r}createPatch(t,e,r){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),r)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const r=this.changeStore.getUriScope(t)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(t));return n!==void 0&&r&&(n.permissions=h.FilePermission.Readonly),n}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},cb([Er()],ds.prototype,"getWorkingOperations",1);function Lp(t){switch(t){case 1:return an("change type changed","Modified");case 2:return an("change type created","Added");case 3:return an("change type deleted","Deleted")}}l(Lp,"getStatusText");function hb(t){const[e,r]=t;switch(e){case 1:switch(r){case 1:case 2:return an("conflict status changed both","Modified by Both");case 3:return an("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(r){case 1:case 2:return an("conflict status created both","Added by Both");case 3:return an("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(r){case 1:case 2:return an("conflict status deleted us","Deleted by Current");case 3:return an("conflict status deleted both","Deleted by Both")}break}}l(hb,"getConflictStatusText");var Op=Object.defineProperty,fb=l(t=>Op(t,"__esModule",{value:!0}),"vu"),Te=l((t,e)=>()=>(t&&(e=t(t=0)),e),"C"),pb=l((t,e)=>{fb(t);for(var r in e)Op(t,r,{get:e[r],enumerable:!0})},"hu"),Hp,gb=Te(()=>{Hp={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}}),Yo,Bn,di,rn,Oc,hi,Hc,Wc,Wp,zp,hs,td=Te(()=>{Yo="function",Bn="object",di="undefined",rn="prototype",Oc="hasOwnProperty",hi=Object,Hc=hi[rn],Wc=hi.assign,Wp=hi.create,zp=hi.defineProperty,hs=Hc[Oc]});function Jo(){return typeof globalThis!==di&&globalThis?globalThis:typeof self!==di&&self?self:typeof window!==di&&window?window:typeof __webpack_require__.g!==di&&__webpack_require__.g?__webpack_require__.g:null}l(Jo,"ot");function rd(t){throw new TypeError(t)}l(rd,"Ir");function zc(t){var e=Wp;if(e)return e(t);if(t==null)return{};var r=typeof t;r!==Bn&&r!==Yo&&rd("Object prototype may only be an Object:"+t);function n(){}return l(n,"n"),n[rn]=t,new n}l(zc,"Dt");var qp=Te(()=>{td()});function Lt(t,e){typeof e!==Yo&&e!==null&&rd("Class extends value "+String(e)+" is not a constructor or null"),qc(t,e);function r(){this.constructor=t}l(r,"r"),t[rn]=e===null?zc(e):(r[rn]=e[rn],new r)}l(Lt,"H");var mb,vb,jp,ea,qc,wb=Te(()=>{td(),qp(),mb=(Jo()||{}).Symbol,vb=(Jo()||{}).Reflect,jp=l(function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Hc[Oc].call(e,i)&&(t[i]=e[i])}return t},"Su"),ea=Wc||jp,qc=l(function(t,e){return qc=hi.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n[Oc](i)&&(r[i]=n[i])},qc(t,e)},"Ai")}),yb=Te(()=>{}),qt=Te(()=>{td(),qp(),wb(),yb()});function Mi(t,e){return t&&ms[Un].hasOwnProperty.call(t,e)}l(Mi,"jt");function Vp(t){return t&&(t===ms[Un]||t===Array[Un])}l(Vp,"To");function nd(t){return Vp(t)||t===Function[Un]}l(nd,"Ri");function ho(t){if(t){if(ra)return ra(t);var e=t[Kp]||t[Un]||(t[fs]?t[fs][Un]:null);if(e)return e}return null}l(ho,"nr");function jc(t,e){var r=[],n=ms.getOwnPropertyNames;if(n)r=n(t);else for(var i in t)typeof i=="string"&&Mi(t,i)&&r.push(i);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}l(jc,"Bn");function id(t,e,r){return e!==fs&&typeof t[e]===ps&&(r||Mi(t,e))}l(id,"Mi");function Vc(t){throw new TypeError("DynamicProto: "+t)}l(Vc,"Vn");function bb(t){var e={};return jc(t,function(r){!e[r]&&id(t,r,!1)&&(e[r]=t[r])}),e}l(bb,"Tu");function od(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}l(od,"Li");function _b(t,e,r,n){function i(c,u,d){var f=u[d];if(f[Gc]&&n){var p=c[gs]||{};p[ta]!==!1&&(f=(p[u[fo]]||{})[d]||f)}return function(){return f.apply(c,arguments)}}l(i,"i");var o={};jc(r,function(c){o[c]=i(e,r,c)});for(var a=ho(t),s=[];a&&!nd(a)&&!od(s,a);)jc(a,function(c){!o[c]&&id(a,c,!ra)&&(o[c]=i(e,a,c))}),s.push(a),a=ho(a);return o}l(_b,"Eu");function xb(t,e,r,n){var i=null;if(t&&Mi(r,fo)){var o=t[gs]||{};if(i=(o[r[fo]]||{})[e],i||Vc("Missing ["+e+"] "+ps),!i[Kc]&&o[ta]!==!1){for(var a=!Mi(t,e),s=ho(t),c=[];a&&s&&!nd(s)&&!od(c,s);){var u=s[e];if(u){a=u===n;break}c.push(s),s=ho(s)}try{a&&(t[e]=i),i[Kc]=1}catch(d){o[ta]=!1}}}return i}l(xb,"wu");function Sb(t,e,r){var n=e[t];return n===r&&(n=ho(e)[t]),typeof n!==ps&&Vc("["+t+"] is not a "+ps),n}l(Sb,"Pu");function Cb(t,e,r,n,i){function o(c,u){var d=l(function(){var f=xb(this,u,c,d)||Sb(u,c,d);return f.apply(this,arguments)},"l");return d[Gc]=1,d}if(l(o,"a"),!Vp(t)){var a=r[gs]=r[gs]||{},s=a[e]=a[e]||{};a[ta]!==!1&&(a[ta]=!!i),jc(r,function(c){id(r,c,!1)&&r[c]!==n[c]&&(s[c]=r[c],delete r[c],(!Mi(t,c)||t[c]&&!t[c][Gc])&&(t[c]=o(t,c)))})}}l(Cb,"bu");function Eb(t,e){if(ra)for(var r=[],n=ho(e);n&&!nd(n)&&!od(r,n);){if(n===t)return!0;r.push(n),n=ho(n)}return!1}l(Eb,"Du");function ad(t,e){return Mi(t,Un)?t.name||e||ld:((t||{})[fs]||{}).name||e||ld}l(ad,"Ui");function sd(t,e,r,n){Mi(t,Un)||Vc("theClass is an invalid class definition.");var i=t[Un];Eb(i,e)||Vc("["+ad(t)+"] is not in class hierarchy of ["+ad(e)+"]");var o=null;Mi(i,fo)?o=i[fo]:(o=Gp+ad(t,"_")+"$"+dd,dd++,i[fo]=o);var a=sd[cd],s=!!a[Qc];s&&n&&n[Qc]!==void 0&&(s=!!n[Qc]);var c=bb(e),u=_b(i,e,c,s);r(e,u);var d=!!ra&&!!a[ud];d&&n&&(d=!!n[ud]),Cb(i,o,e,c,d!==!1)}l(sd,"_i");var fs,Un,ps,gs,Gc,fo,Gp,Kc,ta,cd,ld,Kp,Qc,ud,ms,ra,dd,Qp,lr,Sr=Te(()=>{fs="constructor",Un="prototype",ps="function",gs="_dynInstFuncs",Gc="_isDynProxy",fo="_dynClass",Gp="_dynCls$",Kc="_dynInstChk",ta=Kc,cd="_dfOpts",ld="_unknown_",Kp="__proto__",Qc="useBaseInst",ud="setInstFuncs",ms=Object,ra=ms.getPrototypeOf,dd=0,Qp={setInstFuncs:!0,useBaseInst:!0},sd[cd]=Qp,lr=sd}),Le,Fe,Zc=Te(()=>{(function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"})(Le||(Le={})),Fe={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103}});function hd(t){return Hc.toString.call(t)}l(hd,"Oi");function Rb(t,e){return typeof t===e}l(Rb,"Hi");function zr(t){return t===void 0||typeof t===di}l(zr,"pe");function Oe(t){return t===null||zr(t)}l(Oe,"x");function Ab(t){return!Oe(t)}l(Ab,"ji");function fd(t,e){return t&&hs.call(t,e)}l(fd,"Er");function po(t){return typeof t===Bn}l(po,"st");function Dt(t){return typeof t===Yo}l(Dt,"j");function vs(t,e,r,n){n===void 0&&(n=!1);var i=!1;if(!Oe(t))try{Oe(t[bd])?Oe(t[yd])||(t[yd](wd+e,r),i=!0):(t[bd](e,r,n),i=!0)}catch(o){}return i}l(vs,"zt");function Zp(t,e,r,n){if(n===void 0&&(n=!1),!Oe(t))try{Oe(t[xd])?Oe(t[_d])||t[_d](wd+e,r):t[xd](e,r,n)}catch(i){}}l(Zp,"qn");function Tb(t){var e=t,r=/([^\w\d_$])/g;return r.test(t)&&(e=t.replace(r,"_")),e}l(Tb,"zi");function gr(t,e){if(t)for(var r in t)hs.call(t,r)&&e.call(t,r,t[r])}l(gr,"Q");function kb(t,e){if(t&&e){var r=e.length,n=t.length;if(t===e)return!0;if(n>=r){for(var i=n-1,o=r-1;o>=0;o--){if(t[i]!=e[o])return!1;i--}return!0}}return!1}l(kb,"Bi");function Dr(t,e){return t&&e?t.indexOf(e)!==-1:!1}l(Dr,"Ee");function pd(t){return hd(t)==="[object Date]"}l(pd,"wr");function fi(t){return hd(t)==="[object Array]"}l(fi,"Re");function Xc(t){return hd(t)==="[object Error]"}l(Xc,"Bt");function St(t){return typeof t=="string"}l(St,"_");function gd(t){return typeof t=="number"}l(gd,"ir");function md(t){return typeof t=="boolean"}l(md,"Gr");function Bi(t){if(pd(t)){var e=l(function(r){var n=String(r);return n.length===1&&(n="0"+n),n},"e");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}l(Bi,"Me");function Ct(t,e,r){for(var n=t.length,i=0;i<n&&!(i in t&&e.call(r||t,t[i],i,t)===-1);i++);}l(Ct,"R");function ws(t,e,r){for(var n=t.length,i=r||0,o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in t&&t[o]===e)return o;return-1}l(ws,"Nt");function ys(t,e,r){for(var n=t.length,i=r||t,o=new Array(n),a=0;a<n;a++)a in t&&(o[a]=e.call(i,t[a],t));return o}l(ys,"Vt");function Xp(t,e,r){var n=t.length,i=0,o;if(arguments.length>=3)o=arguments[2];else{for(;i<n&&!(i in t);)i++;o=t[i++]}for(;i<n;)i in t&&(o=e(o,t[i],i,t)),i++;return o}l(Xp,"Kr");function Rr(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"")}l(Rr,"oe");function go(t){var e=typeof t;e!==Yo&&(e!==Bn||t===null)&&rd("objKeys called on non-object");var r=[];for(var n in t)t&&hs.call(t,n)&&r.push(n);if(tg)for(var i=Yc.length,o=0;o<i;o++)t&&hs.call(t,Yc[o])&&r.push(Yc[o]);return r}l(go,"Qe");function na(t,e,r,n){if(Sd)try{var i={enumerable:!0,configurable:!0};return r&&(i.get=r),n&&(i.set=n),Sd(t,e,i),!0}catch(o){}return!1}l(na,"St");function sn(){var t=Date;return t.now?t.now():new t().getTime()}l(sn,"de");function Mt(t){return Xc(t)?t.name:""}l(Mt,"G");function Ft(t,e,r,n,i){var o=r;return t&&(o=t[e],o!==r&&(!i||i(o))&&(!n||n(r))&&(o=r,t[e]=o)),o}l(Ft,"K");function Fr(t,e,r){var n;return t?(n=t[e],!n&&Oe(n)&&(n=zr(r)?{}:r,t[e]=n)):n=zr(r)?{}:r,n}l(Fr,"ge");function Yp(t){return!t}l(Yp,"Gn");function vd(t){return!!t}l(vd,"Pr");function Ln(t){throw new Error(t)}l(Ln,"Ae");function Jp(t,e,r){if(t&&e&&t!==e&&po(t)&&po(e)){var n=l(function(o){if(St(o)){var a=e[o];Dt(a)?(!r||r(o,!0,e,t))&&(t[o]=function(s){return function(){var c=arguments;return e[s].apply(e,c)}}(o)):(!r||r(o,!1,e,t))&&(fd(t,o)&&delete t[o],na(t,o,function(){return e[o]},function(s){e[o]=s})||(t[o]=a))}},"n");for(var i in e)n(i)}return t}l(Jp,"Wr");function Ib(t){return function(){function e(){var r=this;t&&gr(t,function(n,i){r[n]=i})}return l(e,"e"),e}()}l(Ib,"qi");function eg(t){return t&&(t=hi(Wc?Wc({},t):t)),t}l(eg,"Kn");var wd,yd,bd,_d,xd,Sd,Db,Fb,tg,Yc,Pr=Te(()=>{qt(),wd="on",yd="attachEvent",bd="addEventListener",_d="detachEvent",xd="removeEventListener",Sd=zp,Db=hi.freeze,Fb=hi.seal,tg=!{toString:null}.propertyIsEnumerable("toString"),Yc=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]});function Nr(t){var e=Jo();return e&&e[t]?e[t]:t===Ed&&Jc()?window:null}l(Nr,"we");function Jc(){return Boolean(typeof window===Bn&&window)}l(Jc,"ar");function bs(){return Jc()?window:Nr(Ed)}l(bs,"Ct");function rg(){return Boolean(typeof document===Bn&&document)}l(rg,"Wn");function On(){return rg()?document:Nr(ng)}l(On,"Ne");function Pb(){return Boolean(typeof navigator===Bn&&navigator)}l(Pb,"ko");function Hn(){return Pb()?navigator:Nr(ig)}l(Hn,"Ue");function Nb(){return Boolean(typeof history===Bn&&history)}l(Nb,"Ro");function $b(){return Nb()?history:Nr(og)}l($b,"Xi");function mo(t){if(t&&hg){var e=Nr("__mockLocation");if(e)return e}return typeof location===Bn&&location?location:Nr(ag)}l(mo,"et");function Mb(){return typeof console!==di?console:Nr(sg)}l(Mb,"Yi");function pi(){return Nr(cg)}l(pi,"Ye");function ia(){return Boolean(typeof JSON===Bn&&JSON||Nr(Rd)!==null)}l(ia,"vt");function Sn(){return ia()?JSON||Nr(Rd):null}l(Sn,"Pe");function Bb(){return Nr(lg)}l(Bb,"$i");function Ub(){return Nr(ug)}l(Ub,"Zi");function Lb(){var t=Hn();return t&&t.product?t.product===dg:!1}l(Lb,"Qi");function el(){var t=Hn();if(t&&(t.userAgent!==il||nl===null)){il=t.userAgent;var e=(il||"").toLowerCase();nl=Dr(e,tl)||Dr(e,rl)}return nl}l(el,"qt");function Cd(t){if(t===void 0&&(t=null),!t){var e=Hn()||{};t=e?(e.userAgent||"").toLowerCase():""}var r=(t||"").toLowerCase();if(Dr(r,tl))return parseInt(r.split(tl)[1]);if(Dr(r,rl)){var n=parseInt(r.split(rl)[1]);if(n)return n+4}return null}l(Cd,"or");function yt(t){var e=Object[rn].toString.call(t),r="";return e==="[object Error]"?r="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":ia()&&(r=Sn().stringify(t)),e+r}l(yt,"O");var Ed,ng,ig,og,ag,sg,cg,Rd,lg,ug,dg,tl,rl,nl,il,hg,_s=Te(()=>{qt(),Pr(),Ed="window",ng="document",ig="navigator",og="history",ag="location",sg="console",cg="performance",Rd="JSON",lg="crypto",ug="msCrypto",dg="ReactNative",tl="msie",rl="trident/",nl=null,il=null,hg=!1});function fg(t){return t?'"'+t.replace(/\"/g,"")+'"':""}l(fg,"Mo");function ol(t,e){return(t||{}).logger||new Ad(e)}l(ol,"kt");var pg,gg,mg,oa,Ad,Td=Te(()=>{Zc(),_s(),Sr(),Pr(),pg="AI (Internal): ",gg="AI: ",mg="AITR_",oa=function(){function t(e,r,n,i){n===void 0&&(n=!1);var o=this;o.messageId=e,o.message=(n?gg:pg)+e;var a="";ia()&&(a=Sn().stringify(i));var s=(r?" message:"+fg(r):"")+(i?" props:"+fg(a):"");o.message+=s}return l(t,"t"),t.dataType="MessageData",t}(),Ad=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={};lr(t,this,function(i){Oe(e)&&(e={}),i.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},i.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},i.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},i.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},i.throwInternal=function(s,c,u,d,f){f===void 0&&(f=!1);var p=new oa(c,u,f,d);if(i.enableDebugExceptions())throw p;if(!zr(p.message)){var g=i.consoleLoggingLevel();if(f){var _=+p.messageId;!n[_]&&g>=Le.WARNING&&(i.warnToConsole(p.message),n[_]=!0)}else g>=Le.WARNING&&i.warnToConsole(p.message);i.logInternalMessage(s,p)}},i.warnToConsole=function(s){var c=Mb();if(c){var u="log";c.warn&&(u="warn"),Dt(c[u])&&c[u](s)}},i.resetInternalMessageCount=function(){r=0,n={}},i.logInternalMessage=function(s,c){if(!a()){var u=!0,d=mg+c.messageId;if(n[d]?u=!1:n[d]=!0,u&&(s<=i.telemetryLoggingLevel()&&(i.queue.push(c),r++),r===i.maxInternalMessageLimit())){var f="Internal events throttle limit per PageView reached for this app.",p=new oa(Fe.MessageLimitPerPVExceeded,f,!1);i.queue.push(p),i.warnToConsole(f)}}};function o(s,c){var u=e[s];return Oe(u)?c:u}l(o,"a");function a(){return r>=i.maxInternalMessageLimit()}l(a,"o")})}return l(t,"t"),t}()});function aa(t,e,r,n,i){if(t){var o=t;if(Dt(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(al);try{if(a=o.create(e(),n,i),a){if(s&&a.setCtx&&(a.setCtx(sa.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(sa.ChildrenContextKey);c||(c=[],s.setCtx(sa.ChildrenContextKey,c)),c.push(a)}return o.setCtx(al,a),r(a)}}catch(u){a&&a.setCtx&&a.setCtx("exception",u)}finally{a&&o.fire(a),o.setCtx(al,s)}}}return r()}l(aa,"ct");var vo,sa,kd,al,sl=Te(()=>{Sr(),Pr(),vo="ctx",sa=function(){function t(e,r,n){var i=this,o=!1;if(i.start=sn(),i.name=e,i.isAsync=n,i.isChildEvt=function(){return!1},Dt(r)){var a;o=na(i,"payload",function(){return!a&&Dt(r)&&(a=r(),r=null),a})}i.getCtx=function(s){return s?s===t.ParentContextKey||s===t.ChildrenContextKey?i[s]:(i[vo]||{})[s]:null},i.setCtx=function(s,c){if(s)if(s===t.ParentContextKey)i[s]||(i.isChildEvt=function(){return!0}),i[s]=c;else if(s===t.ChildrenContextKey)i[s]=c;else{var u=i[vo]=i[vo]||{};u[s]=c}},i.complete=function(){var s=0,c=i.getCtx(t.ChildrenContextKey);if(fi(c))for(var u=0;u<c.length;u++){var d=c[u];d&&(s+=d.time)}i.time=sn()-i.start,i.exTime=i.time-s,i.complete=function(){},!o&&Dt(r)&&(i.payload=r())}}return l(t,"t"),t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),kd=function(){function t(e){this.ctx={},lr(t,this,function(r){r.create=function(n,i,o){return new sa(n,i,o)},r.fire=function(n){n&&(n.complete(),e&&e.perfEvent(n))},r.setCtx=function(n,i){if(n){var o=r[vo]=r[vo]||{};o[n]=i}},r.getCtx=function(n){return(r[vo]||{})[n]}})}return l(t,"t"),t}(),al="CoreUtils.doPerf"}),vg,Ob=Te(()=>{sl(),Zc(),Pr(),vg=function(){function t(e,r){var n=this,i=null,o=Dt(e.processTelemetry),a=Dt(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(s){i=s},n.processTelemetry=function(s,c){c||(c=r);var u=e?e.identifier:"TelemetryPluginChain";aa(c?c.core():null,function(){return u+":processTelemetry"},function(){if(e&&o){n._hasRun=!0;try{c.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,c)}catch(f){var d=i&&i._hasRun;(!i||!d)&&c.diagLog().throwInternal(Le.CRITICAL,Fe.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+f),i&&!d&&i.processTelemetry(s,c)}}else i&&(n._hasRun=!0,i.processTelemetry(s,c))},function(){return{item:s}},!s.sync)}}return l(t,"t"),t}()});function Id(t,e){var r=[];if(t&&t.length>0)for(var n=null,i=0;i<t.length;i++){var o=t[i];if(o&&Dt(o.processTelemetry)){var a=new vg(o,e);r.push(a),n&&n.setNext(a),n=a}}return r.length>0?r[0]:null}l(Id,"ta");function Hb(t,e,r){var n=[],i=!r;if(t)for(;t;){var o=t.getPlugin();(i||o===r)&&(i=!0,n.push(o)),t=t.getNext()}return i||n.push(r),Id(n,e)}l(Hb,"qu");function Wb(t,e,r){var n=t,i=!1;return r&&t&&(n=[],Ct(t,function(o){(i||o===r)&&(i=!0,n.push(o))})),r&&!i&&(n||(n=[]),n.push(r)),Id(n,e)}l(Wb,"Gu");var wo,Dd=Te(()=>{Td(),Ob(),Pr(),wo=function(){function t(e,r,n,i){var o=this,a=null;i!==null&&(e&&Dt(e.getPlugin)?a=Hb(e,o,i||e.getPlugin()):i?a=Wb(e,o,i):zr(i)&&(a=Id(e,o))),o.core=function(){return n},o.diagLog=function(){return ol(n,r)},o.getCfg=function(){return r},o.getExtCfg=function(s,c){c===void 0&&(c={});var u;if(r){var d=r.extensionConfig;d&&s&&(u=d[s])}return u||c},o.getConfig=function(s,c,u){u===void 0&&(u=!1);var d,f=o.getExtCfg(s,null);return f&&!Oe(f[c])?d=f[c]:r&&!Oe(r[c])&&(d=r[c]),Oe(d)?u:d},o.hasNext=function(){return a!=null},o.getNext=function(){return a},o.setNext=function(s){a=s},o.processNext=function(s){var c=a;c&&(a=c.getNext(),c.processTelemetry(s,o))},o.createNew=function(s,c){return s===void 0&&(s=null),new t(s||a,r,n,c)}}return l(t,"t"),t}()}),wg,Fd,yg=Te(()=>{wg="iKey",Fd="extensionConfig"}),xs,yo,bg=Te(()=>{Dd(),Pr(),yg(),xs="getPlugin",yo=function(){function t(){var e=this,r=!1,n=null,i=null;e.core=null,e.diagLog=function(o){return e._getTelCtx(o).diagLog()},e.isInitialized=function(){return r},e.setInitialized=function(o){r=o},e.setNextPlugin=function(o){i=o},e.processNext=function(o,a){a?a.processNext(o):i&&Dt(i.processTelemetry)&&i.processTelemetry(o,null)},e._getTelCtx=function(o){o===void 0&&(o=null);var a=o;if(!a){var s=n||new wo(null,{},e.core);i&&i[xs]?a=s.createNew(null,i[xs]):a=s.createNew(null,i)}return a},e._baseTelInit=function(o,a,s,c){o&&Ft(o,Fd,[],null,Oe),!c&&a&&(c=a.getProcessTelContext().getNext());var u=i;i&&i[xs]&&(u=i[xs]()),e.core=a,n=new wo(c,o,a,u),r=!0}}return l(t,"t"),t.prototype.initialize=function(e,r,n,i){this._baseTelInit(e,r,n,i)},t}()});function Pd(t,e){for(var r=[],n=null,i=t.getNext();i;){var o=i.getPlugin();o&&(n&&Dt(n[$d])&&Dt(o[cl])&&n[$d](o),(!Dt(o[Md])||!o[Md]())&&r.push(o),n=o,i=i.getNext())}Ct(r,function(a){a.initialize(t.getCfg(),t.core(),e,t.getNext())})}l(Pd,"Yr");function _g(t){return t.sort(function(e,r){var n=0,i=Dt(r[cl]);return Dt(e[cl])?n=i?e[Nd]-r[Nd]:1:i&&(n=-1),n})}l(_g,"aa");var cl,Nd,$d,Md,xg=Te(()=>{Pr(),cl="processTelemetry",Nd="priority",$d="setNextPlugin",Md="isInitialized"}),ll,Sg,Cg,zb=Te(()=>{qt(),Sr(),bg(),Dd(),xg(),Pr(),ll=500,Sg="Channel has invalid priority",Cg=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier="ChannelControllerPlugin",r.priority=ll;var n;lr(e,r,function(s,c){s.setNextPlugin=function(u){},s.processTelemetry=function(u,d){n&&Ct(n,function(f){if(f.length>0){var p=r._getTelCtx(d).createNew(f);p.processNext(u)}})},s.getChannelControls=function(){return n},s.initialize=function(u,d,f){s.isInitialized()||(c.initialize(u,d,f),a((u||{}).channels,f),Ct(n,function(p){return Pd(new wo(p,u,d),f)}))}});function i(s){Ct(s,function(c){c.priority<ll&&Ln(Sg+c.identifier)})}l(i,"i");function o(s){s&&s.length>0&&(s=s.sort(function(c,u){return c.priority-u.priority}),i(s),n.push(s))}l(o,"a");function a(s,c){if(n=[],s&&Ct(s,function(d){return o(d)}),c){var u=[];Ct(c,function(d){d.priority>ll&&u.push(d)}),o(u)}}return l(a,"o"),r}return l(e,"e"),e._staticInit=function(){var r=e.prototype;na(r,"ChannelControls",r.getChannelControls),na(r,"channelQueue",r.getChannelControls)}(),e}(yo)});function Eg(t,e){var r=Ss[gi]||Es[gi];return r||(r=Ss[gi]=Ss(t,e),Es[gi]=r),r}l(Eg,"pa");function ul(t){return t?t.isEnabled():!0}l(ul,"ti");function qb(t){var e=t.cookieCfg=t.cookieCfg||{};if(Ft(e,"domain",t.cookieDomain,Ab,Oe),Ft(e,"path",t.cookiePath||"/",null,Oe),Oe(e[fl])){var r=void 0;zr(t[Od])||(r=!t[Od]),zr(t[Hd])||(r=!t[Hd]),e[fl]=r}return e}l(qb,"Wu");function Bd(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n[gi]?r=n[gi]:r=Ss(e)}return r||(r=Eg(e,(t||{}).logger)),r}l(Bd,"cr");function Ss(t,e){var r=qb(t||Es),n=r.path||"/",i=r.domain,o=r[fl]!==!1,a={isEnabled:function(){var s=o&&Rg(e),c=Es[gi];return s&&c&&a!==c&&(s=ul(c)),s},setEnabled:function(s){o=s!==!1},set:function(s,c,u,d,f){if(ul(a)){var p={},g=Rr(c||cn),_=g.indexOf(";");if(_!==-1&&(g=Rr(c.substring(0,_)),p=Ag(c.substring(_+1))),Ft(p,"domain",d||i,vd,zr),!Oe(u)){var v=el();if(zr(p[hl])){var y=sn(),x=y+u*1e3;if(x>0){var C=new Date;C.setTime(x),Ft(p,hl,Tg(C,v?Ud:Ld)||Tg(C,v?Ud:Ld)||cn,vd)}}v||Ft(p,"max-age",cn+u,null,zr)}var k=mo();k&&k.protocol==="https:"&&(Ft(p,"secure",null,null,zr),pl===null&&(pl=!Dg((Hn()||{}).userAgent)),pl&&Ft(p,"SameSite","None",null,zr)),Ft(p,"path",f||n,null,zr);var I=r.setCookie||Ig;I(s,kg(g,p))}},get:function(s){var c=cn;return ul(a)&&(c=(r.getCookie||jb)(s)),c},del:function(s,c){ul(a)&&a.purge(s,c)},purge:function(s,c){if(Rg(e)){var u=(f={},f.path=c||"/",f[hl]="Thu, 01 Jan 1970 00:00:01 GMT",f);el()||(u["max-age"]="0");var d=r.delCookie||Ig;d(s,kg(cn,u))}var f}};return a[gi]=a,a}l(Ss,"ur");function Rg(t){if(Cs===null){Cs=!1;try{var e=ca||{};Cs=e[dl]!==void 0}catch(r){t&&t.throwInternal(Le.WARNING,Fe.CannotAccessCookie,"Cannot access document.cookie - "+Mt(r),{exception:yt(r)})}}return Cs}l(Rg,"da");function Ag(t){var e={};if(t&&t.length){var r=Rr(t).split(";");Ct(r,function(n){if(n=Rr(n||cn),n){var i=n.indexOf("=");i===-1?e[n]=null:e[Rr(n.substring(0,i))]=Rr(n.substring(i+1))}})}return e}l(Ag,"Xo");function Tg(t,e){return Dt(t[e])?t[e]():null}l(Tg,"Yo");function kg(t,e){var r=t||cn;return gr(e,function(n,i){r+="; "+n+(Oe(i)?cn:"="+i)}),r}l(kg,"$o");function jb(t){var e=cn;if(ca){var r=ca[dl]||cn;Wd!==r&&(zd=Ag(r),Wd=r),e=Rr(zd[t]||cn)}return e}l(jb,"Ju");function Ig(t,e){ca&&(ca[dl]=t+"="+e)}l(Ig,"Zo");function Dg(t){return St(t)?!!(Dr(t,"CPU iPhone OS 12")||Dr(t,"iPad; CPU OS 12")||Dr(t,"Macintosh; Intel Mac OS X 10_14")&&Dr(t,"Version/")&&Dr(t,"Safari")||Dr(t,"Macintosh; Intel Mac OS X 10_14")&&kb(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Dr(t,"Chrome/5")||Dr(t,"Chrome/6")||Dr(t,"UnrealEngine")&&!Dr(t,"Chrome")||Dr(t,"UCBrowser/12")||Dr(t,"UCBrowser/11")):!1}l(Dg,"ri");var Ud,Ld,dl,hl,fl,Od,Hd,gi,cn,Cs,pl,Wd,ca,zd,Es,qd=Te(()=>{Zc(),_s(),Pr(),Ud="toGMTString",Ld="toUTCString",dl="cookie",hl="expires",fl="enabled",Od="isCookieUseDisabled",Hd="disableCookiesUsage",gi="_ckMgr",cn="",Cs=null,pl=null,Wd=null,ca=On(),zd={},Es={}}),Fg,jd,Vd,Pg=Te(()=>{qt(),Sr(),zb(),Dd(),xg(),sl(),qd(),Pr(),yg(),Fg="Extensions must provide callback to initialize",jd="_notificationManager",Vd=function(){function t(){var e=!1,r,n,i,o,a;lr(t,this,function(s){s._extensions=new Array,n=new Cg,s.logger=zc({throwInternal:function(c,u,d,f,p){p===void 0&&(p=!1)},warnToConsole:function(c){},resetInternalMessageCount:function(){}}),r=[],s.isInitialized=function(){return e},s.initialize=function(c,u,d,f){s.isInitialized()&&Ln("Core should not be initialized more than once"),(!c||Oe(c.instrumentationKey))&&Ln("Please provide instrumentation key"),i=f,s[jd]=f,s.config=c||{},c.extensions=Oe(c.extensions)?[]:c.extensions;var p=Fr(c,Fd);p.NotificationManager=f,d&&(s.logger=d);var g=[];g.push.apply(g,u.concat(c.extensions)),g=_g(g);var _=[],v=[],y={};Ct(g,function(x){(Oe(x)||Oe(x.initialize))&&Ln(Fg);var C=x.priority,k=x.identifier;x&&C&&(Oe(y[C])?y[C]=k:d.warnToConsole("Two extensions have same priority #"+C+" - "+y[C]+", "+k)),!C||C<n.priority?_.push(x):v.push(x)}),g.push(n),_.push(n),g=_g(g),s._extensions=g,Pd(new wo([n],c,s),g),Pd(new wo(_,c,s),g),s._extensions=_,s.getTransmissionControls().length===0&&Ln("No channels available"),e=!0,s.releaseQueue()},s.getTransmissionControls=function(){return n.getChannelControls()},s.track=function(c){Ft(c,wg,s.config.instrumentationKey,null,Yp),Ft(c,"time",Bi(new Date),null,Yp),Ft(c,"ver","4.0",null,Oe),s.isInitialized()?s.getProcessTelContext().processNext(c):r.push(c)},s.getProcessTelContext=function(){var c=s._extensions,u=c;return(!c||c.length===0)&&(u=[n]),new wo(u,s.config,s)},s.getNotifyMgr=function(){return i||(i=zc({addNotificationListener:function(c){},removeNotificationListener:function(c){},eventsSent:function(c){},eventsDiscarded:function(c,u){},eventsSendRequest:function(c,u){}}),s[jd]=i),i},s.getCookieMgr=function(){return a||(a=Ss(s.config,s.logger)),a},s.setCookieMgr=function(c){a=c},s.getPerfMgr=function(){return o||s.config&&s.config.enablePerfMgr&&(o=new kd(s.getNotifyMgr())),o},s.setPerfMgr=function(c){o=c},s.eventCnt=function(){return r.length},s.releaseQueue=function(){r.length>0&&(Ct(r,function(c){s.getProcessTelContext().processNext(c)}),r=[])}})}return l(t,"t"),t}()}),Gd,Ng=Te(()=>{Sr(),Pr(),Gd=function(){function t(e){this.listeners=[];var r=!!(e||{}).perfEvtsSendAll;lr(t,this,function(n){n.addNotificationListener=function(i){n.listeners.push(i)},n.removeNotificationListener=function(i){for(var o=ws(n.listeners,i);o>-1;)n.listeners.splice(o,1),o=ws(n.listeners,i)},n.eventsSent=function(i){Ct(n.listeners,function(o){o&&o.eventsSent&&setTimeout(function(){return o.eventsSent(i)},0)})},n.eventsDiscarded=function(i,o){Ct(n.listeners,function(a){a&&a.eventsDiscarded&&setTimeout(function(){return a.eventsDiscarded(i,o)},0)})},n.eventsSendRequest=function(i,o){Ct(n.listeners,function(a){if(a&&a.eventsSendRequest)if(o)setTimeout(function(){return a.eventsSendRequest(i,o)},0);else try{a.eventsSendRequest(i,o)}catch(s){}})},n.perfEvent=function(i){i&&(r||!i.isChildEvt())&&Ct(n.listeners,function(o){if(o&&o.perfEvent)if(i.isAsync)setTimeout(function(){return o.perfEvent(i)},0);else try{o.perfEvent(i)}catch(a){}})}})}return l(t,"t"),t}()}),Kd,Vb=Te(()=>{qt(),Pg(),gb(),Ng(),sl(),Td(),Sr(),Pr(),Kd=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return lr(e,r,function(n,i){n.initialize=function(s,c,u,d){i.initialize(s,c,u||new Ad(s),d||new Gd(s))},n.track=function(s){aa(n.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),Ln("Invalid telemetry item")),o(s),i.track(s)},function(){return{item:s}},!s.sync)},n.addNotificationListener=function(s){var c=n.getNotifyMgr();c&&c.addNotificationListener(s)},n.removeNotificationListener=function(s){var c=n.getNotifyMgr();c&&c.removeNotificationListener(s)},n.pollInternalLogs=function(s){var c=n.config.diagnosticLogInterval;return(!c||!(c>0))&&(c=1e4),setInterval(function(){var u=n.logger?n.logger.queue:[];Ct(u,function(d){var f={name:s||"InternalMessageId: "+d.messageId,iKey:n.config.instrumentationKey,time:Bi(new Date),baseType:oa.dataType,baseData:{message:d.message}};n.track(f)}),u.length=0},c)};function o(s){if(Oe(s.name))throw a(s),Error("telemetry name required")}l(o,"a");function a(s){var c=n.getNotifyMgr();c&&c.eventsDiscarded([s],Hp.InvalidEvent)}l(a,"o")}),r}return l(e,"e"),e}(Vd)});function $g(t){t<0&&(t>>>=0),la=123456789+t&mi,ua=987654321-t&mi,Zd=!0}l($g,"ns");function Mg(){try{var t=sn()&2147483647;$g((Math.random()*Qd^t)+t)}catch(e){}}l(Mg,"is");function Bg(t){return t>0?Math.floor(bo()/mi*(t+1))>>>0:0}l(Bg,"ii");function bo(t){var e,r=Bb()||Ub();return r&&r.getRandomValues?e=r.getRandomValues(new Uint32Array(1))[0]&mi:el()?(Zd||Mg(),e=Ug()&mi):e=Math.floor(Qd*Math.random()|0),t||(e>>>=0),e}l(bo,"It");function Gb(t){t?$g(t):Mg()}l(Gb,"va");function Ug(t){ua=36969*(ua&65535)+(ua>>16)&mi,la=18e3*(la&65535)+(la>>16)&mi;var e=(ua<<16)+(la&65535)>>>0&mi|0;return t||(e>>>=0),e}l(Ug,"ai");var Qd,mi,Zd,la,ua,Lg=Te(()=>{_s(),Pr(),Qd=4294967296,mi=4294967295,Zd=!1,la=123456789,ua=987654321});function _o(t,e){var r=!1,n=bs();n&&(r=vs(n,t,e),r=vs(n.body,t,e)||r);var i=On();return i&&(r=As.Attach(i,t,e)||r),r}l(_o,"Mt");function Kb(){function t(){return Bg(15)}return l(t,"t"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Hg,function(e){var r=t()|0,n=e==="x"?r:r&3|8;return n.toString(16)})}l(Kb,"as");function Qb(){var t=pi();return t&&t.now?t.now():sn()}l(Qb,"os");function gl(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=bo()>>>0,n=0,i="";i.length<t;)n++,i+=e.charAt(r&63),r>>>=6,n===5&&(r=(bo()<<2&4294967295|r&3)>>>0,n=0);return i}l(gl,"Wt");function Wn(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",r,n=0;n<4;n++)r=bo(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var i=t[8+(bo()&3)|0];return e.substr(0,8)+e.substr(9,4)+"4"+e.substr(13,3)+i+e.substr(16,3)+e.substr(19,12)}l(Wn,"He");function da(t,e){var r=Eg(t,e),n=ml._canUseCookies;return ha===null&&(ha=[],Rs=n,na(ml,"_canUseCookies",function(){return Rs},function(i){Rs=i,Ct(ha,function(o){o.setEnabled(i)})})),ws(ha,r)===-1&&ha.push(r),md(n)&&r.setEnabled(n),md(Rs)&&r.setEnabled(Rs),r}l(da,"Xt");function Og(){da().setEnabled(!1)}l(Og,"oi");function Zb(t){return da(null,t).isEnabled()}l(Zb,"xa");function Xb(t,e){return da(null,t).get(e)}l(Xb,"ya");function Yb(t,e,r,n){da(null,t).set(e,r,null,n)}l(Yb,"Sa");function Jb(t,e){return da(null,t).del(e)}l(Jb,"Ca");var ha,Rs,ml,Hg,As,e_=Te(()=>{qt(),qd(),_s(),Pr(),Lg(),ha=null,ml={_canUseCookies:void 0,isTypeof:Rb,isUndefined:zr,isNullOrUndefined:Oe,hasOwnProperty:fd,isFunction:Dt,isObject:po,isDate:pd,isArray:fi,isError:Xc,isString:St,isNumber:gd,isBoolean:md,toISOString:Bi,arrForEach:Ct,arrIndexOf:ws,arrMap:ys,arrReduce:Xp,strTrim:Rr,objCreate:zc,objKeys:go,objDefineAccessors:na,addEventHandler:_o,dateNow:sn,isIE:el,disableCookies:Og,newGuid:Kb,perfNow:Qb,newId:gl,randomValue:Bg,random32:bo,mwcRandomSeed:Gb,mwcRandom32:Ug,generateW3CId:Wn},Hg=/[xy]/g,As={Attach:vs,AttachEvent:vs,Detach:Zp,DetachEvent:Zp}});function Xd(t,e){if(t)for(var r=0;r<t.length&&!e(t[r],r);r++);}l(Xd,"Ia");function Yd(t,e,r,n,i){i>=0&&i<=2&&Xd(t,function(o,a){var s=o.cbks,c=s[th[i]];if(c){e.ctx=function(){var f=n[a]=n[a]||{};return f};try{c.apply(e.inst,r)}catch(f){var u=e.err;try{var d=s[th[2]];d&&(e.err=f,d.apply(e.inst,r))}catch(p){}finally{e.err=u}}}})}l(Yd,"Ta");function t_(t){return function(){var e=this,r=arguments,n=t.h,i={name:t.n,inst:e,ctx:null,set:c},o=[],a=s([i],r);function s(d,f){return Xd(f,function(p){d.push(p)}),d}l(s,"c");function c(d,f){r=s([],r),r[d]=f,a=s([i],r)}l(c,"s"),Yd(n,i,a,o,0);var u=t.f;try{i.rslt=u.apply(e,r)}catch(d){throw i.err=d,Yd(n,i,a,o,3),d}return Yd(n,i,a,o,1),i.rslt}}l(t_,"Qu");function r_(t){if(t){if(rh)return rh(t);var e=t[zg]||t[rn]||t[qg];if(e)return e}return null}l(r_,"el");function Wg(t,e,r){var n=null;return t&&(fd(t,e)?n=t:r&&(n=Wg(r_(t),e,!1))),n}l(Wg,"fs");function n_(t,e,r){return t?Jd(t[rn],e,r,!1):null}l(n_,"Ea");function Jd(t,e,r,n){if(n===void 0&&(n=!0),t&&e&&r){var i=Wg(t,e,n);if(i){var o=i[e];if(typeof o===Yo){var a=o[eh];if(!a){a={i:0,n:e,f:o,h:[]};var s=t_(a);s[eh]=a,i[e]=s}var c={id:a.i,cbks:r,rm:function(){var u=this.id;Xd(a.h,function(d,f){if(d.id===u)return a.h.splice(f,1),1})}};return a.i++,a.h.push(c),c}}}return null}l(Jd,"sn");var eh,th,zg,qg,rh,i_=Te(()=>{qt(),Pr(),eh="_aiHooks",th=["req","rsp","hkErr","fnErr"],zg="__proto__",qg="constructor",rh=Object.getPrototypeOf}),At=Te(()=>{Vb(),Pg(),bg(),Lg(),e_(),Pr(),_s(),qt(),Ng(),sl(),Td(),Zc(),i_(),qd()}),Qt,jg=Te(()=>{Qt={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"}});function nh(t,e,r){var n=e.length,i=Vg(t,e);if(i.length!==n){for(var o=0,a=i;r[a]!==void 0;)o++,a=i.substring(0,150-3)+Qg(o);i=a}return i}l(nh,"si");function Vg(t,e){var r;return e&&(e=Rr(e.toString()),e.length>150&&(r=e.substring(0,150),t.throwInternal(Le.WARNING,Fe.NameTooLong,"name is too long.  It has been truncated to "+150+" characters.",{name:e},!0))),r||e}l(Vg,"Pa");function qr(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=Rr(e),e.toString().length>r&&(n=e.toString().substring(0,r),t.throwInternal(Le.WARNING,Fe.StringValueTooLong,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}l(qr,"ae");function Ts(t,e){return oh(t,e,2048,Fe.UrlTooLong)}l(Ts,"Tt");function ih(t,e){var r;return e&&e.length>32768&&(r=e.substring(0,32768),t.throwInternal(Le.WARNING,Fe.MessageTruncated,"message is too long, it has been truncated to "+32768+" characters.",{message:e},!0)),r||e}l(ih,"Ar");function Gg(t,e){var r;if(e){var n=""+e;n.length>32768&&(r=n.substring(0,32768),t.throwInternal(Le.WARNING,Fe.ExceptionTruncated,"exception is too long, it has been truncated to "+32768+" characters.",{exception:e},!0))}return r||e}l(Gg,"ci");function Ui(t,e){if(e){var r={};gr(e,function(n,i){if(po(i)&&ia())try{i=Sn().stringify(i)}catch(o){t.throwInternal(Le.WARNING,Fe.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:o},!0)}i=qr(t,i,8192),n=nh(t,n,r),r[n]=i}),e=r}return e}l(Ui,"je");function Li(t,e){if(e){var r={};gr(e,function(n,i){n=nh(t,n,r),r[n]=i}),e=r}return e}l(Li,"ze");function Kg(t,e){return e&&oh(t,e,128,Fe.IdTooLong).toString()}l(Kg,"ui");function oh(t,e,r,n){var i;return e&&(e=Rr(e),e.length>r&&(i=e.substring(0,r),t.throwInternal(Le.WARNING,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),i||e}l(oh,"li");function Qg(t){var e="00"+t;return e.substr(e.length-3)}l(Qg,"ba");var Zg,Cn=Te(()=>{At(),Zg={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:nh,sanitizeKey:Vg,sanitizeString:qr,sanitizeUrl:Ts,sanitizeMessage:ih,sanitizeException:Gg,sanitizeProperties:Ui,sanitizeMeasurements:Li,sanitizeId:Kg,sanitizeInput:oh,padNumber:Qg,trim:Rr}});function fa(t){var e=null;if(Dt(Event))e=new Event(t);else{var r=On();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}l(fa,"Lt");var Xg=Te(()=>{At()});function Ot(t,e){return e===void 0&&(e=!1),t==null?e:t.toString().toLowerCase()==="true"}l(Ot,"ee");function vi(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=""+t%1e3,r=""+Math.floor(t/1e3)%60,n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,o=Math.floor(t/(1e3*60*60*24));return e=e.length===1?"00"+e:e.length===2?"0"+e:e,r=r.length<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i,(o>0?o+".":"")+i+":"+n+":"+r+"."+e}l(vi,"Ge");function ah(){var t=Hn();return"sendBeacon"in t&&t.sendBeacon}l(ah,"Nr");function Yg(t,e){var r=null;return Ct(t,function(n){if(n.identifier===e)return r=n,-1}),r}l(Yg,"cn");function Jg(t,e,r,n,i){return!i&&St(t)&&(t==="Script error."||t==="Script error")}l(Jg,"un");var vl=Te(()=>{At()}),xo,wl,pa,yl,sh,ln,En=Te(()=>{xo="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",wl="sampleRate",pa="ProcessLegacy",yl="http.method",sh="https://dc.services.visualstudio.com",ln="not_specified"}),So,Rn,em=Te(()=>{(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage"})(So||(So={})),function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C",t[t.W3C=2]="W3C"}(Rn||(Rn={}))});function ch(){return uh()?bl(So.LocalStorage):null}l(ch,"Fa");function bl(t){try{if(Oe(Jo()))return null;var e=new Date,r=Nr(t===So.LocalStorage?"localStorage":"sessionStorage");r.setItem(e.toString(),e.toString());var n=r.getItem(e.toString())!==e.toString();if(r.removeItem(e.toString()),!n)return r}catch(i){}return null}l(bl,"fi");function lh(){return ga()?bl(So.SessionStorage):null}l(lh,"ka");function tm(){Oi=!1,Hi=!1}l(tm,"pn");function uh(){return Oi===void 0&&(Oi=!!bl(So.LocalStorage)),Oi}l(uh,"kr");function rm(t,e){var r=ch();if(r!==null)try{return r.getItem(e)}catch(n){Oi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Mt(n),{exception:yt(n)})}return null}l(rm,"dn");function nm(t,e,r){var n=ch();if(n!==null)try{return n.setItem(e,r),!0}catch(i){Oi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Mt(i),{exception:yt(i)})}return!1}l(nm,"mn");function im(t,e){var r=ch();if(r!==null)try{return r.removeItem(e),!0}catch(n){Oi=!1,t.throwInternal(Le.WARNING,Fe.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Mt(n),{exception:yt(n)})}return!1}l(im,"gn");function ga(){return Hi===void 0&&(Hi=!!bl(So.SessionStorage)),Hi}l(ga,"wt");function o_(){var t=[];return ga()&&gr(Nr("sessionStorage"),function(e){t.push(e)}),t}l(o_,"Ra");function _l(t,e){var r=lh();if(r!==null)try{return r.getItem(e)}catch(n){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Mt(n),{exception:yt(n)})}return null}l(_l,"$t");function xl(t,e,r){var n=lh();if(n!==null)try{return n.setItem(e,r),!0}catch(i){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Mt(i),{exception:yt(i)})}return!1}l(xl,"Zt");function om(t,e){var r=lh();if(r!==null)try{return r.removeItem(e),!0}catch(n){Hi=!1,t.throwInternal(Le.WARNING,Fe.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Mt(n),{exception:yt(n)})}return!1}l(om,"vn");var Oi,Hi,am=Te(()=>{At(),em(),Oi=void 0,Hi=void 0});function ks(t){var e=fh,r=um,n=r[e];return hh.createElement?r[e]||(n=r[e]=hh.createElement("a")):n={host:lm(t,!0)},n.href=t,e++,e>=r.length&&(e=0),fh=e,n}l(ks,"dr");function sm(t){var e,r=ks(t);return r&&(e=r.href),e}l(sm,"hn");function a_(t){var e,r=ks(t);return r&&(e=r.pathname),e}l(a_,"La");function cm(t,e){return t?t.toUpperCase()+" "+e:e}l(cm,"xn");function lm(t,e){var r=dh(t,e)||"";if(r){var n=r.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>3&&St(n[2])&&n[2].length>0)return n[2]+(n[3]||"")}return r}l(lm,"pi");function dh(t,e){var r=null;if(t){var n=t.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>2&&St(n[2])&&n[2].length>0&&(r=n[2]||"",e&&n.length>2)){var i=(n[1]||"").toLowerCase(),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),r+=o}}return r}l(dh,"yn");var hh,fh,um,dm=Te(()=>{At(),hh=On()||{},fh=0,um=[null,null,null,null,null]});function Sl(t){return hm.indexOf(t.toLowerCase())!==-1}l(Sl,"Rr");function s_(t,e,r,n){var i,o=n,a=n;if(e&&e.length>0){var s=ks(e);if(i=s.host,!o)if(s.pathname!=null){var c=s.pathname.length===0?"/":s.pathname;c.charAt(0)!=="/"&&(c="/"+c),a=s.pathname,o=qr(t,r?r+" "+c:c)}else o=qr(t,e)}else i=n,o=n;return{target:i,name:o,data:a}}l(s_,"gs");function Is(){var t=pi();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return sn()}l(Is,"mr");function jr(t,e){var r=null;return t!==0&&e!==0&&!Oe(t)&&!Oe(e)&&(r=e-t),r}l(jr,"ve");var hm,ph,fm,Wi,pm,gm=Te(()=>{At(),jg(),Cn(),Xg(),vl(),En(),am(),dm(),hm=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],ph={NotSpecified:ln,createDomEvent:fa,disableStorage:tm,isInternalApplicationInsightsEndpoint:Sl,canUseLocalStorage:uh,getStorage:rm,setStorage:nm,removeStorage:im,canUseSessionStorage:ga,getSessionStorageKeys:o_,getSessionStorage:_l,setSessionStorage:xl,removeSessionStorage:om,disableCookies:Og,canUseCookies:Zb,disallowsSameSiteNone:Dg,setCookie:Yb,stringToBoolOrDefault:Ot,getCookie:Xb,deleteCookie:Jb,trim:Rr,newId:gl,random32:function(){return bo(!0)},generateW3CId:Wn,isArray:fi,isError:Xc,isDate:pd,toISOStringForIE8:Bi,getIEVersion:Cd,msToTimeSpan:vi,isCrossOriginError:Jg,dump:yt,getExceptionName:Mt,addEventHandler:vs,IsBeaconApiSupported:ah,getExtension:Yg},fm={parseUrl:ks,getAbsoluteUrl:sm,getPathName:a_,getCompleteUrl:cm,parseHost:lm,parseFullHost:dh},Wi={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t.correlationHeaderExcludePatterns){for(var n=0;n<t.correlationHeaderExcludePatterns.length;n++)if(t.correlationHeaderExcludePatterns[n].test(e))return!1}var i=ks(e).host.toLowerCase();if(i&&(i.indexOf(":443")!==-1||i.indexOf(":80")!==-1)&&(i=(dh(e,!0)||"").toLowerCase()),(!t||!t.enableCorsCorrelation)&&i&&i!==r)return!1;var o=t&&t.correlationHeaderDomains;if(o){var a;if(Ct(o,function(u){var d=new RegExp(u.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(i)}),!a)return!1}var s=t&&t.correlationHeaderExcludedDomains;if(!s||s.length===0)return!0;for(var n=0;n<s.length;n++){var c=new RegExp(s[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(c.test(i))return!1}return i&&i.length>0},getCorrelationContext:function(t){if(t){var e=Wi.getCorrelationContextValue(t,Qt.requestContextTargetKey);if(e&&e!==Wi.correlationIdPrefix)return e}},getCorrelationContextValue:function(t,e){if(t)for(var r=t.split(","),n=0;n<r.length;++n){var i=r[n].split("=");if(i.length===2&&i[0]===e)return i[1]}}},pm={Now:Is,GetDuration:jr}});function mm(t){if(!t)return{};var e=t.split(vm),r=Xp(e,function(i,o){var a=o.split(wm);if(a.length===2){var s=a[0].toLowerCase(),c=a[1];i[s]=c}return i},{});if(go(r).length>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+n+"dc."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||sh}return r}l(mm,"di");var vm,wm,ym,c_=Te(()=>{En(),At(),vm=";",wm="=",ym={parse:mm}}),gh,bm=Te(()=>{gh=function(){function t(){}return l(t,"t"),t}()}),mh,_m=Te(()=>{qt(),bm(),mh=function(t){Lt(e,t);function e(){return t.call(this)||this}return l(e,"e"),e}(gh)}),xm,l_=Te(()=>{xm=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return l(t,"t"),t}()}),vh,u_=Te(()=>{qt(),l_(),Cn(),At(),En(),vh=function(t){Lt(e,t);function e(r,n,i){var o=t.call(this)||this;return o.name=qr(r,i)||ln,o.data=n,o.time=Bi(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1},o}return l(e,"e"),e}(xm)}),wh,Sm=Te(()=>{wh=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return l(t,"t"),t}()}),An,d_=Te(()=>{qt(),Sm(),Cn(),En(),An=function(t){Lt(e,t);function e(r,n,i,o){var a=t.call(this)||this;return a.aiDataContract={ver:1,name:1,properties:0,measurements:0},a.name=qr(r,n)||ln,a.properties=Ui(r,i),a.measurements=Li(r,o),a}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(wh)}),Cm,h_=Te(()=>{Cm=function(){function t(){}return l(t,"t"),t}()}),Em,f_=Te(()=>{Em=function(){function t(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}}return l(t,"t"),t}()}),Rm,p_=Te(()=>{Rm=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return l(t,"t"),t}()});function yh(t,e){var r=t;return r&&!St(r)&&(JSON&&JSON.stringify?(r=JSON.stringify(t),e&&(!r||r==="{}")&&(Dt(t.toString)?r=t.toString():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}l(yh,"Ka");function Am(t,e){var r=t;return t&&(r=t[Rl]||t[xh]||"",r&&!St(r)&&(r=yh(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(r||"").indexOf(e)===-1&&(r=e+": "+r),r||""}l(Am,"As");function g_(t){return po(t)?"hasFullStack"in t&&"typeName"in t:!1}l(g_,"ol");function m_(t){return po(t)?"ver"in t&&"exceptions"in t&&"properties"in t:!1}l(m_,"sl");function Tm(t){return t&&t.src&&St(t.src)&&t.obj&&fi(t.obj)}l(Tm,"Ns");function ma(t){var e=t||"";St(e)||(St(e[nn])?e=e[nn]:e=""+e);var r=e.split(`
`);return{src:e,obj:r}}l(ma,"Lr");function v_(t){for(var e=[],r=t.split(`
`),n=0;n<r.length;n++){var i=r[n];r[n+1]&&(i+="@"+r[n+1],n++),e.push(i)}return{src:t,obj:e}}l(v_,"cl");function km(t){var e=null;if(t)try{if(t[nn])e=ma(t[nn]);else if(t[Co]&&t[Co][nn])e=ma(t[Co][nn]);else if(t.exception&&t.exception[nn])e=ma(t.exception[nn]);else if(Tm(t))e=t;else if(Tm(t[El]))e=t[El];else if(window.opera&&t[Rl])e=v_(t.message);else if(St(t))e=ma(t);else{var r=t[Rl]||t[xh]||"";St(t[_h])&&(r&&(r+=`
`),r+=" from "+t[_h]),r&&(e=ma(r))}}catch(n){e=ma(n)}return e||{src:"",obj:null}}l(km,"Fs");function w_(t){var e="";return t&&(t.obj?Ct(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}l(w_,"ul");function y_(t){var e,r=t.obj;if(r&&r.length>0){e=[];var n=0,i=0;Ct(r,function(_){var v=_.toString();if(Al.regex.test(v)){var y=new Al(v,n++);i+=y.sizeInBytes,e.push(y)}});var o=32*1024;if(i>o)for(var a=0,s=e.length-1,c=0,u=a,d=s;a<s;){var f=e[a].sizeInBytes,p=e[s].sizeInBytes;if(c+=f+p,c>o){var g=d-u+1;e.splice(u,g);break}u=a,d=s,a++,s--}}return e}l(y_,"ll");function Cl(t){var e="";if(t&&(e=t.typeName||t.name||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor.toString());e=n&&n.length>1?n[1]:""}catch(i){}return e}l(Cl,"gi");function bh(t){if(t)try{if(!St(t)){var e=Cl(t),r=yh(t,!1);return(!r||r==="{}")&&(t[Co]&&(t=t[Co],e=Cl(t)),r=yh(t,!0)),r.indexOf(e)!==0&&e!=="String"?e+":"+r:r}}catch(n){}return""+(t||"")}l(bh,"Wa");var Im,Co,nn,El,_h,Rl,xh,Vr,Sh,Al,b_=Te(()=>{qt(),h_(),f_(),p_(),Cn(),At(),En(),Im="<no_method>",Co="error",nn="stack",El="stackDetails",_h="errorSrc",Rl="message",xh="description",Vr=function(t){Lt(e,t);function e(r,n,i,o,a,s){var c=t.call(this)||this;return c.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},m_(n)?(c.exceptions=n.exceptions,c.properties=n.properties,c.measurements=n.measurements,n.severityLevel&&(c.severityLevel=n.severityLevel),n.id&&(c.id=n.id),n.problemGroup&&(c.problemGroup=n.problemGroup),c.ver=2,Oe(n.isManual)||(c.isManual=n.isManual)):(i||(i={}),c.exceptions=[new Sh(r,n,i)],c.properties=Ui(r,i),c.measurements=Li(r,o),a&&(c.severityLevel=a),s&&(c.id=s)),c}return l(e,"e"),e.CreateAutoException=function(r,n,i,o,a,s,c,u){var d=Cl(a||s||r);return{message:Am(r,d),url:n,lineNumber:i,columnNumber:o,error:bh(a||s||r),evt:bh(s||r),typeName:d,stackDetails:km(c||a||s),errorSrc:u}},e.CreateFromInterface=function(r,n,i,o){var a=n.exceptions&&ys(n.exceptions,function(c){return Sh.CreateFromInterface(r,c)}),s=new e(r,ea({},n,{exceptions:a}),i,o);return s},e.prototype.toInterface=function(){var r=this,n=r.exceptions,i=r.properties,o=r.measurements,a=r.severityLevel,s=r.ver,c=r.problemGroup,u=r.id,d=r.isManual,f=n instanceof Array&&ys(n,function(p){return p.toInterface()})||void 0;return{ver:"4.0",exceptions:f,severityLevel:a,properties:i,measurements:o,problemGroup:c,id:u,isManual:d}},e.CreateSimpleException=function(r,n,i,o,a,s){return{exceptions:[{hasFullStack:!0,message:r,stack:a,typeName:n}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=bh,e}(Em),Sh=function(t){Lt(e,t);function e(r,n,i){var o=t.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},g_(n))o.typeName=n.typeName,o.message=n.message,o[nn]=n[nn],o.parsedStack=n.parsedStack,o.hasFullStack=n.hasFullStack;else{var a=n,s=a&&a.evt;Xc(a)||(a=a[Co]||s||a),o.typeName=qr(r,Cl(a))||ln,o.message=ih(r,Am(n||a,o.typeName))||ln;var c=n[El]||km(n);o.parsedStack=y_(c),o[nn]=Gg(r,w_(c)),o.hasFullStack=fi(o.parsedStack)&&o.parsedStack.length>0,i&&(i.typeName=i.typeName||o.typeName)}return o}return l(e,"e"),e.prototype.toInterface=function(){var r=this.parsedStack instanceof Array&&ys(this.parsedStack,function(i){return i.toInterface()}),n={id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[nn],parsedStack:r||void 0};return n},e.CreateFromInterface=function(r,n){var i=n.parsedStack instanceof Array&&ys(n.parsedStack,function(a){return Al.CreateFromInterface(a)})||n.parsedStack,o=new e(r,ea({},n,{parsedStack:i}));return o},e}(Rm),Al=function(t){Lt(e,t);function e(r,n){var i=t.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},typeof r=="string"){var o=r;i.level=n,i.method=Im,i.assembly=Rr(o),i.fileName="",i.line=0;var a=o.match(e.regex);a&&a.length>=5&&(i.method=Rr(a[2])||i.method,i.fileName=Rr(a[4]),i.line=parseInt(a[5])||0)}else i.level=r.level,i.method=r.method,i.assembly=r.assembly,i.fileName=r.fileName,i.line=r.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=e.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return l(e,"e"),e.CreateFromInterface=function(r){return new e(r,null)},e.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(Cm)}),Dm,__=Te(()=>{Dm=function(){function t(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}}return l(t,"t"),t}()}),Ch,x_=Te(()=>{(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(Ch||(Ch={}))}),Fm,S_=Te(()=>{x_(),Fm=function(){function t(){this.kind=Ch.Measurement}return l(t,"t"),t}()}),Pm,C_=Te(()=>{qt(),S_(),Pm=function(t){Lt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},r}return l(e,"e"),e}(Fm)}),zn,E_=Te(()=>{qt(),__(),Cn(),C_(),En(),zn=function(t){Lt(e,t);function e(r,n,i,o,a,s,c,u){var d=t.call(this)||this;d.aiDataContract={ver:1,metrics:1,properties:0};var f=new Pm;return f.count=o>0?o:void 0,f.max=isNaN(s)||s===null?void 0:s,f.min=isNaN(a)||a===null?void 0:a,f.name=qr(r,n)||ln,f.value=i,d.metrics=[f],d.properties=Ui(r,c),d.measurements=Li(r,u),d}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(Dm)}),Tl,Eh=Te(()=>{qt(),Sm(),Tl=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return l(e,"e"),e}(wh)}),Tn,R_=Te(()=>{qt(),Eh(),Cn(),vl(),En(),Tn=function(t){Lt(e,t);function e(r,n,i,o,a,s,c){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},u.id=Kg(r,c),u.url=Ts(r,i),u.name=qr(r,n)||ln,isNaN(o)||(u.duration=vi(o)),u.properties=Ui(r,a),u.measurements=Li(r,s),u}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(Tl)}),Nm,A_=Te(()=>{Nm=function(){function t(){this.ver=2,this.success=!0,this.properties={},this.measurements={}}return l(t,"t"),t}()}),qn,T_=Te(()=>{qt(),Cn(),gm(),A_(),vl(),qn=function(t){Lt(e,t);function e(r,n,i,o,a,s,c,u,d,f,p,g){d===void 0&&(d="Ajax");var _=t.call(this)||this;_.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},_.id=n,_.duration=vi(a),_.success=s,_.resultCode=c+"",_.type=qr(r,d);var v=s_(r,i,u,o);return _.data=Ts(r,o)||v.data,_.target=qr(r,v.target),f&&(_.target=_.target+" | "+f),_.name=qr(r,v.name),_.properties=Ui(r,p),_.measurements=Li(r,g),_}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(Nm)}),$m,k_=Te(()=>{$m=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return l(t,"t"),t}()}),wi,I_=Te(()=>{qt(),k_(),Cn(),En(),wi=function(t){Lt(e,t);function e(r,n,i,o,a){var s=t.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},n=n||ln,s.message=ih(r,n),s.properties=Ui(r,o),s.measurements=Li(r,a),i&&(s.severityLevel=i),s}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}($m)}),Mm,D_=Te(()=>{qt(),Eh(),Mm=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return l(e,"e"),e}(Tl)}),yi,F_=Te(()=>{qt(),D_(),Cn(),En(),yi=function(t){Lt(e,t);function e(r,n,i,o,a,s,c){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},u.url=Ts(r,i),u.name=qr(r,n)||ln,u.properties=Ui(r,a),u.measurements=Li(r,s),c&&(u.domProcessing=c.domProcessing,u.duration=c.duration,u.networkConnect=c.networkConnect,u.perfTotal=c.perfTotal,u.receivedResponse=c.receivedResponse,u.sentRequest=c.sentRequest),u}return l(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(Mm)}),bi,P_=Te(()=>{qt(),_m(),bi=function(t){Lt(e,t);function e(r,n){var i=t.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=r,i.baseData=n,i}return l(e,"e"),e}(mh)}),Ds,N_=Te(()=>{(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(Ds||(Ds={}))}),Bm,$_=Te(()=>{At(),Bm=function(){function t(){}return l(t,"t"),t.getConfig=function(e,r,n,i){i===void 0&&(i=!1);var o;return n&&e.extensionConfig&&e.extensionConfig[n]&&!Oe(e.extensionConfig[n][r])?o=e.extensionConfig[n][r]:o=e[r],Oe(o)?i:o},t}()});function zi(t){var e="ai."+t+".";return function(r){return e+r}}l(zi,"Qt");var va,ur,Fs,Eo,kl,_i,qi,wa,Il,Um=Te(()=>{qt(),At(),va=zi("application"),ur=zi("device"),Fs=zi("location"),Eo=zi("operation"),kl=zi("session"),_i=zi("user"),qi=zi("cloud"),wa=zi("internal"),Il=function(t){Lt(e,t);function e(){return t.call(this)||this}return l(e,"e"),e}(Ib({applicationVersion:va("ver"),applicationBuild:va("build"),applicationTypeId:va("typeId"),applicationId:va("applicationId"),applicationLayer:va("layer"),deviceId:ur("id"),deviceIp:ur("ip"),deviceLanguage:ur("language"),deviceLocale:ur("locale"),deviceModel:ur("model"),deviceFriendlyName:ur("friendlyName"),deviceNetwork:ur("network"),deviceNetworkName:ur("networkName"),deviceOEMName:ur("oemName"),deviceOS:ur("os"),deviceOSVersion:ur("osVersion"),deviceRoleInstance:ur("roleInstance"),deviceRoleName:ur("roleName"),deviceScreenResolution:ur("screenResolution"),deviceType:ur("type"),deviceMachineName:ur("machineName"),deviceVMName:ur("vmName"),deviceBrowser:ur("browser"),deviceBrowserVersion:ur("browserVersion"),locationIp:Fs("ip"),locationCountry:Fs("country"),locationProvince:Fs("province"),locationCity:Fs("city"),operationId:Eo("id"),operationName:Eo("name"),operationParentId:Eo("parentId"),operationRootId:Eo("rootId"),operationSyntheticSource:Eo("syntheticSource"),operationCorrelationVector:Eo("correlationVector"),sessionId:kl("id"),sessionIsFirst:kl("isFirst"),sessionIsNew:kl("isNew"),userAccountAcquisitionDate:_i("accountAcquisitionDate"),userAccountId:_i("accountId"),userAgent:_i("userAgent"),userId:_i("id"),userStoreRegion:_i("storeRegion"),userAuthUserId:_i("authUserId"),userAnonymousUserAcquisitionDate:_i("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:_i("authUserAcquisitionDate"),cloudName:qi("name"),cloudRole:qi("role"),cloudRoleVer:qi("roleVer"),cloudRoleInstance:qi("roleInstance"),cloudEnvironment:qi("environment"),cloudLocation:qi("location"),cloudDeploymentUnit:qi("deploymentUnit"),internalNodeName:wa("nodeName"),internalSdkVersion:wa("sdkVersion"),internalAgentVersion:wa("agentVersion"),internalSnippet:wa("snippet"),internalSdkSrc:wa("sdkSrc")}))}),jn,M_=Te(()=>{Cn(),At(),En(),jn=function(){function t(){}return l(t,"t"),t.create=function(e,r,n,i,o,a){if(n=qr(i,n)||ln,Oe(e)||Oe(r)||Oe(n))throw Error("Input doesn't contain all required fields");var s={name:n,time:Bi(new Date),iKey:"",ext:a||{},tags:[],data:{},baseType:r,baseData:e};return Oe(o)||gr(o,function(c,u){s.data[c]=u}),s},t}()}),Gr,jt,B_=Te(()=>{Um(),Gr={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},jt=new Il}),ya,Dl,Rh,mr=Te(()=>{gm(),c_(),jg(),En(),_m(),bm(),u_(),d_(),b_(),E_(),R_(),Eh(),T_(),I_(),F_(),P_(),N_(),$_(),Um(),Cn(),M_(),B_(),em(),vl(),Xg(),am(),dm(),ya="AppInsightsPropertiesPlugin",Dl="AppInsightsChannelPlugin",Rh="ApplicationInsightsAnalytics"}),Lm,U_=Te(()=>{mr(),At(),Sr(),Lm=function(){function t(e,r,n,i){lr(t,this,function(o){var a=null,s=[],c=!1,u;n&&(u=n.logger);function d(){n&&Ct(n.getTransmissionControls(),function(p){Ct(p,function(g){return g.flush(!0)})})}l(d,"l");function f(p){s.push(p),a||(a=setInterval(function(){var g=s.slice(0),_=!1;s=[],Ct(g,function(v){v()?_=!0:s.push(v)}),s.length===0&&(clearInterval(a),a=null),_&&d()},100))}l(f,"f"),o.trackPageView=function(p,g){var _=p.name;if(Oe(_)||typeof _!="string"){var v=On();_=p.name=v&&v.title||""}var y=p.uri;if(Oe(y)||typeof y!="string"){var x=mo();y=p.uri=x&&x.href||""}if(!i.isPerformanceTimingSupported()){e.sendPageViewInternal(p,g),d(),u.throwInternal(Le.WARNING,Fe.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var C=!1,k,I=i.getPerformanceTiming().navigationStart;I>0&&(k=jr(I,+new Date),i.shouldCollectDuration(k)||(k=void 0));var B;!Oe(g)&&!Oe(g.duration)&&(B=g.duration),(r||!isNaN(B))&&(isNaN(B)&&(g||(g={}),g.duration=k),e.sendPageViewInternal(p,g),d(),C=!0);var J=6e4;g||(g={}),f(function(){var re=!1;try{if(i.isPerformanceTimingDataReady()){re=!0;var K={name:_,uri:y};i.populatePageViewPerformanceEvent(K),!K.isValid&&!C?(g.duration=k,e.sendPageViewInternal(p,g)):(C||(g.duration=K.durationMs,e.sendPageViewInternal(p,g)),c||(e.sendPageViewPerformanceInternal(K,g),c=!0))}else I>0&&jr(I,+new Date)>J&&(re=!0,C||(g.duration=J,e.sendPageViewInternal(p,g)))}catch(we){u.throwInternal(Le.CRITICAL,Fe.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Mt(we),{exception:yt(we)})}return re})}})}return l(t,"t"),t}()}),Om,Hm,L_=Te(()=>{mr(),At(),Om=function(){function t(e,r){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=r,this._logger=e}return l(t,"t"),t.prototype.trackPreviousPageVisit=function(e,r){try{var n=this.restartPageVisitTimer(e,r);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(i){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+yt(i))}},t.prototype.restartPageVisitTimer=function(e,r){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,r),n}catch(i){return this._logger.warnToConsole("Call to restart failed: "+yt(i)),null}},t.prototype.startPageVisitTimer=function(e,r){try{if(ga()){_l(this._logger,this.prevPageVisitDataKeyName)!=null&&Ln("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new Hm(e,r),i=Sn().stringify(n);xl(this._logger,this.prevPageVisitDataKeyName,i)}}catch(o){this._logger.warnToConsole("Call to start failed: "+yt(o))}},t.prototype.stopPageVisitTimer=function(){try{if(ga()){var e=sn(),r=_l(this._logger,this.prevPageVisitDataKeyName);if(r&&ia()){var n=Sn().parse(r);return n.pageVisitTime=e-n.pageVisitStartTime,om(this._logger,this.prevPageVisitDataKeyName),n}else return null}return null}catch(i){return this._logger.warnToConsole("Stop page visit timer failed: "+yt(i)),null}},t}(),Hm=function(){function t(e,r){this.pageVisitStartTime=sn(),this.pageName=e,this.pageUrl=r}return l(t,"t"),t}()}),Wm,O_=Te(()=>{mr(),At(),Wm=function(){function t(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return l(t,"t"),t.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var r=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming(),i=0,o=0,a=0,s=0,c=0;(r||n)&&(r?(i=r.duration,o=r.startTime===0?r.connectEnd:jr(r.startTime,r.connectEnd),a=jr(r.requestStart,r.responseStart),s=jr(r.responseStart,r.responseEnd),c=jr(r.responseEnd,r.loadEventEnd)):(i=jr(n.navigationStart,n.loadEventEnd),o=jr(n.navigationStart,n.connectEnd),a=jr(n.requestStart,n.responseStart),s=jr(n.responseStart,n.responseEnd),c=jr(n.responseEnd,n.loadEventEnd)),i===0?this._logger.throwInternal(Le.WARNING,Fe.ErrorPVCalc,"error calculating page view performance.",{total:i,network:o,request:a,response:s,dom:c}):this.shouldCollectDuration(i,o,a,s,c)?i<Math.floor(o)+Math.floor(a)+Math.floor(s)+Math.floor(c)?this._logger.throwInternal(Le.WARNING,Fe.ClientPerformanceMathError,"client performance math error.",{total:i,network:o,request:a,response:s,dom:c}):(e.durationMs=i,e.perfTotal=e.duration=vi(i),e.networkConnect=vi(o),e.sentRequest=vi(a),e.receivedResponse=vi(s),e.domProcessing=vi(c),e.isValid=!0):this._logger.throwInternal(Le.WARNING,Fe.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:o,request:a,response:s,dom:c}))},t.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?pi().timing:null},t.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?pi().getEntriesByType("navigation")[0]:null},t.prototype.isPerformanceNavigationTimingSupported=function(){var e=pi();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},t.prototype.isPerformanceTimingSupported=function(){var e=pi();return e&&e.timing},t.prototype.isPerformanceTimingDataReady=function(){var e=pi(),r=e?e.timing:0;return r&&r.domainLookupStart>0&&r.navigationStart>0&&r.responseStart>0&&r.requestStart>0&&r.loadEventEnd>0&&r.responseEnd>0&&r.connectEnd>0&&r.domLoading>0},t.prototype.shouldCollectDuration=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=Hn()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=n.userAgent,a=!1;if(o)for(var s=0;s<i.length;s++)a=a||o.toLowerCase().indexOf(i[s])!==-1;if(a)return!1;for(var s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},t}()});function Ps(t,e){t&&t.dispatchEvent&&e&&t.dispatchEvent(e)}l(Ps,"Pn");var Ah,Fl,Th,kh,H_=Te(()=>{qt(),mr(),At(),U_(),L_(),O_(),Sr(),Ah="duration",Fl="event",Th=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier=Rh,r.priority=180,r.autoRoutePVDelay=500;var n,i,o,a=0,s,c;return lr(e,r,function(u,d){var f=mo(!0);s=f&&f.href||"",u.getCookieMgr=function(){return Bd(u.core)},u.processTelemetry=function(y,x){aa(u.core,function(){return u.identifier+":processTelemetry"},function(){var C=!1,k=u._telemetryInitializers.length;x=u._getTelCtx(x);for(var I=0;I<k;++I){var B=u._telemetryInitializers[I];if(B)try{if(B.apply(null,[y])===!1){C=!0;break}}catch(J){x.diagLog().throwInternal(Le.CRITICAL,Fe.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Mt(J),{exception:yt(J)},!0)}}C||u.processNext(y,x)},function(){return{item:y}},!y.sync)},u.trackEvent=function(y,x){try{var C=jn.create(y,An.dataType,An.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(Le.WARNING,Fe.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Mt(k),{exception:yt(k)})}},u.startTrackEvent=function(y){try{n.start(y)}catch(x){u.diagLog().throwInternal(Le.CRITICAL,Fe.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Mt(x),{exception:yt(x)})}},u.stopTrackEvent=function(y,x,C){try{n.stop(y,void 0,x)}catch(k){u.diagLog().throwInternal(Le.CRITICAL,Fe.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Mt(k),{exception:yt(k)})}},u.trackTrace=function(y,x){try{var C=jn.create(y,wi.dataType,wi.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(Le.WARNING,Fe.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Mt(k),{exception:yt(k)})}},u.trackMetric=function(y,x){try{var C=jn.create(y,zn.dataType,zn.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Mt(k),{exception:yt(k)})}},u.trackPageView=function(y,x){try{var C=y||{};u._pageViewManager.trackPageView(C,ea({},C.properties,C.measurements,x)),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(C.name,C.uri)}catch(k){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Mt(k),{exception:yt(k)})}},u.sendPageViewInternal=function(y,x,C){var k=On();k&&(y.refUri=y.refUri===void 0?k.referrer:y.refUri);var I=jn.create(y,Tn.dataType,Tn.envelopeType,u.diagLog(),x,C);u.core.track(I),a=0},u.sendPageViewPerformanceInternal=function(y,x,C){var k=jn.create(y,yi.dataType,yi.envelopeType,u.diagLog(),x,C);u.core.track(k)},u.trackPageViewPerformance=function(y,x){try{u._pageViewPerformanceManager.populatePageViewPerformanceEvent(y),u.sendPageViewPerformanceInternal(y,x)}catch(C){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Mt(C),{exception:yt(C)})}},u.startTrackPage=function(y){try{if(typeof y!="string"){var x=On();y=x&&x.title||""}i.start(y)}catch(C){u.diagLog().throwInternal(Le.CRITICAL,Fe.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Mt(C),{exception:yt(C)})}},u.stopTrackPage=function(y,x,C,k){try{if(typeof y!="string"){var I=On();y=I&&I.title||""}if(typeof x!="string"){var B=mo();x=B&&B.href||""}i.stop(y,x,C,k),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(y,x)}catch(J){u.diagLog().throwInternal(Le.CRITICAL,Fe.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Mt(J),{exception:yt(J)})}},u.sendExceptionInternal=function(y,x,C){var k=y.exception||y.error||new Error(ln),I=new Vr(u.diagLog(),k,y.properties||x,y.measurements,y.severityLevel,y.id).toInterface(),B=jn.create(I,Vr.dataType,Vr.envelopeType,u.diagLog(),x,C);u.core.track(B)},u.trackException=function(y,x){try{u.sendExceptionInternal(y,x)}catch(C){u.diagLog().throwInternal(Le.CRITICAL,Fe.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Mt(C),{exception:yt(C)})}},u._onerror=function(y){var x=y&&y.error,C=y&&y.evt;try{if(!C){var k=bs();k&&(C=k[Fl])}var I=y&&y.url||(On()||{}).URL,B=y.errorSrc||"window.onerror@"+I+":"+(y.lineNumber||0)+":"+(y.columnNumber||0),J={errorSrc:B,url:I,lineNumber:y.lineNumber||0,columnNumber:y.columnNumber||0,message:y.message};Jg(y.message,y.url,y.lineNumber,y.columnNumber,y.error)?v(Vr.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",I,y.lineNumber||0,y.columnNumber||0,x,C,null,B),J):(y.errorSrc||(y.errorSrc=B),u.trackException({exception:y,severityLevel:Ds.Error},J))}catch(K){var re=x?x.name+", "+x.message:"null";u.diagLog().throwInternal(Le.CRITICAL,Fe.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Mt(K),{exception:yt(K),errorString:re})}},u.addTelemetryInitializer=function(y){u._telemetryInitializers.push(y)},u.initialize=function(y,x,C,k){if(!u.isInitialized()){if(Oe(x))throw Error("Error initializing");d.initialize(y,x,C,k),u.setInitialized(!1);var I=u._getTelCtx(),B=u.identifier;u.config=I.getExtCfg(B);var J=e.getDefaultConfig(y);J!==void 0&&gr(J,function(Pe,Xe){u.config[Pe]=I.getConfig(B,Pe,Xe),u.config[Pe]===void 0&&(u.config[Pe]=Xe)}),u.config.isStorageUseDisabled&&tm();var re={instrumentationKey:function(){return y.instrumentationKey},accountId:function(){return u.config.accountId||y.accountId},sessionRenewalMs:function(){return u.config.sessionRenewalMs||y.sessionRenewalMs},sessionExpirationMs:function(){return u.config.sessionExpirationMs||y.sessionExpirationMs},sampleRate:function(){return u.config.samplingPercentage||y.samplingPercentage},sdkExtension:function(){return u.config.sdkExtension||y.sdkExtension},isBrowserLinkTrackingEnabled:function(){return u.config.isBrowserLinkTrackingEnabled||y.isBrowserLinkTrackingEnabled},appId:function(){return u.config.appId||y.appId}};u._pageViewPerformanceManager=new Wm(u.core),u._pageViewManager=new Lm(r,u.config.overridePageViewDuration,u.core,u._pageViewPerformanceManager),u._pageVisitTimeManager=new Om(u.diagLog(),function(Pe,Xe,it){return p(Pe,Xe,it)}),u._telemetryInitializers=u._telemetryInitializers||[],g(re),n=new kh(u.diagLog(),"trackEvent"),n.action=function(Pe,Xe,it,ft){ft||(ft={}),ft[Ah]=it.toString(),u.trackEvent({name:Pe,properties:ft})},i=new kh(u.diagLog(),"trackPageView"),i.action=function(Pe,Xe,it,ft,Tt){Oe(ft)&&(ft={}),ft[Ah]=it.toString();var Ht={name:Pe,uri:Xe,properties:ft,measurements:Tt};u.sendPageViewInternal(Ht,ft)};var K=bs(),we=$b(),ie=mo(!0),pe=r;if(u.config.disableExceptionTracking===!1&&!u.config.autoExceptionInstrumented&&K){var Se="onerror",Je=K[Se];K.onerror=function(Pe,Xe,it,ft,Tt){var Ht=K[Fl],vn=Je&&Je(Pe,Xe,it,ft,Tt);return vn!==!0&&pe._onerror(Vr.CreateAutoException(Pe,Xe,it,ft,Tt,Ht)),vn},u.config.autoExceptionInstrumented=!0}if(u.config.disableExceptionTracking===!1&&u.config.enableUnhandledPromiseRejectionTracking===!0&&!u.config.autoUnhandledPromiseInstrumented&&K){var ae="onunhandledrejection",Ae=K[ae];K[ae]=function(Pe){var Xe=K[Fl],it=Ae&&Ae.call(K,Pe);return it!==!0&&pe._onerror(Vr.CreateAutoException(Pe.reason.toString(),ie?ie.href:"",0,0,Pe,Xe)),it},u.config.autoUnhandledPromiseInstrumented=!0}if(u.config.enableAutoRouteTracking===!0&&we&&Dt(we.pushState)&&Dt(we.replaceState)&&K&&typeof Event!="undefined"){var Ne=r;Ct(C,function(Pe){Pe.identifier===ya&&(o=Pe)}),we.pushState=function(Pe){return function(){var Xe=Pe.apply(this,arguments);return Ps(K,fa(Ne.config.namePrefix+"pushState")),Ps(K,fa(Ne.config.namePrefix+"locationchange")),Xe}}(we.pushState),we.replaceState=function(Pe){return function(){var Xe=Pe.apply(this,arguments);return Ps(K,fa(Ne.config.namePrefix+"replaceState")),Ps(K,fa(Ne.config.namePrefix+"locationchange")),Xe}}(we.replaceState),K.addEventListener&&(K.addEventListener(Ne.config.namePrefix+"popstate",function(){Ps(K,fa(Ne.config.namePrefix+"locationchange"))}),K.addEventListener(Ne.config.namePrefix+"locationchange",function(){if(o&&o.context&&o.context.telemetryTrace){o.context.telemetryTrace.traceID=Wn();var Pe="_unknown_";ie&&ie.pathname&&(Pe=ie.pathname+(ie.hash||"")),o.context.telemetryTrace.name=Pe}c&&(s=c),c=ie&&ie.href||"",setTimeout(function(Xe){Ne.trackPageView({refUri:Xe,properties:{duration:0}})}.bind(r,s),Ne.autoRoutePVDelay)}))}u.setInitialized(!0)}};function p(y,x,C){var k={PageName:y,PageUrl:x};u.trackMetric({name:"PageVisitTime",average:C,max:C,min:C,sampleCount:1},k)}l(p,"m");function g(y){if(!y.isBrowserLinkTrackingEnabled()){var x=["/browserLinkSignalR/","/__browserLink/"],C=l(function(k){if(k.baseType===qn.dataType){var I=k.baseData;if(I){for(var B=0;B<x.length;B++)if(I.target&&I.target.indexOf(x[B])>=0)return!1}}return!0},"y");_(C)}}l(g,"I");function _(y){u._telemetryInitializers.push(y)}l(_,"E");function v(y,x){var C=jn.create(y,Vr.dataType,Vr.envelopeType,u.diagLog(),x);u.core.track(C)}l(v,"b")}),r}return l(e,"e"),e.getDefaultConfig=function(r){return r||(r={}),r.sessionRenewalMs=30*60*1e3,r.sessionExpirationMs=24*60*60*1e3,r.disableExceptionTracking=Ot(r.disableExceptionTracking),r.autoTrackPageVisitTime=Ot(r.autoTrackPageVisitTime),r.overridePageViewDuration=Ot(r.overridePageViewDuration),r.enableUnhandledPromiseRejectionTracking=Ot(r.enableUnhandledPromiseRejectionTracking),(isNaN(r.samplingPercentage)||r.samplingPercentage<=0||r.samplingPercentage>=100)&&(r.samplingPercentage=100),r.isStorageUseDisabled=Ot(r.isStorageUseDisabled),r.isBrowserLinkTrackingEnabled=Ot(r.isBrowserLinkTrackingEnabled),r.enableAutoRouteTracking=Ot(r.enableAutoRouteTracking),r.namePrefix=r.namePrefix||"",r.enableDebug=Ot(r.enableDebug),r.disableFlushOnBeforeUnload=Ot(r.disableFlushOnBeforeUnload),r.disableFlushOnUnload=Ot(r.disableFlushOnUnload,r.disableFlushOnBeforeUnload),r},e.Version="2.6.4",e}(yo),kh=function(){function t(e,r){var n=this,i={};n.start=function(o){typeof i[o]!="undefined"&&e.throwInternal(Le.WARNING,Fe.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:o,key:o},!0),i[o]=+new Date},n.stop=function(o,a,s,c){var u=i[o];if(isNaN(u))e.throwInternal(Le.WARNING,Fe.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:o,key:o},!0);else{var d=+new Date,f=jr(u,d);n.action(o,a,f,s,c)}delete i[o],i[o]=void 0}}return l(t,"t"),t}()}),zm=Te(()=>{H_()}),qm,jm,W_=Te(()=>{mr(),At(),Sr(),qm=function(){function t(e){var r=[];lr(t,this,function(n){n.enqueue=function(i){r.push(i)},n.count=function(){return r.length},n.clear=function(){r.length=0},n.getItems=function(){return r.slice(0)},n.batchPayloads=function(i){if(i&&i.length>0){var o=e.emitLineDelimitedJson()?i.join(`
`):"["+i.join(",")+"]";return o}return null},n.markAsSent=function(i){n.clear()},n.clearSent=function(i){}})}return l(t,"t"),t}(),jm=function(){function t(e,r){var n=!1,i;lr(t,this,function(o){var a=u(t.BUFFER_KEY),s=u(t.SENT_BUFFER_KEY);i=a.concat(s),i.length>t.MAX_BUFFER_SIZE&&(i.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,i),o.enqueue=function(f){if(i.length>=t.MAX_BUFFER_SIZE){n||(e.throwInternal(Le.WARNING,Fe.SessionStorageBufferFull,"Maximum buffer size reached: "+i.length,!0),n=!0);return}i.push(f),d(t.BUFFER_KEY,i)},o.count=function(){return i.length},o.clear=function(){i=[],d(t.BUFFER_KEY,[]),d(t.SENT_BUFFER_KEY,[]),n=!1},o.getItems=function(){return i.slice(0)},o.batchPayloads=function(f){if(f&&f.length>0){var p=r.emitLineDelimitedJson()?f.join(`
`):"["+f.join(",")+"]";return p}return null},o.markAsSent=function(f){i=c(f,i),d(t.BUFFER_KEY,i);var p=u(t.SENT_BUFFER_KEY);p instanceof Array&&f instanceof Array&&(p=p.concat(f),p.length>t.MAX_BUFFER_SIZE&&(e.throwInternal(Le.CRITICAL,Fe.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+p.length,!0),p.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,p))},o.clearSent=function(f){var p=u(t.SENT_BUFFER_KEY);p=c(f,p),d(t.SENT_BUFFER_KEY,p)};function c(f,p){var g=[];return Ct(p,function(_){!Dt(_)&&ws(f,_)===-1&&g.push(_)}),g}l(c,"s");function u(f){var p=f;try{p=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+p:p;var g=_l(e,p);if(g){var _=Sn().parse(g);if(St(_)&&(_=Sn().parse(_)),_&&fi(_))return _}}catch(v){e.throwInternal(Le.CRITICAL,Fe.FailedToRestoreStorageBuffer," storage key: "+p+", "+Mt(v),{exception:yt(v)})}return[]}l(u,"u");function d(f,p){var g=f;try{g=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+g:g;var _=JSON.stringify(p);xl(e,g,_)}catch(v){xl(e,g,JSON.stringify([])),e.throwInternal(Le.WARNING,Fe.FailedToSetStorageBuffer," storage key: "+g+", "+Mt(v)+". Buffer cleared",{exception:yt(v)})}}l(d,"l")})}return l(t,"t"),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}()});function dr(t,e,r){return Ft(t,e,r,vd)}l(dr,"ye");var Pl,Yt,vr,Ih,rr,Vm,Dh,Gm,Km,Qm,Zm,Xm,z_=Te(()=>{qt(),mr(),At(),Pl="baseType",Yt="baseData",vr="properties",Ih="true",rr=function(){function t(){}return l(t,"t"),t.extractPropsAndMeasurements=function(e,r,n){Oe(e)||gr(e,function(i,o){gd(o)?n[i]=o:St(o)?r[i]=o:ia()&&(r[i]=Sn().stringify(o))})},t.createEnvelope=function(e,r,n,i){var o=new vh(e,i,r);dr(o,"sampleRate",n[wl]),(n[Yt]||{}).startTime&&(o.time=Bi(n[Yt].startTime)),o.iKey=n.iKey;var a=n.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),t.extractPartAExtensions(n,o),n.tags=n.tags||[],eg(o)},t.extractPartAExtensions=function(e,r){var n=r.tags=r.tags||{},i=e.ext=e.ext||{},o=e.tags=e.tags||[],a=i.user;a&&(dr(n,jt.userAuthUserId,a.authId),dr(n,jt.userId,a.id||a.localId));var s=i.app;s&&dr(n,jt.sessionId,s.sesId);var c=i.device;c&&(dr(n,jt.deviceId,c.id||c.localId),dr(n,jt.deviceType,c.deviceClass),dr(n,jt.deviceIp,c.ip),dr(n,jt.deviceModel,c.model),dr(n,jt.deviceType,c.deviceType));var u=e.ext.web;if(u){dr(n,jt.deviceLanguage,u.browserLang),dr(n,jt.deviceBrowserVersion,u.browserVer),dr(n,jt.deviceBrowser,u.browser);var d=r.data=r.data||{},f=d[Yt]=d[Yt]||{},p=f[vr]=f[vr]||{};dr(p,"domain",u.domain),dr(p,"isManual",u.isManual?Ih:null),dr(p,"screenRes",u.screenRes),dr(p,"userConsent",u.userConsent?Ih:null)}var g=i.os;g&&dr(n,jt.deviceOS,g.name);var _=i.trace;_&&(dr(n,jt.operationParentId,_.parentID),dr(n,jt.operationName,_.name),dr(n,jt.operationId,_.traceID));for(var v={},y=o.length-1;y>=0;y--){var x=o[y];gr(x,function(k,I){v[k]=I}),o.splice(y,1)}gr(o,function(k,I){v[k]=I});var C=ea({},n,v);C[jt.internalSdkVersion]||(C[jt.internalSdkVersion]="javascript:"+t.Version),r.tags=eg(C)},t.prototype.Init=function(e,r){this._logger=e,Oe(r[Yt])&&this._logger.throwInternal(Le.CRITICAL,Fe.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},t.Version="2.6.4",t}(),Vm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Yt].measurements||{},o=n[Yt][vr]||{};rr.extractPropsAndMeasurements(n.data,o,i);var a=n[Yt];if(Oe(a))return r.warnToConsole("Invalid input for dependency data"),null;var s=a[vr]&&a[vr][yl]?a[vr][yl]:"GET",c=new qn(r,a.id,a.target,a.name,a.duration,a.success,a.responseCode,s,a.type,a.correlationContext,o,i),u=new bi(qn.dataType,c);return rr.createEnvelope(r,qn.envelopeType,n,u)},e.DependencyEnvelopeCreator=new e,e}(rr),Dh=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i={},o={};n[Pl]!==An.dataType&&(i.baseTypeSource=n[Pl]),n[Pl]===An.dataType?(i=n[Yt][vr]||{},o=n[Yt].measurements||{}):n[Yt]&&rr.extractPropsAndMeasurements(n[Yt],i,o),rr.extractPropsAndMeasurements(n.data,i,o);var a=n[Yt].name,s=new An(r,a,i,o),c=new bi(An.dataType,s);return rr.createEnvelope(r,An.envelopeType,n,c)},e.EventEnvelopeCreator=new e,e}(rr),Gm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Yt].measurements||{},o=n[Yt][vr]||{};rr.extractPropsAndMeasurements(n.data,o,i);var a=n[Yt],s=Vr.CreateFromInterface(r,a,o,i),c=new bi(Vr.dataType,s);return rr.createEnvelope(r,Vr.envelopeType,n,c)},e.ExceptionEnvelopeCreator=new e,e}(rr),Km=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Yt],o=i[vr]||{},a=i.measurements||{};rr.extractPropsAndMeasurements(n.data,o,a);var s=new zn(r,i.name,i.average,i.sampleCount,i.min,i.max,o,a),c=new bi(zn.dataType,s);return rr.createEnvelope(r,zn.envelopeType,n,c)},e.MetricEnvelopeCreator=new e,e}(rr),Qm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i="duration",o,a=n[Yt];!Oe(a)&&!Oe(a[vr])&&!Oe(a[vr][i])?(o=a[vr][i],delete a[vr][i]):!Oe(n.data)&&!Oe(n.data[i])&&(o=n.data[i],delete n.data[i]);var s=n[Yt],c;((n.ext||{}).trace||{}).traceID&&(c=n.ext.trace.traceID);var u=s.id||c,d=s.name,f=s.uri,p=s[vr]||{},g=s.measurements||{};if(Oe(s.refUri)||(p.refUri=s.refUri),Oe(s.pageType)||(p.pageType=s.pageType),Oe(s.isLoggedIn)||(p.isLoggedIn=s.isLoggedIn.toString()),!Oe(s[vr])){var _=s[vr];gr(_,function(x,C){p[x]=C})}rr.extractPropsAndMeasurements(n.data,p,g);var v=new Tn(r,d,f,o,p,g,u),y=new bi(Tn.dataType,v);return rr.createEnvelope(r,Tn.envelopeType,n,y)},e.PageViewEnvelopeCreator=new e,e}(rr),Zm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Yt],o=i.name,a=i.uri||i.url,s=i[vr]||{},c=i.measurements||{};rr.extractPropsAndMeasurements(n.data,s,c);var u=new yi(r,o,a,void 0,s,c,i),d=new bi(yi.dataType,u);return rr.createEnvelope(r,yi.envelopeType,n,d)},e.PageViewPerformanceEnvelopeCreator=new e,e}(rr),Xm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return l(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Yt].message,o=n[Yt].severityLevel,a=n[Yt][vr]||{},s=n[Yt].measurements||{};rr.extractPropsAndMeasurements(n.data,a,s);var c=new wi(r,i,o,a,s),u=new bi(wi.dataType,c);return rr.createEnvelope(r,wi.envelopeType,n,u)},e.TraceEnvelopeCreator=new e,e}(rr)}),Ym,q_=Te(()=>{At(),Sr(),Ym=function(){function t(e){lr(t,this,function(r){r.serialize=function(a){var s=n(a,"root");try{return Sn().stringify(s)}catch(c){e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,c&&Dt(c.toString)?c.toString():"Error serializing object",null,!0)}};function n(a,s){var c="__aiCircularRefCheck",u={};if(!a)return e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:s},!0),u;if(a[c])return e.throwInternal(Le.WARNING,Fe.CircularReferenceDetected,"Circular reference detected while serializing object",{name:s},!0),u;if(!a.aiDataContract){if(s==="measurements")u=o(a,"number",s);else if(s==="properties")u=o(a,"string",s);else if(s==="tags")u=o(a,"string",s);else if(fi(a))u=i(a,s);else{e.throwInternal(Le.WARNING,Fe.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{Sn().stringify(a),u=a}catch(d){e.throwInternal(Le.CRITICAL,Fe.CannotSerializeObject,d&&Dt(d.toString)?d.toString():"Error serializing object",null,!0)}}return u}return a[c]=!0,gr(a.aiDataContract,function(d,f){var p=Dt(f)?f()&1:f&1,g=Dt(f)?f()&4:f&4,_=f&2,v=a[d]!==void 0,y=po(a[d])&&a[d]!==null;if(p&&!v&&!_)e.throwInternal(Le.CRITICAL,Fe.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:d,name:s});else if(!g){var x=void 0;y?_?x=i(a[d],d):x=n(a[d],d):x=a[d],x!==void 0&&(u[d]=x)}}),delete a[c],u}l(n,"n");function i(a,s){var c;if(a)if(!fi(a))e.throwInternal(Le.CRITICAL,Fe.ItemNotInArray,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{c=[];for(var u=0;u<a.length;u++){var d=a[u],f=n(d,s+"["+u+"]");c.push(f)}}return c}l(i,"i");function o(a,s,c){var u;return a&&(u={},gr(a,function(d,f){if(s==="string")f===void 0?u[d]="undefined":f===null?u[d]="null":f.toString?u[d]=f.toString():u[d]="invalid field: toString() is not defined.";else if(s==="number")if(f===void 0)u[d]="undefined";else if(f===null)u[d]="null";else{var p=parseFloat(f);isNaN(p)?u[d]="NaN":u[d]=p}else u[d]="invalid field: "+c+" is of unknown type.",e.throwInternal(Le.CRITICAL,u[d],null,!0)})),u}l(o,"a")})}return l(t,"t"),t}()}),Jm,Fh,j_=Te(()=>{At(),Sr(),Jm=function(){function t(){var e=bs(),r=On(),n=!1,i=!0;lr(t,this,function(o){try{if(e&&As.Attach(e,"online",c)&&(As.Attach(e,"offline",u),n=!0),r){var a=r.body||r;zr(a.ononline)||(a.ononline=c,a.onoffline=u,n=!0)}if(n){var s=Hn();s&&!Oe(s.onLine)&&(i=s.onLine)}}catch(d){n=!1}o.isListening=n,o.isOnline=function(){var d=!0,f=Hn();return n?d=i:f&&!Oe(f.onLine)&&(d=f.onLine),d},o.isOffline=function(){return!o.isOnline()};function c(){i=!0}l(c,"s");function u(){i=!1}l(u,"u")})}return l(t,"t"),t.Offline=new t,t}(),Fh=Jm.Offline}),ev,V_=Te(()=>{ev=function(){function t(){}return l(t,"t"),t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e.length<t.MIN_INPUT_LENGTH;)e=e.concat(e);for(var r=5381,n=0;n<e.length;++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t.MIN_INPUT_LENGTH=8,t}()}),tv,G_=Te(()=>{V_(),mr(),tv=function(){function t(){this.hashCodeGeneragor=new ev,this.keys=new Il}return l(t,"t"),t.prototype.getSamplingScore=function(e){var r=0;return e.tags&&e.tags[this.keys.userId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):r=Math.random()*100,r},t}()}),rv,K_=Te(()=>{G_(),mr(),At(),rv=function(){function t(e,r){this.INT_MAX_VALUE=2147483647,this._logger=r||ol(null),(e>100||e<0)&&(this._logger.throwInternal(Le.WARNING,Fe.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new tv}return l(t,"t"),t.prototype.isSampledIn=function(e){var r=this.sampleRate,n=!1;return r==null||r>=100||e.baseType===zn.dataType?!0:(n=this.samplingScoreGenerator.getSamplingScore(e)<r,n)},t}()});function Nl(t){try{return t.responseText}catch(e){}return null}l(Nl,"Si");var Ph,Q_=Te(()=>{qt(),W_(),z_(),q_(),mr(),At(),j_(),K_(),Sr(),Ph=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=Dl,r._XMLHttpRequestSupported=!1;var n,i,o,a,s,c,u={};return lr(e,r,function(d,f){function p(){Ln("Method not implemented.")}l(p,"m"),d.pause=p,d.resume=p,d.flush=function(){try{d.triggerSend(!0,null,1)}catch(ae){d.diagLog().throwInternal(Le.CRITICAL,Fe.FlushFailed,"flush failed, telemetry will not be collected: "+Mt(ae),{exception:yt(ae)})}},d.onunloadFlush=function(){if((d._senderConfig.onunloadDisableBeacon()===!1||d._senderConfig.isBeaconApiDisabled()===!1)&&ah())try{d.triggerSend(!0,y,2)}catch(ae){d.diagLog().throwInternal(Le.CRITICAL,Fe.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Mt(ae),{exception:yt(ae)})}else d.flush()},d.teardown=p,d.addHeader=function(ae,Ae){u[ae]=Ae},d.initialize=function(ae,Ae,Ne,Pe){f.initialize(ae,Ae,Ne,Pe);var Xe=d._getTelCtx(),it=d.identifier;s=new Ym(Ae.logger),n=0,i=null,o=0,d._sender=null,c=0;var ft=e._getDefaultAppInsightsChannelConfig();if(d._senderConfig=e._getEmptyAppInsightsChannelConfig(),gr(ft,function(be,Me){d._senderConfig[be]=function(){return Xe.getConfig(it,be,Me())}}),d._buffer=d._senderConfig.enableSessionStorageBuffer()&&ga()?new jm(d.diagLog(),d._senderConfig):new qm(d._senderConfig),d._sample=new rv(d._senderConfig.samplingPercentage(),d.diagLog()),Je(ae)||d.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidInstrumentationKey,"Invalid Instrumentation key "+ae.instrumentationKey),!Sl(d._senderConfig.endpointUrl())&&d._senderConfig.customHeaders()&&d._senderConfig.customHeaders().length>0&&Ct(d._senderConfig.customHeaders(),function(be){r.addHeader(be.header,be.value)}),!d._senderConfig.isBeaconApiDisabled()&&ah())d._sender=y;else{var Tt=Nr("XMLHttpRequest");if(Tt){var Ht=new Tt;"withCredentials"in Ht?(d._sender=x,d._XMLHttpRequestSupported=!0):typeof XDomainRequest!==di&&(d._sender=we)}else{var vn=Nr("fetch");vn&&(d._sender=C)}}},d.processTelemetry=function(ae,Ae){Ae=d._getTelCtx(Ae);try{if(d._senderConfig.disableTelemetry())return;if(!ae){Ae.diagLog().throwInternal(Le.CRITICAL,Fe.CannotSendEmptyTelemetry,"Cannot send empty telemetry");return}if(ae.baseData&&!ae.baseType){Ae.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidEvent,"Cannot send telemetry without baseData and baseType");return}if(ae.baseType||(ae.baseType="EventData"),!d._sender){Ae.diagLog().throwInternal(Le.CRITICAL,Fe.SenderNotInitialized,"Sender was not initialized");return}if(g(ae))ae[wl]=d._sample.sampleRate;else{Ae.diagLog().throwInternal(Le.WARNING,Fe.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:d._sample.sampleRate});return}var Ne=e.constructEnvelope(ae,d._senderConfig.instrumentationKey(),Ae.diagLog());if(!Ne){Ae.diagLog().throwInternal(Le.CRITICAL,Fe.CreateEnvelopeError,"Unable to create an AppInsights envelope");return}var Pe=!1;if(ae.tags&&ae.tags[pa]&&(Ct(ae.tags[pa],function(Tt){try{Tt&&Tt(Ne)===!1&&(Pe=!0,Ae.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(Ht){Ae.diagLog().throwInternal(Le.CRITICAL,Fe.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Mt(Ht),{exception:yt(Ht)},!0)}}),delete ae.tags[pa]),Pe)return;var Xe=s.serialize(Ne),it=d._buffer.getItems(),ft=d._buffer.batchPayloads(it);ft&&ft.length+Xe.length>d._senderConfig.maxBatchSizeInBytes()&&d.triggerSend(!0,null,10),d._buffer.enqueue(Xe),J()}catch(Tt){Ae.diagLog().throwInternal(Le.WARNING,Fe.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Mt(Tt),{exception:yt(Tt)})}d.processNext(ae,Ae)},d._xhrReadyStateChange=function(ae,Ae,Ne){ae.readyState===4&&_(ae.status,Ae,ae.responseURL,Ne,K(ae),Nl(ae)||ae.response)},d.triggerSend=function(ae,Ae,Ne){ae===void 0&&(ae=!0);try{if(d._senderConfig.disableTelemetry())d._buffer.clear();else{if(d._buffer.count()>0){var Pe=d._buffer.getItems();Se(Ne||0,ae),Ae?Ae.call(r,Pe,ae):d._sender(Pe,ae)}o=+new Date}clearTimeout(a),a=null,i=null}catch(it){var Xe=Cd();(!Xe||Xe>9)&&d.diagLog().throwInternal(Le.CRITICAL,Fe.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Mt(it),{exception:yt(it)})}},d._onError=function(ae,Ae,Ne){d.diagLog().throwInternal(Le.WARNING,Fe.OnError,"Failed to send telemetry.",{message:Ae}),d._buffer.clearSent(ae)},d._onPartialSuccess=function(ae,Ae){for(var Ne=[],Pe=[],Xe=Ae.errors.reverse(),it=0,ft=Xe;it<ft.length;it++){var Tt=ft[it],Ht=ae.splice(Tt.index,1)[0];re(Tt.statusCode)?Pe.push(Ht):Ne.push(Ht)}ae.length>0&&d._onSuccess(ae,Ae.itemsAccepted),Ne.length>0&&d._onError(Ne,K(null,["partial success",Ae.itemsAccepted,"of",Ae.itemsReceived].join(" "))),Pe.length>0&&(I(Pe),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,"Partial success. Delivered: "+ae.length+", Failed: "+Ne.length+". Will retry to send "+Pe.length+" our of "+Ae.itemsReceived+" items"))},d._onSuccess=function(ae,Ae){d._buffer.clearSent(ae)},d._xdrOnLoad=function(ae,Ae){var Ne=Nl(ae);if(ae&&(Ne+""=="200"||Ne===""))n=0,d._onSuccess(Ae,0);else{var Pe=k(Ne);Pe&&Pe.itemsReceived&&Pe.itemsReceived>Pe.itemsAccepted&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Ae,Pe):d._onError(Ae,ie(ae))}};function g(ae){return d._sample.isSampledIn(ae)}l(g,"I");function _(ae,Ae,Ne,Pe,Xe,it){var ft=null;if(d._appId||(ft=k(it),ft&&ft.appId&&(d._appId=ft.appId)),(ae<200||ae>=300)&&ae!==0){if((ae===301||ae===307||ae===308)&&!v(Ne)){d._onError(Ae,Xe);return}!d._senderConfig.isRetryDisabled()&&re(ae)?(I(Ae),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Response code "+ae+". Will retry to send "+Ae.length+" items.")):d._onError(Ae,Xe)}else if(Fh.isOffline()){if(!d._senderConfig.isRetryDisabled()){var Tt=10;I(Ae,Tt),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Offline - Response Code: "+ae+". Offline status: "+Fh.isOffline()+". Will retry to send "+Ae.length+" items.")}}else v(Ne),ae===206?(ft||(ft=k(it)),ft&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Ae,ft):d._onError(Ae,Xe)):(n=0,d._onSuccess(Ae,Pe))}l(_,"E");function v(ae){return c>=10?!1:!Oe(ae)&&ae!==""&&ae!==d._senderConfig.endpointUrl()?(d._senderConfig.endpointUrl=function(){return ae},++c,!0):!1}l(v,"b");function y(ae,Ae){var Ne=d._senderConfig.endpointUrl(),Pe=d._buffer.batchPayloads(ae),Xe=new Blob([Pe],{type:"text/plain;charset=UTF-8"}),it=Hn().sendBeacon(Ne,Xe);it?(d._buffer.markAsSent(ae),d._onSuccess(ae,ae.length)):(x(ae,!0),d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}l(y,"p");function x(ae,Ae){var Ne=new XMLHttpRequest,Pe=d._senderConfig.endpointUrl();try{Ne[xo]=!0}catch(it){}Ne.open("POST",Pe,Ae),Ne.setRequestHeader("Content-type","application/json"),Sl(Pe)&&Ne.setRequestHeader(Qt.sdkContextHeader,Qt.sdkContextHeaderAppIdRequest),Ct(go(u),function(it){Ne.setRequestHeader(it,u[it])}),Ne.onreadystatechange=function(){return d._xhrReadyStateChange(Ne,ae,ae.length)},Ne.onerror=function(it){return d._onError(ae,K(Ne),it)};var Xe=d._buffer.batchPayloads(ae);Ne.send(Xe),d._buffer.markAsSent(ae)}l(x,"v");function C(ae,Ae){var Ne=d._senderConfig.endpointUrl(),Pe=d._buffer.batchPayloads(ae),Xe=new Blob([Pe],{type:"text/plain;charset=UTF-8"}),it=new Headers;Sl(Ne)&&it.append(Qt.sdkContextHeader,Qt.sdkContextHeaderAppIdRequest),Ct(go(u),function(Ht){it.append(Ht,u[Ht])});var ft={method:"POST",headers:it,body:Xe},Tt=new Request(Ne,ft);fetch(Tt).then(function(Ht){if(Ht.ok)Ht.text().then(function(vn){_(Ht.status,ae,Ht.url,ae.length,Ht.statusText,vn)}),d._buffer.markAsSent(ae);else throw Error(Ht.statusText)}).catch(function(Ht){d._onError(ae,Ht.message)})}l(C,"y");function k(ae){try{if(ae&&ae!==""){var Ae=Sn().parse(ae);if(Ae&&Ae.itemsReceived&&Ae.itemsReceived>=Ae.itemsAccepted&&Ae.itemsReceived-Ae.itemsAccepted===Ae.errors.length)return Ae}}catch(Ne){d.diagLog().throwInternal(Le.CRITICAL,Fe.InvalidBackendResponse,"Cannot parse the response. "+Mt(Ne),{response:ae})}return null}l(k,"w");function I(ae,Ae){if(Ae===void 0&&(Ae=1),!(!ae||ae.length===0)){d._buffer.clearSent(ae),n++;for(var Ne=0,Pe=ae;Ne<Pe.length;Ne++){var Xe=Pe[Ne];d._buffer.enqueue(Xe)}B(Ae),J()}}l(I,"L");function B(ae){var Ae=10,Ne;if(n<=1)Ne=Ae;else{var Pe=(Math.pow(2,n)-1)/2,Xe=Math.floor(Math.random()*Pe*Ae)+1;Xe=ae*Xe,Ne=Math.max(Math.min(Xe,3600),Ae)}var it=sn()+Ne*1e3;i=it}l(B,"F");function J(){if(!a){var ae=i?Math.max(0,i-sn()):0,Ae=Math.max(d._senderConfig.maxBatchInterval(),ae);a=setTimeout(function(){d.triggerSend(!0,null,1)},Ae)}}l(J,"Y");function re(ae){return ae===408||ae===429||ae===500||ae===503}l(re,"Se");function K(ae,Ae){return ae?"XMLHttpRequest,Status:"+ae.status+",Response:"+Nl(ae)||0||0:Ae}l(K,"X");function we(ae,Ae){var Ne=bs(),Pe=new XDomainRequest;Pe.onload=function(){return d._xdrOnLoad(Pe,ae)},Pe.onerror=function(Tt){return d._onError(ae,ie(Pe),Tt)};var Xe=Ne&&Ne.location&&Ne.location.protocol||"";if(d._senderConfig.endpointUrl().lastIndexOf(Xe,0)!==0){d.diagLog().throwInternal(Le.WARNING,Fe.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),d._buffer.clear();return}var it=d._senderConfig.endpointUrl().replace(/^(https?:)/,"");Pe.open("POST",it);var ft=d._buffer.batchPayloads(ae);Pe.send(ft),d._buffer.markAsSent(ae)}l(we,"me");function ie(ae,Ae){return ae?"XDomainRequest,Response:"+Nl(ae)||0:Ae}l(ie,"De");function pe(){var ae="getNotifyMgr";return d.core[ae]?d.core[ae]():d.core._notificationManager}l(pe,"pt");function Se(ae,Ae){var Ne=pe();if(Ne&&Ne.eventsSendRequest)try{Ne.eventsSendRequest(ae,Ae)}catch(Pe){d.diagLog().throwInternal(Le.CRITICAL,Fe.NotificationException,"send request notification failed: "+Mt(Pe),{exception:yt(Pe)})}}l(Se,"at");function Je(ae){var Ae=Oe(ae.disableInstrumentationKeyValidation)?!1:ae.disableInstrumentationKeyValidation;if(Ae)return!0;var Ne="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",Pe=new RegExp(Ne);return Pe.test(ae.instrumentationKey)}l(Je,"dt")}),r}return l(e,"e"),e.constructEnvelope=function(r,n,i){var o;switch(n!==r.iKey&&!Oe(n)?o=ea({},r,{iKey:n}):o=r,o.baseType){case An.dataType:return Dh.EventEnvelopeCreator.Create(i,o);case wi.dataType:return Xm.TraceEnvelopeCreator.Create(i,o);case Tn.dataType:return Qm.PageViewEnvelopeCreator.Create(i,o);case yi.dataType:return Zm.PageViewPerformanceEnvelopeCreator.Create(i,o);case Vr.dataType:return Gm.ExceptionEnvelopeCreator.Create(i,o);case zn.dataType:return Km.MetricEnvelopeCreator.Create(i,o);case qn.dataType:return Vm.DependencyEnvelopeCreator.Create(i,o);default:return Dh.EventEnvelopeCreator.Create(i,o)}},e._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},e._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},e}(yo)}),nv=Te(()=>{Q_()}),iv,Nh,ov,Z_=Te(()=>{Sr(),mr(),At(),iv="ai_session",Nh=function(){function t(){}return l(t,"t"),t}(),ov=function(){function t(e,r){var n=this,i,o,a=ol(r),s=Bd(r);lr(t,n,function(c){e||(e={}),Dt(e.sessionExpirationMs)||(e.sessionExpirationMs=function(){return t.acquisitionSpan}),Dt(e.sessionRenewalMs)||(e.sessionRenewalMs=function(){return t.renewalSpan}),c.config=e;var u=c.config.sessionCookiePostfix&&c.config.sessionCookiePostfix()?c.config.sessionCookiePostfix():c.config.namePrefix&&c.config.namePrefix()?c.config.namePrefix():"";i=l(function(){return iv+u},"i"),c.automaticSession=new Nh,c.update=function(){var v=sn(),y=!1,x=c.automaticSession;x.id||(y=!d(x,v));var C=c.config.sessionExpirationMs();if(!y&&C>0){var k=c.config.sessionRenewalMs(),I=v-x.acquisitionDate,B=v-x.renewalDate;y=I<0||B<0,y=y||I>C,y=y||B>k}y?p(v):(!o||v-o>t.cookieUpdateInterval)&&g(x,v)},c.backup=function(){var v=c.automaticSession;_(v.id,v.acquisitionDate,v.renewalDate)};function d(v,y){var x=!1,C=s.get(i());if(C&&Dt(C.split))x=f(v,C);else{var k=rm(a,i());k&&(x=f(v,k))}return x||!!v.id}l(d,"l");function f(v,y){var x=!1,C=", session will be reset",k=y.split("|");if(k.length>=2)try{var I=+k[1]||0,B=+k[2]||0;isNaN(I)||I<=0?a.throwInternal(Le.WARNING,Fe.SessionRenewalDateIsZero,"AI session acquisition date is 0"+C):isNaN(B)||B<=0?a.throwInternal(Le.WARNING,Fe.SessionRenewalDateIsZero,"AI session renewal date is 0"+C):k[0]&&(v.id=k[0],v.acquisitionDate=I,v.renewalDate=B,x=!0)}catch(J){a.throwInternal(Le.CRITICAL,Fe.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(y||"")+"]"+C+" - "+Mt(J),{exception:yt(J)})}return x}l(f,"f");function p(v){var y=c.config||{},x=(y.getNewId?y.getNewId():null)||gl;c.automaticSession.id=x(y.idLength?y.idLength():22),c.automaticSession.acquisitionDate=v,g(c.automaticSession,v),uh()||a.throwInternal(Le.WARNING,Fe.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}l(p,"m");function g(v,y){var x=v.acquisitionDate;v.renewalDate=y;var C=c.config,k=C.sessionRenewalMs(),I=x+C.sessionExpirationMs()-y,B=[v.id,x,y],J=0;I<k?J=I/1e3:J=k/1e3;var re=C.cookieDomain?C.cookieDomain():null;s.set(i(),B.join("|"),C.sessionExpirationMs()>0?J:null,re),o=y}l(g,"I");function _(v,y,x){nm(a,i(),[v,y,x].join("|"))}l(_,"E")})}return l(t,"t"),t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}()}),av,X_=Te(()=>{av=function(){function t(){}return l(t,"t"),t}()}),sv,Y_=Te(()=>{sv=function(){function t(){this.id="browser",this.deviceClass="Browser"}return l(t,"t"),t}()}),cv,lv,J_=Te(()=>{cv="2.6.4",lv=function(){function t(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+cv}return l(t,"t"),t}()});function uv(t){return!(typeof t!="string"||!t||t.match(/,|;|=| |\|/))}l(uv,"zc");var dv,ex=Te(()=>{Sr(),mr(),At(),dv=function(){function t(e,r){this.isNewUser=!1;var n=ol(r),i=Bd(r),o;lr(t,this,function(a){a.config=e;var s=a.config.userCookiePostfix&&a.config.userCookiePostfix()?a.config.userCookiePostfix():"";o=l(function(){return t.userCookieName+s},"a");var c=i.get(o());if(c){a.isNewUser=!1;var u=c.split(t.cookieSeparator);u.length>0&&(a.id=u[0])}if(!a.id){var d=e||{},f=(d.getNewId?d.getNewId():null)||gl;a.id=f(d.idLength?e.idLength():22);var p=31536e3,g=Bi(new Date);a.accountAcquisitionDate=g,a.isNewUser=!0;var _=[a.id,g];i.set(o(),_.join(t.cookieSeparator),p);var v=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";im(n,v)}a.accountId=e.accountId?e.accountId():void 0;var y=i.get(t.authUserCookieName);if(y){y=decodeURI(y);var x=y.split(t.cookieSeparator);x[0]&&(a.authenticatedId=x[0]),x.length>1&&x[1]&&(a.accountId=x[1])}a.setAuthenticatedUserContext=function(C,k,I){I===void 0&&(I=!1);var B=!uv(C)||k&&!uv(k);if(B){n.throwInternal(Le.WARNING,Fe.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a.authenticatedId=C;var J=a.authenticatedId;k&&(a.accountId=k,J=[a.authenticatedId,a.accountId].join(t.cookieSeparator)),I&&i.set(t.authUserCookieName,encodeURI(J))},a.clearAuthenticatedUserContext=function(){a.authenticatedId=null,a.accountId=null,i.del(t.authUserCookieName)}})}return l(t,"t"),t.cookieSeparator="|",t.userCookieName="ai_user",t.authUserCookieName="ai_authUser",t}()}),hv,tx=Te(()=>{hv=function(){function t(){}return l(t,"t"),t}()}),fv,rx=Te(()=>{mr(),At(),fv=function(){function t(e,r,n,i){var o=this;o.traceID=e||Wn(),o.parentID=r,o.name=n;var a=mo();!n&&a&&a.pathname&&(o.name=a.pathname),o.name=qr(i,o.name)}return l(t,"t"),t}()});function ba(t,e){t&&t[e]&&go(t[e]).length===0&&delete t[e]}l(ba,"Or");var Ns,$s,pv,nx=Te(()=>{Sr(),At(),Z_(),mr(),X_(),Y_(),J_(),ex(),tx(),rx(),Ns="ext",$s="tags",pv=function(){function t(e,r){var n=this,i=e.logger;this.appId=function(){return null},lr(t,this,function(o){o.application=new av,o.internal=new lv(r),Jc()&&(o.sessionManager=new ov(r,e),o.device=new sv,o.location=new hv,o.user=new dv(r,e),o.telemetryTrace=new fv(void 0,void 0,void 0,i),o.session=new Nh),o.applySessionContext=function(a,s){var c=o.session,u=o.sessionManager;c&&St(c.id)?Ft(Fr(a.ext,Gr.AppExt),"sesId",c.id):u&&u.automaticSession&&Ft(Fr(a.ext,Gr.AppExt),"sesId",u.automaticSession.id,St)},o.applyOperatingSystemContxt=function(a,s){Ft(a.ext,Gr.OSExt,o.os)},o.applyApplicationContext=function(a,s){var c=o.application;if(c){var u=Fr(a,$s);Ft(u,jt.applicationVersion,c.ver,St),Ft(u,jt.applicationBuild,c.build,St)}},o.applyDeviceContext=function(a,s){var c=o.device;if(c){var u=Fr(Fr(a,Ns),Gr.DeviceExt);Ft(u,"localId",c.id,St),Ft(u,"ip",c.ip,St),Ft(u,"model",c.model,St),Ft(u,"deviceClass",c.deviceClass,St)}},o.applyInternalContext=function(a,s){var c=o.internal;if(c){var u=Fr(a,$s);Ft(u,jt.internalAgentVersion,c.agentVersion,St),Ft(u,jt.internalSdkVersion,c.sdkVersion,St),(a.baseType===oa.dataType||a.baseType===Tn.dataType)&&(Ft(u,jt.internalSnippet,c.snippetVer,St),Ft(u,jt.internalSdkSrc,c.sdkSrc,St))}},o.applyLocationContext=function(a,s){var c=n.location;c&&Ft(Fr(a,$s,[]),jt.locationIp,c.ip,St)},o.applyOperationContext=function(a,s){var c=o.telemetryTrace;if(c){var u=Fr(Fr(a,Ns),Gr.TraceExt,{traceID:void 0,parentID:void 0});Ft(u,"traceID",c.traceID,St),Ft(u,"name",c.name,St),Ft(u,"parentID",c.parentID,St)}},o.applyWebContext=function(a,s){var c=n.web;c&&Ft(Fr(a,Ns),Gr.WebExt,c)},o.applyUserContext=function(a,s){var c=o.user;if(c){var u=Fr(a,$s,[]);Ft(u,jt.userAccountId,c.accountId,St);var d=Fr(Fr(a,Ns),Gr.UserExt);Ft(d,"id",c.id,St),Ft(d,"authId",c.authenticatedId,St)}},o.cleanUp=function(a,s){var c=a.ext;c&&(ba(c,Gr.DeviceExt),ba(c,Gr.UserExt),ba(c,Gr.WebExt),ba(c,Gr.OSExt),ba(c,Gr.AppExt),ba(c,Gr.TraceExt))}})}return l(t,"t"),t}()}),gv,$h,ix=Te(()=>{qt(),Sr(),At(),nx(),mr(),gv=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.priority=110,r.identifier=ya;var n,i;return lr(e,r,function(o,a){o.initialize=function(c,u,d,f){a.initialize(c,u,d,f);var p=o._getTelCtx(),g=o.identifier,_=e.getDefaultConfig();i=i||{},gr(_,function(v,y){i[v]=function(){return p.getConfig(g,v,y())}}),o.context=new pv(u,i),n=Yg(d,Dl),o.context.appId=function(){return n?n._appId:null},o._extConfig=i},o.processTelemetry=function(c,u){if(!Oe(c)){u=o._getTelCtx(u),c.name===Tn.envelopeType&&u.diagLog().resetInternalMessageCount();var d=o.context||{};if(d.session&&typeof o.context.session.id!="string"&&d.sessionManager&&d.sessionManager.update(),s(c,u),d.user&&d.user.isNewUser){d.user.isNewUser=!1;var f=new oa(Fe.SendBrowserInfoOnUserInit,(Hn()||{}).userAgent||"");u.diagLog().logInternalMessage(Le.CRITICAL,f)}o.processNext(c,u)}};function s(c,u){Fr(c,"tags",[]),Fr(c,"ext",{});var d=o.context;d.applySessionContext(c,u),d.applyApplicationContext(c,u),d.applyDeviceContext(c,u),d.applyOperationContext(c,u),d.applyUserContext(c,u),d.applyOperatingSystemContxt(c,u),d.applyWebContext(c,u),d.applyLocationContext(c,u),d.applyInternalContext(c,u),d.cleanUp(c,u)}l(s,"c")}),r}return l(e,"e"),e.getDefaultConfig=function(){var r={instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 30*60*1e3},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 24*60*60*1e3},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}};return r},e}(yo),$h=gv}),mv=Te(()=>{ix()});function vv(t,e,r){var n=0,i=t[e],o=t[r];return i&&o&&(n=jr(i,o)),n}l(vv,"$c");function Ro(t,e,r,n,i){var o=0,a=vv(r,n,i);return a&&(o=ji(t,e,vi(a))),o}l(Ro,"xr");function ji(t,e,r){var n="ajaxPerf",i=0;if(t&&e&&r){var o=t[n]=t[n]||{};o[e]=r,i=1}return i}l(ji,"tr");function ox(t,e){var r=t.perfTiming,n=e[Zr]||{},i=0,o="name",a="Start",s="End",c="domainLookup",u="connect",d="redirect",f="request",p="response",g="duration",_="startTime",v=c+a,y=c+s,x=u+a,C=u+s,k=f+a,I=f+s,B=p+a,J=p+s,re=d+a,K=d=s,we="transferSize",ie="encodedBodySize",pe="decodedBodySize",Se="serverTiming";if(r){i|=Ro(n,d,r,re,K),i|=Ro(n,c,r,v,y),i|=Ro(n,u,r,x,C),i|=Ro(n,f,r,k,I),i|=Ro(n,p,r,B,J),i|=Ro(n,"networkConnect",r,_,C),i|=Ro(n,"sentRequest",r,k,J);var Je=r[g];Je||(Je=vv(r,_,J)||0),i|=ji(n,g,Je),i|=ji(n,"perfTotal",Je);var ae=r[Se];if(ae){var Ae={};Ct(ae,function(Ne,Pe){var Xe=Tb(Ne[o]||""+Pe),it=Ae[Xe]||{};gr(Ne,function(ft,Tt){(ft!==o&&St(Tt)||gd(Tt))&&(it[ft]&&(Tt=it[ft]+";"+Tt),(Tt||!St(Tt))&&(it[ft]=Tt))}),Ae[Xe]=it}),i|=ji(n,Se,Ae)}i|=ji(n,we,r[we]),i|=ji(n,ie,r[ie]),i|=ji(n,pe,r[pe])}else t.perfMark&&(i|=ji(n,"missing",t.perfAttempts));i&&(e[Zr]=n)}l(ox,"vl");var Zr,wv,Mh,ax=Te(()=>{mr(),At(),Sr(),Zr="properties",wv=function(){function t(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1}return l(t,"t"),t}(),Mh=function(){function t(e,r,n){var i=this,o=n,a="responseText";i.perfMark=null,i.completed=!1,i.requestHeadersSize=null,i.requestHeaders=null,i.responseReceivingDuration=null,i.callbackDuration=null,i.ajaxTotalDuration=null,i.aborted=0,i.pageUrl=null,i.requestUrl=null,i.requestSize=0,i.method=null,i.status=null,i.requestSentTime=null,i.responseStartedTime=null,i.responseFinishedTime=null,i.callbackFinishedTime=null,i.endTime=null,i.xhrMonitoringState=new wv,i.clientFailure=0,i.traceID=e,i.spanID=r,lr(t,i,function(s){s.getAbsoluteUrl=function(){return s.requestUrl?sm(s.requestUrl):null},s.getPathName=function(){return s.requestUrl?Ts(o,cm(s.method,s.requestUrl)):null},s.CreateTrackItem=function(c,u,d){if(s.ajaxTotalDuration=Math.round(jr(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s.ajaxTotalDuration<0)return null;var f=(v={id:"|"+s.traceID+"."+s.spanID,target:s.getAbsoluteUrl(),name:s.getPathName(),type:c,startTime:null,duration:s.ajaxTotalDuration,success:+s.status>=200&&+s.status<400,responseCode:+s.status,method:s.method},v[Zr]={HttpMethod:s.method},v);if(s.requestSentTime&&(f.startTime=new Date,f.startTime.setTime(s.requestSentTime)),ox(s,f),u&&go(s.requestHeaders).length>0&&(f[Zr]=f[Zr]||{},f[Zr].requestHeaders=s.requestHeaders),d){var p=d();if(p){var g=p.correlationContext;if(g&&(f.correlationContext=g),p.headerMap&&go(p.headerMap).length>0&&(f[Zr]=f[Zr]||{},f[Zr].responseHeaders=p.headerMap),s.status>=400){var _=p.type;f[Zr]=f[Zr]||{},(_===""||_==="text")&&(f[Zr][a]=p[a]?p.statusText+" - "+p[a]:p.statusText),_==="json"&&(f[Zr][a]=p.response?p.statusText+" - "+JSON.stringify(p.response):p.statusText)}}}return f;var v}})}return l(t,"t"),t}()}),sx,cx=Te(()=>{At(),At(),sx=function(){function t(){}return l(t,"t"),t.GetLength=function(e){var r=0;if(!Oe(e)){var n="";try{n=e.toString()}catch(i){}r=n.length,r=isNaN(r)?0:r}return r},t}()}),Bh,lx=Te(()=>{At(),Bh=function(){function t(e,r){var n=this;n.traceFlag=t.DEFAULT_TRACE_FLAG,n.version=t.DEFAULT_VERSION,e&&t.isValidTraceId(e)?n.traceId=e:n.traceId=Wn(),r&&t.isValidSpanId(r)?n.spanId=r:n.spanId=Wn().substr(0,16)}return l(t,"t"),t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}()});function ux(){var t=Jo();return!t||Oe(t.Request)||Oe(t.Request[rn])||Oe(t[Sa])?null:t[Sa]}l(ux,"xl");function dx(t){var e=!1;if(typeof XMLHttpRequest!==di&&!Oe(XMLHttpRequest)){var r=XMLHttpRequest[rn];e=!Oe(r)&&!Oe(r.open)&&!Oe(r.send)&&!Oe(r.abort)}var n=Cd();if(n&&n<9&&(e=!1),e)try{var i=new XMLHttpRequest;i[Xr]={};var o=XMLHttpRequest[rn].open;XMLHttpRequest[rn].open=o}catch(a){e=!1,Ms(t,Fe.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:yt(a)})}return e}l(dx,"yl");function $l(t){var e="";try{!Oe(t)&&!Oe(t[Xr])&&!Oe(t[Xr].requestUrl)&&(e+="(url: '"+t[Xr].requestUrl+"')")}catch(r){}return e}l($l,"Ti");function Ms(t,e,r,n,i){t[xa]()[Lh](Le.CRITICAL,e,r,n,i)}l(Ms,"kn");function Ml(t,e,r,n,i){t[xa]()[Lh](Le.WARNING,e,r,n,i)}l(Ml,"Ei");function Bs(t,e,r){return function(n){Ms(t,e,r,{ajaxDiagnosticsMessage:$l(n.inst),exception:yt(n.err)})}}l(Bs,"Rn");function _a(t,e){return t&&e?t.indexOf(e):-1}l(_a,"Hr");var Uh,xa,Xr,Lh,Sa,Oh,Hh,hx=Te(()=>{qt(),mr(),At(),ax(),cx(),lx(),Sr(),Uh="ai.ajxmn.",xa="diagLog",Xr="ajaxData",Lh="throwInternal",Sa="fetch",Oh=0,Hh=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier=e.identifier,r.priority=120;var n="trackDependencyDataInternal",i=mo(),o=!1,a=!1,s=i&&i.host&&i.host.toLowerCase(),c=e.getEmptyConfig(),u=!1,d=0,f,p,g,_,v=!1,y=0,x=!1,C=[],k={},I;return lr(e,r,function(B,J){B.initialize=function(be,Me,Ge,We){if(!B.isInitialized()){J.initialize(be,Me,Ge,We);var et=B._getTelCtx(),dt=e.getDefaultConfig();gr(dt,function(Lr,Pi){c[Lr]=et.getConfig(e.identifier,Lr,Pi)});var lt=c.distributedTracingMode;if(u=c.enableRequestHeaderTracking,v=c.enableAjaxPerfTracking,y=c.maxAjaxCallsPerView,x=c.enableResponseHeaderTracking,I=c.excludeRequestFromAutoTrackingPatterns,g=lt===Rn.AI||lt===Rn.AI_AND_W3C,p=lt===Rn.AI_AND_W3C||lt===Rn.W3C,v){var kt=be.instrumentationKey||"unkwn";kt.length>5?_=Uh+kt.substring(kt.length-5)+".":_=Uh+kt+"."}if(c.disableAjaxTracking===!1&&ie(),K(),Ge.length>0&&Ge){for(var Zt=void 0,ar=0;!Zt&&ar<Ge.length;)Ge[ar]&&Ge[ar].identifier===ya&&(Zt=Ge[ar]),ar++;Zt&&(f=Zt.context)}}},B.teardown=function(){Ct(C,function(be){be.rm()}),C=[],o=!1,a=!1,B.setInitialized(!1)},B.trackDependencyData=function(be,Me){B[n](be,Me)},B.includeCorrelationHeaders=function(be,Me,Ge,We){var et=B._currentWindowHost||s;if(Me){if(Wi.canIncludeCorrelationHeader(c,be.getAbsoluteUrl(),et)){if(Ge||(Ge={}),Ge.headers=new Headers(Ge.headers||(Me instanceof Request?Me.headers||{}:{})),g){var dt="|"+be.traceID+"."+be.spanID;Ge.headers.set(Qt.requestIdHeader,dt),u&&(be.requestHeaders[Qt.requestIdHeader]=dt)}var lt=c.appId||f&&f.appId();if(lt&&(Ge.headers.set(Qt.requestContextHeader,Qt.requestContextAppIdFormat+lt),u&&(be.requestHeaders[Qt.requestContextHeader]=Qt.requestContextAppIdFormat+lt)),p){var kt=new Bh(be.traceID,be.spanID);Ge.headers.set(Qt.traceParentHeader,kt.toString()),u&&(be.requestHeaders[Qt.traceParentHeader]=kt.toString())}}return Ge}else if(We){if(Wi.canIncludeCorrelationHeader(c,be.getAbsoluteUrl(),et)){if(g){var dt="|"+be.traceID+"."+be.spanID;We.setRequestHeader(Qt.requestIdHeader,dt),u&&(be.requestHeaders[Qt.requestIdHeader]=dt)}var lt=c.appId||f&&f.appId();if(lt&&(We.setRequestHeader(Qt.requestContextHeader,Qt.requestContextAppIdFormat+lt),u&&(be.requestHeaders[Qt.requestContextHeader]=Qt.requestContextAppIdFormat+lt)),p){var kt=new Bh(be.traceID,be.spanID);We.setRequestHeader(Qt.traceParentHeader,kt.toString()),u&&(be.requestHeaders[Qt.traceParentHeader]=kt.toString())}}return We}},B[n]=function(be,Me,Ge){if(y===-1||d<y){(c.distributedTracingMode===Rn.W3C||c.distributedTracingMode===Rn.AI_AND_W3C)&&typeof be.id=="string"&&be.id[be.id.length-1]!=="."&&(be.id+="."),Oe(be.startTime)&&(be.startTime=new Date);var We=jn.create(be,qn.dataType,qn.envelopeType,B[xa](),Me,Ge);B.core.track(We)}else d===y&&Ms(B,Fe.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++d};function re(be){var Me=!0;return(be||c.ignoreHeaders)&&Ct(c.ignoreHeaders,function(Ge){if(Ge.toLowerCase()===be.toLowerCase())return Me=!1,-1}),Me}l(re,"Se");function K(){var be=ux();if(be){var Me=Jo(),Ge=be.polyfill;c.disableFetchTracking===!1?(C.push(Jd(Me,Sa,{req:function(We,et,dt){var lt;if(o&&!pe(null,et,dt)&&!(Ge&&a)){var kt=We.ctx();lt=ft(et,dt);var Zt=B.includeCorrelationHeaders(lt,et,dt);Zt!==dt&&We.set(1,Zt),kt.data=lt}},rsp:function(We,et){var dt=We.ctx().data;dt&&(We.rslt=We.rslt.then(function(lt){return Ht(We,(lt||{}).status,lt,dt,function(){var kt={statusText:lt.statusText,headerMap:null,correlationContext:vn(lt)};if(x){var Zt={};lt.headers.forEach(function(ar,Lr){re(Lr)&&(Zt[Lr]=ar)}),kt.headerMap=Zt}return kt}),lt}).catch(function(lt){throw Ht(We,0,et,dt,null,{error:lt.message}),lt}))},hkErr:Bs(B,Fe.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),o=!0):Ge&&C.push(Jd(Me,Sa,{req:function(We,et,dt){pe(null,et,dt)}})),Ge&&(Me[Sa].polyfill=Ge)}}l(K,"X");function we(be,Me,Ge){C.push(n_(be,Me,Ge))}l(we,"me");function ie(){dx(B)&&!a&&(we(XMLHttpRequest,"open",{req:function(be,Me,Ge,We){var et=be.inst,dt=et[Xr];!pe(et,Ge)&&Se(et,!0)&&(!dt||!dt.xhrMonitoringState.openDone)&&Je(et,Me,Ge,We)},hkErr:Bs(B,Fe.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),we(XMLHttpRequest,"send",{req:function(be,Me){var Ge=be.inst,We=Ge[Xr];Se(Ge)&&!We.xhrMonitoringState.sendDone&&(Xe("xhr",We),We.requestSentTime=Is(),B.includeCorrelationHeaders(We,void 0,void 0,Ge),We.xhrMonitoringState.sendDone=!0)},hkErr:Bs(B,Fe.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),we(XMLHttpRequest,"abort",{req:function(be){var Me=be.inst,Ge=Me[Xr];Se(Me)&&!Ge.xhrMonitoringState.abortDone&&(Ge.aborted=1,Ge.xhrMonitoringState.abortDone=!0)},hkErr:Bs(B,Fe.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),u&&we(XMLHttpRequest,"setRequestHeader",{req:function(be,Me,Ge){var We=be.inst;Se(We)&&re(Me)&&(We[Xr].requestHeaders[Me]=Ge)},hkErr:Bs(B,Fe.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),a=!0)}l(ie,"De");function pe(be,Me,Ge){var We=!1,et=((St(Me)?Me:(Me||{}).url||"")||"").toLowerCase();if(Ct(I,function(kt){var Zt=kt;St(kt)&&(Zt=new RegExp(kt)),We||(We=Zt.test(et))}),We)return We;var dt=_a(et,"?"),lt=_a(et,"#");return(dt===-1||lt!==-1&&lt<dt)&&(dt=lt),dt!==-1&&(et=et.substring(0,dt)),Oe(be)?Oe(Me)||(We=(typeof Me=="object"?Me[xo]===!0:!1)||(Ge?Ge[xo]===!0:!1)):We=be[xo]===!0||et[xo]===!0,We?k[et]||(k[et]=1):k[et]&&(We=!0),We}l(pe,"pt");function Se(be,Me){var Ge=!0,We=a;return Oe(be)||(Ge=Me===!0||!Oe(be[Xr])),We&&Ge}l(Se,"at");function Je(be,Me,Ge,We){var et=f&&f.telemetryTrace&&f.telemetryTrace.traceID||Wn(),dt=Wn().substr(0,16),lt=new Mh(et,dt,B[xa]());lt.method=Me,lt.requestUrl=Ge,lt.xhrMonitoringState.openDone=!0,lt.requestHeaders={},lt.async=We,be[Xr]=lt,ae(be)}l(Je,"dt");function ae(be){be[Xr].xhrMonitoringState.stateChangeAttached=As.Attach(be,"readystatechange",function(){try{be&&be.readyState===4&&Se(be)&&Ne(be)}catch(Ge){var Me=yt(Ge);(!Me||_a(Me.toLowerCase(),"c00c023f")===-1)&&Ms(B,Fe.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:$l(be),exception:Me})}})}l(ae,"d");function Ae(be){try{var Me=be.responseType;if(Me===""||Me==="text")return be.responseText}catch(Ge){}return null}l(Ae,"T");function Ne(be){var Me=be[Xr];Me.responseFinishedTime=Is(),Me.status=be.status;function Ge(We,et){var dt=et||{};dt.ajaxDiagnosticsMessage=$l(be),We&&(dt.exception=yt(We)),Ml(B,Fe.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",dt)}l(Ge,"N"),it("xmlhttprequest",Me,function(){try{var We=Me.CreateTrackItem("Ajax",u,function(){var et={statusText:be.statusText,headerMap:null,correlationContext:Pe(be),type:be.responseType,responseText:Ae(be),response:be.response};if(x){var dt=be.getAllResponseHeaders();if(dt){var lt=Rr(dt).split(/[\r\n]+/),kt={};Ct(lt,function(Zt){var ar=Zt.split(": "),Lr=ar.shift(),Pi=ar.join(": ");re(Lr)&&(kt[Lr]=Pi)}),et.headerMap=kt}}return et});We?B[n](We):Ge(null,{requestSentTime:Me.requestSentTime,responseFinishedTime:Me.responseFinishedTime})}finally{try{be[Xr]=null}catch(et){}}},function(We){Ge(We,null)})}l(Ne,"A");function Pe(be){try{var Me=be.getAllResponseHeaders();if(Me!==null){var Ge=_a(Me.toLowerCase(),Qt.requestContextHeaderLowerCase);if(Ge!==-1){var We=be.getResponseHeader(Qt.requestContextHeader);return Wi.getCorrelationContext(We)}}}catch(et){Ml(B,Fe.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:$l(be),exception:yt(et)})}}l(Pe,"D");function Xe(be,Me){if(Me.requestUrl&&_&&v){var Ge=pi();if(Ge&&Dt(Ge.mark)){Oh++;var We=_+be+"#"+Oh;Ge.mark(We);var et=Ge.getEntriesByName(We);et&&et.length===1&&(Me.perfMark=et[0])}}}l(Xe,"z");function it(be,Me,Ge,We){var et=Me.perfMark,dt=pi(),lt=c.maxAjaxPerfLookupAttempts,kt=c.ajaxPerfLookupDelay,Zt=Me.requestUrl,ar=0;l(function Lr(){try{if(dt&&et){ar++;for(var Pi=null,Du=dt.getEntries(),Va=Du.length-1;Va>=0;Va--){var wn=Du[Va];if(wn){if(wn.entryType==="resource")wn.initiatorType===be&&(_a(wn.name,Zt)!==-1||_a(Zt,wn.name)!==-1)&&(Pi=wn);else if(wn.entryType==="mark"&&wn.name===et.name){Me.perfTiming=Pi;break}if(wn.startTime<et.startTime-1e3)break}}}!et||Me.perfTiming||ar>=lt||Me.async===!1?(et&&Dt(dt.clearMarks)&&dt.clearMarks(et.name),Me.perfAttempts=ar,Ge()):setTimeout(Lr,kt)}catch(Ep){We(Ep)}},"We")()}l(it,"U");function ft(be,Me){var Ge=f&&f.telemetryTrace&&f.telemetryTrace.traceID||Wn(),We=Wn().substr(0,16),et=new Mh(Ge,We,B[xa]());et.requestSentTime=Is(),be instanceof Request?et.requestUrl=be?be.url:"":et.requestUrl=be;var dt="GET";Me&&Me.method?dt=Me.method:be&&be instanceof Request&&(dt=be.method),et.method=dt;var lt={};if(u){var kt=new Headers((Me?Me.headers:0)||(be instanceof Request?be.headers||{}:{}));kt.forEach(function(Zt,ar){re(ar)&&(lt[ar]=Zt)})}return et.requestHeaders=lt,Xe("fetch",et),et}l(ft,"q");function Tt(be){var Me="";try{Oe(be)||(typeof be=="string"?Me+="(url: '"+be+"')":Me+="(url: '"+be.url+"')")}catch(Ge){Ms(B,Fe.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:yt(Ge)})}return Me}l(Tt,"$");function Ht(be,Me,Ge,We,et,dt){if(!We)return;function lt(kt,Zt,ar){var Lr=ar||{};Lr.fetchDiagnosticsMessage=Tt(Ge),Zt&&(Lr.exception=yt(Zt)),Ml(B,kt,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",Lr)}l(lt,"B"),We.responseFinishedTime=Is(),We.status=Me,it("fetch",We,function(){var kt=We.CreateTrackItem("Fetch",u,et);kt?B[n](kt):lt(Fe.FailedMonitorAjaxDur,null,{requestSentTime:We.requestSentTime,responseFinishedTime:We.responseFinishedTime})},function(kt){lt(Fe.FailedMonitorAjaxGetCorrelationHeader,kt,null)})}l(Ht,"ie");function vn(be){if(be&&be.headers)try{var Me=be.headers.get(Qt.requestContextHeader);return Wi.getCorrelationContext(Me)}catch(Ge){Ml(B,Fe.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:Tt(be),exception:yt(Ge)})}}l(vn,"Ht")}),r}return l(e,"e"),e.getDefaultConfig=function(){var r={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:Rn.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]};return r},e.getEmptyConfig=function(){var r=this.getDefaultConfig();return gr(r,function(n){r[n]=void 0}),r},e.prototype.processTelemetry=function(r,n){this.processNext(r,n)},e.identifier="AjaxDependencyPlugin",e}(yo)}),yv=Te(()=>{hx()}),Wh,zh,bv,_v,qh,xv=Te(()=>{At(),zm(),nv(),mv(),yv(),mr(),zh=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],bv={Default:0,Required:1,Array:2,Hidden:4},_v={__proto__:null,PropertiesPluginIdentifier:ya,BreezeChannelIdentifier:Dl,AnalyticsPluginIdentifier:Rh,Util:ph,CorrelationIdHelper:Wi,UrlHelper:fm,DateTimeUtils:pm,ConnectionStringParser:ym,FieldType:bv,RequestHeaders:Qt,DisabledPropertyName:xo,ProcessLegacy:pa,SampleRate:wl,HttpMethod:yl,DEFAULT_BREEZE_ENDPOINT:sh,AIData:mh,AIBase:gh,Envelope:vh,Event:An,Exception:Vr,Metric:zn,PageView:Tn,PageViewData:Tl,RemoteDependencyData:qn,Trace:wi,PageViewPerformance:yi,Data:bi,SeverityLevel:Ds,ConfigurationManager:Bm,ContextTagKeys:Il,DataSanitizer:Zg,TelemetryItemCreator:jn,CtxTagKeys:jt,Extensions:Gr,DistributedTracingModes:Rn},qh=function(){function t(e){var r=this;r._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var n=e.config||{};if(n.connectionString){var i=mm(n.connectionString),o=i.ingestionendpoint;n.endpointUrl=o?o+"/v2/track":n.endpointUrl,n.instrumentationKey=i.instrumentationkey||n.instrumentationKey}r.appInsights=new Th,r.properties=new $h,r.dependencies=new Hh,r.core=new Kd,r._sender=new Ph,r.snippet=e,r.config=n,r.getSKUDefaults()}return l(t,"t"),t.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},t.prototype.trackEvent=function(e,r){this.appInsights.trackEvent(e,r)},t.prototype.trackPageView=function(e){var r=e||{};this.appInsights.trackPageView(r)},t.prototype.trackPageViewPerformance=function(e){var r=e||{};this.appInsights.trackPageViewPerformance(r)},t.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},t.prototype._onerror=function(e){this.appInsights._onerror(e)},t.prototype.trackTrace=function(e,r){this.appInsights.trackTrace(e,r)},t.prototype.trackMetric=function(e,r){this.appInsights.trackMetric(e,r)},t.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsights.stopTrackPage(e,r,n,i)},t.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsights.stopTrackEvent(e,r,n)},t.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){n===void 0&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},t.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},t.prototype.flush=function(e){var r=this;e===void 0&&(e=!0),aa(this.core,function(){return"AISKU.flush"},function(){Ct(r.core.getTransmissionControls(),function(n){Ct(n,function(i){i.flush(e)})})},null,e)},t.prototype.onunloadFlush=function(e){e===void 0&&(e=!0),Ct(this.core.getTransmissionControls(),function(r){Ct(r,function(n){n.onunloadFlush?n.onunloadFlush():n.flush(e)})})},t.prototype.loadAppInsights=function(e,r,n){var i=this;e===void 0&&(e=!1);var o=this;function a(s){if(s){var c="";Oe(o._snippetVersion)||(c+=o._snippetVersion),e&&(c+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=c||"-"),gr(o,function(u,d){St(u)&&!Dt(d)&&u&&u[0]!=="_"&&zh.indexOf(u)===-1&&(s[u]=d)})}}return l(a,"o"),e&&o.config.extensions&&o.config.extensions.length>0&&Ln("Extensions not allowed in legacy mode"),aa(o.core,function(){return"AISKU.loadAppInsights"},function(){var s=[];s.push(o._sender),s.push(o.properties),s.push(o.dependencies),s.push(o.appInsights),o.core.initialize(o.config,s,r,n),o.context=o.properties.context,Wh&&o.context&&(o.context.internal.sdkSrc=Wh),a(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(i)}),o},t.prototype.updateSnippetDefinitions=function(e){Jp(e,this,function(r){return r&&zh.indexOf(r)===-1})},t.prototype.emptyQueue=function(){var e=this;try{if(fi(e.snippet.queue)){for(var r=e.snippet.queue.length,n=0;n<r;n++){var i=e.snippet.queue[n];i()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(a){var o={};a&&Dt(a.toString)&&(o.exception=a.toString())}},t.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},t.prototype.addHousekeepingBeforeUnload=function(e){if(Jc()||rg()){var r=l(function(){e.onunloadFlush(!1),Ct(e.appInsights.core._extensions,function(i){if(i.identifier===ya)return i&&i.context&&i.context._sessionManager&&i.context._sessionManager.backup(),-1})},"r");if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=_o("beforeunload",r);n=_o("unload",r)||n,n=_o("pagehide",r)||n,n=_o("visibilitychange",r)||n,!n&&!Lb()&&e.appInsights.core.logger.throwInternal(Le.CRITICAL,Fe.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(_o("pagehide",r),_o("visibilitychange",r))}},t.prototype.getSender=function(){return this._sender},t.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},t}(),function(){var t=null,e=!1,r=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(t=n.src)}catch(s){}if(t)try{var i=t.toLowerCase();if(i){for(var o="",a=0;a<r.length;a++)if(i.indexOf(r[a])!==-1){o="cdn"+(a+1),i.indexOf("/scripts/")===-1&&(i.indexOf("/next/")!==-1?o+="-next":i.indexOf("/beta/")!==-1&&(o+="-beta")),Wh=o+(e?".mod":"");break}}}catch(s){}}()}),Sv,Cv,fx=Te(()=>{mr(),At(),Sv=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],Cv=function(){function t(e,r){this._hasLegacyInitializers=!1,this._queue=[],this.config=t.getDefaultConfig(e.config),this.appInsightsNew=r,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return l(t,"t"),t.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=30*60*1e3,e.sessionExpirationMs=24*60*60*1e3,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Ot(e.enableDebug),e.disableExceptionTracking=Ot(e.disableExceptionTracking),e.disableTelemetry=Ot(e.disableTelemetry),e.verboseLogging=Ot(e.verboseLogging),e.emitLineDelimitedJson=Ot(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Ot(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Ot(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Ot(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Ot(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Ot(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Ot(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Ot(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Ot(e.isRetryDisabled),e.isCookieUseDisabled=Ot(e.isCookieUseDisabled),e.isStorageUseDisabled=Ot(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ot(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Ot(e.enableCorsCorrelation),e},t.prototype.addTelemetryInitializers=function(e){var r=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(n){r._processLegacyInitializers(n)}),this._hasLegacyInitializers=!0),this._queue.push(e)},t.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},t.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsightsNew.stopTrackPage(e,r,n)},t.prototype.trackPageView=function(e,r,n,i,o){var a={name:e,uri:r,properties:n,measurements:i};this.appInsightsNew.trackPageView(a)},t.prototype.trackEvent=function(e,r,n){this.appInsightsNew.trackEvent({name:e})},t.prototype.trackDependency=function(e,r,n,i,o,a,s){this.appInsightsNew.trackDependencyData({id:e,target:n,type:i,duration:o,properties:{HttpMethod:r},success:a,responseCode:s})},t.prototype.trackException=function(e,r,n,i,o){this.appInsightsNew.trackException({exception:e})},t.prototype.trackMetric=function(e,r,n,i,o,a){this.appInsightsNew.trackMetric({name:e,average:r,sampleCount:n,min:i,max:o})},t.prototype.trackTrace=function(e,r,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},t.prototype.flush=function(e){this.appInsightsNew.flush(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},t.prototype._onerror=function(e,r,n,i,o){this.appInsightsNew._onerror({message:e,url:r,lineNumber:n,columnNumber:i,error:o})},t.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsightsNew.stopTrackEvent(e,r,n)},t.prototype.downloadAndSetup=function(e){Ln("downloadAndSetup not implemented in web SKU")},t.prototype.updateSnippetDefinitions=function(e){Jp(e,this,function(r){return r&&Sv.indexOf(r)===-1})},t.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var r=this.trackPageView;this.trackPageView=function(o,a,s){r.apply(e,[null,o,a,s])}}var n="logPageView";typeof this.snippet[n]=="function"&&(this[n]=function(o,a,s){e.trackPageView(null,o,a,s)});var i="logEvent";return typeof this.snippet[i]=="function"&&(this[i]=function(o,a,s){e.trackEvent(o,a,s)}),this},t.prototype._processLegacyInitializers=function(e){return e.tags[pa]=this._queue,e},t}()}),Ev,px=Te(()=>{fx(),xv(),At(),Ev=function(){function t(){}return l(t,"t"),t.getAppInsights=function(e,r){var n=new qh(e),i=r!==2;if(da(),r===2)return n.updateSnippetDefinitions(e),n.loadAppInsights(i),n;var o=new Cv(e,n);return o.updateSnippetDefinitions(e),n.loadAppInsights(i),o},t}()}),Rv={};pb(Rv,{AppInsightsCore:()=>Kd,ApplicationAnalytics:()=>Th,ApplicationInsights:()=>qh,ApplicationInsightsContainer:()=>Ev,BaseCore:()=>Vd,BaseTelemetryPlugin:()=>yo,CoreUtils:()=>ml,DependenciesPlugin:()=>Hh,DistributedTracingModes:()=>Rn,Event:()=>An,Exception:()=>Vr,LoggingSeverity:()=>Le,Metric:()=>zn,NotificationManager:()=>Gd,PageView:()=>Tn,PageViewPerformance:()=>yi,PerfEvent:()=>sa,PerfManager:()=>kd,PropertiesPlugin:()=>$h,RemoteDependencyData:()=>qn,Sender:()=>Ph,SeverityLevel:()=>Ds,Telemetry:()=>_v,Trace:()=>wi,Util:()=>ph,_InternalMessageId:()=>Fe,doPerf:()=>aa});var gx=Te(()=>{xv(),px(),At(),mr(),nv(),zm(),mv(),yv()}),un;(function(t){t.ON="on",t.ERROR="error",t.OFF="off"})(un||(un={}));function jh(){let t="telemetry",e="enableTelemetry";return h.env.isTelemetryEnabled!==void 0?h.env.isTelemetryEnabled?un.ON:un.OFF:h.workspace.getConfiguration(t).get(e)?un.ON:un.OFF}l(jh,"jr");var mx=l(class{constructor(t,e,r,n,i){this.extensionId=t,this.extensionVersion=e,this.telemetryAppender=r,this.osShim=n,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!i,this.updateUserOptStatus(),h.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(h.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let t=jh();this.userOptIn=t===un.ON,this.errorOptIn=t===un.ERROR||t===un.ON,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(t){if(!t)return"none";let e="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(r=>{t.indexOf(`${r}+`)===0&&(e=r)}),e}get extension(){return this._extension===void 0&&(this._extension=h.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,e){if(t===null||typeof t!="object"||typeof e!="function")return t;let r={};for(let n in t)r[n]=e(n,t[n]);return r}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?this.cleanRemoteName(h.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===h.ExtensionKind.Workspace||h.env.uiKind===h.UIKind.Web):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,h&&h.env){switch(t["common.vscodemachineid"]=h.env.machineId,t["common.vscodesessionid"]=h.env.sessionId,t["common.vscodeversion"]=h.version,t["common.isnewappinstall"]=h.env.isNewAppInstall?h.env.isNewAppInstall.toString():"false",t["common.product"]=h.env.appHost,h.env.uiKind){case h.UIKind.Web:t["common.uikind"]="web";break;case h.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(h.env.remoteName)}return t}anonymizeFilePaths(t,e){let r;if(t==null)return"";let n=[];h.env.appRoot!==""&&n.push(new RegExp(h.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(e){let o=[];for(let u of n)for(;(r=u.exec(t))&&r;)o.push([r.index,u.lastIndex]);let a=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,c=0;for(i="";(r=s.exec(t))&&r;)r[0]&&!a.test(r[0])&&o.every(([u,d])=>r.index<u||r.index>=d)&&(i+=t.substring(c,r.index)+"<REDACTED: user-file-path>",c=s.lastIndex);c<t.length&&(i+=t.substr(c))}for(let o of n)i=i.replace(o,"");return i}removePropertiesWithPossibleUserInfo(t){if(typeof t!="object")return;let e=Object.create(null);for(let r of Object.keys(t)){let n=t[r];if(!n)continue;let i=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(n.toLowerCase())?e[r]="<REDACTED: secret>":i.test(n)?e[r]="<REDACTED: email>":e[r]=n}return e}sendTelemetryEvent(t,e,r){if(this.userOptIn&&t!==""){e={...e,...this.getCommonProperties()};let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}sendTelemetryErrorEvent(t,e,r,n){if(this.errorOptIn&&t!==""){e={...e,...this.getCommonProperties()};let i=this.cloneAndChange(e,(o,a)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(a,this.firstParty):n===void 0||n.indexOf(o)!==-1?"REDACTED":this.anonymizeFilePaths(a,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:r})}}sendTelemetryException(t,e,r){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&t){e={...e,...this.getCommonProperties()};let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));t.stack&&(t.stack=this.anonymizeFilePaths(t.stack,this.firstParty)),this.telemetryAppender.logException(t,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(t=>t.dispose()))}},"bi"),vx=l(class{constructor(t){this._key=t,this._isInstantiated=!1,jh()!==un.OFF&&this.instantiateAppender()}logEvent(t,e){!this._aiClient||this._aiClient.trackEvent({name:t},{...e.properties,...e.measurements})}logException(t,e){!this._aiClient||this._aiClient.trackException({exception:t,properties:{...e.properties,...e.measurements}})}flush(){return this._aiClient&&(this._aiClient.flush(),this._aiClient=void 0),Promise.resolve(void 0)}instantiateAppender(){this._isInstantiated||Promise.resolve().then(()=>(gx(),Rv)).then(t=>{let e;this._key&&this._key.indexOf("AIF-")===0&&(e="https://vortex.data.microsoft.com/collect/v1"),this._aiClient=new t.ApplicationInsights({config:{instrumentationKey:this._key,endpointUrl:e,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),this._aiClient.loadAppInsights();let r=jh();e&&(r===un.ON||r===un.ERROR)&&fetch(e).catch(()=>this._aiClient=void 0),this._isInstantiated=!0})}},"du"),wx=l(class extends mx{constructor(t,e,r,n){let i=new vx(r);r&&r.indexOf("AIF-")===0&&(n=!0);super(t,e,i,{release:navigator.appVersion,platform:"web"},n)}},"mu");/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */const yx="Type of classified event does not match event properties",Vh=l(class{constructor(t){this.sharedProperties={},Vh._instance=this,this.reporter=new wx(t.extension.id,t.extension.packageJSON.version,Vh.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==yx&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,r){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},r)}sendErrorEvent(t,e,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},r)}sendException(t,e,r){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},r)}setSharedProperty(t,e){this.sharedProperties[t]=e}},"_TelemetryService");let Us=Vh;Us.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function bx(t,e){h.env.appHost==="github.dev"&&(E.debug(`Executing ${t}`),e={...e,errorDetail:e.errorDetail instanceof Error?e.errorDetail.name:void 0},h.commands.executeCommand(t,e).then(r=>{},r=>{E.debug(`Failed to execute ${t}`,r)}))}l(bx,"reportWorkbenchLoadResult");const Bl=(0,O.loadMessageBundle)();let kn;var Gh;(function(t){function e(r){const n=Sx(r);return kn=h.env.uiKind===h.UIKind.Web,E.warn(`Running on the ${kn?"web":"desktop"}${r.extensionRuntime!==h.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${r.globalStorageUri.toString(!0)}`),n}l(e,"configure"),t.configure=e})(Gh||(Gh={}));function _x(){var t,e;return(e=(t=h.workspace.workspaceFolders)==null?void 0:t.every(r=>r.uri.scheme===Pt.scheme))!=null?e:!1}l(_x,"isVirtualWorkspace");var Bt;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})(Bt||(Bt={}));const xx=/\/workspaceStorage\/(?<id>[^/]+)/i;function Sx(t){var e;if(t.storageUri===void 0)return"";const r=xx.exec(t.storageUri.path);let n;if((e=r==null?void 0:r.groups)==null?void 0:e.id)n=r.groups.id;else{n=t.storageUri.path;const i=$u(t.globalStorageUri.path,n),o=`/${t.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}l(Sx,"getWorkspaceId");async function dn(t,e){var r,n,i,o,a;if(Us.instance.sendEvent("openWorkspace",{location:t.location}),t.location===Bt.AddToWorkspace){const c=(n=(r=h.workspace.workspaceFolders)==null?void 0:r.length)!=null?n:0;return void h.workspace.updateWorkspaceFolders(c,0,{uri:t.uri,name:t.name})}if(t.location===Bt.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const c=await ds.instance.getWorkspaceProvidersWithChanges();if(c.length){const u={title:Bl("continue","Continue")},d={title:Bl("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(kn?Bl("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,c.map(p=>p.name).join(", ")):Bl("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,c.map(p=>p.name).join(", ")),{modal:!0,useCustom:!0},u,d)!==u){Us.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const s=h.env.remoteName?!0:void 0;return t.filesToOpen&&(t.location===Bt.CurrentWindow&&s===void 0&&((i=h.workspace.workspaceFolders)==null?void 0:i.length)===1&&h.workspace.workspaceFolders[0].uri.toString()===t.uri.toString()?await((o=Iu())==null?void 0:o.openPendingFiles(t.uri,t.filesToOpen)):await((a=Iu())==null?void 0:a.setPendingFilesToOpen(t.uri,t.filesToOpen))),Us.instance.sendEvent("openWorkspace.success",{location:t.location,forceLocalWindow:String(s)}),void h.commands.executeCommand("vscode.openFolder",t.uri,{forceNewWindow:t.location===Bt.NewWindow,forceLocalWindow:s})}l(dn,"openWorkspace");var Vn;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.HasSearchIndexes="remoteHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="remoteHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="remoteHub:enabledAllSearchIndexes",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasPullRequestExtension="remoteHub:hasPullRequestExtension",t.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",t.HasRecentRepositories="remoteHub:hasRecentRepositories"})(Vn||(Vn={}));const Av=new Map;function Ca(t){return t==="isWeb"?kn:t==="remoteName"?h.env.remoteName:t==="virtualWorkspace"?_x():t.startsWith("config.")?j.getAny(t.substr(7)):Av.get(t)}l(Ca,"getContext");function Ea(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}l(Ea,"isSupportedContextKey");async function xi(t,e){Av.set(t,e),!t.startsWith("continueOn:")&&await h.commands.executeCommand("setContext",t,e)}l(xi,"setContext");class Tv{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await h.commands.executeCommand(this.menuItem.command,e)}}l(Tv,"ContinueOnCommandQuickPickItem");var Kh;(function(t){async function e(r,n,i){const o=Cx(r).map(c=>new Tv(c)),a=h.window.createQuickPick(),s=[];try{return await new Promise(u=>{s.push(a.onDidHide(()=>u(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[d]=a.activeItems;u(d)}})),a.title=i,a.placeholder=n,a.items=o,a.show()})}finally{a.dispose(),s.forEach(c=>void c.dispose())}}l(e,"show"),t.show=e})(Kh||(Kh={}));function Cx(t){var e,r,n,i,o;const a=new Map,[,s]=t.split(".");for(const u of h.extensions.all){const{name:d,displayName:f,contributes:p}=u.packageJSON;if(!p)continue;const g=(r=(e=p.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:r.continueOn;if(g==null?void 0:g.length){const _=new Map(((n=p.commands)!=null?n:[]).map(v=>[v.command,v]));for(const v of g){if(!v.command)continue;if(a.has(v.command)){E.warn(`Duplicate 'continueOn' menu command: ${v.command}`);continue}const y=_.get(v.command);if(!y){E.warn(`Unable to find 'continueOn' menu command: ${v.command}`);continue}if(!Ex(v.when))continue;const x=(o=(i=v.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(v.command,{extension:{id:d,name:f,builtin:d===s},command:y.command,title:y.title,icon:typeof y.icon=="string"?y.icon:void 0,group:x>0?v.group.substr(0,x):v.group,order:x>0?Number(v.group.substr(x+1)):0,category:y.category})}}}function c(u,d){const f=u.group,p=d.group;if(f!==p){if(!f)return 1;if(!p||f==="navigation")return-1;if(p==="navigation")return 1;const g=f.localeCompare(p);if(g!==0)return g}return u.order<d.order?-1:u.order>d.order?1:u.title.localeCompare(d.title)}return l(c,"compareMenuItems"),[...a.values()].sort(c)}l(Cx,"getContinueOnContributions");function Ex(t){return t?t.split("&&").every(e=>{const r=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!r)return!0;const[,n,i,o,a,s]=r;if(i){if(i==="false")return!1;if(!Ea(i))return!0;const c=Ca(i);return n?!c:c}if(o&&a&&s)switch(a){case"==":return!Ea(o)||!Ea(s)||Ca(o)==Ca(s);case"!=":return!Ea(o)||!Ea(s)||Ca(o)!=Ca(s);case"=~":{if(!Ea(o))return!0;const c=Ca(o);try{return new RegExp(s.slice(1,-1)).test(String(c!=null?c:""))}catch{return!1}}}return!0}):!0}l(Ex,"evaluateWhenClause");class Ul{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,r=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}l(Ul,"TaskDebouncer");const Si=(0,O.loadMessageBundle)(),Qh=Symbol("QuickPickGoBack");var Zh;(function(t){async function e(r,n,i,o,a,s){const c=r.getRemoteWorkspaceSourceProviders();let u=[];c.length===0?u=[]:u=c.map(_=>new Xh(_));const d=await n.getRemoteWorkspaceSourceProvider();if(d){const _=await d.provideSources();_&&u.push(..._.filter(v=>j.get("azureRepos.enabled")?!0:v.providerId==="github").map(v=>({label:`${v.icon?`${v.icon} `:""}${v.name}`,description:v.description,detail:v.detail,url:v.url,workspace:v.url?void 0:v.workspace,buttons:[In.OpenInNewWindow]})))}const f=h.window.createQuickPick();f.ignoreFocusOut=!0;const p=[];let g=i;try{for(;;){const _=await new Promise(v=>{p.push(f.onDidHide(()=>v(void 0)),f.onDidChangeValue(y=>{y=y.trim(),y.length===0?f.items=u:f.activeItems.length===0||f.activeItems[0]instanceof Ra?f.items=[new Ra(r,y),...u]:f.items=u}),f.onDidAccept(()=>{if(f.activeItems.length!==0){const[y]=f.activeItems;(!(y instanceof Ra)||y.validate())&&v(y)}}),f.onDidChangeActive(()=>{if(g!==void 0||!(s==null?void 0:s.allowAddToWorkspace))return;const[y]=f.activeItems;let x=!0;if(y===void 0?x=Boolean(f.value):x=y instanceof Ra,x){if(f.buttons.length===1)return;f.buttons=[In.AddToWorkspace]}else{if(f.buttons.length===0)return;f.buttons=[]}}),f.onDidTriggerButton(y=>{if(y===In.AddToWorkspace){const[x]=f.activeItems;if(!(x instanceof Ra))return;x.validate()&&(g=Bt.AddToWorkspace,v(x))}}),f.onDidTriggerItemButton(y=>{switch(y.button){case In.OpenInNewWindow:g=Bt.NewWindow,v(y.item);break;default:break}})),f.title=a,f.placeholder=o,f.matchOnDescription=!0,f.items=u,f.sortByLabel=!1,f.show()});if(_ instanceof Xh){const v=await _.show(g,_.placeholder,a,s);if(v===Qh)continue;return v}return[_,g]}}finally{f.dispose(),p.forEach(_=>void _.dispose())}}l(e,"show"),t.show=e})(Zh||(Zh={}));class Xh{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,r,n,i){const o=h.window.createQuickPick(),a=new Ul(500),s=[a];async function c(y,x,C,k,I){const B=await y.provideSources(x,C,k,I);return B==null?void 0:B.map(J=>({label:`${J.icon?`${J.icon} `:""}${J.name}`,description:J.description,detail:J.detail,url:J.url,workspace:J.workspace,buttons:[In.OpenInNewWindow]}))}l(c,"getItems");async function u(y){var x;g=void 0;const C=o.activeItems;o.items=(x=y!=null?y:await v)!=null?x:[],p&&C.length!==0&&(o.activeItems=o.items.filter(k=>C.some(I=>I.url===k.url))),o.busy=!1}l(u,"setItems");let d,f;if(this.provider.provideOrganization&&this.provider.provideProject){if(d=await this.provider.provideOrganization(),!d)return[void 0,void 0];if(f=await this.provider.provideProject(d),!f)return[void 0,void 0]}let p=!1,g,_=e;const v=c(this.provider,d,f,void 0,{sort:"updated"});try{const y=await new Promise(x=>{s.push(o.onDidHide(()=>x(void 0)),o.onDidChangeValue(C=>{p=!1,C=C.trim(),o.busy=!0;const k=a.debounce(C?()=>c(this.provider,d,f,C,{sort:"stars"}):()=>v);g===void 0&&(g=k.then(I=>u(I)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[C]=o.activeItems;x(C)}}),o.onDidChangeActive(()=>{if(p=o.activeItems.length!==0,_!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[C]=o.activeItems;if(C===void 0){if(o.buttons.length===1)return;o.buttons=[h.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[h.QuickInputButtons.Back,In.AddToWorkspace]}}),o.onDidTriggerButton(C=>{if(C===h.QuickInputButtons.Back){x(Qh);return}if(C===In.AddToWorkspace){const[k]=o.activeItems;if(k===void 0)return;_=Bt.AddToWorkspace,x(k)}}),o.onDidTriggerItemButton(C=>{switch(C.button){case In.OpenInNewWindow:_=Bt.NewWindow,x(C.item);break;default:break}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[h.QuickInputButtons.Back],o.busy=!0,o.show(),g=a.debounce(()=>v,0).then(C=>u(C))});return y===Qh?y:[y,_]}finally{o.dispose(),s.forEach(y=>void y.dispose())}}}l(Xh,"RemoteSourceProviderPickerItem");class Ra{constructor(e,r){this.url=r,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(r)}get buttons(){return[In.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:r}=this.canOpenResult;switch(r){case at.Branch:return Si("remote url picker open branch","Open Branch from {0} Repository",e.name);case at.Tag:return Si("remote url picker open tag","Open Tag from {0} Repository",e.name);case at.Commit:return Si("remote url picker open commit","Open Commit from {0} Repository",e.name);case at.File:return Si("remote url picker open file","Open File from {0} Repository",e.name);case at.PullRequest:return Si("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return Si("remote url picker open repository","Open {0} Repository",e.name)}}return Si("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}l(Ra,"RemoteUrlQuickPickItem");var In;(function(t){t.AddToWorkspace={iconPath:new h.ThemeIcon("plus"),tooltip:Si("remote url picker button add to workspace","Add to Workspace")},t.OpenInNewWindow={iconPath:new h.ThemeIcon("empty-window"),tooltip:Si("remote picker open in new window","Open in New Window")}})(In||(In={}));var Rx=Object.defineProperty,Ax=Object.getOwnPropertyDescriptor,Ci=l((t,e,r,n)=>{for(var i=n>1?void 0:n?Ax(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Rx(e,r,i),i},"messages_decorateClass");const or=(0,O.loadMessageBundle)();class Dn{showGitHubStatus500Message(){return h.window.showErrorMessage(or("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),or("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void h.window.showErrorMessage(or("401 error notification","The provided credentials are either invalid or expired."),or("ok","OK"));const r=or("401 error notification confirm","Reauthenticate");await h.window.showErrorMessage(or("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),r)===r&&e()}async showStatus403Message(e){if(!e)return void h.window.showErrorMessage(or("403 error notification","The provided credentials do not have the required access."),or("ok","OK"));const r=or("403 error notification confirm","Reauthenticate");await h.window.showErrorMessage(or("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?"),r)===r&&e()}async showRepositoryEmptyMessage(e){const r=or("repository empty open","Open Repository");await h.window.showErrorMessage(or("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,r){const n=or("pull request not found open","Open Pull Request");await h.window.showErrorMessage(or("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,r),n)===n&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,r){const n=or("pull request head not found ok","OK");await h.window.showWarningMessage(or("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,r),n)}async showRepositoryForbiddenMessage(e){const r=or("repository forbidden open","Open Repository");await h.window.showErrorMessage(or("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const r=or("repository not found confirm","Open Repository");await h.window.showErrorMessage(or("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const r=or("unable to open repo confirm","Open Repository");await h.window.showErrorMessage(or("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}}l(Dn,"Messages"),Ci([Er(()=>"")],Dn.prototype,"showGitHubStatus500Message",1),Ci([Er(()=>"")],Dn.prototype,"showStatus401Message",1),Ci([Er(()=>"")],Dn.prototype,"showStatus403Message",1),Ci([Er()],Dn.prototype,"showRepositoryEmptyMessage",1),Ci([Er()],Dn.prototype,"showPullRequestNotFoundMessage",1),Ci([Er()],Dn.prototype,"showPullRequestHeadNotFoundMessage",1),Ci([Er()],Dn.prototype,"showRepositoryForbiddenMessage",1),Ci([Er()],Dn.prototype,"showRepositoryNotFoundMessage",1),Ci([Er()],Dn.prototype,"showUnableToOpenRepositoryMessage",1);const $r=new Dn,wr=(0,O.loadMessageBundle)();function Tx(t,e,r,n,i){async function o(s){const[c,u]=await Zh.show(t,r,s,wr("open repo placeholder","Enter a remote url, or select a remote provider"),s===Bt.AddToWorkspace?wr("open repo title add to workspace","Add Remote Repository to Workspace"):wr("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!c){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let d;if(c.workspace)d=c.workspace,d.location=u!=null?u:d.location;else if(d=await t.createWorkspaceForRemoteUrl(c.url,void 0,u!=null?u:s),!d){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await dn(d)}catch(d){if(i.sendException(d),d instanceof Qe){const{reauthenticate:f}=d;$r.showStatus401Message(()=>f());return}if(d instanceof Ke){$r.showRepositoryNotFoundMessage(d.name);return}if(d instanceof vt){$r.showRepositoryForbiddenMessage(d.name);return}if(d instanceof ct){$r.showRepositoryEmptyMessage(d.name);return}if(d instanceof ne){$r.showPullRequestNotFoundMessage(d.name,d.id);return}E.error(d)}}l(o,"openRepository");async function a(s,c,u){if(u==null?void 0:u.workspaceFolder){const f=t.getRepository(u.workspaceFolder,c);if(f!==void 0)return f}const d=c?t.repositories.filter(f=>f.provider.id===c):t.repositories;if(d.length!==0){if(d.length>1){const f=await h.window.showQuickPick(d.map(p=>({label:p.name,description:p.provider.name,repository:p})),{placeHolder:s});return f?f.repository:void 0}return d[0]}}return l(a,"getRepository"),[h.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),h.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),h.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn",async()=>{const s=await a(wr("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(s===void 0)return;i.sendEvent("command.continueOn");const c=await Kh.show(n,wr("continue on placeholder","Choose how you would like to continue working"),wr("continue on title","Continue '{0}' on",s.name));if(!c){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await e.hasChanges(s.uri)){const f={title:wr("continue","Continue")},p={title:wr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(wr("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},f,p)!==f){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const u=t.getRemoteUri(s.provider.id,{repo:s.id}),{HEAD:d}=await s.getMetadata();await c.execute({provider:s.provider,workspaceFolder:s.uri,name:s.name,url:u==null?void 0:u.toString(!0),ref:d.name})}),h.commands.registerCommand("remoteHub.openOnDesktop",async s=>{if(!kn)return;const c=await a(wr("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,s);if(c===void 0)return;const u=await t.getBestRemoteUri(c.uri);u!==void 0&&(i.sendEvent("command.openOnDesktop"),h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://${n}/open?url=${encodeURIComponent(u.toString(!0))}`)))}),h.commands.registerCommand("remoteHub.openOnWeb",async s=>{if(kn)return;const c=await a(wr("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,s);if(c===void 0)return;const u=await t.getBestRemoteUri(c.uri);u!==void 0&&(i.sendEvent("command.openOnWeb"),h.env.openExternal(u))}),h.commands.registerCommand("remoteHub.goToRepository",async()=>{var s,c,u;i.sendEvent("command.goToRepository");const d=await a(wr("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!d)return;const f=await t.getMetadata(d.uri);let p;const g={provider:d.provider,repo:d.id,path:((s=h.window.activeTextEditor)==null?void 0:s.document.uri)?t.getRelativeFilePath((c=h.window.activeTextEditor)==null?void 0:c.document.uri):void 0};return f.HEAD.type===_e.Branch&&(((u=h.window.activeTextEditor)==null?void 0:u.document)||f.defaultBranch.name!==f.HEAD.name)?p={...g,branch:f.HEAD.name}:f.HEAD.type===_e.Tag?p={...g,tag:f.HEAD.name}:f.HEAD.type===_e.Commit?p={...g,sha:f.HEAD.sha}:p={...g},h.commands.executeCommand("remoteHub.openOnRemote",p)}),h.commands.registerCommand("remoteHub.openOnRemote",async s=>{i.sendEvent("command.openOnRemote");const{provider:c,...u}=s,d=t.getRemoteUri(c.id,u);if(d){await h.env.openExternal(d);return}h.window.showErrorMessage(wr("open on remote command provider not supported","Unable to open the resource on {0}",s.provider.name))}),h.commands.registerCommand("remoteHub.clone",async s=>{const c=await a(wr("clone placeholder","Choose which repository to clone"),void 0,s);if(c!==void 0){if(i.sendEvent("command.clone"),s===void 0&&await e.hasChanges(c.uri)){const u={title:wr("continue","Continue")},d={title:wr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(wr("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},u,d)!==u){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(c.uri)}}),h.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),h.commands.registerCommand("remoteHub.enableDebugLogging",()=>j.updateEffective("logLevel",me.Debug)),h.commands.registerCommand("remoteHub.disableDebugLogging",()=>j.updateEffective("logLevel",me.Warn)),h.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{await r.exportDebugInfo(),await e.exportDebugInfo()}),h.commands.registerCommand("remoteHub.setContext",async(s,c)=>{if(!s.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await xi(s,c)}),h.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const s={title:wr("continue on","Continue Working On...")};await h.window.showInformationMessage(wr("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},s)===s&&await h.commands.executeCommand("remoteHub.continueOn")}),h.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>kn?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}l(Tx,"registerCommands");function Fn(t){return t}l(Fn,"command");async function Yh(t,e){return h.commands.executeCommand(t,e)}l(Yh,"executeCommand");class kv{constructor(){this._timeout=0,this._disposable=j.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const r=j.get("autoFetch");this._config={enabled:(e=r.enabled)!=null?e:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(e){!j.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await Yh("remoteHub.fetchAll",{automated:!0})}catch(e){E.error(e,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}l(kv,"AutoFetchService");var kx=__webpack_require__(8764),Ll,Ix=new Uint8Array(16);function Dx(){if(!Ll&&(Ll=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ll))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ll(Ix)}l(Dx,"rng");const Fx=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Px(t){return typeof t=="string"&&Fx.test(t)}l(Px,"validate");const Nx=Px;for(var Ar=[],Jh=0;Jh<256;++Jh)Ar.push((Jh+256).toString(16).substr(1));function $x(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Ar[t[e+0]]+Ar[t[e+1]]+Ar[t[e+2]]+Ar[t[e+3]]+"-"+Ar[t[e+4]]+Ar[t[e+5]]+"-"+Ar[t[e+6]]+Ar[t[e+7]]+"-"+Ar[t[e+8]]+Ar[t[e+9]]+"-"+Ar[t[e+10]]+Ar[t[e+11]]+Ar[t[e+12]]+Ar[t[e+13]]+Ar[t[e+14]]+Ar[t[e+15]]).toLowerCase();if(!Nx(r))throw TypeError("Stringified UUID is invalid");return r}l($x,"stringify");const Mx=$x;function Bx(t,e,r){t=t||{};var n=t.random||(t.rng||Dx)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return Mx(n)}l(Bx,"v4");const ef=Bx,Gn=globalThis.fetch;async function tf(t,e,r){const n=new AbortController;r.onCancellationRequested(()=>n.abort());try{return await globalThis.fetch(t,{...e,signal:n.signal})}catch(i){throw r.isCancellationRequested?new h.CancellationError:i}}l(tf,"fetchWithCancellation");var Ux="/";const Lx=O.loadMessageBundle(__webpack_require__(6470).join(Ux,"azure-devops/azdoAuthHelper.ts")),Ox="https://app.vssps.visualstudio.com/oauth2",Iv="https://vscode.dev/codeExchangeProxyEndpoints/azuredevops",Hx="B6B1E9E6-B408-45D9-A6EA-AF1FFBAB6A0F",Ls=["vso.code"];function Dv(t){return(t.query.includes("&")?t.query:decodeURIComponent(t.query)).split("&").reduce((r,n)=>{const i=n.split("=");return r[i[0]]=i[1],r},{})}l(Dv,"parseQuery");const Vi=new h.EventEmitter,Fv=new h.EventEmitter,Ol="Network failure",Pv="AzDO",Os="azuredevops";class Nv{constructor(e){this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this.secretStorage=e.secrets,this.extensionId=e.extension.id}async initialize(){await this.secretStorage.get(Pv)&&(E.debug("Detected outdated auth session format. Removing and will ask for new auth session... "),await this.secretStorage.delete(Pv));const r=await this.secretStorage.get(Os);if(r)try{const i=this.parseStoredData(r).map(async o=>{var a;if(!o.refreshToken)return Promise.resolve();try{await this.refreshToken(o.refreshToken,o.scope,o.id)}catch(s){s.message===Ol?await this.handleRefreshNetworkError(o.id,o.refreshToken,o.scope)||(this._tokens.push({accessToken:void 0,refreshToken:o.refreshToken,account:{label:(a=o.account.label)!=null?a:o.account.displayName,id:o.account.id},scope:o.scope,sessionId:o.id}),this.pollForReconnect(o.id,o.refreshToken,o.scope)):await this.removeSession(o.id)}});await Promise.all(i)}catch(n){E.log("Failed to initialize stored data"),await this.clearSessions()}this._disposables.push(this.secretStorage.onDidChange(()=>this.checkForUpdates))}parseStoredData(e){return JSON.parse(e)}async storeTokenData(){const e=this._tokens.map(r=>({id:r.sessionId,refreshToken:r.refreshToken,scope:r.scope,account:r.account}));await this.secretStorage.store(Os,JSON.stringify(e))}async checkForUpdates(){const e=[];let r=[];const n=await this.secretStorage.get(Os);if(n)try{const i=this.parseStoredData(n);let o=i.map(async a=>{if(!this._tokens.some(c=>c.scope===a.scope&&c.sessionId===a.id)&&a.refreshToken)try{const c=await this.refreshToken(a.refreshToken,a.scope,a.id);e.push(this.convertToSessionSync(c))}catch(c){c.message===Ol||await this.removeSession(a.id)}});o=o.concat(this._tokens.map(async a=>{i.some(c=>a.scope===c.scope&&a.sessionId===c.id)||(await this.removeSession(a.sessionId),r.push(this.convertToSessionSync(a)))})),await Promise.all(o)}catch(i){E.error(i),r=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(r=this._tokens.map(this.convertToSessionSync),E.log("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach(i=>{clearTimeout(i)}),this._refreshTimeouts.clear());(e.length||r.length)&&Vi.fire({added:e,removed:r,changed:[]})}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e){const r=await this.resolveAccessToken(e);return{id:e.sessionId,accessToken:r,account:e.account,scopes:e.scope.split(" ")}}async resolveAccessToken(e){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?E.log(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):E.log("Token available from cache"),Promise.resolve(e.accessToken);try{E.log("Token expired or unavailable, trying refresh");const r=await this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(r.accessToken)return r.accessToken;throw new Error("No access token returned.")}catch(r){throw new Error("Unavailable due to network problems")}}getTokenClaims(e){try{return JSON.parse(kx.Buffer.from(e.split(".")[1],"base64").toString())}catch(r){throw E.error(r),new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map(e=>this.convertToSession(e)))}async getSessions(e){if(!e)return this.sessions;const r=e.sort().join(" "),n=this._tokens.filter(i=>i.scope===r);return Promise.all(n.map(i=>this.convertToSession(i)))}createSession(e){return E.log("Logging in..."),this.loginWithoutLocalServer(e)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[]}isTestEnvironment(e){return/\.azurewebsites\.net$/.test(e.authority)||e.authority.startsWith("localhost:")}async loginWithoutLocalServer(e){var r;const n=await h.env.asExternalUri(h.Uri.parse(`${h.env.uriScheme}://${this.extensionId}/login`));if(this.isTestEnvironment(n)){const u=await h.window.showInputBox({prompt:'Azure Repos Personal Access Token (you must have "vso.code" in your scopes)',ignoreFocusOut:!0});if(!u)throw new Error("Sign in failed: No token provided");return{id:"test",accessToken:u,scopes:Ls,account:{id:"test",label:"Test Account"}}}const i=n.toString(),o=h.Uri.parse(`${Ox}/authorize?client_id=${Hx}&response_type=Assertion&state=${encodeURIComponent(i)}&scope=${encodeURIComponent(Ls.join(" "))}&redirect_uri=${encodeURIComponent(Iv)}`),a=new Promise((u,d)=>{const f=setTimeout(()=>{clearTimeout(f),d("Login timed out.")},1e3*60*5)}),s=(r=this._pendingStates.get(e))!=null?r:[];this._pendingStates.set(e,[...s,i]);let c=this._codeExchangePromises.get(e);return c||(c=this.handleCodeResponse(e),this._codeExchangePromises.set(e,c)),h.env.openExternal(o),Promise.race([c,a]).finally(()=>{this._pendingStates.delete(e),this._codeExchangePromises.delete(e)})}async handleCodeResponse(e){let r;return new Promise((n,i)=>{r=Fv.event(async o=>{try{E.log(`Received Uri: ${o.toString()}`);const a=Dv(o);if(!a)throw new Error(`No access info found in query: ${JSON.stringify(a)}`);const s=a,c=await this.getTokenFromResponse(s,e);this.setToken(c,e);const u=await this.convertToSession(c);n(u)}catch(a){E.error(a),i(a)}})}).then(n=>(r.dispose(),n)).catch(n=>{throw r.dispose(),n})}setToken(e,r){const n=this._tokens.findIndex(i=>i.sessionId===e.sessionId);return n>-1?this._tokens.splice(n,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout(async()=>{try{const i=await this.refreshToken(e.refreshToken,r,e.sessionId);Vi.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){i.message===Ol?await this.handleRefreshNetworkError(e.sessionId,e.refreshToken,r)||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(await this.removeSession(e.sessionId),Vi.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}},1e3*(e.expiresIn*2/3))),this.storeTokenData()}async getTokenFromResponse(e,r,n){var i;const o=this.getTokenClaims(e.access_token),a=await Gn("https://app.vssps.visualstudio.com/_apis/profile/profiles/me?api-version=6.0",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});let s;if(a.ok)s=(await a.json()).displayName;else{const c=await a.text();E.error(c),s="User"}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+e.expires_in*1e3:void 0,accessToken:e.access_token,refreshToken:e.refresh_token,scope:r,sessionId:n!=null?n:`${o.nameid}/${ef()}`,account:{label:s,id:`${o.nameid}/${(i=o.aui)!=null?i:""}`}}}async refreshToken(e,r,n){E.log("Refreshing token...");const i=`refresh_token=${encodeURIComponent(e)}`;let o;try{o=await Gn(Iv,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":i.length.toString()},body:i})}catch(a){throw E.error("Refreshing token failed"),new Error(Ol)}try{if(o.ok){const a=await o.json(),s=await this.getTokenFromResponse({access_token:a.access_token,expires_in:a.expires_in,refresh_token:a.refresh_token},r,n);return this.setToken(s,r),E.log("Token refresh success"),s}throw new Error("Bad request.")}catch(a){throw await h.window.showErrorMessage(Lx(0,null)),E.error(`Refreshing token failed: ${o.statusText}`),new Error("Refreshing token failed")}}clearSessionTimeout(e){const r=this._refreshTimeouts.get(e);r&&(clearTimeout(r),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const r=this._tokens.findIndex(i=>i.sessionId===e);let n;return r>-1&&(n=this._tokens[r],this._tokens.splice(r,1)),this.clearSessionTimeout(e),n}pollForReconnect(e,r,n){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const i=await this.refreshToken(r,n,e);Vi.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){this.pollForReconnect(e,r,n)}},1e3*60*30))}handleRefreshNetworkError(e,r,n,i=1){return new Promise((o,a)=>{if(i===3)return E.error("Token refresh failed after 3 attempts"),o(!1);const s=5*i*i;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const c=await this.refreshToken(r,n,e);return Vi.fire({added:[],removed:[],changed:[this.convertToSessionSync(c)]}),o(!0)}catch(c){return o(await this.handleRefreshNetworkError(e,r,n,i+1))}},1e3*s))})}async removeSession(e){E.log(`Logging out of session '${e}'`);const r=this.removeInMemorySessionData(e);let n;return r&&(n=this.convertToSessionSync(r)),this._tokens.length===0?await this.secretStorage.delete(Os):this.storeTokenData(),n}async clearSessions(){E.log("Logging out of all sessions"),this._tokens=[],await this.secretStorage.delete(Os),this._refreshTimeouts.forEach(e=>{clearTimeout(e)}),this._refreshTimeouts.clear()}}l(Nv,"AzureDevOpsAuthService");const $v=l(class{constructor(t){this.onDidChangeSessions=Vi.event,this.loginService=new Nv(t),this.initializePromise=this.loginService.initialize(),this.disposable=h.authentication.registerAuthenticationProvider($v.id,"Azure Repos",this)}dispose(){this.disposable.dispose()}async getSessions(t){return await this.initializePromise,this.loginService.getSessions(t)}async createSession(t){await this.initializePromise;const e=await this.loginService.createSession(t.sort().join(" "));return Vi.fire({added:[e],removed:[],changed:[]}),e}async removeSession(t){await this.initializePromise;const e=await this.loginService.removeSession(t);e&&Vi.fire({added:[],removed:[e],changed:[]})}},"_AzDOAuthenticationProvider");let Ao=$v;Ao.id="azurerepos";var Aa=__webpack_require__(7360),Wx=__webpack_require__(850),rf=__webpack_require__.n(Wx);function nf(t,e,r){if(!(e==null?void 0:e.length)&&!(r==null?void 0:r.length))return new Set(t);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(a=>`${a}/**`)]),o=rf()(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(r==null?void 0:r.length){const i=new Set([...r,...r.map(o=>`${o}/**`)]);if(n===void 0){const o=rf().not(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}else rf()(t,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}l(nf,"globFilter");var zx=Object.defineProperty,qx=Object.getOwnPropertyDescriptor,of=l((t,e,r,n)=>{for(var i=n>1?void 0:n?qx(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&zx(e,r,i),i},"fs_decorateClass");const jx=(0,O.loadMessageBundle)(),Vx=h.FileSystemError.FileNotFound().code,Gx=/(\/|\\)/g;class Hs{constructor(e,r,n){this.providerService=e,this.azdo=r,this.changeStore=n,this._onDidChangeFile=new h.EventEmitter,this.contentCache=new Map,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.pathTypeMap={},this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),h.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(i=>{i.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([i.repository.uri])}),e.onDidRefresh(i=>this.onRefreshOrRepositoryChanged(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.azdo.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Pt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){E.log(`AzDOFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>tt(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);for(const[r,{uri:n}]of[...this.contentCache])e.some(i=>tt(n,i))&&this.contentCache.delete(r);this.updateOpenOrWatchedUris(e)}}onTextDocumentClosed(e){e.scheme===this.scheme&&this.contentCache.delete(W(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>tt(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));E.debug(`AzDOFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(W(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{E.debug(`AzDOFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=W(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){const r=W(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${r}`,n);const i=await this.providerService.getMetadata(e),o=h.FilePermission.Readonly;if(!i.path)return{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o};if(i.path in this.pathTypeMap||await this.updateWorkspaceItemMap(i,e.path,!0),i.path in this.pathTypeMap)return this.pathTypeMap[i.path]===h.FileType.Directory?{type:h.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o}:{type:h.FileType.File,mtime:0,ctime:0,size:0,permissions:o};if(this.implicitlyWatchedUris.delete(r),e.query!=="~")throw h.FileSystemError.FileNotFound(e);return{type:h.FileType.File,size:0,ctime:0,mtime:Date.now(),permissions:h.FilePermission.Readonly}}finally{this.pendingUriRequests.delete(`stat:${r}`),(n==null?void 0:n.outdated)&&setTimeout(()=>{E.log(`AzDOFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async updateWorkspaceItemMap(e,r,n){const i=new Array,o=await this.azdo.getRepoItems(e,r,{recursionLevel:"OneLevel"});for(const a of o){const s=a.path.substring(1);if(s!==e.path||n){const c=a.isFolder===!0?h.FileType.Directory:h.FileType.File;this.pathTypeMap[s]=c,i.push([s,c])}}return i}async readDirectory(e){this.implicitlyWatchedUris.set(W(e),e);const r=this.providerService.getVirtualRootUri(e),n=await this.providerService.getMetadata(e);return(await this.updateWorkspaceItemMap(n,e.path,!1)).map(o=>[this.providerService.getRelativeFilePath(e,Ve(r,o[0])),o[1]])}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){var r;const n=W(e);this.implicitlyWatchedUris.set(n,e);let i=this.contentCache.get(n);if(i!==void 0)return i.content;const o={uri:e,outdated:!1};try{return this.pendingUriRequests.set(n,o),i={content:this.azdo.getFileContent(e),uri:e},this.contentCache.set(n,i),await i.content}catch(a){if(this.implicitlyWatchedUris.delete(n),i!==void 0&&i.content===((r=this.contentCache.get(n))==null?void 0:r.content)&&this.contentCache.delete(n),e.query==="~"&&a instanceof h.FileSystemError&&a.code===Vx)return new Uint8Array(0);throw a}finally{this.pendingUriRequests.delete(n),(o==null?void 0:o.outdated)&&setTimeout(()=>{E.log(`AzDOFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw h.FileSystemError.NoPermissions()}delete(e,r){throw h.FileSystemError.NoPermissions()}rename(e,r,n){throw h.FileSystemError.NoPermissions()}copy(e,r,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},a){const s=`${W(r)}|${JSON.stringify({includes:i,excludes:o})}`;let c=this.fileSearchCache.get(s);if(c===void 0){const d=await this.providerService.getMetadata(r),f=await this.azdo.getRepoItems(d,"",{recursionLevel:"Full"});let p=[];for(const g of f)g.isFolder||p.push(g.path);if(p.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(p=[...nf(p,i,o)]),c=p.map(g=>Aa.prepareSlow(g)),this.fileSearchCache.set(s,c)}let u;return e.pattern===""?u=c.map(d=>h.Uri.joinPath(r,d.target)):(u=Aa.go(e.pattern.replace(Gx,"/"),c,{allowTypo:!0,limit:n}).map(d=>h.Uri.joinPath(r,d.target)),Aa.cleanup()),n!==void 0&&n!==0&&n<u.length&&(u=u.slice(0,n)),u}async provideTextSearchResults(e,r,n,i){const o=[];(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&o.push({text:jx("azdo flags not supported","Search flags are not supported."),type:h.TextSearchCompleteMessageType.Warning});const a=await this.azdo.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(a.warnings&&a.warnings.forEach(c=>{o.push({text:c,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let s;for(const c of a.matches)s=h.Uri.joinPath(r.folder,c.path),n.report({uri:s,ranges:c.ranges,preview:{text:c.preview,matches:c.matches}});return{limitHit:!1,message:o}}}l(Hs,"AzDOFS"),of([en()],Hs.prototype,"stat",1),of([en()],Hs.prototype,"readDirectory",1),of([en()],Hs.prototype,"readFile",1);var Mv;(function(t){t[t.Force=0]="Force",t[t.ForceWithLease=1]="ForceWithLease"})(Mv||(Mv={}));var Kn;(function(t){t[t.Head=0]="Head",t[t.RemoteHead=1]="RemoteHead",t[t.Tag=2]="Tag"})(Kn||(Kn={}));var Ws;(function(t){t[t.INDEX_MODIFIED=0]="INDEX_MODIFIED",t[t.INDEX_ADDED=1]="INDEX_ADDED",t[t.INDEX_DELETED=2]="INDEX_DELETED",t[t.INDEX_RENAMED=3]="INDEX_RENAMED",t[t.INDEX_COPIED=4]="INDEX_COPIED",t[t.MODIFIED=5]="MODIFIED",t[t.DELETED=6]="DELETED",t[t.UNTRACKED=7]="UNTRACKED",t[t.IGNORED=8]="IGNORED",t[t.INTENT_TO_ADD=9]="INTENT_TO_ADD",t[t.ADDED_BY_US=10]="ADDED_BY_US",t[t.ADDED_BY_THEM=11]="ADDED_BY_THEM",t[t.DELETED_BY_US=12]="DELETED_BY_US",t[t.DELETED_BY_THEM=13]="DELETED_BY_THEM",t[t.BOTH_ADDED=14]="BOTH_ADDED",t[t.BOTH_DELETED=15]="BOTH_DELETED",t[t.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(Ws||(Ws={}));var Bv;(function(t){t.BadConfigFile="BadConfigFile",t.AuthenticationFailed="AuthenticationFailed",t.NoUserNameConfigured="NoUserNameConfigured",t.NoUserEmailConfigured="NoUserEmailConfigured",t.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",t.NotAGitRepository="NotAGitRepository",t.NotAtRepositoryRoot="NotAtRepositoryRoot",t.Conflict="Conflict",t.StashConflict="StashConflict",t.UnmergedChanges="UnmergedChanges",t.PushRejected="PushRejected",t.RemoteConnectionError="RemoteConnectionError",t.DirtyWorkTree="DirtyWorkTree",t.CantOpenResource="CantOpenResource",t.GitNotFound="GitNotFound",t.CantCreatePipe="CantCreatePipe",t.PermissionDenied="PermissionDenied",t.CantAccessRemote="CantAccessRemote",t.RepositoryNotFound="RepositoryNotFound",t.RepositoryIsLocked="RepositoryIsLocked",t.BranchNotFullyMerged="BranchNotFullyMerged",t.NoRemoteReference="NoRemoteReference",t.InvalidBranchName="InvalidBranchName",t.BranchAlreadyExists="BranchAlreadyExists",t.NoLocalChanges="NoLocalChanges",t.NoStashFound="NoStashFound",t.LocalChangesOverwritten="LocalChangesOverwritten",t.NoUpstreamBranch="NoUpstreamBranch",t.IsInSubmodule="IsInSubmodule",t.WrongCase="WrongCase",t.CantLockRef="CantLockRef",t.CantRebaseMultipleBranches="CantRebaseMultipleBranches",t.PatchDoesNotApply="PatchDoesNotApply",t.NoPathFound="NoPathFound",t.UnknownPath="UnknownPath"})(Bv||(Bv={}));var Kx=Object.defineProperty,Qx=Object.getOwnPropertyDescriptor,Zx=l((t,e,r,n)=>{for(var i=n>1?void 0:n?Qx(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Kx(e,r,i),i},"provider_decorateClass");const Xx=/^https?:\/\/dev\.azure\.com(?:\/defaultcollection)?\/(?<organization>[^/]+)(?:\/(?<project>[^_/][^/]*))?(?:\/_git)?\/(?<repo>[^/?#]+)(?:\/commit\/(?<commit>[0-9a-f]{40})|\/pullrequest\/(?<pull>\d+))?/i,Uv=(0,O.loadMessageBundle)(),Lv=1,Ov=Object.freeze({id:"azurerepos",name:"Azure Repos"});function To(t){const{scheme:e,metadata:r}=Pt.decodeAuthority(t),[,n,i,o,...a]=t.path.split("/");return{scheme:e,provider:Ov,name:`${n}/${i}/${o}`,repo:{organization:n,project:i,name:o},path:a.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}l(To,"getAzDOMetadata");function Yx(t,e){const{repo:r}=e!=null?e:To(t);return t.with({path:`/${r.organization}/${r.project}/${r.name}`,query:"",fragment:""})}l(Yx,"getAzDORootUri");function af(t,e,r){const{repo:{organization:n,name:i}}=t instanceof h.Uri?To(t):t;return h.Uri.parse(`azurerepos://${Pt.encodeAuthority("azurerepos",{v:Lv,ref:{type:Ue.Commit,id:e}})}/${n}/${i}/${r}`)}l(af,"getAzDORevisionUri");function Hv(t){var e,r,n,i,o,a;const s=Xx.exec(t);if((s==null?void 0:s.groups)===void 0)return;const{organization:c,project:u,repo:d,commit:f}=s.groups,p=Dv(h.Uri.parse(t)),g=/^GB(?<branchName>.+)/i.exec((e=p.version)!=null?e:""),_=/^GT(?<tagName>.+)/i.exec((r=p.version)!=null?r:""),v=/^GC(?<commit>[0-9a-f]{40})/i.exec((n=p.version)!=null?n:""),y=p.path&&p.path!=="/"?p.path:void 0;return{organization:c,project:u,repo:d,branch:(i=g==null?void 0:g.groups)==null?void 0:i.branchName,tag:(o=_==null?void 0:_.groups)==null?void 0:o.tagName,commit:f!=null?f:(a=v==null?void 0:v.groups)==null?void 0:a.commit,path:y}}l(Hv,"parseAzureReposUrl");class sf{constructor(e){this.providerService=e}get isReadonly(){return!0}get scheme(){return"azurerepos"}dispose(){}async ensureAuthenticated(e=!1){const r=new Be("AzDO.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return await h.authentication.getSession(Ao.id,Ls,{createIfNone:!0,forceNewSession:e})}catch{try{const o=await h.authentication.getSession(Ao.id,Ls,{createIfNone:!1});if(o!==void 0)return o}catch{}return new Promise(o=>{async function a(){const c=await h.authentication.getSession(Ao.id,Ls,{createIfNone:!0});c!==void 0&&o(c)}l(a,"getSession");const s=h.authentication.onDidChangeSessions(async c=>{c.provider.id===Ao.id&&(s.dispose(),await a())})})}}l(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id===Ao.id&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:Ov,session:r,getRichNavigationHeaders:()=>({"X-Git-AzureDevOps":`Basic ${this.getBase64AuthenticationSessionToken(r)}`})}}getBase64AuthenticationSessionToken(e){if(this._sessionTokenBase64===void 0){if(e===void 0)return this.ensureAuthenticated().then(r=>(this._sessionTokenBase64=zo(`PAT:${r.accessToken}`),this._sessionTokenBase64));this._sessionTokenBase64=zo(`PAT:${e.accessToken}`)}return this._sessionTokenBase64}clearAuthenticationSession(){this._session=void 0,this._sessionTokenBase64=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async sendGetRequest(e,r,n,i){const a=`${n?`https://dev.azure.com/${e}/${n}/_apis/`:`https://dev.azure.com/${e}/_apis/`}${r}${i?`?${i}&`:"?"}api-version=5.1`;try{const s=await this.getBase64AuthenticationSessionToken();if(!s)throw new Qe("Unauthenticated",()=>this.reauthenticate());const c=await Gn(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${s}`}});if(c.status===401)throw new Qe("Unauthenticated",()=>this.reauthenticate());if(c.status===404)return;const u=await c.json();return u!=null?u:void 0}catch(s){throw E.error(s),s instanceof Qe&&$r.showStatus401Message(s.reauthenticate),s}}async sendPostRequest(e,r){try{const n=await this.getBase64AuthenticationSessionToken();if(!n)throw new Qe("Unauthenticated",()=>this.reauthenticate());const i=await Gn(e,{method:"POST",body:r,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${n}`}});if(i.status===401)throw new Qe("Unauthenticated",()=>this.reauthenticate());const o=await i.json();return o!=null?o:void 0}catch(n){throw E.error(n),n instanceof Qe&&$r.showStatus401Message(n.reauthenticate),n}}canOpenRemoteUrl(e){const r=Hv(e);if(r===void 0)return;const{branch:n,tag:i,commit:o,path:a}=r;return a?at.File:n?at.Branch:i?at.Tag:o?at.Commit:at.Repository}async createWorkspaceForRemoteUrl(e,r=Bt.CurrentWindow){const n=Hv(e);if(n===void 0)return;const{organization:i,project:o,repo:a,branch:s,tag:c,commit:u,path:d}=n;let f;s?f={type:Ue.Branch,id:s}:c?f={type:Ue.Tag,id:c}:u&&(f={type:Ue.Commit,id:u});const p=this.providerService.createVirtualUri("azurerepos",{repo:{organization:i,project:o!=null?o:a,name:a},ref:f});return{name:(await this.providerService.getMetadata(p)).name,uri:p,location:r,filesToOpen:d?[d]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){if((n==null?void 0:n.type)===Ue.Tree)throw new Error(`Invalid ref type '${n.type}'`);const a=n!==void 0||i!==void 0?{v:Lv}:void 0;return a&&(n&&(a.ref={type:n.type,id:n.id}),i&&(a.idx=i)),e.with({authority:Pt.encodeAuthority("azurerepos",a),path:`/${r.organization}/${r.project}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:`/${o!=null?o:""}`}`})}getRemoteUri(e){const r=`https://dev.azure.com/${e.repo.organization}/${e.repo.project}/_git/${e.repo.name}`,n=e.path?`&path=/${e.path}`:"";return e.pullRequest?h.Uri.parse(r):e.branch?h.Uri.parse(`${r}?version=GB${e.branch}${n}`):e.tag?h.Uri.parse(`${r}?version=GT${e.tag}${n}`):e.sha?h.Uri.parse(`${r}?version=GC${e.sha}${n}`):h.Uri.parse(r)}getProviderRootUri(e){return Yx(e)}getRelativeFilePath(e,r){const{path:n}=To(e),{path:i}=To(Ve(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=To(e);return{provider:r,name:n,repo:i,ref:o}}async validateBranchOrTagCasing(e,r,n,i){const o=`git/repositories/${n}/refs`,a="includeLinks=true",s=await this.sendGetRequest(e,o,r,a);if((s==null?void 0:s.value)===void 0){E.warn("Could not get branches, might be incorrect auth token");return}const c=s.value;if(c.length===0)return i?{type:Ue.Branch,id:i}:void 0;const u=`refs/heads/${i.toLowerCase()}`,d=`refs/tags/${i.toLowerCase()}`;for(const f of c){const p=f.name;if(p.toLowerCase()==u)return{type:Ue.Branch,id:p.substr(11)};if(p.toLowerCase()==d)return{type:Ue.Tag,id:p.substr(10)}}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case _e.Branch:return i!==void 0?q.PullRequestBranch:q.Branch;case _e.RemoteBranch:return i!==void 0?q.PullRequestRemoteBranch:q.RemoteBranch;case _e.Tag:return q.Tag;case _e.Commit:return q.Commit}}async createMetadata(e,r){var n,i,o,a;const s=new Be(`AzDO.createMetadata(${e.toString()}, ${r})`);let c;try{let{provider:u,name:d,repo:{organization:f,project:p,name:g},ref:_}=To(e);if(!_||_.type===Ue.Commit&&/HEAD/i.test(_.id))_={type:Ue.Commit,id:"HEAD"};else if((_.type===Ue.Branch||_.type===Ue.Tag)&&(_=await this.validateBranchOrTagCasing(f,p,g,_.id),_===void 0))throw new Error(`Cannot get metadata for Uri(${e.toString(!0)}); Unable to find the specified branch or tag`);const v=await this.getRepositoryInfo(f,p,g,_);if(v===void 0)throw c=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let y;if(r)y=r;else if(_.type===Ue.Commit)y=_.id;else if(y=(i=(n=v.ref)==null?void 0:n.sha)!=null?i:v.defaultBranch.sha,y===void 0)throw c=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let x;((o=v.ref)==null?void 0:o.prefix)==="refs/heads/"?x={type:_e.Branch,name:v.ref.name,sha:y,branch:{name:v.ref.name,sha:v.ref.sha}}:((a=v.ref)==null?void 0:a.prefix)==="refs/tags/"?x={type:_e.Tag,name:v.ref.name,sha:y,detached:{type:_e.Tag,name:v.ref.name}}:x={type:_e.Commit,name:wt(y),sha:y,detached:{type:_e.Commit,name:wt(y)}};const C={version:$e.schemaVersion,timestamp:Date.now(),provider:u,name:d,repo:v.repo,user:v.user,accessLevel:v.accessLevel,HEAD:x,defaultBranch:v.defaultBranch,pullRequest:v.pullRequest};return c=` \u2022 HEAD=${x.sha}`,C}finally{s.stop(c?{suffix:c}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(azure-devops)",label:Uv("open repo from","Open Repository from {0}","Azure Repos"),placeholder:Uv("pick repo","Choose a repository"),provideOrganization:async()=>{var e;return(e=await this.getOrganization())==null?void 0:e.label},provideProject:async e=>{var r;return(r=await this.getTeamProject(e))==null?void 0:r.label},provideSources:async(e,r,n,i)=>{if(n)return;const o=await this.searchRepositoriesQuery(e,r);return o==null?void 0:o.map(a=>({providerId:"azurerepos",name:a.name,icon:"$(repo)",description:`${a.fork?`$(repo-forked) ${a.fork}`:""}${a.stars>0?`${a.fork?" \u2022 ":""}$(star-full) ${a.stars}`:""}`,detail:a.description,url:a.url}))}}]}async createBranch(e,r,n,i){throw new Error("Branch creation is currently not supported")}async createCommit(e,r,n,i){throw new Error("Commit creation is currently not supported")}async createAndPushCommit(e,r,n,i,o){throw new Error("Commit creation is currently not supported")}async createPullRequest(e,r,n,i,o){throw new Error("PR creation is currently not supported")}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,a,s;const{force:c,to:u}={...n,force:r||(n==null?void 0:n.force)},d=new Be(`AzDO.fetch(${e.toString()}, force=${c}, to=${u})`);let f;try{const p=await this.getMetadata(e);if(p.HEAD.detached)return f=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:p};if(p.HEAD.type===_e.RemoteBranch)return f=" \u2022 Skipped; remote branch",{fetched:!1,metadata:p};const g=await this.getBranchTips(e);if(!g)throw f=" \u2022 Unable to fetch branch tips",new pt(r);if(!c&&!u&&((i=g.defaultBranch)==null?void 0:i.sha)!==void 0&&g.defaultBranch.sha===p.defaultBranch.sha&&((o=g.branch)==null?void 0:o.sha)!==void 0&&g.branch.sha===p.HEAD.branch.sha)return f=" \u2022 No changes detected",{fetched:!1,metadata:p};let _;if(((a=g.defaultBranch)==null?void 0:a.sha)!==void 0&&g.defaultBranch.sha!==p.defaultBranch.sha&&(_={defaultBranch:{...p.defaultBranch,sha:g.defaultBranch.sha}}),((s=g.branch)==null?void 0:s.sha)===void 0){if(f=" \u2022 Unable to find branch tip",c)throw new pt(r);return _!==void 0?{fetched:!0,metadata:{...p,..._}}:{fetched:!1,metadata:p}}return g.branch.sha!==p.HEAD.branch.sha&&(_={..._,HEAD:{...p.HEAD,branch:{...p.HEAD.branch,sha:g.branch.sha},detached:void 0}}),g.branch.sha===p.HEAD.sha?(f=" \u2022 Up to date",p.state!==void 0||_!==void 0?{fetched:!0,metadata:{...p,..._,state:void 0}}:{fetched:!1,metadata:p}):_!==void 0?{fetched:!0,metadata:{...p,..._}}:{fetched:!1,metadata:p}}finally{d.stop(f?{suffix:f}:void 0)}}async fork(e){throw new Error("Forks are currently not supported")}async getBranches(e,r){try{const n=await this.getRefs(e,{...r,filter:"heads",filterContains:r==null?void 0:r.query});if(n.length===0)return{branches:[]};const i=[];for(const o of n)!o.name.startsWith("refs/heads/")||i.push({type:Kn.Head,name:o.name.substr(11),commit:o.objectId,commitUrl:o.url});return{branches:i}}catch(n){return{branches:[]}}}async getCommit(e,r){try{const{repo:{organization:n,project:i,name:o}}=await this.getMetadata(e),a=`git/repositories/${o}/commits/${r}`,s=await this.sendGetRequest(n,a,i);return s===void 0?void 0:{hash:s.commitId,message:s.comment,parents:s.parents,authorDate:new Date(s.author.date),authorEmail:s.author.email,authorName:s.author.name,commitDate:new Date(s.committer.date)}}catch(n){return}}async getCommits(e,r){var n,i;try{const{repo:{organization:o,project:a,name:s}}=await this.getMetadata(e),c=`git/repositories/${s}/commits`;let u=`searchCriteria.itemVersion.version=${(n=r==null?void 0:r.cursor)!=null?n:r==null?void 0:r.ref}&searchCriteria.itemVersion.versionType=commit`;(r==null?void 0:r.path)&&(u+=`&searchCriteria.itemPath=${r.path}`);const d=(i=r==null?void 0:r.limit)!=null?i:100;u+=`&searchCriteria.$top=${d+1}`;const f=await this.sendGetRequest(o,c,a,u);if((f==null?void 0:f.value)===void 0)return;const p=f.value.map((_,v)=>({hash:_.commitId,message:_.comment,parents:f.value[v+1]?[f.value[v+1].commitId]:[],authorDate:new Date(_.author.date),authorEmail:_.author.email,authorName:_.author.name,commitDate:new Date(_.committer.date)}));let g;return p.length>d&&(p.splice(p.length-1,1),g={cursor:p[p.length-1].hash,more:!0}),{commits:p,paging:g}}catch(o){return}}async getFileContent(e,r,n){var i,o;try{const{HEAD:a,repo:{organization:s,project:c,id:u},path:d}=await this.providerService.getMetadata(e);n=n!=null?n:d;const f=`git/repositories/${u}/items`;let p="";n&&(p+=`path=${n}&includeContent=true`),r||Gt((i=a.branch)==null?void 0:i.name)?p+=`&versionDescriptor.version=${r!=null?r:(o=a.branch)==null?void 0:o.name}&versionDescriptor.versionType=commit`:a.type===_e.Branch?p+=`&versionDescriptor.version=${a.branch.name}&versionDescriptor.versionType=branch`:a.type===_e.Tag&&(p+=`&versionDescriptor.version=${a.name}&versionDescriptor.versionType=tag`);const g=await this.sendGetRequest(s,f,c,p);if(g)return new TextEncoder().encode(g.content);throw h.FileSystemError.FileNotFound(e)}catch(a){throw E.logLevel===me.Debug&&E.error(a),a}}async getFork(e){throw new Error("Forks are currently not supported")}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){throw new Error("Comparing commits is currently not supported")}async getObjectDetails(e,r,n){throw new Error("Not able to get object detail")}async getPullRequest(e,r){throw new Error("PRs are currently not supported")}async getRepoItems(e,r,n){const i=`git/repositories/${e.repo.name}/items`,[,,,,...o]=r.split("/");let a=`scopePath=${o.join("/")}&recursionLevel=${n.recursionLevel}&includeContentMetadata=true`;e.HEAD.type===_e.Commit?a+=`&versionDescriptor.version=${e.HEAD.sha}&versionDescriptor.versionType=commit`:e.HEAD.type===_e.Branch?a+=`&versionDescriptor.version=${e.HEAD.branch.name}&versionDescriptor.versionType=branch`:e.HEAD.type===_e.Tag&&(a+=`&versionDescriptor.version=${e.HEAD.name}&versionDescriptor.versionType=tag`);const s=await this.sendGetRequest(e.repo.organization,i,e.repo.project,a);return s&&Array.isArray(s==null?void 0:s.value)?s==null?void 0:s.value:(E.debug(`AzDOProvider.getRepoItems returned ${s===void 0?"empty":"invalid"} result ${s==null?void 0:s.value} for path ${r}`),[])}async getTags(e,r){try{const n=await this.getRefs(e,{...r,filter:"tags",filterContains:r==null?void 0:r.query});if(n.length===0)return{tags:[]};const i=[];for(const o of n)!o.name.startsWith("refs/tags/")||i.push({type:Kn.Tag,name:o.name.substr(10),commit:o.objectId,commitUrl:o.url});return{tags:i}}catch(n){return{tags:[]}}}async getTarGz(e,r){throw new Error("Getting zip is currently not supported")}async pushCommit(e,r,n,i){throw new Error("Commit pushing is not currently supported")}async getRefs(e,r){var n;const{repo:{organization:i,project:o,name:a}}=To(e),s=`git/repositories/${a}/refs`;let c="includeLinks=true";(r==null?void 0:r.filter)&&(c+=`&filter=${r.filter}`),(r==null?void 0:r.filterContains)&&(c+=`&filterContains=${r.filterContains}`),(r==null?void 0:r.limit)&&(c+=`&$top=${r.limit}`);const u=await this.sendGetRequest(i,s,o,c);return(n=u==null?void 0:u.value)!=null?n:[]}async getOrganization(){const e=l(async()=>{const r=await this.getAccounts();return r?r.sort((n,i)=>n.accountName.localeCompare(i.accountName)).map(n=>({label:n.accountName})):[]},"getQuickPickItems");return h.window.showQuickPick(e(),{placeHolder:"Choose an Azure DevOps Organization",title:"Choose an Azure DevOps Organization",ignoreFocusOut:!0})}async getTeamProject(e){const r=l(async()=>{const n=await this.sendGetRequest(e,"projects");return(n==null?void 0:n.value)?n.value.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({label:i.name,description:i.description})):[]},"getQuickPickItems");return h.window.showQuickPick(r(),{placeholder:"Choose an Azure DevOps project",title:"Choose an Azure DevOps project",ignoreFocusOut:!0})}async searchRepositoriesQuery(e,r){try{const n=await this.sendGetRequest(e,"git/repositories",r);return n?n.value.filter(i=>i.defaultBranch&&!i.isDisabled).sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({name:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0})):void 0}catch(n){throw E.error(n),n}}async getAccounts(){var e;try{const r=await this.getBase64AuthenticationSessionToken();if(!r)throw new Qe("Unauthenticated",()=>this.reauthenticate());const i=`https://app.vssps.visualstudio.com/_apis/accounts?memberId=${(e=this._session)==null?void 0:e.account.id.split("/")[0]}&api-version=6.0`,o=await Gn(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${r}`}});if(o.status===401)throw new Qe("Unauthenticated",()=>this.reauthenticate());return(await o.json()).value}catch(r){E.error(r);return}}async searchCodeQuery(e,r,n){var i;const{repo:{organization:o,project:a,name:s},HEAD:c,defaultBranch:u}=await this.getMetadata(r),d=`https://almsearch.dev.azure.com/${o}/${a}/_apis/search/codesearchresults?api-version=6.1-preview.1`,f=c.branch?c.branch.name:u.name,p={searchText:e,$skip:0,$top:1e3,filters:{Project:[a],Repository:[s],Path:["/"],Branch:[f]},$orderBy:[{field:"filename",sortOrder:"ASC"}],includeSnippet:!0},g=await this.sendPostRequest(d,JSON.stringify(p)),_=new h.Range(0,0,0,0),v=[];let y;for(const x of(i=g==null?void 0:g.results)!=null?i:[])for(const C of x.matches.content){y={path:x.path,ranges:[],preview:"",matches:[]};const k=Math.max(0,C.line-1),I=C.charOffset,B=I+C.length;y.preview=C.codeSnippet?C.codeSnippet:`CharOffset: ${C.charOffset}, Type: ${C.type}`,y.ranges.push(new h.Range(k,I,k,B)),y.matches.push(_),v.push(y)}return{matches:v,limitHit:!1}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let s;if(!(r!==void 0&&(typeof r=="string"?r.startsWith("refs/heads/")?s={type:Ue.Branch,id:r.substr(11)}:r.startsWith("refs/tags/")?s={type:Ue.Tag,id:r.substr(10)}:s={type:Ue.Branch,id:r}:s={...r,type:r.type===Ue.Tree?Ue.Branch:r.type},(a==null?void 0:a.name)===s.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:s}),location:(n==null?void 0:n.openInNewWindow)?Bt.NewWindow:Bt.CurrentWindow}}async sync(e,r,n){var i,o,a,s,c,u;const d=new Be(`AzDO.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let f;try{const{metadata:p}=await this.fetchCore(e,!0,{to:n.to});if(p.HEAD.detached){f=" \u2022 Skipped; detached HEAD";return}if(((o=(i=p==null?void 0:p.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){d.logStep("Fetching upstream changes");const g=[],_=(s=(a=p.state)==null?void 0:a.incomingChanges)!=null?s:[];if(_.length>0){const v=await r.getChanges(e);for(const y of v){const x=this.providerService.getRelativeFilePath(e,y.uri),C=_.find(k=>k.uri.path===y.uri.path);if(C!==void 0){g.push({path:x,current:y,incomingType:C.type});break}}}if(g.length>0)switch(n.conflictResolution){case cr.KeepCurrent:d.logStep("Syncing (keep) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const v of g)await r.keep(v.current.uri,{type:v.incomingType,providerUri:af(p,p.HEAD.branch.sha,v.path)});break;case cr.DiscardCurrent:d.logStep("Syncing (discard) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const v of g)await r.discard(v.current.uri);break;case cr.Merge:d.logStep("Syncing (merge) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const v of g)await r.merge(v.current.uri,{type:v.incomingType,providerUri:af(p,p.HEAD.branch.sha,v.path)},{providerUri:af(p,p.HEAD.sha,v.path)});break;case cr.Abort:default:throw d.logStep("Syncing (abort) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,p),new Vt}}f=` \u2022 to=${(c=n.to)!=null?c:p.HEAD.branch.sha}`,await this.fastForwardTo(e,(u=n.to)!=null?u:p.HEAD.branch.sha,p)}finally{d.stop(f?{suffix:f}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new he("Unable to fast-forward; no current branch");n.HEAD.sha===r&&n.state===void 0||(E.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&await this.fetchCore(e,!1,{to:r}))}async getBranchTips(e,r){try{const{repo:{organization:n,project:i,name:o},HEAD:{branch:a}}=await this.getMetadata(e);r===void 0?r=a?`heads/${a.name}`:"":r.startsWith("refs/")&&(r=r.slice(5));const s=`git/repositories/${o}/refs`,c=`includeLinks=true&filter=${r}`,u=await this.sendGetRequest(n,s,i,c),d=u==null?void 0:u.value;if(d===[])return;const f={target:{oid:d[0].objectId}},p=`git/repositories/${o}`,g=await this.sendGetRequest(n,p,i);let _=g==null?void 0:g.defaultBranch;_.startsWith("refs/")&&(_=_.slice(5));const v=`git/repositories/${o}/refs`,y=`includeLinks=true&filter=${_}`,x=await this.sendGetRequest(n,v,i,y),C=x==null?void 0:x.value;if(C===[])return;const k={target:{oid:C[0].objectId}};if(!k&&!f)return;const I=k?{sha:k.target.oid}:void 0,B=f?{sha:f.target.oid}:void 0;return{defaultBranch:I,branch:B}}catch(n){return}}async getRepositoryId(e,r,n){const i=`git/repositories/${n}`,o=await this.sendGetRequest(e,i,r);if(o){if(o.id)return o.id;throw new Error("Sign in page was returned for repoId. Check the token sent")}throw new Error("Can't get Repo Id")}async getRepositoryInfo(e,r,n,i){const o=await this.getRepositoryId(e,r,n),a=`git/repositories/${o}`,s=await this.sendGetRequest(e,a,r);if(!s)return;s.defaultBranch.startsWith("refs/heads/")&&(s.defaultBranch=s.defaultBranch.substr(11));const c=`git/repositories/${n}/stats/branches`,u=`name=${s.defaultBranch}`,d=await this.sendGetRequest(e,c,r,u);if(!d)return;const f={user:"jepetty",repo:{organization:e,project:r,name:n,id:o},accessLevel:De.Read,defaultBranch:{name:d.name,sha:d.commit.commitId}};if(i.type===Ue.Branch){const p=`git/repositories/${n}/stats/branches`,g=`name=${i.id}`,_=await this.sendGetRequest(e,p,r,g);if(_)return{...f,ref:{name:_.name,sha:_.commit.commitId,prefix:"refs/heads/"}}}else if(i.type===Ue.Tag){const p=`git/repositories/${o}/items`,g=`versionDescriptor.version=${i.id}&versionDescriptor.versionType=tag`,_=await this.sendGetRequest(e,p,r,g);if(_&&_.value.length===1)return{...f,ref:{name:i.id,sha:_.value[0].commitId,prefix:"refs/tags/"}}}else{if(i.type===Ue.Commit)return i.id==="HEAD"&&(i.id=s.defaultBranch),{...f,ref:{name:i.id,sha:Gt(i.id)?i.id:d.commit.commitId,prefix:Gt(i.id)?"":"refs/heads/"}};throw new Error("Not supported yet :(")}}}l(sf,"AzDORepositoryProvider"),Zx([Er()],sf.prototype,"ensureAuthenticated",1);class Wv{constructor(e,r){this.providerService=e,this.changeStore=r,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepositories(n=>{for(const i of n.added)this.repositoryOpened(i);for(const i of n.removed)this.repositoryClosed(i)}),j.onDidChange(n=>{for(const i of this.services.values()){const o=i.service.getRepository();n.affectsConfiguration("remoteHub.richNavigation.indexMode",o.uri)&&i.service.updateIndexMode().catch(a=>{E.error(a)})}}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const r=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(e){const r=W(e.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e,this.changeStore);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(e){const r=W(e.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(W(e.uri)))}}l(Wv,"CodeNavigationServices");/*! (c) Andrea Giammarchi - ISC */var Hl={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;Hl.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,r,n){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,s=/%(?![0-9a-fA-F]{2})/g,c=/\+/g,u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},d={append:function(C,k){_(this._ungap,C,k)},delete:function(C){delete this._ungap[C]},get:function(C){return this.has(C)?this._ungap[C][0]:null},getAll:function(C){return this.has(C)?this._ungap[C].slice(0):[]},has:function(C){return C in this._ungap},set:function(C,k){this._ungap[C]=[r(k)]},forEach:function(C,k){var I=this;for(var B in I._ungap)I._ungap[B].forEach(J,B);function J(re){C.call(k,re,r(B),I)}l(J,"invoke")},toJSON:function(){return{}},toString:function(){var C=[];for(var k in this._ungap)for(var I=y(k),B=0,J=this._ungap[k];B<J.length;B++)C.push(I+"="+y(J[B]));return C.join("&")}};for(var f in d)o(p.prototype,f,{configurable:!0,writable:!0,value:d[f]});Hl.URLSearchParams=p;function p(C){var k=i(null);switch(o(this,"_ungap",{value:k}),!0){case!C:break;case typeof C=="string":C.charAt(0)==="?"&&(C=C.slice(1));for(var I=C.split("&"),B=0,J=I.length;B<J;B++){var re=I[B],K=re.indexOf("=");-1<K?_(k,v(re.slice(0,K)),v(re.slice(K+1))):re.length&&_(k,v(re),"")}break;case n(C):for(var B=0,J=C.length;B<J;B++){var re=C[B];_(k,re[0],re[1])}break;case"forEach"in C:C.forEach(g,k);break;default:for(var we in C)_(k,we,C[we])}}l(p,"URLSearchParams");function g(C,k){_(this,k,C)}l(g,"addEach");function _(C,k,I){var B=n(I)?I.join(","):I;k in C?C[k].push(B):C[k]=[B]}l(_,"appendTo");function v(C){return decodeURIComponent(C.replace(s,"%25").replace(c," "))}l(v,"decode");function y(C){return encodeURIComponent(C).replace(a,x)}l(y,"encode");function x(C){return u[C]}l(x,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in t||(t.forEach=l(function(i,o){var a=this,s=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(c){!c.length||c in s||(s[c]=a.getAll(c)).forEach(function(u){i.call(o,u,c,a)})})},"forEach")),"keys"in t||(t.keys=l(function(){return r(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=l(function(){return r(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=l(function(){return r(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=l(function(){for(var i=this.entries(),o=i.next(),a=o.done,s=[],c=Object.create(null),u,d,f;!a;)f=o.value,d=f[0],s.push(d),d in c||(c[d]=[]),c[d].push(f[1]),o=i.next(),a=o.done;for(s.sort(),u=0;u<s.length;u++)this.delete(s[u]);for(u=0;u<s.length;u++)d=s[u],this.append(d,c[d].shift())},"sort"));function r(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}l(r,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,a=l(function(f){function p(v,y){t.append.call(this,v,y),v=this.toString(),f.set.call(this._usp,v?"?"+v:"")}l(p,"append");function g(v){t.delete.call(this,v),v=this.toString(),f.set.call(this._usp,v?"?"+v:"")}l(g,"del");function _(v,y){t.set.call(this,v,y),v=this.toString(),f.set.call(this._usp,v?"?"+v:"")}return l(_,"set"),function(v,y){return v.append=p,v.delete=g,v.set=_,i(v,"_usp",{configurable:!0,writable:!0,value:y})}},"createSearchParamsPollute"),s=l(function(f){return function(p,g){return i(p,"_searchParams",{configurable:!0,writable:!0,value:f(g,p)}),g}},"createSearchParamsCreate"),c=l(function(f){var p=f.append;f.append=t.append,URLSearchParams.call(f,f._usp.search.slice(1)),f.append=p},"updateSearchParams"),u=l(function(f,p){if(!(f instanceof p))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+p.name)},"verifySearchParams"),d=l(function(f){var p=f.prototype,g=o(p,"searchParams"),_=o(p,"href"),v=o(p,"search"),y;!g&&v&&v.set&&(y=s(a(v)),n.defineProperties(p,{href:{get:function(){return _.get.call(this)},set:function(x){var C=this._searchParams;_.set.call(this,x),C&&c(C)}},search:{get:function(){return v.get.call(this)},set:function(x){var C=this._searchParams;v.set.call(this,x),C&&c(C)}},searchParams:{get:function(){return u(this,f),this._searchParams||y(this,new URLSearchParams(this.search.slice(1)))},set:function(x){u(this,f),y(this,x)}}}))},"upgradeClass");try{d(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&d(URL)}catch(f){}}(Object)})(Hl.URLSearchParams.prototype,Object);const zv=Hl.URLSearchParams;var Jx=__webpack_require__(6822);const nt=(0,O.loadMessageBundle)(),cf=60,lf=cf*60,zs=lf*24,qv=zs*7,jv=zs*30,Vv=zs*365;function qs(t,e){typeof t!="number"&&(t=t.getTime());const r=Math.round((new Date().getTime()-t)/1e3);if(r<-30)return nt("date.fromNow.in","in {0}",qs(new Date().getTime()+r*1e3,{ago:!1,short:e==null?void 0:e.short}));if(r<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?nt("date.fromNow.seconds.short.ago","secs ago"):nt("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?nt("date.fromNow.now.short","now"):nt("date.fromNow.now","Just now");let n;return r<cf?(n=r,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):nt("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?nt("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):nt("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.seconds.singular.short","{0} sec",n):nt("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?nt("date.fromNow.seconds.plural.short","{0} secs",n):nt("date.fromNow.seconds.plural","{0} seconds",n)):r<lf?(n=Math.floor(r/cf),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.minutes.singular.short.ago","{0} min ago",n):nt("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?nt("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):nt("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.minutes.singular.short","{0} min",n):nt("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?nt("date.fromNow.minutes.plural.short","{0} mins",n):nt("date.fromNow.minutes.plural","{0} minutes",n)):r<zs?(n=Math.floor(r/lf),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.hours.singular.short.ago","{0} hr ago",n):nt("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?nt("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):nt("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.hours.singular.short","{0} hr",n):nt("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?nt("date.fromNow.hours.plural.short","{0} hrs",n):nt("date.fromNow.hours.plural","{0} hours",n)):r<qv?(n=Math.floor(r/zs),(e==null?void 0:e.ago)?n===1?nt("date.fromNow.days.singular.ago","{0} day ago",n):nt("date.fromNow.days.plural.ago","{0} days ago",n):n===1?nt("date.fromNow.days.singular","{0} day",n):nt("date.fromNow.days.plural","{0} days",n)):r<jv?(n=Math.floor(r/qv),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):nt("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?nt("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):nt("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.weeks.singular.short","{0} wk",n):nt("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?nt("date.fromNow.weeks.plural.short","{0} wks",n):nt("date.fromNow.weeks.plural","{0} weeks",n)):r<Vv?(n=Math.floor(r/jv),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.months.singular.short.ago","{0} mo ago",n):nt("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?nt("date.fromNow.months.plural.short.ago","{0} mos ago",n):nt("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.months.singular.short","{0} mo",n):nt("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?nt("date.fromNow.months.plural.short","{0} mos",n):nt("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/Vv),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.years.singular.short.ago","{0} yr ago",n):nt("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?nt("date.fromNow.years.plural.short.ago","{0} yrs ago",n):nt("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.years.singular.short","{0} yr",n):nt("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?nt("date.fromNow.years.plural.short","{0} yrs",n):nt("date.fromNow.years.plural","{0} years",n))}l(qs,"fromNow");var Gv,Mr;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Mr||(Mr={}));class Kv{constructor(){this[Gv]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,r=Mr.None){const n=this._map.get(e);if(!!n)return r!==Mr.None&&this.touch(n,r),n.value}set(e,r,n=Mr.None){let i=this._map.get(e);if(i)i.value=r,n!==Mr.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case Mr.None:this.addItemLast(i);break;case Mr.First:this.addItemFirst(i);break;case Mr.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const r=this._map.get(e);if(!!r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){const n=this._state;let i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(Gv=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==Mr.First&&r!==Mr.Last)){if(r===Mr.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===Mr.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(const[r,n]of e)this.set(r,n)}}l(Kv,"LinkedMap");class Ei extends Kv{constructor(e,r=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=Mr.AsNew){return super.get(e,r)}peek(e){return super.get(e,Mr.None)}set(e,r){return super.set(e,r,Mr.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}l(Ei,"LRUCache");function eS(t,e,r){return new Gi(new uf(t),new uf(e)).ComputeDiff(r).changes}l(eS,"stringDiff");class Ri{constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}l(Ri,"DiffChange");var Qv;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(Qv||(Qv={}));function Zv(t,e){return(e<<5)-e+t|0}l(Zv,"numberHash");function tS(t,e){e=Zv(149417,e);for(let r=0,n=t.length;r<n;r++)e=Zv(t.charCodeAt(r),e);return e}l(tS,"stringHash");class uf{constructor(e){this.source=e}getElements(){const e=this.source,r=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r}}l(uf,"StringDiffSequence");class ko{static Assert(e,r){if(!e)throw new Error(r)}}l(ko,"Debug");class Io{static Copy(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}static Copy2(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}}l(Io,"MyArray");var Xv;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(Xv||(Xv={}));class df{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Ri(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}l(df,"DiffChangeHelper");class Gi{constructor(e,r,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=r;const[i,o,a]=Gi._getElements(e),[s,c,u]=Gi._getElements(r);this._hasStrings=a&&u,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=c,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const r=e.getElements();if(Gi._isStringArray(r)){const n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=tS(r[i],0);return[r,n,!0]}return r instanceof Int32Array?[[],r,!1]:[[],new Int32Array(r),!1]}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[r]:!0}ElementsAreStrictEqual(e,r){if(!this.ElementsAreEqual(e,r))return!1;const n=Gi._getStrictElement(this._originalSequence,e),i=Gi._getStrictElement(this._modifiedSequence,r);return n===i}static _getStrictElement(e,r){return typeof e.getStrictElement=="function"?e.getStrictElement(r):null}OriginalElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[r]:!0}ModifiedElementsAreEqual(e,r){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[r]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,r,n,i,o){const a=[!1];let s=this.ComputeDiffRecursive(e,r,n,i,a);return o&&(s=this.PrettifyChanges(s)),{quitEarly:a[0],changes:s}}ComputeDiffRecursive(e,r,n,i,o){for(o[0]=!1;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let f;return n<=i?(ko.Assert(e===r+1,"originalStart should only be one more than originalEnd"),f=[new Ri(e,0,n,i-n+1)]):e<=r?(ko.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[new Ri(e,r-e+1,n,0)]):(ko.Assert(e===r+1,"originalStart should only be one more than originalEnd"),ko.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[]),f}const a=[0],s=[0],c=this.ComputeRecursionPoint(e,r,n,i,a,s,o),u=a[0],d=s[0];if(c!==null)return c;if(!o[0]){const f=this.ComputeDiffRecursive(e,u,n,d,o);let p=[];return o[0]?p=[new Ri(u+1,r-(u+1)+1,d+1,i-(d+1)+1)]:p=this.ComputeDiffRecursive(u+1,r,d+1,i,o),this.ConcatenateChanges(f,p)}return[new Ri(e,r-e+1,n,i-n+1)]}WALKTRACE(e,r,n,i,o,a,s,c,u,d,f,p,g,_,v,y,x,C){let k=null,I=null,B=new df,J=r,re=n,K=g[0]-y[0]-i,we=-1073741824,ie=this.m_forwardHistory.length-1;do{const pe=K+e;pe===J||pe<re&&u[pe-1]<u[pe+1]?(f=u[pe+1],_=f-K-i,f<we&&B.MarkNextChange(),we=f,B.AddModifiedElement(f+1,_),K=pe+1-e):(f=u[pe-1]+1,_=f-K-i,f<we&&B.MarkNextChange(),we=f-1,B.AddOriginalElement(f,_+1),K=pe-1-e),ie>=0&&(u=this.m_forwardHistory[ie],e=u[0],J=1,re=u.length-1)}while(--ie>=-1);if(k=B.getReverseChanges(),C[0]){let pe=g[0]+1,Se=y[0]+1;if(k!==null&&k.length>0){const Je=k[k.length-1];pe=Math.max(pe,Je.getOriginalEnd()),Se=Math.max(Se,Je.getModifiedEnd())}I=[new Ri(pe,p-pe+1,Se,v-Se+1)]}else{B=new df,J=a,re=s,K=g[0]-y[0]-c,we=1073741824,ie=x?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const pe=K+o;pe===J||pe<re&&d[pe-1]>=d[pe+1]?(f=d[pe+1]-1,_=f-K-c,f>we&&B.MarkNextChange(),we=f+1,B.AddOriginalElement(f+1,_+1),K=pe+1-o):(f=d[pe-1],_=f-K-c,f>we&&B.MarkNextChange(),we=f,B.AddModifiedElement(f+1,_+1),K=pe-1-o),ie>=0&&(d=this.m_reverseHistory[ie],o=d[0],J=1,re=d.length-1)}while(--ie>=-1);I=B.getChanges()}return this.ConcatenateChanges(k,I)}ComputeRecursionPoint(e,r,n,i,o,a,s){let c=0,u=0,d=0,f=0,p=0,g=0;e--,n--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const _=r-e+(i-n),v=_+1,y=new Int32Array(v),x=new Int32Array(v),C=i-n,k=r-e,I=e-n,B=r-i,re=(k-C)%2==0;y[C]=e,x[k]=r,s[0]=!1;for(let K=1;K<=_/2+1;K++){let we=0,ie=0;d=this.ClipDiagonalBound(C-K,K,C,v),f=this.ClipDiagonalBound(C+K,K,C,v);for(let Se=d;Se<=f;Se+=2){Se===d||Se<f&&y[Se-1]<y[Se+1]?c=y[Se+1]:c=y[Se-1]+1,u=c-(Se-C)-I;const Je=c;for(;c<r&&u<i&&this.ElementsAreEqual(c+1,u+1);)c++,u++;if(y[Se]=c,c+u>we+ie&&(we=c,ie=u),!re&&Math.abs(Se-k)<=K-1&&c>=x[Se])return o[0]=c,a[0]=u,Je<=x[Se]&&1447>0&&K<=1447+1?this.WALKTRACE(C,d,f,I,k,p,g,B,y,x,c,r,o,u,i,a,re,s):null}const pe=(we-e+(ie-n)-K)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(we,pe))return s[0]=!0,o[0]=we,a[0]=ie,pe>0&&1447>0&&K<=1447+1?this.WALKTRACE(C,d,f,I,k,p,g,B,y,x,c,r,o,u,i,a,re,s):(e++,n++,[new Ri(e,r-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(k-K,K,k,v),g=this.ClipDiagonalBound(k+K,K,k,v);for(let Se=p;Se<=g;Se+=2){Se===p||Se<g&&x[Se-1]>=x[Se+1]?c=x[Se+1]-1:c=x[Se-1],u=c-(Se-k)-B;const Je=c;for(;c>e&&u>n&&this.ElementsAreEqual(c,u);)c--,u--;if(x[Se]=c,re&&Math.abs(Se-C)<=K&&c<=y[Se])return o[0]=c,a[0]=u,Je>=y[Se]&&1447>0&&K<=1447+1?this.WALKTRACE(C,d,f,I,k,p,g,B,y,x,c,r,o,u,i,a,re,s):null}if(K<=1447){let Se=new Int32Array(f-d+2);Se[0]=C-d+1,Io.Copy2(y,d,Se,1,f-d+1),this.m_forwardHistory.push(Se),Se=new Int32Array(g-p+2),Se[0]=k-p+1,Io.Copy2(x,p,Se,1,g-p+1),this.m_reverseHistory.push(Se)}}return this.WALKTRACE(C,d,f,I,k,p,g,B,y,x,c,r,o,u,i,a,re,s)}PrettifyChanges(e){for(let r=0;r<e.length;r++){const n=e[r],i=r<e.length-1?e[r+1].originalStart:this._originalElementsOrHash.length,o=r<e.length-1?e[r+1].modifiedStart:this._modifiedElementsOrHash.length,a=n.originalLength>0,s=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!s||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const u=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!u)break;n.originalStart++,n.modifiedStart++}let c=[null];if(r<e.length-1&&this.ChangesOverlap(e[r],e[r+1],c)){e[r]=c[0],e.splice(r+1,1),r--;continue}}for(let r=e.length-1;r>=0;r--){const n=e[r];let i=0,o=0;if(r>0){const f=e[r-1];i=f.originalStart+f.originalLength,o=f.modifiedStart+f.modifiedLength}const a=n.originalLength>0,s=n.modifiedLength>0;let c=0,u=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let f=1;;f++){const p=n.originalStart-f,g=n.modifiedStart-f;if(p<i||g<o||a&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||s&&!this.ModifiedElementsAreEqual(g,g+n.modifiedLength))break;const v=(p===i&&g===o?5:0)+this._boundaryScore(p,n.originalLength,g,n.modifiedLength);v>u&&(u=v,c=f)}n.originalStart-=c,n.modifiedStart-=c;const d=[null];if(r>0&&this.ChangesOverlap(e[r-1],e[r],d)){e[r-1]=d[0],e.splice(r,1),r++;continue}}if(this._hasStrings)for(let r=1,n=e.length;r<n;r++){const i=e[r-1],o=e[r],a=o.originalStart-i.originalStart-i.originalLength,s=i.originalStart,c=o.originalStart+o.originalLength,u=c-s,d=i.modifiedStart,f=o.modifiedStart+o.modifiedLength,p=f-d;if(a<5&&u<20&&p<20){const g=this._findBetterContiguousSequence(s,u,d,p,a);if(g){const[_,v]=g;(_!==i.originalStart+i.originalLength||v!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=_-i.originalStart,i.modifiedLength=v-i.modifiedStart,o.originalStart=_+a,o.modifiedStart=v+a,o.originalLength=c-o.originalStart,o.modifiedLength=f-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,r,n,i,o){if(r<o||i<o)return null;const a=e+r-o+1,s=n+i-o+1;let c=0,u=0,d=0;for(let f=e;f<a;f++)for(let p=n;p<s;p++){const g=this._contiguousSequenceScore(f,p,o);g>0&&g>c&&(c=g,u=f,d=p)}return c>0?[u,d]:null}_contiguousSequenceScore(e,r,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,r+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,r){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,r){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,r,n,i){const o=this._OriginalRegionIsBoundary(e,r)?1:0,a=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+a}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){const i=new Array(e.length+r.length-1);return Io.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Io.Copy(r,1,i,e.length,r.length-1),i}else{const i=new Array(e.length+r.length);return Io.Copy(e,0,i,0,e.length),Io.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(ko.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),ko.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(s=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new Ri(i,o,a,s),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;const o=n,a=i-n-1,s=r%2==0;if(e<0){const c=o%2==0;return s===c?0:1}else{const c=a%2==0;return s===c?i-1:i-2}}}l(Gi,"LcsDiff");var hf;(function(t){function e(n,i){return n instanceof Ta?i:new h.Position(i.line,i.character)}l(e,"makePosition"),t.makePosition=e;function r(n,i){return n instanceof Ta?i:new h.Range(i.start.line,i.start.character,i.end.line,i.end.character)}l(r,"makeRange"),t.makeRange=r})(hf||(hf={}));var Yv;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(Yv||(Yv={}));const Jv=l(class{constructor(t,e,r,n){this.diffCache=new Ei(32),this.indexDocumentCache=new Ei(32),this.codeDocumentCache=new Ei(32),this.providerService=t,this.rootUri=e,this.index=r,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const r=t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===ht.Created||i===ht.Deleted)return;const o=await this.getIndexDocument(r);if(o===void 0)return;const a=this.getDiff(2,o,t);if(a.length===0)return e;const s=t.offsetAt(new h.Position(e.line,e.character));let c=s;for(const p of a){if(p.modifiedStart<=s&&s<p.modifiedStart+p.modifiedLength)return;if(c<p.modifiedStart)break;c=c-(p.modifiedLength-p.originalLength)}const u=o.positionAt(c),d=this.getWordAtOffset(o.lineAt(u.line).text,u.character),f=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(d===void 0||f===void 0||d!==f))return new h.Position(u.line,u.character)}async mapRangeFromIndexToCode(t,e){const r=t instanceof h.Uri?t:t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===ht.Created||i===ht.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(r),this.getCodeDocument(t)]);if(o===void 0||a===void 0)return;const s=this.getDiff(1,o,a);if(s.length===0)return e;const c=o.offsetAt(e.start);let u=c;const d=o.offsetAt(e.end);let f=d;for(const y of s){if(f<y.originalStart)break;const x=y.modifiedLength-y.originalLength;if(y.originalStart<=c){if(c<y.originalStart+y.originalLength)return;u+=x}else if(d<y.originalStart+y.originalLength)return;if(y.originalStart<=d){if(d<y.originalStart+y.originalLength)return;f+=x}}const p=a.positionAt(u),g=a.positionAt(f),_=o.getText(e),v=a.getText(hf.makeRange(a,{start:p,end:g}));if(_===v)return new h.Range(p.line,p.character,g.line,g.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof h.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,r){let n=t.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,r),t.set(e.toString(),n),n.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),n}async _getDocument(t,e){const r=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,r).then(n=>new Ta(t,Number.MAX_VALUE,Jv.textDecoder.decode(n)),()=>{})}getDiff(t,e,r){if(e.uri.toString()!==r.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${r.uri.toString()}) are pointing to a different document`);const n=`${t}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===r.version||(i={original:e.version,modified:r.version,changes:eS(e.getText(),r.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(t,e){let r="findStart",n=0,i=t.length,o=0;for(;o<t.length&&r!=="endFound";){switch(o===e&&(r="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(r){case"findStart":n=o+1;break;case"findEnd":i=o,r="endFound";break}break}o++}return r==="endFound"?t.substring(n,i):void 0}},"_DiffMapper");let e0=Jv;e0.textDecoder=new TextDecoder("utf8");var t0;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(t0||(t0={}));class Ta{static computeLineOffsets(e,r,n=0){const i=r?[n]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,r,n){this._content=n,this.uri=e,this.version=r,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Ta.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}lineAt(e){const r=this.getLineOffsets();if(e>=r.length)return{lineNumber:e,text:""};const n=r[e],i=r[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const r=this.getLineOffsets();let n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){const a=Math.floor((n+i)/2);r[a]>e?i=a:n=a+1}const o=n-1;return{line:o,character:e-r[o]}}offsetAt(e){const r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;const n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}l(Ta,"TextDocument");var r0;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(r0||(r0={}));var Wl;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(Wl||(Wl={}));var Qn;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=Wl.MAX_VALUE),i===Number.MAX_VALUE&&(i=Wl.MAX_VALUE),{line:n,character:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.objectLiteral(i)&&fe.uinteger(i.line)&&fe.uinteger(i.character)}l(r,"is"),t.is=r})(Qn||(Qn={}));var Tr;(function(t){function e(n,i,o,a){if(fe.uinteger(n)&&fe.uinteger(i)&&fe.uinteger(o)&&fe.uinteger(a))return{start:Qn.create(n,i),end:Qn.create(o,a)};if(Qn.is(n)&&Qn.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+a+"]")}l(e,"create"),t.create=e;function r(n){var i=n;return fe.objectLiteral(i)&&Qn.is(i.start)&&Qn.is(i.end)}l(r,"is"),t.is=r})(Tr||(Tr={}));var ff;(function(t){function e(n,i){return{uri:n,range:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&Tr.is(i.range)&&(fe.string(i.uri)||fe.undefined(i.uri))}l(r,"is"),t.is=r})(ff||(ff={}));var zl;(function(t){function e(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&Tr.is(i.targetRange)&&fe.string(i.targetUri)&&(Tr.is(i.targetSelectionRange)||fe.undefined(i.targetSelectionRange))&&(Tr.is(i.originSelectionRange)||fe.undefined(i.originSelectionRange))}l(r,"is"),t.is=r})(zl||(zl={}));var pf;(function(t){function e(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.numberRange(i.red,0,1)&&fe.numberRange(i.green,0,1)&&fe.numberRange(i.blue,0,1)&&fe.numberRange(i.alpha,0,1)}l(r,"is"),t.is=r})(pf||(pf={}));var n0;(function(t){function e(n,i){return{range:n,color:i}}l(e,"create"),t.create=e;function r(n){var i=n;return Tr.is(i.range)&&pf.is(i.color)}l(r,"is"),t.is=r})(n0||(n0={}));var i0;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.string(i.label)&&(fe.undefined(i.textEdit)||Ki.is(i))&&(fe.undefined(i.additionalTextEdits)||fe.typedArray(i.additionalTextEdits,Ki.is))}l(r,"is"),t.is=r})(i0||(i0={}));var js;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(js||(js={}));var o0;(function(t){function e(n,i,o,a,s){var c={startLine:n,endLine:i};return fe.defined(o)&&(c.startCharacter=o),fe.defined(a)&&(c.endCharacter=a),fe.defined(s)&&(c.kind=s),c}l(e,"create"),t.create=e;function r(n){var i=n;return fe.uinteger(i.startLine)&&fe.uinteger(i.startLine)&&(fe.undefined(i.startCharacter)||fe.uinteger(i.startCharacter))&&(fe.undefined(i.endCharacter)||fe.uinteger(i.endCharacter))&&(fe.undefined(i.kind)||fe.string(i.kind))}l(r,"is"),t.is=r})(o0||(o0={}));var gf;(function(t){function e(n,i){return{location:n,message:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&ff.is(i.location)&&fe.string(i.message)}l(r,"is"),t.is=r})(gf||(gf={}));var ka;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(ka||(ka={}));var ql;(function(t){t.Unnecessary=1,t.Deprecated=2})(ql||(ql={}));var mf;(function(t){function e(r){var n=r;return n!=null&&fe.string(n.href)}l(e,"is"),t.is=e})(mf||(mf={}));var jl;(function(t){function e(n,i,o,a,s,c){var u={range:n,message:i};return fe.defined(o)&&(u.severity=o),fe.defined(a)&&(u.code=a),fe.defined(s)&&(u.source=s),fe.defined(c)&&(u.relatedInformation=c),u}l(e,"create"),t.create=e;function r(n){var i,o=n;return fe.defined(o)&&Tr.is(o.range)&&fe.string(o.message)&&(fe.number(o.severity)||fe.undefined(o.severity))&&(fe.integer(o.code)||fe.string(o.code)||fe.undefined(o.code))&&(fe.undefined(o.codeDescription)||fe.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(fe.string(o.source)||fe.undefined(o.source))&&(fe.undefined(o.relatedInformation)||fe.typedArray(o.relatedInformation,gf.is))}l(r,"is"),t.is=r})(jl||(jl={}));var Vs;(function(t){function e(n,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s={title:n,command:i};return fe.defined(o)&&o.length>0&&(s.arguments=o),s}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.string(i.title)&&fe.string(i.command)}l(r,"is"),t.is=r})(Vs||(Vs={}));var Ki;(function(t){function e(o,a){return{range:o,newText:a}}l(e,"replace"),t.replace=e;function r(o,a){return{range:{start:o,end:o},newText:a}}l(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}l(n,"del"),t.del=n;function i(o){var a=o;return fe.objectLiteral(a)&&fe.string(a.newText)&&Tr.is(a.range)}l(i,"is"),t.is=i})(Ki||(Ki={}));var Ia;(function(t){function e(n,i,o){var a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}l(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&fe.objectLiteral(i)&&fe.string(i.label)&&(fe.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(fe.string(i.description)||i.description===void 0)}l(r,"is"),t.is=r})(Ia||(Ia={}));var Br;(function(t){function e(r){var n=r;return typeof n=="string"}l(e,"is"),t.is=e})(Br||(Br={}));var Qi;(function(t){function e(o,a,s){return{range:o,newText:a,annotationId:s}}l(e,"replace"),t.replace=e;function r(o,a,s){return{range:{start:o,end:o},newText:a,annotationId:s}}l(r,"insert"),t.insert=r;function n(o,a){return{range:o,newText:"",annotationId:a}}l(n,"del"),t.del=n;function i(o){var a=o;return Ki.is(a)&&(Ia.is(a.annotationId)||Br.is(a.annotationId))}l(i,"is"),t.is=i})(Qi||(Qi={}));var Gs;(function(t){function e(n,i){return{textDocument:n,edits:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&Gl.is(i.textDocument)&&Array.isArray(i.edits)}l(r,"is"),t.is=r})(Gs||(Gs={}));var Da;(function(t){function e(n,i,o){var a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}l(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="create"&&fe.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||fe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||fe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Br.is(i.annotationId))}l(r,"is"),t.is=r})(Da||(Da={}));var Fa;(function(t){function e(n,i,o,a){var s={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(s.options=o),a!==void 0&&(s.annotationId=a),s}l(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="rename"&&fe.string(i.oldUri)&&fe.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||fe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||fe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Br.is(i.annotationId))}l(r,"is"),t.is=r})(Fa||(Fa={}));var Pa;(function(t){function e(n,i,o){var a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}l(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="delete"&&fe.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||fe.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||fe.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Br.is(i.annotationId))}l(r,"is"),t.is=r})(Pa||(Pa={}));var vf;(function(t){function e(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return fe.string(i.kind)?Da.is(i)||Fa.is(i)||Pa.is(i):Gs.is(i)}))}l(e,"is"),t.is=e})(vf||(vf={}));var Vl=function(){function t(e,r){this.edits=e,this.changeAnnotations=r}return l(t,"TextEditChangeImpl"),t.prototype.insert=function(e,r,n){var i,o;if(n===void 0?i=Ki.insert(e,r):Br.is(n)?(o=n,i=Qi.insert(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Qi.insert(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,r,n){var i,o;if(n===void 0?i=Ki.replace(e,r):Br.is(n)?(o=n,i=Qi.replace(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Qi.replace(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,r){var n,i;if(r===void 0?n=Ki.del(e):Br.is(r)?(i=r,n=Qi.del(e,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=Qi.del(e,i)),this.edits.push(n),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),a0=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return l(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,r){var n;if(Br.is(e)?n=e:(n=this.nextId(),r=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),PR=function(){function t(e){var r=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new a0(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(Gs.is(n)){var i=new Vl(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new Vl(e.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return l(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Gl.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:e.uri,version:e.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new Vl(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new Vl(i),this._textEditChanges[e]=n}return n}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new a0,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Ia.is(r)||Br.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Da.create(e,n):(a=Br.is(i)?i:this._changeAnnotations.manage(i),o=Da.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t.prototype.renameFile=function(e,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;Ia.is(n)||Br.is(n)?o=n:i=n;var a,s;if(o===void 0?a=Fa.create(e,r,i):(s=Br.is(o)?o:this._changeAnnotations.manage(o),a=Fa.create(e,r,i,s)),this._workspaceEdit.documentChanges.push(a),s!==void 0)return s},t.prototype.deleteFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Ia.is(r)||Br.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Pa.create(e,n):(a=Br.is(i)?i:this._changeAnnotations.manage(i),o=Pa.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t}(),s0;(function(t){function e(n){return{uri:n}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.string(i.uri)}l(r,"is"),t.is=r})(s0||(s0={}));var c0;(function(t){function e(n,i){return{uri:n,version:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.string(i.uri)&&fe.integer(i.version)}l(r,"is"),t.is=r})(c0||(c0={}));var Gl;(function(t){function e(n,i){return{uri:n,version:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.string(i.uri)&&(i.version===null||fe.integer(i.version))}l(r,"is"),t.is=r})(Gl||(Gl={}));var l0;(function(t){function e(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.string(i.uri)&&fe.string(i.languageId)&&fe.integer(i.version)&&fe.string(i.text)}l(r,"is"),t.is=r})(l0||(l0={}));var Ai;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(Ai||(Ai={})),function(t){function e(r){var n=r;return n===t.PlainText||n===t.Markdown}l(e,"is"),t.is=e}(Ai||(Ai={}));var wf;(function(t){function e(r){var n=r;return fe.objectLiteral(r)&&Ai.is(n.kind)&&fe.string(n.value)}l(e,"is"),t.is=e})(wf||(wf={}));var u0;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(u0||(u0={}));var d0;(function(t){t.PlainText=1,t.Snippet=2})(d0||(d0={}));var h0;(function(t){t.Deprecated=1})(h0||(h0={}));var f0;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}l(e,"create"),t.create=e;function r(n){var i=n;return i&&fe.string(i.newText)&&Tr.is(i.insert)&&Tr.is(i.replace)}l(r,"is"),t.is=r})(f0||(f0={}));var p0;(function(t){t.asIs=1,t.adjustIndentation=2})(p0||(p0={}));var g0;(function(t){function e(r){return{label:r}}l(e,"create"),t.create=e})(g0||(g0={}));var m0;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}l(e,"create"),t.create=e})(m0||(m0={}));var Kl;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}l(e,"fromPlainText"),t.fromPlainText=e;function r(n){var i=n;return fe.string(i)||fe.objectLiteral(i)&&fe.string(i.language)&&fe.string(i.value)}l(r,"is"),t.is=r})(Kl||(Kl={}));var v0;(function(t){function e(r){var n=r;return!!n&&fe.objectLiteral(n)&&(wf.is(n.contents)||Kl.is(n.contents)||fe.typedArray(n.contents,Kl.is))&&(r.range===void 0||Tr.is(r.range))}l(e,"is"),t.is=e})(v0||(v0={}));var w0;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}l(e,"create"),t.create=e})(w0||(w0={}));var y0;(function(t){function e(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:r};return fe.defined(n)&&(a.documentation=n),fe.defined(i)?a.parameters=i:a.parameters=[],a}l(e,"create"),t.create=e})(y0||(y0={}));var Ks;(function(t){t.Text=1,t.Read=2,t.Write=3})(Ks||(Ks={}));var b0;(function(t){function e(r,n){var i={range:r};return fe.number(n)&&(i.kind=n),i}l(e,"create"),t.create=e})(b0||(b0={}));var yf;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(yf||(yf={}));var bf;(function(t){t.Deprecated=1})(bf||(bf={}));var _0;(function(t){function e(r,n,i,o,a){var s={name:r,kind:n,location:{uri:o,range:i}};return a&&(s.containerName=a),s}l(e,"create"),t.create=e})(_0||(_0={}));var x0;(function(t){function e(n,i,o,a,s,c){var u={name:n,detail:i,kind:o,range:a,selectionRange:s};return c!==void 0&&(u.children=c),u}l(e,"create"),t.create=e;function r(n){var i=n;return i&&fe.string(i.name)&&fe.number(i.kind)&&Tr.is(i.range)&&Tr.is(i.selectionRange)&&(i.detail===void 0||fe.string(i.detail))&&(i.deprecated===void 0||fe.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}l(r,"is"),t.is=r})(x0||(x0={}));var Zn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Zn||(Zn={}));var S0;(function(t){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.typedArray(i.diagnostics,jl.is)&&(i.only===void 0||fe.typedArray(i.only,fe.string))}l(r,"is"),t.is=r})(S0||(S0={}));var C0;(function(t){function e(n,i,o){var a={title:n},s=!0;return typeof i=="string"?(s=!1,a.kind=i):Vs.is(i)?a.command=i:a.edit=i,s&&o!==void 0&&(a.kind=o),a}l(e,"create"),t.create=e;function r(n){var i=n;return i&&fe.string(i.title)&&(i.diagnostics===void 0||fe.typedArray(i.diagnostics,jl.is))&&(i.kind===void 0||fe.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Vs.is(i.command))&&(i.isPreferred===void 0||fe.boolean(i.isPreferred))&&(i.edit===void 0||vf.is(i.edit))}l(r,"is"),t.is=r})(C0||(C0={}));var E0;(function(t){function e(n,i){var o={range:n};return fe.defined(i)&&(o.data=i),o}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&Tr.is(i.range)&&(fe.undefined(i.command)||Vs.is(i.command))}l(r,"is"),t.is=r})(E0||(E0={}));var R0;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&fe.uinteger(i.tabSize)&&fe.boolean(i.insertSpaces)}l(r,"is"),t.is=r})(R0||(R0={}));var A0;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}l(e,"create"),t.create=e;function r(n){var i=n;return fe.defined(i)&&Tr.is(i.range)&&(fe.undefined(i.target)||fe.string(i.target))}l(r,"is"),t.is=r})(A0||(A0={}));var T0;(function(t){function e(n,i){return{range:n,parent:i}}l(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Tr.is(i.range)&&(i.parent===void 0||t.is(i.parent))}l(r,"is"),t.is=r})(T0||(T0={}));var NR=null,k0;(function(t){function e(o,a,s,c){return new rS(o,a,s,c)}l(e,"create"),t.create=e;function r(o){var a=o;return!!(fe.defined(a)&&fe.string(a.uri)&&(fe.undefined(a.languageId)||fe.string(a.languageId))&&fe.uinteger(a.lineCount)&&fe.func(a.getText)&&fe.func(a.positionAt)&&fe.func(a.offsetAt))}l(r,"is"),t.is=r;function n(o,a){for(var s=o.getText(),c=i(a,function(_,v){var y=_.range.start.line-v.range.start.line;return y===0?_.range.start.character-v.range.start.character:y}),u=s.length,d=c.length-1;d>=0;d--){var f=c[d],p=o.offsetAt(f.range.start),g=o.offsetAt(f.range.end);if(g<=u)s=s.substring(0,p)+f.newText+s.substring(g,s.length);else throw new Error("Overlapping edit");u=p}return s}l(n,"applyEdits"),t.applyEdits=n;function i(o,a){if(o.length<=1)return o;var s=o.length/2|0,c=o.slice(0,s),u=o.slice(s);i(c,a),i(u,a);for(var d=0,f=0,p=0;d<c.length&&f<u.length;){var g=a(c[d],u[f]);g<=0?o[p++]=c[d++]:o[p++]=u[f++]}for(;d<c.length;)o[p++]=c[d++];for(;f<u.length;)o[p++]=u[f++];return o}l(i,"mergeSort")})(k0||(k0={}));var rS=function(){function t(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return l(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content},t.prototype.update=function(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(e.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return Qn.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>e?i=o:n=o+1}var a=n-1;return Qn.create(a,e-r[a])},t.prototype.offsetAt=function(e){var r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;var n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),fe;(function(t){var e=Object.prototype.toString;function r(g){return typeof g!="undefined"}l(r,"defined"),t.defined=r;function n(g){return typeof g=="undefined"}l(n,"undefined"),t.undefined=n;function i(g){return g===!0||g===!1}l(i,"boolean"),t.boolean=i;function o(g){return e.call(g)==="[object String]"}l(o,"string"),t.string=o;function a(g){return e.call(g)==="[object Number]"}l(a,"number"),t.number=a;function s(g,_,v){return e.call(g)==="[object Number]"&&_<=g&&g<=v}l(s,"numberRange"),t.numberRange=s;function c(g){return e.call(g)==="[object Number]"&&-2147483648<=g&&g<=2147483647}l(c,"integer"),t.integer=c;function u(g){return e.call(g)==="[object Number]"&&0<=g&&g<=2147483647}l(u,"uinteger"),t.uinteger=u;function d(g){return e.call(g)==="[object Function]"}l(d,"func"),t.func=d;function f(g){return g!==null&&typeof g=="object"}l(f,"objectLiteral"),t.objectLiteral=f;function p(g,_){return Array.isArray(g)&&g.every(_)}l(p,"typedArray"),t.typedArray=p})(fe||(fe={}));var Qs;(function(t){function e(n){return typeof n=="string"||n instanceof String}l(e,"string"),t.string=e;function r(n){return typeof n=="number"||n instanceof Number}l(r,"number"),t.number=r})(Qs||(Qs={}));var _f;(function(t){function e(r){const n=r;return n!=null&&(Qs.number(n.value)||Qs.string(n.value))&&Qs.string(n.target)}l(e,"is"),t.is=e})(_f||(_f={}));class I0 extends h.Diagnostic{constructor(e,r,n,i){super(e,r,n);this.data=i,this.hasDiagnosticCode=!1}}l(I0,"ProtocolDiagnostic");var Xn;(function(t){const e=Object.prototype.toString;function r(d){return typeof d!="undefined"}l(r,"defined"),t.defined=r;function n(d){return d===!0||d===!1}l(n,"boolean"),t.boolean=n;function i(d){return e.call(d)==="[object String]"}l(i,"string"),t.string=i;function o(d){return e.call(d)==="[object Number]"}l(o,"number"),t.number=o;function a(d){return d!==null&&typeof d=="object"}l(a,"objectLiteral"),t.objectLiteral=a;function s(d){return Array.isArray(d)}l(s,"array"),t.array=s;function c(d){return s(d)&&d.every(f=>i(f))}l(c,"stringArray"),t.stringArray=c;function u(d,f){return Array.isArray(d)&&d.every(f)}l(u,"typedArray"),t.typedArray=u})(Xn||(Xn={}));var Ql;(function(t){function e(r){const n=r;return n&&Xn.string(n.language)&&Xn.string(n.value)}l(e,"is"),t.is=e})(Ql||(Ql={}));function nS(t){const e=l(H=>h.Uri.parse(H),"nullConverter"),r=t!=null?t:e;function n(H){return r(H)}l(n,"asUri");function i(H){return H.map(o)}l(i,"asDiagnostics");function o(H){const ke=new I0(f(H.range),H.message,g(H.severity),H.data);return H.code!==void 0&&(mf.is(H.codeDescription)?ke.code={value:H.code,target:n(H.codeDescription.href)}:_f.is(H.code)?(ke.hasDiagnosticCode=!0,ke.code={value:H.code.value,target:n(H.code.target)}):ke.code=H.code),H.source&&(ke.source=H.source),H.relatedInformation&&(ke.relatedInformation=a(H.relatedInformation)),Array.isArray(H.tags)&&(ke.tags=c(H.tags)),ke}l(o,"asDiagnostic");function a(H){return H.map(s)}l(a,"asRelatedInformation");function s(H){return new h.DiagnosticRelatedInformation(K(H.location),H.message)}l(s,"asDiagnosticRelatedInformation");function c(H){if(!H)return;const ke=[];for(const bt of H){const Ir=u(bt);Ir!==void 0&&ke.push(Ir)}return ke.length>0?ke:void 0}l(c,"asDiagnosticTags");function u(H){switch(H){case ql.Unnecessary:return h.DiagnosticTag.Unnecessary;case ql.Deprecated:return h.DiagnosticTag.Deprecated;default:return}}l(u,"asDiagnosticTag");function d(H){if(!!H)return new h.Position(H.line,H.character)}l(d,"asPosition");function f(H){if(!!H)return new h.Range(d(H.start),d(H.end))}l(f,"asRange");function p(H){return H.map(ke=>f(ke))}l(p,"asRanges");function g(H){if(H==null)return h.DiagnosticSeverity.Error;switch(H){case ka.Error:return h.DiagnosticSeverity.Error;case ka.Warning:return h.DiagnosticSeverity.Warning;case ka.Information:return h.DiagnosticSeverity.Information;case ka.Hint:return h.DiagnosticSeverity.Hint}return h.DiagnosticSeverity.Error}l(g,"asDiagnosticSeverity");function _(H){if(Xn.string(H))return new h.MarkdownString(H);if(Ql.is(H))return new h.MarkdownString().appendCodeblock(H.value,H.language);if(Array.isArray(H)){const bt=[];for(const Ir of H){const Rc=new h.MarkdownString;Ql.is(Ir)?Rc.appendCodeblock(Ir.value,Ir.language):Rc.appendMarkdown(Ir),bt.push(Rc)}return bt}let ke;switch(H.kind){case Ai.Markdown:return new h.MarkdownString(H.value);case Ai.PlainText:return ke=new h.MarkdownString,ke.appendText(H.value),ke;default:return ke=new h.MarkdownString,ke.appendText(`Unsupported Markup content received. Kind is: ${H.kind}`),ke}}l(_,"asHoverContent");function v(H){if(Xn.string(H))return H;switch(H.kind){case Ai.Markdown:return new h.MarkdownString(H.value);case Ai.PlainText:return H.value;default:return`Unsupported Markup content received. Kind is: ${H.kind}`}}l(v,"asDocumentation");function y(H){if(!!H)return new h.Hover(_(H.contents),f(H.range))}l(y,"asHover");function x(H){if(!!H)return new h.TextEdit(f(H.range),H.newText)}l(x,"asTextEdit");function C(H){if(!!H)return H.map(x)}l(C,"asTextEdits");function k(H){if(!H)return;const ke=new h.SignatureHelp;return Xn.number(H.activeSignature)?ke.activeSignature=H.activeSignature:ke.activeSignature=0,Xn.number(H.activeParameter)?ke.activeParameter=H.activeParameter:ke.activeParameter=0,H.signatures&&(ke.signatures=I(H.signatures)),ke}l(k,"asSignatureHelp");function I(H){return H.map(B)}l(I,"asSignatureInformations");function B(H){const ke=new h.SignatureInformation(H.label);return H.documentation!==void 0&&(ke.documentation=v(H.documentation)),H.parameters!==void 0&&(ke.parameters=J(H.parameters)),H.activeParameter!==void 0&&(ke.activeParameter=H.activeParameter),ke}l(B,"asSignatureInformation");function J(H){return H.map(re)}l(J,"asParameterInformations");function re(H){const ke=new h.ParameterInformation(H.label);return H.documentation&&(ke.documentation=v(H.documentation)),ke}l(re,"asParameterInformation");function K(H){if(!!H)return new h.Location(r(H.uri),f(H.range))}l(K,"asLocation");function we(H){if(!!H)return Se(H)}l(we,"asDeclarationResult");function ie(H){if(!!H)return Se(H)}l(ie,"asDefinitionResult");function pe(H){if(!H)return;const ke={targetUri:r(H.targetUri),targetRange:f(H.targetSelectionRange),originSelectionRange:f(H.originSelectionRange),targetSelectionRange:f(H.targetSelectionRange)};if(!ke.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return ke}l(pe,"asLocationLink");function Se(H){if(!!H)return Xn.array(H)?H.length===0?[]:zl.is(H[0])?H.map(Ir=>pe(Ir)):H.map(bt=>K(bt)):zl.is(H)?[pe(H)]:K(H)}l(Se,"asLocationResult");function Je(H){if(!!H)return H.map(ke=>K(ke))}l(Je,"asReferences");function ae(H){if(!!H)return H.map(Ae)}l(ae,"asDocumentHighlights");function Ae(H){const ke=new h.DocumentHighlight(f(H.range));return Xn.number(H.kind)&&(ke.kind=Ne(H.kind)),ke}l(Ae,"asDocumentHighlight");function Ne(H){switch(H){case Ks.Text:return h.DocumentHighlightKind.Text;case Ks.Read:return h.DocumentHighlightKind.Read;case Ks.Write:return h.DocumentHighlightKind.Write}return h.DocumentHighlightKind.Text}l(Ne,"asDocumentHighlightKind");function Pe(H,ke){if(!!H)return H.map(bt=>Tt(bt,ke))}l(Pe,"asSymbolInformations");function Xe(H){return H<=yf.TypeParameter?H-1:h.SymbolKind.Property}l(Xe,"asSymbolKind");function it(H){switch(H){case bf.Deprecated:return h.SymbolTag.Deprecated;default:return}}l(it,"asSymbolTag");function ft(H){if(H==null)return;const ke=[];for(const bt of H){const Ir=it(bt);Ir!==void 0&&ke.push(Ir)}return ke.length===0?void 0:ke}l(ft,"asSymbolTags");function Tt(H,ke){const bt=new h.SymbolInformation(H.name,Xe(H.kind),f(H.location.range),H.location.uri?r(H.location.uri):ke);return be(bt,H),H.containerName&&(bt.containerName=H.containerName),bt}l(Tt,"asSymbolInformation");function Ht(H){if(H!=null)return H.map(vn)}l(Ht,"asDocumentSymbols");function vn(H){var ke;const bt=new h.DocumentSymbol(H.name,(ke=H.detail)!=null?ke:"",Xe(H.kind),f(H.range),f(H.selectionRange));if(be(bt,H),H.children!==void 0&&H.children.length>0){const Ir=[];for(const Rc of H.children)Ir.push(vn(Rc));bt.children=Ir}return bt}l(vn,"asDocumentSymbol");function be(H,ke){H.tags=ft(ke.tags),ke.deprecated&&(H.tags?H.tags.includes(h.SymbolTag.Deprecated)||(H.tags=H.tags.concat(h.SymbolTag.Deprecated)):H.tags=[h.SymbolTag.Deprecated])}l(be,"fillTags");function Me(H){const ke={title:H.title,command:H.command};return H.arguments&&(ke.arguments=H.arguments),ke}l(Me,"asCommand");function Ge(H){if(!!H)return H.map(Me)}l(Ge,"asCommands");const We=new Map;We.set(Zn.Empty,h.CodeActionKind.Empty),We.set(Zn.QuickFix,h.CodeActionKind.QuickFix),We.set(Zn.Refactor,h.CodeActionKind.Refactor),We.set(Zn.RefactorExtract,h.CodeActionKind.RefactorExtract),We.set(Zn.RefactorInline,h.CodeActionKind.RefactorInline),We.set(Zn.RefactorRewrite,h.CodeActionKind.RefactorRewrite),We.set(Zn.Source,h.CodeActionKind.Source),We.set(Zn.SourceOrganizeImports,h.CodeActionKind.SourceOrganizeImports);function et(H){if(H==null)return;let ke=We.get(H);if(ke)return ke;const bt=H.split(".");ke=h.CodeActionKind.Empty;for(const Ir of bt)ke=ke.append(Ir);return ke}l(et,"asCodeActionKind");function dt(H){if(H!=null)return H.map(ke=>et(ke))}l(dt,"asCodeActionKinds");function lt(H){if(H==null)return;const ke=new h.CodeAction(H.title);return H.kind!==void 0&&(ke.kind=et(H.kind)),H.diagnostics&&(ke.diagnostics=i(H.diagnostics)),H.edit&&(ke.edit=kt(H.edit)),H.command&&(ke.command=Me(H.command)),H.isPreferred!==void 0&&(ke.isPreferred=H.isPreferred),ke}l(lt,"asCodeAction");function kt(H){if(!H)return;const ke=new h.WorkspaceEdit;return H.documentChanges?H.documentChanges.forEach(bt=>{if(Da.is(bt))ke.createFile(r(bt.uri),bt.options);else if(Fa.is(bt))ke.renameFile(r(bt.oldUri),r(bt.newUri),bt.options);else if(Pa.is(bt))ke.deleteFile(r(bt.uri),bt.options);else if(Gs.is(bt))ke.set(r(bt.textDocument.uri),C(bt.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(bt,void 0,4)}`)}):H.changes&&Object.keys(H.changes).forEach(bt=>{ke.set(r(bt),C(H.changes[bt]))}),ke}l(kt,"asWorkspaceEdit");function Zt(H){return new h.Color(H.red,H.green,H.blue,H.alpha)}l(Zt,"asColor");function ar(H){return new h.ColorInformation(f(H.range),Zt(H.color))}l(ar,"asColorInformation");function Lr(H){if(Array.isArray(H))return H.map(ar)}l(Lr,"asColorInformations");function Pi(H){const ke=new h.ColorPresentation(H.label);return ke.additionalTextEdits=C(H.additionalTextEdits),H.textEdit&&(ke.textEdit=x(H.textEdit)),ke}l(Pi,"asColorPresentation");function Du(H){if(Array.isArray(H))return H.map(Pi)}l(Du,"asColorPresentations");function Va(H){if(H)switch(H){case js.Comment:return h.FoldingRangeKind.Comment;case js.Imports:return h.FoldingRangeKind.Imports;case js.Region:return h.FoldingRangeKind.Region}}l(Va,"asFoldingRangeKind");function wn(H){return new h.FoldingRange(H.startLine,H.endLine,Va(H.kind))}l(wn,"asFoldingRange");function Ep(H){if(Array.isArray(H))return H.map(wn)}l(Ep,"asFoldingRanges");function Rp(H){return new h.SelectionRange(f(H.range),H.parent?Rp(H.parent):void 0)}l(Rp,"asSelectionRange");function ER(H){if(!Array.isArray(H))return[];const ke=[];for(const bt of H)ke.push(Rp(bt));return ke}return l(ER,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:f,asRanges:p,asPosition:d,asDiagnosticSeverity:g,asDiagnosticTag:u,asHover:y,asTextEdit:x,asTextEdits:C,asSignatureHelp:k,asSignatureInformations:I,asSignatureInformation:B,asParameterInformations:J,asParameterInformation:re,asDeclarationResult:we,asDefinitionResult:ie,asLocation:K,asReferences:Je,asDocumentHighlights:ae,asDocumentHighlight:Ae,asDocumentHighlightKind:Ne,asSymbolKind:Xe,asSymbolTag:it,asSymbolTags:ft,asSymbolInformations:Pe,asSymbolInformation:Tt,asDocumentSymbols:Ht,asDocumentSymbol:vn,asCommand:Me,asCommands:Ge,asCodeAction:lt,asCodeActionKind:et,asCodeActionKinds:dt,asWorkspaceEdit:kt,asFoldingRangeKind:Va,asFoldingRange:wn,asFoldingRanges:Ep,asColor:Zt,asColorInformation:ar,asColorInformations:Lr,asColorPresentation:Pi,asColorPresentations:Du,asSelectionRange:Rp,asSelectionRanges:ER}}l(nS,"createConverter");const hr=(0,Jx.loadMessageBundle)();var Yn;(function(t){function e(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}l(e,"externalUri"),t.externalUri=e;function r(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}l(r,"externalIndexUri"),t.externalIndexUri=r})(Yn||(Yn={}));var Zi;(function(t){function e(i){if(i.HEAD.type===_e.Branch||i.HEAD.type===_e.RemoteBranch)return i.HEAD.name}l(e,"getBranchName"),t.getBranchName=e;function r(i){if(i.HEAD.type!==_e.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}l(r,"getIndexBranchName"),t.getIndexBranchName=r;async function n(i,o,a=yr.timeout){const s=await i.getMetadata(o),c=Yn.externalIndexUri(i,s),u=t.getIndexBranchName(s);if(!(c===void 0||u===void 0))return yr.getIndexedTip(c,u,{authentication:i.getAuthentication(o)},a)}l(n,"getIndexedTip"),t.getIndexedTip=n})(Zi||(Zi={}));var Zs;(function(t){const e=new Ei(1024);function r(a,s,c){let u=e.get(c);return u!==void 0||(u=a.getCommit(s,c),e.set(c,u)),u}l(r,"get"),t.get=r;async function n(a,s,c){const u=[];for(const f of c)u.push(r(a,s,f));const d=[];for(const f of await Promise.all(u))f!==void 0&&d.push(f);return d}l(n,"all"),t.all=n;function i(a,s){const c=a.commitDate,u=s.commitDate;return c===void 0&&u===void 0?0:c===void 0?1:u===void 0?-1:c<u?1:c>u?-1:0}l(i,"sort"),t.sort=i;function o(a){const s=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",c=a.commitDate!==void 0?`  \u2022  ${qs(a.commitDate,{ago:!0})}`:"",u=a.branchName!==void 0?` - ${a.branchName}`:"",d=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:s,date:c,branch:u,tag:d}}l(o,"getCommitInfo"),t.getCommitInfo=o})(Zs||(Zs={}));var D0;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(D0||(D0={}));var Zl;(function(t){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:r(n.BranchName),creationDate:new Date(n._ts*1e3)}}l(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function r(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}l(r,"getBranchName")})(Zl||(Zl={}));var yr;(function(t){t.timeout=5*60*1e3;const e=new Ei(32),r=new Ei(32);async function n(d,f,p,g=t.timeout){const _=await i(d,f,p,g);if(!(_===void 0||_.length===0))return _[0]}l(n,"getIndexedTip"),t.getIndexedTip=n;async function i(d,f,p,g=t.timeout){const _=a(d,f);let v=e.get(_);if(v===void 0||v!==void 0&&Date.now()-v.time>g){const y=hn.getAllWorkspaceSnapshots(d,p,f);v={time:Date.now(),promise:y,snapshots:void 0},e.set(_,v)}if(v.snapshots!==null){if(v.snapshots===void 0){let y=await v.promise;if(y===void 0){v.snapshots=null;return}y.sort((x,C)=>C.creationDate.getTime()-x.creationDate.getTime()),y=y.filter(x=>x.state===5||x.state===3),v.snapshots=y}return v.snapshots}}l(i,"all"),t.all=i;async function o(d,f,p,g,_=t.timeout){const v=d.toString();let y=r.get(v);if(y===null)return;if(y!==void 0)return y;const x=a(d,p),C=e.get(x);if(C!==void 0&&Date.now()-C.time<=_){if(C.snapshots===null)return;const k=C.snapshots!==void 0?C.snapshots:await i(d,p,g);if(k!==void 0){for(const I of k)if(I.commitId===f)return I}return}if(y=await hn.getWorkspaceSnapshot(f,g),y===void 0){r.set(v,null);return}return r.set(v,y),y}l(o,"single"),t.single=o;function a(d,f){return f!==void 0?`${f}\\${d.toString()}`:d.toString()}l(a,"getAllCacheKey");async function s(d,f,p,g=t.timeout){return await o(d,f,void 0,p,g)!==void 0}l(s,"exists"),t.exists=s;async function c(d,f,p,g=t.timeout){return await i(d,f,p,g)!==void 0}l(c,"branch"),t.branch=c;async function u(d,f,p){const g=new Map(p.map(y=>[y.commitId,y])),_=await Zs.all(d,f.uri,p.map(y=>y.commitId));if(_.length===0)return;const v=[];for(const y of _){const x=g.get(y.hash);x!==void 0&&v.push({...x,commit:y})}if(v.length!==0)return v}l(u,"resolve"),t.resolve=u})(yr||(yr={}));var Jn;(function(t){function e(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}l(e,"create"),t.create=e})(Jn||(Jn={}));var hn;(function(t){const e="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(x,C,k){var I;const B=await Gn(x,{method:"POST",body:JSON.stringify(C),headers:{"Content-Type":"application/json",...(await k.authentication).getRichNavigationHeaders(),"x-correlation-id":(I=k.correlationId)!=null?I:ef()}});if(!!B.ok)return B.json()}l(n,"postRequest");async function i(x,C,k){const I=await Gn(x,{method:"POST",body:C,headers:(await k.authentication).getRichNavigationHeaders()});if(!!I.ok)return await I.json()}l(i,"postForm");function o(x,C){return`${r}/${e}/HttpLanguageService/${x}/${C}`}l(o,"makeRequestUrl");async function a(x,C){const k=await Gn(`${r}/${e}/WorkspaceSnapshot?commitId=${x}`,{headers:(await C.authentication).getRichNavigationHeaders()});if(k.ok){const I=await k.json();return{workspaceId:I.workspaceId,snapshotId:I.snapshotId,state:I.state,commitId:x.toLowerCase(),branchName:void 0,creationDate:new Date}}}l(a,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=a;async function s(x,C,k){const I=new zv;I.append("uriString",x.toString(!0)),k!==void 0&&I.append("branchName",k);try{const B=await i(`${r}/${e}/WorkspaceSnapshot/all`,I,C);return B===void 0?void 0:B.map(Zl.asWorkspaceSnapshot)}catch(B){E.error(B);return}}l(s,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=s;async function c(x,C,k){const I=new zv;I.append("uriString",x.toString(!0)),k!==void 0&&I.append("branchName",k);try{const B=await i(`${r}/${e}/WorkspaceSnapshot/latest`,I,C);return B===void 0?void 0:Zl.asWorkspaceSnapshot(B)}catch(B){E.error(B);return}}l(c,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=c;async function u(x,C,k){try{return n(o(x,"textDocument/capabilities"),C,k)}catch(I){E.error(I);return}}l(u,"capabilities"),t.capabilities=u;async function d(x,C,k){try{return n(o(x,"textDocument/hover"),C,k)}catch(I){E.error(I);return}}l(d,"provideHover"),t.provideHover=d;async function f(x,C,k){try{return n(o(x,"textDocument/definition"),C,k)}catch(I){E.error(I);return}}l(f,"provideDefinition"),t.provideDefinition=f;async function p(x,C,k){try{return n(o(x,"textDocument/declaration"),C,k)}catch(I){E.error(I);return}}l(p,"provideDeclaration"),t.provideDeclaration=p;async function g(x,C,k){try{return n(o(x,"textDocument/typeDefinition"),C,k)}catch(I){E.error(I);return}}l(g,"provideTypeDefinition"),t.provideTypeDefinition=g;async function _(x,C,k){try{return n(o(x,"textDocument/references"),C,k)}catch(I){E.error(I);return}}l(_,"provideReferences"),t.provideReferences=_;async function v(x,C,k){try{return n(o(x,"textDocument/foldingRange"),C,k)}catch(I){E.error(I);return}}l(v,"providerFoldingRanges"),t.providerFoldingRanges=v;async function y(x,C,k){const I=h.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${x}/${C}/assets/designtime`,query:`id=${k}`});try{const B=await Gn(I.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return B.ok?B.text():void 0}catch(B){E.error(B);return}}l(y,"getDesignTimeFileContent"),t.getDesignTimeFileContent=y})(hn||(hn={}));class F0{constructor(e,r){this.providerService=e,this.telemetryService=r,this.metadata=new Map;const n=[];n.push(this.providerService.onDidChangeRepositories(i=>{var o;for(const a of i.added){const s=a.uri,c=j.getIndexMemento(s);if(c!==void 0){const u=Yn.externalIndexUri(this.providerService,s);u!==void 0&&(typeof((o=c.branch)==null?void 0:o.name)=="string"?yr.all(u,c.branch.name,{authentication:this.providerService.getAuthentication(s)}).catch(void 0):typeof c.ref=="string"&&Gt(c.ref)&&yr.single(u,c.ref,void 0,{authentication:this.providerService.getAuthentication(s)}).catch(void 0))}this.providerService.getMetadata(s).then(u=>{const d={},f=u.pullRequest===void 0?Zi.getIndexBranchName(u):void 0;f!==void 0?d.branch={name:f}:d.ref=u.HEAD.sha,j.setIndexMemento(s,d).then(void 0,void 0)},void 0)}})),n.push(this.providerService.onDidChangeRepository(i=>{const o=i.repository.uri,a=W(o);this.metadata.delete(a),this.getIndexMetadata(o).catch(void 0)})),this.disposable=h.Disposable.from(...n)}dispose(){this.disposable.dispose()}async resolveIndexRef(e,r){const n=await this.providerService.getModeRefType(e),i=T.decode(e);if(i!==void 0){if(i.type===xt.Latest)return n===q.Branch?this.getIndexedTip(e,r?0:yr.timeout):void 0;if(i.type===xt.SHA){const a=Yn.externalIndexUri(this.providerService,e);return a===void 0?void 0:await yr.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},r?0:yr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===N.Latest)return this.getIndexedTip(e,r?0:yr.timeout)}refresh(e){for(const r of e)this.metadata.delete(r.toString())}getIndexMetadata(e){const r=this.providerService.getVirtualRootUri(e),n=W(r);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,r=yr.timeout){const n=await Zi.getIndexedTip(this.providerService,e,r);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const r=new Be(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=Yn.externalIndexUri(this.providerService,e);if(n===void 0)return;r.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;r.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const s=this.providerService.getAuthentication(e),c=a.pullRequest===void 0?Zi.getIndexBranchName(a):void 0,u=await yr.single(n,a.HEAD.sha,c,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===_e.Branch||a.HEAD.type===_e.RemoteBranch){const g=T.decode(e);if(g!==void 0)return r.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),u===void 0?g.type===xt.Latest?(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await yr.branch(n,c,{authentication:this.providerService.getAuthentication(e)})?{type:Ye.Indexed}:{type:Ye.NotIndexed}):{type:Ye.NotIndexed}:g.type===xt.Latest||g.type===xt.SHA?{type:Ye.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}:{type:Ye.Match,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}}r.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const f=this.providerService.getModeConfig(e,await o),p=this.providerService.getVirtualUriMetadata(e);if((f.index===N.Latest||f.index===N.Match)&&u!==void 0)return{type:Ye.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(f.index===N.TipPlusLatest&&p.provider.id==="github"){if(u!==void 0&&u.commitId===a.HEAD.sha)return{type:Ye.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(a.HEAD.type===_e.Branch&&c!==void 0){r.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const g=await yr.all(n,c,{authentication:s});if(g!==void 0&&g.length>0)return{type:Ye.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,g),branch:{name:c}}}}return u!==void 0?{type:Ye.Indexed}:a.HEAD.type===_e.Branch&&(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),c!==void 0&&await yr.branch(n,c,{authentication:s}))?{type:Ye.Indexed}:{type:Ye.NotIndexed}}finally{r.stop()}}async computeClosestIndex(e,r,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(d=>d.commitId)),o=await this.providerService.getCommits(e,{ref:r,limit:100});if(o===void 0)return;let a;for(const d of o.commits)if(d.hash===r){a=d;break}if(a===void 0)return;const s=new Map(o.commits.map(d=>[d.hash,d])),c=[a];let u;for(;c.length>0;){for(u=c.shift();u!==void 0&&!i.has(u.hash);)if(u.parents.length>0){for(let d=1;d<u.parents.length;d++){const f=s.get(u.parents[d]);f!==void 0&&c.push(f)}u=s.get(u.parents[0])}if(u!==void 0)break}return u!==void 0?u.hash:void 0}async getSnapshots(e,r){const n=Yn.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await yr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const r=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,r)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:a}=r,s=[];if(n!==void 0){let c;const u=[`${wt(a.sha)}`];if(n.type===Ye.Active){const d=await n.sha;o.index===N.Latest||o.index===N.Match?(c=o.display===P.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",u.push(hr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===N.TipPlusLatest&&(c="$(layers-dot)",d!==r.HEAD.sha?u.push(hr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):u.push(hr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===Ye.Match?(c="$(layers)",u.push(hr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===Ye.Indexed&&(c="$(layers)",u.push(hr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));c&&s.push(Fn({command:"remoteHub.indexMode.select",title:c,tooltip:u.join(`
`),arguments:[{uri:e}]}))}return s}}l(F0,"RichNavIndexProvider");var Do;(function(t){let e;function r(){return e=h.window.createStatusBarItem(h.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,h.window.onDidChangeActiveTextEditor(()=>{c()}),h.commands.registerCommand("remoteHub.indexMode.select",d=>{u(d).catch(f=>E.log("Selecting index mode failed.",f))})]}l(r,"create"),t.create=r;const n=new Map;function i(d){n.set(d.key(),d)}l(i,"addService"),t.addService=i;function o(d){n.delete(d.key())}l(o,"removeService"),t.removeService=o;function a(d){return n.get(W(d))}l(a,"getService");async function s(d){for(const f of n.values())if(await f.handles(d))return f}l(s,"getServiceForDocument");async function c(){try{let d=l(function(_){const v=_.lastIndexOf("/");return v<=0?_:_.substr(v+1)},"basename");const f=h.window.activeTextEditor;if(f===void 0){e.hide();return}const p=await s(f.document);if(p===void 0){e.hide();return}const g=await p.isDocumentIndexed(f.document);g===Xl.Indexed?(e.text="$(compass)",e.tooltip=new h.MarkdownString(hr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",d(f.document.uri.path))),e.show()):g===Xl.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new h.MarkdownString(hr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",d(f.document.uri.path))),e.show()):e.hide()}catch(d){e.hide()}}l(c,"updateStatusBarItem"),t.updateStatusBarItem=c;async function u(d){var f;const p=d.uri,g=a(p);if(g===void 0)return;const[_,v,y,x]=await Promise.all([g.getBranchName(),g.getMetadata(),g.getIndexMetadata(),g.getModeRefType(p)]);if(y===void 0||!Ye.hasIndex(y.type))return;let C,k=!1;const I=T.decode(p);(I==null?void 0:I.type)===xt.Latest||(I==null?void 0:I.type)===xt.SHA?(k=!0,C={display:P.Browse,index:I.type===xt.Latest?N.Latest:N.Match}):C=(f=g.getCurrentIndexMode())!=null?f:g.getModeConfig(p,x);const B=g.getUriMetadata(),J=hr("current item","{0} current","$(check)"),re={kind:"disable",label:hr("RichNavStatus.disable.label","Disable"),description:C.index===N.None?`  \u2022  ${J}`:void 0,detail:hr("RichNavStatus.disable.detail","Disable rich navigation. {0}",B.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let K,we;if(x===q.PullRequestBranch||x===q.PullRequestRemoteBranch||x===q.Commit||x===q.Tag){const ie={kind:"match",label:hr("RichNavStatus.match.label","Current indexed commit - readonly"),description:C.index===N.Match&&C.display===P.Browse?`  \u2022  ${J}`:void 0,detail:hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},pe={kind:"match+writeable",label:hr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:C.index===N.Match&&C.display===P.Edit?`  \u2022  ${J}`:void 0,detail:hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let Se=B.provider.id==="github";Se&&(Se=v.HEAD.type===_e.RemoteBranch?v.HEAD.branch.remote.accessLevel>=De.Write:!0);const Je=Se?[ie,pe,re]:[ie,re];we=await h.window.showQuickPick(Je,{placeHolder:"Pick a rich navigation mode"})}else if(x===q.Branch||x===q.RemoteBranch){const ie={kind:"latest",label:hr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:C.index===N.Latest?`  \u2022  ${J}`:void 0,detail:hr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},pe={kind:"tip+latest",label:hr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:C.index===N.TipPlusLatest?`  \u2022  ${J}`:void 0,detail:hr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},Se=B.provider.id==="github"?[ie,pe,re]:[ie,re];we=await h.window.showQuickPick(Se,{placeHolder:hr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",_)})}if(we!==void 0&&(we.kind==="disable"?K={display:P.Edit,index:N.None}:we.kind==="match"?K={display:P.Browse,index:N.Match}:we.kind==="match+writeable"?K={display:P.Edit,index:N.Match}:we.kind==="tip+latest"?K={display:P.Edit,index:N.TipPlusLatest}:we.kind==="latest"&&(K={display:P.Browse,index:N.Latest}),K!==void 0&&!Q.equals(C,K))){if(await g.hasChanges()&&K.display===P.Browse){await h.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(await g.updateIndexMode(K),k){const ie=await g.getNonIndexedWorkspaceDescriptor();ie!==void 0&&dn(ie)}}}l(u,"toggleIndexMode")})(Do||(Do={}));class xf{constructor(e){this.telemetryService=e}static createStatus(){return Do.create()}async createNavigationService(e,r,n){const i=await e.getIndexMetadata(r.uri);if(!(i===void 0||i.type===Ye.NotIndexed))return()=>new Cf(e,r,n,this.telemetryService)}}l(xf,"RichNavServiceProvider");var Xs;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function r(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return h.Uri.from({scheme:Ti.scheme,authority:Ja(JSON.stringify(a)),path:o[4]})}l(r,"toVSCode"),t.toVSCode=r;function n(i){if(i.scheme!==Ti.scheme)return;let o;try{return o=JSON.parse(on(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}l(n,"toRichNavComponents"),t.toRichNavComponents=n})(Xs||(Xs={}));const Sf=l(class{constructor(){this._onDidChangeFile=new h.EventEmitter,this.cache=new Ei(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return Sf.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return{type:h.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:h.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw h.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return e.content}writeFile(t,e,r){throw h.FileSystemError.NoPermissions()}delete(t,e){throw h.FileSystemError.NoPermissions()}rename(t,e,r){throw h.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==Sf.scheme)return;const r=Xs.toRichNavComponents(t);if(r===void 0)return;const n=await hn.getDesignTimeFileContent(r.workspaceId,r.snapshotId,r.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let Ti=Sf;Ti.scheme="vsck-fs",Ti.emptyDisposable={dispose:()=>{}};var Xl;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(Xl||(Xl={}));const ei=l(class{static registerCapability(t,e,r){var n;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(n=r[e])!=null?n:!1}constructor(t,e,r,n){this.providerService=t,this.repository=e,this.changeStore=r,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const i=l((a=!1)=>{const s=this.repository.uri;a||(this.metadata=this.providerService.getMetadata(s),this.indexMetadata=this.providerService.getIndexMetadata(s)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(s,this.metadata)]).then(async c=>{var u,d;const[f,p,g]=this.currentlyResolved,[_,v,y]=c,x=this.providerService.getModeConfig(s,y);if(f!==void 0&&p!==void 0&&g!==void 0&&f.HEAD.sha===_.HEAD.sha&&v!==void 0&&p.type===v.type&&g.index===x.index&&g.display===x.display){const k=(p==null?void 0:p.type)===Ye.Active?await p.sha:void 0,I=(v==null?void 0:v.type)===Ye.Active?await v.sha:void 0;if(k===I)return}const C={newDisplayMode:x.display,newIndexMode:x.index,newIndexType:(v==null?void 0:v.type)===void 0?"undefined":Ye[v==null?void 0:v.type],currentDisplayMode:(u=g==null?void 0:g.display)!=null?u:"undefined",currentIndexMode:(d=g==null?void 0:g.index)!=null?d:"undefined",currentIndexType:(p==null?void 0:p.type)===void 0?"undefined":Ye[p==null?void 0:p.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",C),this.currentlyResolved=[_,v,x];for(const k of this.registeredFeatures.values())k.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,$t.isActive(v)){const k=Yn.externalIndexUri(this.providerService,_),I=await v.sha;if(k!==void 0&&I!==void 0){const B=await yr.single(k,I,Zi.getIndexBranchName(_),{authentication:this.providerService.getAuthentication(s)});B!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:B.snapshotId}),this.workspaceSnapshot=B,this.documentListeners=this.installDocumentListeners(),((x==null?void 0:x.display)===P.Edit||_.HEAD.sha!==I)&&(this.mapper=new e0(this.providerService,s,I,_.HEAD.sha)))}}await Do.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Ei(2048),this.knownDesignTimeFiles=new Set;const o=[];o.push(this.providerService.onDidChangeRepository(a=>{W(a.repository.uri)===W(this.repository.uri)&&i()})),o.push(this.providerService.onDidRefresh(a=>{for(const s of a)if(W(s)===W(this.repository.uri)){i();break}})),this.environmentListeners=h.Disposable.from(...o),i(!0),Do.addService(this),this.indexMetadata.then(async a=>{var s;const c=this.repository.uri;let u=!1;const d=T.decode(this.repository.uri);if(d!==void 0&&a!==void 0&&(d.type===xt.Latest&&a.type!==Ye.Active||d.type===xt.SHA&&(a.type!==Ye.Active||await a.sha!==d.sha))&&(u=!0),!u){await this.metadata;const f=await this.providerService.getModeRefType(c,this.metadata),p=(s=this.currentlyResolved[2])!=null?s:this.providerService.getModeConfig(c,f,!0);p!==void 0&&p.display===P.Browse&&a!==void 0&&p.index!==N.None&&a.type!==Ye.Active?u=!0:(a==null?void 0:a.type)===Ye.Active&&await a.sha===void 0&&((p==null?void 0:p.display)===P.Browse,u=!0)}u&&h.window.showWarningMessage(hr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),ei.fileSystemProvider===void 0&&(ei.fileSystemProvider=new Ti,h.workspace.registerFileSystemProvider(Ti.scheme,ei.fileSystemProvider))}getRepository(){return this.repository}async updateIndexMode(t){const e=this.currentlyResolved[2],r=t!==void 0;if(t===void 0){const n=this.repository.uri,i=await this.providerService.getModeRefType(n,this.metadata);t=this.providerService.getModeConfig(n,i),await new Promise(o=>setTimeout(o,1e3))}if(e===void 0||e.index!==t.index||e.display!==t.display){if(t.index===N.Latest){await Promise.all([this.metadata,this.indexMetadata]);const n=await this.getIndexedTip();if(n===void 0)return;await this.sync(n.hash)}else t.index===N.TipPlusLatest&&(await Promise.all([this.metadata,this.indexMetadata]),await this.sync());r&&await j.setMode(this.repository.uri,t),this.refresh()}}getCurrentIndexMode(){return this.currentlyResolved[2]}key(){return W(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),Do.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Pt.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Zi.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:r}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:r}),location:Bt.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===Ye.NotIndexed||this.workspaceSnapshot===void 0)return 0;const r=this.pendingCapabilitiesRequests.get(t.uri.toString());return r!==void 0&&await r,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=Yn.externalIndexUri(this.providerService,t),r=Zi.getIndexBranchName(t);if(e===void 0||r===void 0)return;const n=await yr.getIndexedTip(e,r,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await Zs.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:r}}hasChanges(){return this.changeStore.hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,this.changeStore,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,r=Yn.externalIndexUri(this.providerService,e);if(r===void 0)return;const[n,i]=await Promise.all([Zs.get(this.providerService,this.repository.uri,t),yr.single(r,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const t=[],e=l(async r=>{const n=r.uri.scheme;if(Pt.scheme!==n&&Ti.scheme!==n)return;const i=r.uri.toString();if(n===Pt.scheme&&!i.startsWith(this.repositoryRoot)||n===Ti.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const s=this.capabilities(r.uri);this.pendingCapabilitiesRequests.set(i,s),a=await s,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!h.workspace.textDocuments.some(s=>s===r)||this.registerProviders(r,a,o)}},"openHandler");return t.push(h.workspace.onDidOpenTextDocument(e)),h.workspace.textDocuments.forEach(e),t.push(h.workspace.onDidCloseTextDocument(r=>{const n=r.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(r.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),h.Disposable.from(...t)}registerProviders(t,e,r){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=t.languageId,a=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],s=[],c=new Promise((v,y)=>{const x=`/${n.snapshotId}/source/`;this.metadata.then(C=>{v(nS(k=>{const I=h.Uri.parse(k);if(C===void 0)return I;try{if(I.scheme==="vsck"&&I.authority===n.workspaceId&&I.path.startsWith(x))return this.repository.createRelativeUri(I.path.substr(x.length));const B=Xs.toVSCode(k);return B!==void 0?(this.knownDesignTimeFiles.add(B.toString()),B):I}catch(B){return I}}))},y)}),u=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function d(v){const y=u.exec(v);return y===null||y.length===2}l(d,"designTimeFilter");function f(v){if(v==null)return v;if(Array.isArray(v)){if(v.length===0)return[];const y=v[0];return typeof y.uri=="string"?v.filter(k=>d(k.uri)):typeof y.targetUri=="string"?v.filter(k=>d(k.targetUri)):[]}return u.exec(v.uri)===null?v:void 0}l(f,"filterDesignTimeFiles");async function p(v,y,x){var C,k,I;if(x==null||v===void 0)return x;const B=new Map(h.workspace.textDocuments.map(re=>[re.uri.toString(!0),re]));if(Array.isArray(x)){const re=[],K=[];if(x.length===0)return[];for(const we of x){const ie=we;if(ie.uri instanceof h.Uri){const pe=await v.mapRangeFromIndexToCode((C=B.get(ie.uri.toString()))!=null?C:ie.uri,ie.range);pe!==void 0&&re.push(new h.Location(ie.uri,pe))}else{const pe=we,Se=(k=B.get(pe.targetUri.toString()))!=null?k:pe.targetUri,Je=pe.originSelectionRange?await v.mapRangeFromIndexToCode(y,pe.originSelectionRange):void 0;if(Je!==void 0||pe.originSelectionRange===void 0){const ae=await v.mapRangeFromIndexToCode(Se,pe.targetRange);if(ae!==void 0){const Ae=pe.targetSelectionRange?await v.mapRangeFromIndexToCode(Se,pe.targetSelectionRange):void 0;(Ae!==void 0||pe.targetSelectionRange===void 0)&&K.push({targetUri:pe.targetUri,targetRange:ae,targetSelectionRange:Ae,originSelectionRange:Je})}}}}return re.length>0?re:K}const J=await v.mapRangeFromIndexToCode((I=B.get(x.uri.toString()))!=null?I:x.uri,x.range);if(J!==void 0)return new h.Location(x.uri,J)}l(p,"mapLocations");const g=l(v=>({authentication:this.providerService.getAuthentication(v.uri),correlationId:ef()}),"getRestApiOptions"),_=l((v,y)=>{const x={method:v,correlationId:y.correlationId};this.telemetryService.publicLog2("codex.restAPICall",x)},"sendTelemetry");ei.registerCapability(i,"hoverProvider",e)&&s.push(h.languages.registerHoverProvider(a,{provideHover:async(v,y)=>{const x=await this.createTextDocumentPositionParams(v,y);if(x===void 0)return;const C=g(v);return _("codex.provideHover",C),(await c).asHover(await hn.provideHover(r,x,C))}})),ei.registerCapability(i,"definitionProvider",e)&&s.push(h.languages.registerDefinitionProvider(a,{provideDefinition:async(v,y)=>{const x=await this.createTextDocumentPositionParams(v,y);if(x===void 0)return;const C=g(v);return _("codex.provideDefinition",C),p(this.mapper,v,(await c).asDefinitionResult(f(await hn.provideDefinition(r,x,C))))}})),ei.registerCapability(i,"declarationProvider",e)&&s.push(h.languages.registerDeclarationProvider(a,{provideDeclaration:async(v,y)=>{const x=await this.createTextDocumentPositionParams(v,y);if(x===void 0)return;const C=g(v);return _("codex.provideDeclaration",C),p(this.mapper,v,(await c).asDeclarationResult(f(await hn.provideDeclaration(r,x,C))))}})),ei.registerCapability(i,"typeDefinitionProvider",e)&&s.push(h.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(v,y)=>{const x=await this.createTextDocumentPositionParams(v,y);if(x===void 0)return;const C=g(v);return _("codex.provideTypeDefinition",C),p(this.mapper,v,(await c).asDefinitionResult(f(await hn.provideTypeDefinition(r,x,C))))}})),ei.registerCapability(i,"referencesProvider",e)&&s.push(h.languages.registerReferenceProvider(a,{provideReferences:async(v,y,x)=>{const C=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(v,y):y;if(C===void 0)return;const k={position:{line:C.line,character:C.character},textDocument:{uri:this.createRichNavDocumentUri(v.uri).toString(!0)},context:{includeDeclaration:x.includeDeclaration}},I=g(v);return _("codex.provideReferences",I),p(this.mapper,v,(await c).asReferences(f(await hn.provideReferences(r,k,I))))}})),ei.registerCapability(i,"foldingRangeProvider",e)&&s.push(h.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async v=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(v))return;const y=g(v);return _("codex.provideFoldingRanges",y),(await c).asFoldingRanges(await hn.providerFoldingRanges(r,this.createTextDocumentParams(v.uri),y))}})),this.registeredFeatures.set(t.uri.toString(),h.Disposable.from(...s)),Do.updateStatusBarItem()}async capabilities(t){var e;const r=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(r!==void 0)return(e=await hn.capabilities(r,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const r=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(r!==void 0)return{position:{line:r.line,character:r.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===Ti.scheme){const n=Xs.toRichNavComponents(t);return n===void 0?t:h.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),r=t.toString(!0);return h.Uri.file(r.substr(e.length))}},"_RichNavService");let Cf=ei;Cf.localCapabilities=new Map([["javascript",Object.assign(Jn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Jn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Jn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Jn.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),Cf.disabledCapabilities=new Map([["javascript",Object.assign(Jn.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Jn.create(),{declarationProvider:!0})],["typescript",Object.assign(Jn.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Jn.create(),{declarationProvider:!0})]]);var P0=l((t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},"__accessCheck"),ti=l((t,e,r)=>(P0(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),N0=l((t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},"__privateAdd"),$0=l((t,e,r,n)=>(P0(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),"__privateSet"),fn,Yl;class M0{constructor(e,r){N0(this,fn,void 0),N0(this,Yl,void 0),$0(this,fn,e),$0(this,Yl,r)}async loadWorkspaceContents(e){if(e.scheme!=="vscode-vfs")return!1;const r=ti(this,fn).getProviderRootUri(e);if(r.scheme!=="github")return!1;try{return await ti(this,Yl).getTar(r),!0}catch(n){return E.error(n),!1}}async getMetadata(e){const r=ti(this,fn).getVirtualUriMetadata(e);if(r===void 0)return;const{provider:n,repo:i}=r;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await ti(this,fn).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return ti(this,fn).getRegisteredProvider(e)}getProviderUri(e){return ti(this,fn).getProviderUri(e)}getProviderRootUri(e){return ti(this,fn).getProviderRootUri(e)}isProviderUri(e,r){return e.scheme!==Pt.scheme&&ti(this,fn).hasProvider(e,r)}getVirtualUri(e){return ti(this,fn).getVirtualUri(e)}getVirtualWorkspaceUri(e){return ti(this,fn).getVirtualWorkspaceUri(e)}}l(M0,"ExtensionApi"),fn=new WeakMap,Yl=new WeakMap;var iS=Object.defineProperty,oS=Object.getOwnPropertyDescriptor,Ef=l((t,e,r,n)=>{for(var i=n>1?void 0:n?oS(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&iS(e,r,i),i},"src_fs_decorateClass");const Rf=h.FileSystemError.FileNotFound().code;class Ys{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFile=new h.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),r.onDidChange(n=>{const i=n.map(o=>{switch(o.type){case ht.Created:return{type:h.FileChangeType.Created,uri:o.uri};case ht.Changed:return{type:h.FileChangeType.Changed,uri:o.uri};case ht.Deleted:return{type:h.FileChangeType.Deleted,uri:o.uri}}});setTimeout(()=>this._onDidChangeFile.fire(i),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Pt.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>r.scheme===this.scheme),e.length!==0&&(E.log(`fs.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>tt(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));E.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(W(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{E.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=W(e);this.watchedUris.set(n,e);const i=this.providerService.watch(this.providerService.getProviderUri(e),r);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const r=new Be(`fs.stat(${e.toString()})`);let n;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(r.logStep("ChangeStore query"),n=await this.changeStore.stat(e),n!==void 0)return n;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(W(e),e);return n=await this.providerService.stat(this.providerService.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(W(e)),r.stop()}}async readDirectory(e){const r=new Be(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(W(e),e);try{r.logStep("Provider query");let n=await this.providerService.readDirectory(this.providerService.getProviderUri(e));return this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(r.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.changeStore.updateDirectoryEntries(e,n)),n}finally{r.stop()}}async createDirectory(e){const r=new Be(`fs.createDirectory(${e.toString()})`);try{await this.changeStore.createDirectory(e)}catch(n){throw E.error(n,r.context),n}finally{r.stop()}}async readFile(e){const r=new Be(`fs.readFile(${e.toString()})`),n=W(e);let i;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){r.logStep("ChangeStore query");const o=await this.changeStore.readFile(e);if(o!==void 0)return o;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(this.providerService.getProviderUri(e)),i}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),r.stop()}}async writeFile(e,r,n){const i=new Be(`fs.writeFile(${e.toString()})`,{},r.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw h.FileSystemError.FileExists()}catch(a){if(a instanceof h.FileSystemError&&a.code===Rf){if(!n.create)throw h.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.changeStore.createFile(e,r);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(this.providerService.getProviderUri(e))}catch(s){if(s instanceof h.FileSystemError&&s.code===Rf)a=new Uint8Array;else throw s}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.changeStore.writeFile(e,r,a)}}catch(a){throw E.error(a,i.context),a}}finally{i.stop()}}async delete(e,r){const n=new Be(`fs.delete(${e.toString()})`,{},r);try{switch((await this.stat(e)).type){case h.FileType.File:await this.changeStore.deleteFile(e);break;case h.FileType.Directory:{await this.deleteDirectory(e,r);break}default:throw h.FileSystemError.NoPermissions()}}catch(i){throw E.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,r){const n=new Be(`fs.deleteDirectory(${e.toString()})`,{},r);try{const i=await this.readDirectory(e);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===h.FileType.Directory))throw h.FileSystemError.NoPermissions();for(const[o,a]of i)a===h.FileType.Directory?await this.deleteDirectory(h.Uri.joinPath(e,o),r):await this.changeStore.deleteFile(h.Uri.joinPath(e,o))}await this.changeStore.deleteDirectory(e)}catch(i){throw E.error(i,n.context),i}finally{n.stop()}}async rename(e,r,n){const i=new Be(`fs.rename(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case h.FileType.Directory:{await this.renameDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw E.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,r,n){const i=new Be(`fs.renameDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{await this.copyDirectory(e,r,n),await this.delete(e,{recursive:!0})}catch(o){throw E.error(o,i.context),o}finally{i.stop()}}async copy(e,r,n){const i=new Be(`fs.copy(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite});break}case h.FileType.Directory:{await this.copyDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw E.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,r,n){const i=new Be(`fs.copyDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{if(await this.exists(r))throw h.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(e);for(const[a,s]of o)s===h.FileType.Directory?await this.copyDirectory(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n):await this.copy(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n)}catch(o){throw E.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(r){if(r instanceof h.FileSystemError&&r.code===Rf)return!1;throw r}}async provideFileSearchResults(e,r,n){var i;const o=new Be(`fs.provideFileSearchResults(${e.pattern}, ${r.folder.toString()})`,{logLevel:me.Debug});let a;try{return a=await this.providerService.provideFileSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},n),a==null?void 0:a.map(s=>this.providerService.getVirtualUri(s))}catch(s){throw E.error(s,o.context),s}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}provideTextSearchResults(e,r,n,i){return this.providerService.provideTextSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}l(Ys,"ChangeTrackingFileSystem"),Ef([en()],Ys.prototype,"stat",1),Ef([en()],Ys.prototype,"readDirectory",1),Ef([en()],Ys.prototype,"readFile",1);function aS(t){return t.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}l(aS,"escapeRegExpCharacters");function sS(t,e,r={}){if(!t)throw new Error("Cannot create regex from empty string");e||(t=aS(t)),r.wholeWord&&(/\B/.test(t.charAt(0))||(t=`\\b${t}`),/\B/.test(t.charAt(t.length-1))||(t=`${t}\\b`));let n="gmu";return r.matchCase||(n+="i"),new RegExp(t,n)}l(sS,"createRegExp");let B0,U0,Af;const cS=l((t,e,r,n)=>{const i=`${e.join("--")};;;;${r.join("--")}`,o=t.map(s=>s.path).join("::");if(B0===o&&i==U0&&Af)return Af;const a=nf((n?t.filter(s=>s.size<n):t).map(s=>s.path),e,r);return B0=o,U0=i,Af=a,a},"generateIncludeSet"),lS=l((t,e,r,n)=>{var i;const o=[];let a;if(typeof t=="string")a=t;else{const d=t;if(d[0]==255&&d[1]==254)a=new TextDecoder("utf-16le").decode(d);else if(d[0]==254&&d[1]==255)a=new TextDecoder("utf-16be").decode(d);else if(a=new TextDecoder("utf8").decode(d),a.slice(0,1e3).includes("\uFFFD")&&d.includes(0))return[]}const s=[];let c=null,u=n.remainingResultQuota;for(;(u===void 0||u>=0)&&(c=r.exec(a));)s.push({matchStartIndex:c.index,matchedText:c[0]}),u!==void 0&&u--;if(s.length){const d=new Set,f=new Set,p=[],g=l(C=>a.slice(p[C].start,p[C].end),"readLine");let _=0,v=null;const y=/\r?\n/g;for(;v=y.exec(a);)p.push({start:_,end:v.index}),_=v.index+v[0].length;_<a.length&&p.push({start:_,end:a.length});let x=0;for(const{matchStartIndex:C,matchedText:k}of s){if(u!==void 0&&u<0)break;for(;Boolean(p[x+1])&&C>p[x].end;)x++;let I=x;for(;Boolean(p[I+1])&&C+k.length>p[I].end;)I++;if(n.beforeContext)for(let ie=Math.max(0,x-n.beforeContext);ie<x;ie++)d.add(ie);let B="",J=0;for(let ie=x;ie<=I;ie++){let pe=g(ie);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&pe.length>n.previewOptions.charsPerLine&&(J=Math.max(C-p[x].start-20,0),pe=pe.substr(J,n.previewOptions.charsPerLine)),B+=`${pe}
`,f.add(ie)}const re=new h.Range(x,C-p[x].start,I,C+k.length-p[I].start),K=new h.Range(0,C-p[x].start-J,I-x,C+k.length-p[I].start-(I===x?J:0)),we={uri:h.Uri.file(e),ranges:re,preview:{text:B,matches:K}};if(o.push(we),n.afterContext)for(let ie=I+1;ie<=Math.min(I+n.afterContext,p.length-1);ie++)d.add(ie)}for(const C of d)f.has(C)||o.push({uri:h.Uri.file(e),text:g(C),lineNumber:C+1})}return o},"getFileResults");/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const uS=4,L0=0,O0=1,dS=2;function Na(t){let e=t.length;for(;--e>=0;)t[e]=0}l(Na,"zero$1");const hS=0,H0=1,fS=2,pS=3,gS=258,Tf=29,Js=256,ec=Js+1+Tf,$a=30,kf=19,W0=2*ec+1,Fo=15,If=16,mS=7,Df=256,z0=16,q0=17,j0=18,Ff=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Jl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),vS=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),V0=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wS=512,ki=new Array((ec+2)*2);Na(ki);const tc=new Array($a*2);Na(tc);const rc=new Array(wS);Na(rc);const nc=new Array(gS-pS+1);Na(nc);const Pf=new Array(Tf);Na(Pf);const eu=new Array($a);Na(eu);function Nf(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}l(Nf,"StaticTreeDesc");let G0,K0,Q0;function $f(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}l($f,"TreeDesc");const Z0=l(t=>t<256?rc[t]:rc[256+(t>>>7)],"d_code"),ic=l((t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},"put_short"),Yr=l((t,e,r)=>{t.bi_valid>If-r?(t.bi_buf|=e<<t.bi_valid&65535,ic(t,t.bi_buf),t.bi_buf=e>>If-t.bi_valid,t.bi_valid+=r-If):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},"send_bits"),ri=l((t,e,r)=>{Yr(t,r[e*2],r[e*2+1])},"send_code"),X0=l((t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},"bi_reverse"),yS=l(t=>{t.bi_valid===16?(ic(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},"bi_flush"),bS=l((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,c=e.stat_desc.max_length;let u,d,f,p,g,_,v=0;for(p=0;p<=Fo;p++)t.bl_count[p]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<W0;u++)d=t.heap[u],p=r[r[d*2+1]*2+1]+1,p>c&&(p=c,v++),r[d*2+1]=p,!(d>n)&&(t.bl_count[p]++,g=0,d>=s&&(g=a[d-s]),_=r[d*2],t.opt_len+=_*(p+g),o&&(t.static_len+=_*(i[d*2+1]+g)));if(v!==0){do{for(p=c-1;t.bl_count[p]===0;)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[c]--,v-=2}while(v>0);for(p=c;p!==0;p--)for(d=t.bl_count[p];d!==0;)f=t.heap[--u],!(f>n)&&(r[f*2+1]!==p&&(t.opt_len+=(p-r[f*2+1])*r[f*2],r[f*2+1]=p),d--)}},"gen_bitlen"),Y0=l((t,e,r)=>{const n=new Array(Fo+1);let i=0,o,a;for(o=1;o<=Fo;o++)n[o]=i=i+r[o-1]<<1;for(a=0;a<=e;a++){let s=t[a*2+1];s!==0&&(t[a*2]=X0(n[s]++,s))}},"gen_codes"),_S=l(()=>{let t,e,r,n,i;const o=new Array(Fo+1);for(r=0,n=0;n<Tf-1;n++)for(Pf[n]=r,t=0;t<1<<Ff[n];t++)nc[r++]=n;for(nc[r-1]=n,i=0,n=0;n<16;n++)for(eu[n]=i,t=0;t<1<<Jl[n];t++)rc[i++]=n;for(i>>=7;n<$a;n++)for(eu[n]=i<<7,t=0;t<1<<Jl[n]-7;t++)rc[256+i++]=n;for(e=0;e<=Fo;e++)o[e]=0;for(t=0;t<=143;)ki[t*2+1]=8,t++,o[8]++;for(;t<=255;)ki[t*2+1]=9,t++,o[9]++;for(;t<=279;)ki[t*2+1]=7,t++,o[7]++;for(;t<=287;)ki[t*2+1]=8,t++,o[8]++;for(Y0(ki,ec+1,o),t=0;t<$a;t++)tc[t*2+1]=5,tc[t*2]=X0(t,5);G0=new Nf(ki,Ff,Js+1,ec,Fo),K0=new Nf(tc,Jl,0,$a,Fo),Q0=new Nf(new Array(0),vS,0,kf,mS)},"tr_static_init"),J0=l(t=>{let e;for(e=0;e<ec;e++)t.dyn_ltree[e*2]=0;for(e=0;e<$a;e++)t.dyn_dtree[e*2]=0;for(e=0;e<kf;e++)t.bl_tree[e*2]=0;t.dyn_ltree[Df*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},"init_block"),ew=l(t=>{t.bi_valid>8?ic(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},"bi_windup"),xS=l((t,e,r,n)=>{ew(t),n&&(ic(t,r),ic(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},"copy_block"),tw=l((t,e,r,n)=>{const i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},"smaller"),Mf=l((t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&tw(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!tw(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},"pqdownheap"),rw=l((t,e,r)=>{let n,i,o=0,a,s;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?ri(t,i,e):(a=nc[i],ri(t,a+Js+1,e),s=Ff[a],s!==0&&(i-=Pf[a],Yr(t,i,s)),n--,a=Z0(n),ri(t,a,r),s=Jl[a],s!==0&&(n-=eu[a],Yr(t,n,s)));while(o<t.last_lit);ri(t,Df,e)},"compress_block"),Bf=l((t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let a,s,c=-1,u;for(t.heap_len=0,t.heap_max=W0,a=0;a<o;a++)r[a*2]!==0?(t.heap[++t.heap_len]=c=a,t.depth[a]=0):r[a*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[u*2+1]);for(e.max_code=c,a=t.heap_len>>1;a>=1;a--)Mf(t,r,a);u=o;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Mf(t,r,1),s=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=s,r[u*2]=r[a*2]+r[s*2],t.depth[u]=(t.depth[a]>=t.depth[s]?t.depth[a]:t.depth[s])+1,r[a*2+1]=r[s*2+1]=u,t.heap[1]=u++,Mf(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],bS(t,e),Y0(r,c,t.bl_count)},"build_tree"),nw=l((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,c=7,u=4;for(a===0&&(c=138,u=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=e[(n+1)*2+1],!(++s<c&&o===a)&&(s<u?t.bl_tree[o*2]+=s:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[z0*2]++):s<=10?t.bl_tree[q0*2]++:t.bl_tree[j0*2]++,s=0,i=o,a===0?(c=138,u=3):o===a?(c=6,u=3):(c=7,u=4))},"scan_tree"),iw=l((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,c=7,u=4;for(a===0&&(c=138,u=3),n=0;n<=r;n++)if(o=a,a=e[(n+1)*2+1],!(++s<c&&o===a)){if(s<u)do ri(t,o,t.bl_tree);while(--s!=0);else o!==0?(o!==i&&(ri(t,o,t.bl_tree),s--),ri(t,z0,t.bl_tree),Yr(t,s-3,2)):s<=10?(ri(t,q0,t.bl_tree),Yr(t,s-3,3)):(ri(t,j0,t.bl_tree),Yr(t,s-11,7));s=0,i=o,a===0?(c=138,u=3):o===a?(c=6,u=3):(c=7,u=4)}},"send_tree"),SS=l(t=>{let e;for(nw(t,t.dyn_ltree,t.l_desc.max_code),nw(t,t.dyn_dtree,t.d_desc.max_code),Bf(t,t.bl_desc),e=kf-1;e>=3&&t.bl_tree[V0[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),CS=l((t,e,r,n)=>{let i;for(Yr(t,e-257,5),Yr(t,r-1,5),Yr(t,n-4,4),i=0;i<n;i++)Yr(t,t.bl_tree[V0[i]*2+1],3);iw(t,t.dyn_ltree,e-1),iw(t,t.dyn_dtree,r-1)},"send_all_trees"),ES=l(t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return L0;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return O0;for(r=32;r<Js;r++)if(t.dyn_ltree[r*2]!==0)return O0;return L0},"detect_data_type");let ow=!1;const RS=l(t=>{ow||(_S(),ow=!0),t.l_desc=new $f(t.dyn_ltree,G0),t.d_desc=new $f(t.dyn_dtree,K0),t.bl_desc=new $f(t.bl_tree,Q0),t.bi_buf=0,t.bi_valid=0,J0(t)},"_tr_init$1"),aw=l((t,e,r,n)=>{Yr(t,(hS<<1)+(n?1:0),3),xS(t,e,r,!0)},"_tr_stored_block$1"),AS=l(t=>{Yr(t,H0<<1,3),ri(t,Df,ki),yS(t)},"_tr_align$1"),TS=l((t,e,r,n)=>{let i,o,a=0;t.level>0?(t.strm.data_type===dS&&(t.strm.data_type=ES(t)),Bf(t,t.l_desc),Bf(t,t.d_desc),a=SS(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?aw(t,e,r,n):t.strategy===uS||o===i?(Yr(t,(H0<<1)+(n?1:0),3),rw(t,ki,tc)):(Yr(t,(fS<<1)+(n?1:0),3),CS(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),rw(t,t.dyn_ltree,t.dyn_dtree)),J0(t),n&&ew(t)},"_tr_flush_block$1"),kS=l((t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(nc[r]+Js+1)*2]++,t.dyn_dtree[Z0(e)*2]++),t.last_lit===t.lit_bufsize-1),"_tr_tally$1");var IS=RS,DS=aw,FS=TS,PS=kS,NS=AS,$S={_tr_init:IS,_tr_stored_block:DS,_tr_flush_block:FS,_tr_tally:PS,_tr_align:NS},oc=l((t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+e[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0},"adler32");const MS=l(()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},"makeTable"),BS=new Uint32Array(MS());var Cr=l((t,e,r,n)=>{const i=BS,o=n+r;t^=-1;for(let a=n;a<o;a++)t=t>>>8^i[(t^e[a])&255];return t^-1},"crc32"),Po={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},No={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:US,_tr_stored_block:LS,_tr_flush_block:OS,_tr_tally:Xi,_tr_align:HS}=$S,{Z_NO_FLUSH:$o,Z_PARTIAL_FLUSH:WS,Z_FULL_FLUSH:zS,Z_FINISH:Yi,Z_BLOCK:sw,Z_OK:ni,Z_STREAM_END:cw,Z_STREAM_ERROR:pn,Z_DATA_ERROR:qS,Z_BUF_ERROR:Uf,Z_DEFAULT_COMPRESSION:jS,Z_FILTERED:VS,Z_HUFFMAN_ONLY:tu,Z_RLE:GS,Z_FIXED:KS,Z_DEFAULT_STRATEGY:QS,Z_UNKNOWN:ZS,Z_DEFLATED:ru}=No,XS=9,YS=15,JS=8,e1=29,Lf=256+1+e1,t1=30,r1=19,n1=2*Lf+1,i1=15,It=3,Ji=258,Pn=Ji+It+1,o1=32,nu=42,Of=69,iu=73,ou=91,au=103,Mo=113,ac=666,br=1,sc=2,Bo=3,Ma=4,a1=3,eo=l((t,e)=>(t.msg=Po[e],e),"err"),lw=l(t=>(t<<1)-(t>4?9:0),"rank"),to=l(t=>{let e=t.length;for(;--e>=0;)t[e]=0},"zero");let ro=l((t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,"HASH_ZLIB");const no=l(t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},"flush_pending"),kr=l((t,e)=>{OS(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,no(t.strm)},"flush_block_only"),Nt=l((t,e)=>{t.pending_buf[t.pending++]=e},"put_byte"),cc=l((t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},"putShortMSB"),s1=l((t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=oc(t.adler,e,i,r):t.state.wrap===2&&(t.adler=Cr(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},"read_buf"),uw=l((t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,a=t.prev_length,s=t.nice_match;const c=t.strstart>t.w_size-Pn?t.strstart-(t.w_size-Pn):0,u=t.window,d=t.w_mask,f=t.prev,p=t.strstart+Ji;let g=u[n+a-1],_=u[n+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do if(i=e,!(u[i+a]!==_||u[i+a-1]!==g||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<p);if(o=Ji-(p-n),n=p-Ji,o>a){if(t.match_start=e,a=o,o>=s)break;g=u[n+a-1],_=u[n+a]}}while((e=f[e&d])>c&&--r!=0);return a<=t.lookahead?a:t.lookahead},"longest_match"),Uo=l(t=>{const e=t.w_size;let r,n,i,o,a;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Pn)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=s1(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=It)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=ro(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=ro(t,t.ins_h,t.window[a+It-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<It)););}while(t.lookahead<Pn&&t.strm.avail_in!==0)},"fill_window"),c1=l((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Uo(t),t.lookahead===0&&e===$o)return br;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,kr(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Pn&&(kr(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===Yi?(kr(t,!0),t.strm.avail_out===0?Bo:Ma):(t.strstart>t.block_start&&(kr(t,!1),t.strm.avail_out===0),br)},"deflate_stored"),Hf=l((t,e)=>{let r,n;for(;;){if(t.lookahead<Pn){if(Uo(t),t.lookahead<Pn&&e===$o)return br;if(t.lookahead===0)break}if(r=0,t.lookahead>=It&&(t.ins_h=ro(t,t.ins_h,t.window[t.strstart+It-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Pn&&(t.match_length=uw(t,r)),t.match_length>=It)if(n=Xi(t,t.strstart-t.match_start,t.match_length-It),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=It){t.match_length--;do t.strstart++,t.ins_h=ro(t,t.ins_h,t.window[t.strstart+It-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ro(t,t.ins_h,t.window[t.strstart+1]);else n=Xi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(kr(t,!1),t.strm.avail_out===0))return br}return t.insert=t.strstart<It-1?t.strstart:It-1,e===Yi?(kr(t,!0),t.strm.avail_out===0?Bo:Ma):t.last_lit&&(kr(t,!1),t.strm.avail_out===0)?br:sc},"deflate_fast"),Ba=l((t,e)=>{let r,n,i;for(;;){if(t.lookahead<Pn){if(Uo(t),t.lookahead<Pn&&e===$o)return br;if(t.lookahead===0)break}if(r=0,t.lookahead>=It&&(t.ins_h=ro(t,t.ins_h,t.window[t.strstart+It-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=It-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Pn&&(t.match_length=uw(t,r),t.match_length<=5&&(t.strategy===VS||t.match_length===It&&t.strstart-t.match_start>4096)&&(t.match_length=It-1)),t.prev_length>=It&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-It,n=Xi(t,t.strstart-1-t.prev_match,t.prev_length-It),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=ro(t,t.ins_h,t.window[t.strstart+It-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=It-1,t.strstart++,n&&(kr(t,!1),t.strm.avail_out===0))return br}else if(t.match_available){if(n=Xi(t,0,t.window[t.strstart-1]),n&&kr(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return br}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Xi(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<It-1?t.strstart:It-1,e===Yi?(kr(t,!0),t.strm.avail_out===0?Bo:Ma):t.last_lit&&(kr(t,!1),t.strm.avail_out===0)?br:sc},"deflate_slow"),l1=l((t,e)=>{let r,n,i,o;const a=t.window;for(;;){if(t.lookahead<=Ji){if(Uo(t),t.lookahead<=Ji&&e===$o)return br;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=It&&t.strstart>0&&(i=t.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=t.strstart+Ji;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);t.match_length=Ji-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=It?(r=Xi(t,1,t.match_length-It),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Xi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(kr(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===Yi?(kr(t,!0),t.strm.avail_out===0?Bo:Ma):t.last_lit&&(kr(t,!1),t.strm.avail_out===0)?br:sc},"deflate_rle"),u1=l((t,e)=>{let r;for(;;){if(t.lookahead===0&&(Uo(t),t.lookahead===0)){if(e===$o)return br;break}if(t.match_length=0,r=Xi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(kr(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===Yi?(kr(t,!0),t.strm.avail_out===0?Bo:Ma):t.last_lit&&(kr(t,!1),t.strm.avail_out===0)?br:sc},"deflate_huff");function ii(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}l(ii,"Config");const lc=[new ii(0,0,0,0,c1),new ii(4,4,8,4,Hf),new ii(4,5,16,8,Hf),new ii(4,6,32,32,Hf),new ii(4,4,16,16,Ba),new ii(8,16,32,32,Ba),new ii(8,16,128,128,Ba),new ii(8,32,128,256,Ba),new ii(32,128,258,1024,Ba),new ii(32,258,258,4096,Ba)],d1=l(t=>{t.window_size=2*t.w_size,to(t.head),t.max_lazy_match=lc[t.level].max_lazy,t.good_match=lc[t.level].good_length,t.nice_match=lc[t.level].nice_length,t.max_chain_length=lc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=It-1,t.match_available=0,t.ins_h=0},"lm_init");function h1(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ru,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(n1*2),this.dyn_dtree=new Uint16Array((2*t1+1)*2),this.bl_tree=new Uint16Array((2*r1+1)*2),to(this.dyn_ltree),to(this.dyn_dtree),to(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(i1+1),this.heap=new Uint16Array(2*Lf+1),to(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Lf+1),to(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}l(h1,"DeflateState");const dw=l(t=>{if(!t||!t.state)return eo(t,pn);t.total_in=t.total_out=0,t.data_type=ZS;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?nu:Mo,t.adler=e.wrap===2?0:1,e.last_flush=$o,US(e),ni},"deflateResetKeep"),hw=l(t=>{const e=dw(t);return e===ni&&d1(t.state),e},"deflateReset"),f1=l((t,e)=>!t||!t.state||t.state.wrap!==2?pn:(t.state.gzhead=e,ni),"deflateSetHeader"),fw=l((t,e,r,n,i,o)=>{if(!t)return pn;let a=1;if(e===jS&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>XS||r!==ru||n<8||n>15||e<0||e>9||o<0||o>KS)return eo(t,pn);n===8&&(n=9);const s=new h1;return t.state=s,s.strm=t,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+It-1)/It),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=(1+2)*s.lit_bufsize,s.level=e,s.strategy=o,s.method=r,hw(t)},"deflateInit2"),p1=l((t,e)=>fw(t,e,ru,YS,JS,QS),"deflateInit"),g1=l((t,e)=>{let r,n;if(!t||!t.state||e>sw||e<0)return t?eo(t,pn):pn;const i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===ac&&e!==Yi)return eo(t,t.avail_out===0?Uf:pn);i.strm=t;const o=i.last_flush;if(i.last_flush=e,i.status===nu)if(i.wrap===2)t.adler=0,Nt(i,31),Nt(i,139),Nt(i,8),i.gzhead?(Nt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Nt(i,i.gzhead.time&255),Nt(i,i.gzhead.time>>8&255),Nt(i,i.gzhead.time>>16&255),Nt(i,i.gzhead.time>>24&255),Nt(i,i.level===9?2:i.strategy>=tu||i.level<2?4:0),Nt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Nt(i,i.gzhead.extra.length&255),Nt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Cr(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Of):(Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,0),Nt(i,i.level===9?2:i.strategy>=tu||i.level<2?4:0),Nt(i,a1),i.status=Mo);else{let a=ru+(i.w_bits-8<<4)<<8,s=-1;i.strategy>=tu||i.level<2?s=0:i.level<6?s=1:i.level===6?s=2:s=3,a|=s<<6,i.strstart!==0&&(a|=o1),a+=31-a%31,i.status=Mo,cc(i,a),i.strstart!==0&&(cc(i,t.adler>>>16),cc(i,t.adler&65535)),t.adler=1}if(i.status===Of)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),no(t),r=i.pending,i.pending===i.pending_buf_size));)Nt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=iu)}else i.status=iu;if(i.status===iu)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),no(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,Nt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=ou)}else i.status=ou;if(i.status===ou)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),no(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,Nt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=Cr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=au)}else i.status=au;if(i.status===au&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&no(t),i.pending+2<=i.pending_buf_size&&(Nt(i,t.adler&255),Nt(i,t.adler>>8&255),t.adler=0,i.status=Mo)):i.status=Mo),i.pending!==0){if(no(t),t.avail_out===0)return i.last_flush=-1,ni}else if(t.avail_in===0&&lw(e)<=lw(o)&&e!==Yi)return eo(t,Uf);if(i.status===ac&&t.avail_in!==0)return eo(t,Uf);if(t.avail_in!==0||i.lookahead!==0||e!==$o&&i.status!==ac){let a=i.strategy===tu?u1(i,e):i.strategy===GS?l1(i,e):lc[i.level].func(i,e);if((a===Bo||a===Ma)&&(i.status=ac),a===br||a===Bo)return t.avail_out===0&&(i.last_flush=-1),ni;if(a===sc&&(e===WS?HS(i):e!==sw&&(LS(i,0,0,!1),e===zS&&(to(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),no(t),t.avail_out===0))return i.last_flush=-1,ni}return e!==Yi?ni:i.wrap<=0?cw:(i.wrap===2?(Nt(i,t.adler&255),Nt(i,t.adler>>8&255),Nt(i,t.adler>>16&255),Nt(i,t.adler>>24&255),Nt(i,t.total_in&255),Nt(i,t.total_in>>8&255),Nt(i,t.total_in>>16&255),Nt(i,t.total_in>>24&255)):(cc(i,t.adler>>>16),cc(i,t.adler&65535)),no(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ni:cw)},"deflate$2"),m1=l(t=>{if(!t||!t.state)return pn;const e=t.state.status;return e!==nu&&e!==Of&&e!==iu&&e!==ou&&e!==au&&e!==Mo&&e!==ac?eo(t,pn):(t.state=null,e===Mo?eo(t,qS):ni)},"deflateEnd"),v1=l((t,e)=>{let r=e.length;if(!t||!t.state)return pn;const n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==nu||n.lookahead)return pn;if(i===1&&(t.adler=oc(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(to(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(e.subarray(r-n.w_size,r),0),e=c,r=n.w_size}const o=t.avail_in,a=t.next_in,s=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Uo(n);n.lookahead>=It;){let c=n.strstart,u=n.lookahead-(It-1);do n.ins_h=ro(n,n.ins_h,n.window[c+It-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--u);n.strstart=c,n.lookahead=It-1,Uo(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=It-1,n.match_available=0,t.next_in=a,t.input=s,t.avail_in=o,n.wrap=i,ni},"deflateSetDictionary");var w1=p1,y1=fw,b1=hw,_1=dw,x1=f1,S1=g1,C1=m1,E1=v1,R1="pako deflate (from Nodeca project)",uc={deflateInit:w1,deflateInit2:y1,deflateReset:b1,deflateResetKeep:_1,deflateSetHeader:x1,deflate:S1,deflateEnd:C1,deflateSetDictionary:E1,deflateInfo:R1};const A1=l((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"_has");var T1=l(function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)A1(r,n)&&(t[n]=r[n])}}return t},"pako_esm_assign"),k1=l(t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let a=t[n];r.set(a,i),i+=a.length}return r},"flattenChunks"),su={assign:T1,flattenChunks:k1};let pw=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){pw=!1}const dc=new Uint8Array(256);for(let t=0;t<256;t++)dc[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;dc[254]=dc[254]=1;var I1=l(t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,a=t.length,s=0;for(i=0;i<a;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(s),o=0,i=0;o<s;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},"string2buf");const D1=l((t,e)=>{if(e<65534&&t.subarray&&pw)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},"buf2binstring");var F1=l((t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let a=t[n++];if(a<128){o[i++]=a;continue}let s=dc[a];if(s>4){o[i++]=65533,n+=s-1;continue}for(a&=s===2?31:s===3?15:7;s>1&&n<r;)a=a<<6|t[n++]&63,s--;if(s>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return D1(o,i)},"buf2string"),P1=l((t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+dc[t[r]]>e?r:e},"utf8border"),hc={string2buf:I1,buf2string:F1,utf8border:P1};function N1(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}l(N1,"ZStream");var gw=N1;const mw=Object.prototype.toString,{Z_NO_FLUSH:$1,Z_SYNC_FLUSH:M1,Z_FULL_FLUSH:B1,Z_FINISH:U1,Z_OK:cu,Z_STREAM_END:L1,Z_DEFAULT_COMPRESSION:O1,Z_DEFAULT_STRATEGY:H1,Z_DEFLATED:W1}=No;function fc(t){this.options=su.assign({level:O1,method:W1,chunkSize:16384,windowBits:15,memLevel:8,strategy:H1},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gw,this.strm.avail_out=0;let r=uc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==cu)throw new Error(Po[r]);if(e.header&&uc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=hc.string2buf(e.dictionary):mw.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=uc.deflateSetDictionary(this.strm,n),r!==cu)throw new Error(Po[r]);this._dict_set=!0}}l(fc,"Deflate$1"),fc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?U1:$1,typeof t=="string"?r.input=hc.string2buf(t):mw.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===M1||o===B1)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=uc.deflate(r,o),i===L1)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=uc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===cu;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},fc.prototype.onData=function(t){this.chunks.push(t)},fc.prototype.onEnd=function(t){t===cu&&(this.result=su.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Wf(t,e){const r=new fc(e);if(r.push(t,!0),r.err)throw r.msg||Po[r.err];return r.result}l(Wf,"deflate$1");function z1(t,e){return e=e||{},e.raw=!0,Wf(t,e)}l(z1,"deflateRaw$1");function q1(t,e){return e=e||{},e.gzip=!0,Wf(t,e)}l(q1,"gzip$1");var j1=fc,V1=Wf,G1=z1,K1=q1,Q1=No,Z1={Deflate:j1,deflate:V1,deflateRaw:G1,gzip:K1,constants:Q1};const lu=30,X1=12;var Y1=l(function(e,r){let n,i,o,a,s,c,u,d,f,p,g,_,v,y,x,C,k,I,B,J,re,K,we,ie;const pe=e.state;n=e.next_in,we=e.input,i=n+(e.avail_in-5),o=e.next_out,ie=e.output,a=o-(r-e.avail_out),s=o+(e.avail_out-257),c=pe.dmax,u=pe.wsize,d=pe.whave,f=pe.wnext,p=pe.window,g=pe.hold,_=pe.bits,v=pe.lencode,y=pe.distcode,x=(1<<pe.lenbits)-1,C=(1<<pe.distbits)-1;e:do{_<15&&(g+=we[n++]<<_,_+=8,g+=we[n++]<<_,_+=8),k=v[g&x];t:for(;;){if(I=k>>>24,g>>>=I,_-=I,I=k>>>16&255,I===0)ie[o++]=k&65535;else if(I&16){B=k&65535,I&=15,I&&(_<I&&(g+=we[n++]<<_,_+=8),B+=g&(1<<I)-1,g>>>=I,_-=I),_<15&&(g+=we[n++]<<_,_+=8,g+=we[n++]<<_,_+=8),k=y[g&C];r:for(;;){if(I=k>>>24,g>>>=I,_-=I,I=k>>>16&255,I&16){if(J=k&65535,I&=15,_<I&&(g+=we[n++]<<_,_+=8,_<I&&(g+=we[n++]<<_,_+=8)),J+=g&(1<<I)-1,J>c){e.msg="invalid distance too far back",pe.mode=lu;break e}if(g>>>=I,_-=I,I=o-a,J>I){if(I=J-I,I>d&&pe.sane){e.msg="invalid distance too far back",pe.mode=lu;break e}if(re=0,K=p,f===0){if(re+=u-I,I<B){B-=I;do ie[o++]=p[re++];while(--I);re=o-J,K=ie}}else if(f<I){if(re+=u+f-I,I-=f,I<B){B-=I;do ie[o++]=p[re++];while(--I);if(re=0,f<B){I=f,B-=I;do ie[o++]=p[re++];while(--I);re=o-J,K=ie}}}else if(re+=f-I,I<B){B-=I;do ie[o++]=p[re++];while(--I);re=o-J,K=ie}for(;B>2;)ie[o++]=K[re++],ie[o++]=K[re++],ie[o++]=K[re++],B-=3;B&&(ie[o++]=K[re++],B>1&&(ie[o++]=K[re++]))}else{re=o-J;do ie[o++]=ie[re++],ie[o++]=ie[re++],ie[o++]=ie[re++],B-=3;while(B>2);B&&(ie[o++]=ie[re++],B>1&&(ie[o++]=ie[re++]))}}else if((I&64)==0){k=y[(k&65535)+(g&(1<<I)-1)];continue r}else{e.msg="invalid distance code",pe.mode=lu;break e}break}}else if((I&64)==0){k=v[(k&65535)+(g&(1<<I)-1)];continue t}else if(I&32){pe.mode=X1;break e}else{e.msg="invalid literal/length code",pe.mode=lu;break e}break}}while(n<i&&o<s);B=_>>3,n-=B,_-=B<<3,g&=(1<<_)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<s?257+(s-o):257-(o-s),pe.hold=g,pe.bits=_},"inflate_fast");const Ua=15,vw=852,ww=592,yw=0,zf=1,bw=2,J1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),eC=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),tC=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rC=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var pc=l((t,e,r,n,i,o,a,s)=>{const c=s.bits;let u=0,d=0,f=0,p=0,g=0,_=0,v=0,y=0,x=0,C=0,k,I,B,J,re,K=null,we=0,ie;const pe=new Uint16Array(Ua+1),Se=new Uint16Array(Ua+1);let Je=null,ae=0,Ae,Ne,Pe;for(u=0;u<=Ua;u++)pe[u]=0;for(d=0;d<n;d++)pe[e[r+d]]++;for(g=c,p=Ua;p>=1&&pe[p]===0;p--);if(g>p&&(g=p),p===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,s.bits=1,0;for(f=1;f<p&&pe[f]===0;f++);for(g<f&&(g=f),y=1,u=1;u<=Ua;u++)if(y<<=1,y-=pe[u],y<0)return-1;if(y>0&&(t===yw||p!==1))return-1;for(Se[1]=0,u=1;u<Ua;u++)Se[u+1]=Se[u]+pe[u];for(d=0;d<n;d++)e[r+d]!==0&&(a[Se[e[r+d]]++]=d);if(t===yw?(K=Je=a,ie=19):t===zf?(K=J1,we-=257,Je=eC,ae-=257,ie=256):(K=tC,Je=rC,ie=-1),C=0,d=0,u=f,re=o,_=g,v=0,B=-1,x=1<<g,J=x-1,t===zf&&x>vw||t===bw&&x>ww)return 1;for(;;){Ae=u-v,a[d]<ie?(Ne=0,Pe=a[d]):a[d]>ie?(Ne=Je[ae+a[d]],Pe=K[we+a[d]]):(Ne=32+64,Pe=0),k=1<<u-v,I=1<<_,f=I;do I-=k,i[re+(C>>v)+I]=Ae<<24|Ne<<16|Pe|0;while(I!==0);for(k=1<<u-1;C&k;)k>>=1;if(k!==0?(C&=k-1,C+=k):C=0,d++,--pe[u]==0){if(u===p)break;u=e[r+a[d]]}if(u>g&&(C&J)!==B){for(v===0&&(v=g),re+=f,_=u-v,y=1<<_;_+v<p&&(y-=pe[_+v],!(y<=0));)_++,y<<=1;if(x+=1<<_,t===zf&&x>vw||t===bw&&x>ww)return 1;B=C&J,i[B]=g<<24|_<<16|re-o|0}}return C!==0&&(i[re+C]=u-v<<24|64<<16|0),s.bits=g,0},"inflate_table");const nC=0,_w=1,xw=2,{Z_FINISH:Sw,Z_BLOCK:iC,Z_TREES:uu,Z_OK:Lo,Z_STREAM_END:oC,Z_NEED_DICT:aC,Z_STREAM_ERROR:gn,Z_DATA_ERROR:Cw,Z_MEM_ERROR:Ew,Z_BUF_ERROR:sC,Z_DEFLATED:Rw}=No,Aw=1,Tw=2,kw=3,Iw=4,Dw=5,Fw=6,Pw=7,Nw=8,$w=9,Mw=10,du=11,Ii=12,qf=13,Bw=14,jf=15,Uw=16,Lw=17,Ow=18,Hw=19,hu=20,fu=21,Ww=22,zw=23,qw=24,jw=25,Vw=26,Vf=27,Gw=28,Kw=29,tr=30,Qw=31,cC=32,lC=852,uC=592,dC=15,Zw=l(t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24),"zswap32");function hC(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}l(hC,"InflateState");const Xw=l(t=>{if(!t||!t.state)return gn;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Aw,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(lC),e.distcode=e.distdyn=new Int32Array(uC),e.sane=1,e.back=-1,Lo},"inflateResetKeep"),Yw=l(t=>{if(!t||!t.state)return gn;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Xw(t)},"inflateReset"),Jw=l((t,e)=>{let r;if(!t||!t.state)return gn;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?gn:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Yw(t))},"inflateReset2"),ey=l((t,e)=>{if(!t)return gn;const r=new hC;t.state=r,r.window=null;const n=Jw(t,e);return n!==Lo&&(t.state=null),n},"inflateInit2"),fC=l(t=>ey(t,dC),"inflateInit");let ty=!0,Gf,Kf;const pC=l(t=>{if(ty){Gf=new Int32Array(512),Kf=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(pc(_w,t.lens,0,288,Gf,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;pc(xw,t.lens,0,32,Kf,0,t.work,{bits:5}),ty=!1}t.lencode=Gf,t.lenbits=9,t.distcode=Kf,t.distbits=5},"fixedtables"),ry=l((t,e,r,n)=>{let i;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),gC=l((t,e)=>{let r,n,i,o,a,s,c,u,d,f,p,g,_,v,y=0,x,C,k,I,B,J,re,K;const we=new Uint8Array(4);let ie,pe;const Se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return gn;r=t.state,r.mode===Ii&&(r.mode=qf),a=t.next_out,i=t.output,c=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,f=s,p=c,K=Lo;e:for(;;)switch(r.mode){case Aw:if(r.wrap===0){r.mode=qf;break}for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.wrap&2&&u===35615){r.check=0,we[0]=u&255,we[1]=u>>>8&255,r.check=Cr(r.check,we,2,0),u=0,d=0,r.mode=Tw;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=tr;break}if((u&15)!==Rw){t.msg="unknown compression method",r.mode=tr;break}if(u>>>=4,d-=4,re=(u&15)+8,r.wbits===0)r.wbits=re;else if(re>r.wbits){t.msg="invalid window size",r.mode=tr;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=u&512?Mw:Ii,u=0,d=0;break;case Tw:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==Rw){t.msg="unknown compression method",r.mode=tr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=tr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=Cr(r.check,we,2,0)),u=0,d=0,r.mode=kw;case kw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,we[2]=u>>>16&255,we[3]=u>>>24&255,r.check=Cr(r.check,we,4,0)),u=0,d=0,r.mode=Iw;case Iw:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=Cr(r.check,we,2,0)),u=0,d=0,r.mode=Dw;case Dw:if(r.flags&1024){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(we[0]=u&255,we[1]=u>>>8&255,r.check=Cr(r.check,we,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=Fw;case Fw:if(r.flags&1024&&(g=r.length,g>s&&(g=s),g&&(r.head&&(re=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+g),re)),r.flags&512&&(r.check=Cr(r.check,n,g,o)),s-=g,o+=g,r.length-=g),r.length))break e;r.length=0,r.mode=Pw;case Pw:if(r.flags&2048){if(s===0)break e;g=0;do re=n[o+g++],r.head&&re&&r.length<65536&&(r.head.name+=String.fromCharCode(re));while(re&&g<s);if(r.flags&512&&(r.check=Cr(r.check,n,g,o)),s-=g,o+=g,re)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Nw;case Nw:if(r.flags&4096){if(s===0)break e;g=0;do re=n[o+g++],r.head&&re&&r.length<65536&&(r.head.comment+=String.fromCharCode(re));while(re&&g<s);if(r.flags&512&&(r.check=Cr(r.check,n,g,o)),s-=g,o+=g,re)break e}else r.head&&(r.head.comment=null);r.mode=$w;case $w:if(r.flags&512){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=tr;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Ii;break;case Mw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}t.adler=r.check=Zw(u),u=0,d=0,r.mode=du;case du:if(r.havedict===0)return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,aC;t.adler=r.check=1,r.mode=Ii;case Ii:if(e===iC||e===uu)break e;case qf:if(r.last){u>>>=d&7,d-=d&7,r.mode=Vf;break}for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=Bw;break;case 1:if(pC(r),r.mode=hu,e===uu){u>>>=2,d-=2;break e}break;case 2:r.mode=Lw;break;case 3:t.msg="invalid block type",r.mode=tr}u>>>=2,d-=2;break;case Bw:for(u>>>=d&7,d-=d&7;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((u&65535)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=tr;break}if(r.length=u&65535,u=0,d=0,r.mode=jf,e===uu)break e;case jf:r.mode=Uw;case Uw:if(g=r.length,g){if(g>s&&(g=s),g>c&&(g=c),g===0)break e;i.set(n.subarray(o,o+g),a),s-=g,o+=g,c-=g,a+=g,r.length-=g;break}r.mode=Ii;break;case Lw:for(;d<14;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=tr;break}r.have=0,r.mode=Ow;case Ow:for(;r.have<r.ncode;){for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.lens[Se[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[Se[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ie={bits:r.lenbits},K=pc(nC,r.lens,0,19,r.lencode,0,r.work,ie),r.lenbits=ie.bits,K){t.msg="invalid code lengths set",r.mode=tr;break}r.have=0,r.mode=Hw;case Hw:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(k<16)u>>>=x,d-=x,r.lens[r.have++]=k;else{if(k===16){for(pe=x+2;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u>>>=x,d-=x,r.have===0){t.msg="invalid bit length repeat",r.mode=tr;break}re=r.lens[r.have-1],g=3+(u&3),u>>>=2,d-=2}else if(k===17){for(pe=x+3;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=x,d-=x,re=0,g=3+(u&7),u>>>=3,d-=3}else{for(pe=x+7;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=x,d-=x,re=0,g=11+(u&127),u>>>=7,d-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=tr;break}for(;g--;)r.lens[r.have++]=re}}if(r.mode===tr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=tr;break}if(r.lenbits=9,ie={bits:r.lenbits},K=pc(_w,r.lens,0,r.nlen,r.lencode,0,r.work,ie),r.lenbits=ie.bits,K){t.msg="invalid literal/lengths set",r.mode=tr;break}if(r.distbits=6,r.distcode=r.distdyn,ie={bits:r.distbits},K=pc(xw,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ie),r.distbits=ie.bits,K){t.msg="invalid distances set",r.mode=tr;break}if(r.mode=hu,e===uu)break e;case hu:r.mode=fu;case fu:if(s>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,Y1(t,p),a=t.next_out,i=t.output,c=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,r.mode===Ii&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(C&&(C&240)==0){for(I=x,B=C,J=k;y=r.lencode[J+((u&(1<<I+B)-1)>>I)],x=y>>>24,C=y>>>16&255,k=y&65535,!(I+x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=I,d-=I,r.back+=I}if(u>>>=x,d-=x,r.back+=x,r.length=k,C===0){r.mode=Vw;break}if(C&32){r.back=-1,r.mode=Ii;break}if(C&64){t.msg="invalid literal/length code",r.mode=tr;break}r.extra=C&15,r.mode=Ww;case Ww:if(r.extra){for(pe=r.extra;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=zw;case zw:for(;y=r.distcode[u&(1<<r.distbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((C&240)==0){for(I=x,B=C,J=k;y=r.distcode[J+((u&(1<<I+B)-1)>>I)],x=y>>>24,C=y>>>16&255,k=y&65535,!(I+x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=I,d-=I,r.back+=I}if(u>>>=x,d-=x,r.back+=x,C&64){t.msg="invalid distance code",r.mode=tr;break}r.offset=k,r.extra=C&15,r.mode=qw;case qw:if(r.extra){for(pe=r.extra;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=tr;break}r.mode=jw;case jw:if(c===0)break e;if(g=p-c,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=tr;break}g>r.wnext?(g-=r.wnext,_=r.wsize-g):_=r.wnext-g,g>r.length&&(g=r.length),v=r.window}else v=i,_=a-r.offset,g=r.length;g>c&&(g=c),c-=g,r.length-=g;do i[a++]=v[_++];while(--g);r.length===0&&(r.mode=fu);break;case Vw:if(c===0)break e;i[a++]=r.length,c--,r.mode=fu;break;case Vf:if(r.wrap){for(;d<32;){if(s===0)break e;s--,u|=n[o++]<<d,d+=8}if(p-=c,t.total_out+=p,r.total+=p,p&&(t.adler=r.check=r.flags?Cr(r.check,i,p,a-p):oc(r.check,i,p,a-p)),p=c,(r.flags?u:Zw(u))!==r.check){t.msg="incorrect data check",r.mode=tr;break}u=0,d=0}r.mode=Gw;case Gw:if(r.wrap&&r.flags){for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=tr;break}u=0,d=0}r.mode=Kw;case Kw:K=oC;break e;case tr:K=Cw;break e;case Qw:return Ew;case cC:default:return gn}return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,(r.wsize||p!==t.avail_out&&r.mode<tr&&(r.mode<Vf||e!==Sw))&&ry(t,t.output,t.next_out,p-t.avail_out),f-=t.avail_in,p-=t.avail_out,t.total_in+=f,t.total_out+=p,r.total+=p,r.wrap&&p&&(t.adler=r.check=r.flags?Cr(r.check,i,p,t.next_out-p):oc(r.check,i,p,t.next_out-p)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Ii?128:0)+(r.mode===hu||r.mode===jf?256:0),(f===0&&p===0||e===Sw)&&K===Lo&&(K=sC),K},"inflate$2"),mC=l(t=>{if(!t||!t.state)return gn;let e=t.state;return e.window&&(e.window=null),t.state=null,Lo},"inflateEnd"),vC=l((t,e)=>{if(!t||!t.state)return gn;const r=t.state;return(r.wrap&2)==0?gn:(r.head=e,e.done=!1,Lo)},"inflateGetHeader"),wC=l((t,e)=>{const r=e.length;let n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==du)?gn:n.mode===du&&(i=1,i=oc(i,e,r,0),i!==n.check)?Cw:(o=ry(t,e,r,r),o?(n.mode=Qw,Ew):(n.havedict=1,Lo))},"inflateSetDictionary");var yC=Yw,bC=Jw,_C=Xw,xC=fC,SC=ey,CC=gC,EC=mC,RC=vC,AC=wC,TC="pako inflate (from Nodeca project)",Di={inflateReset:yC,inflateReset2:bC,inflateResetKeep:_C,inflateInit:xC,inflateInit2:SC,inflate:CC,inflateEnd:EC,inflateGetHeader:RC,inflateSetDictionary:AC,inflateInfo:TC};function kC(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}l(kC,"GZheader");var IC=kC;const ny=Object.prototype.toString,{Z_NO_FLUSH:DC,Z_FINISH:FC,Z_OK:gc,Z_STREAM_END:Qf,Z_NEED_DICT:Zf,Z_STREAM_ERROR:PC,Z_DATA_ERROR:iy,Z_MEM_ERROR:NC}=No;function mc(t){this.options=su.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gw,this.strm.avail_out=0;let r=Di.inflateInit2(this.strm,e.windowBits);if(r!==gc)throw new Error(Po[r]);if(this.header=new IC,Di.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=hc.string2buf(e.dictionary):ny.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Di.inflateSetDictionary(this.strm,e.dictionary),r!==gc)))throw new Error(Po[r])}l(mc,"Inflate$1"),mc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?FC:DC,ny.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Di.inflate(r,a),o===Zf&&i&&(o=Di.inflateSetDictionary(r,i),o===gc?o=Di.inflate(r,a):o===iy&&(o=Zf));r.avail_in>0&&o===Qf&&r.state.wrap>0&&t[r.next_in]!==0;)Di.inflateReset(r),o=Di.inflate(r,a);switch(o){case PC:case iy:case Zf:case NC:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(r.avail_out===0||o===Qf))if(this.options.to==="string"){let c=hc.utf8border(r.output,r.next_out),u=r.next_out-c,d=hc.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===gc&&s===0)){if(o===Qf)return o=Di.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},mc.prototype.onData=function(t){this.chunks.push(t)},mc.prototype.onEnd=function(t){t===gc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=su.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Xf(t,e){const r=new mc(e);if(r.push(t),r.err)throw r.msg||Po[r.err];return r.result}l(Xf,"inflate$1");function $C(t,e){return e=e||{},e.raw=!0,Xf(t,e)}l($C,"inflateRaw$1");var MC=mc,BC=Xf,UC=$C,LC=Xf,OC=No,HC={Inflate:MC,inflate:BC,inflateRaw:UC,ungzip:LC,constants:OC};const{Deflate:WC,deflate:zC,deflateRaw:qC,gzip:jC}=Z1,{Inflate:VC,inflate:GC,inflateRaw:KC,ungzip:QC}=HC;var ZC=WC,XC=zC,YC=qC,JC=jC,eE=VC,tE=GC,rE=KC,oy=QC,nE=No,HR={Deflate:ZC,deflate:XC,deflateRaw:YC,gzip:JC,Inflate:eE,inflate:tE,inflateRaw:rE,ungzip:oy,constants:nE};class Yf{constructor(e){this.bytes=e,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(e){const r=this.byteIndexCurrent;return this.byteIndexCurrent+=e,this.bytes.slice(r,this.byteIndexCurrent)}readByte(){const e=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,e}readString(e){const r=[],n=this.byteIndexCurrent+e;let i=this.byteIndexCurrent;for(;i<n;){const o=this.bytes[i++];if(o===0)break;let a=0,s=0;if((o&128)==0)a=o,s=0;else if((o&224)==192)a=o&31,s=1;else if((o&240)==224)a=o&15,s=2;else if((o&248)==240)a=o&7,s=3;else throw Error(`Invalid unicode, unknown multibyte encoding header ${o.toString(2)} at offset ${i}`);for(;s>0;){const c=this.bytes[i++];if((c&192)!=128)throw Error(`Invalid unicode, unexpected multibyte encoding trailer ${c.toString(2)} at offset ${i}`);a=a<<6|c&63,s--}r.push(String.fromCodePoint(a))}return this.byteIndexCurrent=n,r.join("")}}l(Yf,"ByteStream");class Ur{constructor(e,r){this.value=e,this.id=`_${this.value}`,this.name=r}static Instances(){return Ur._instances==null&&(Ur._instances=new ay),Ur._instances}}l(Ur,"TarFileTypeFlag");class ay{constructor(){this.Normal=new Ur("0","Normal"),this.HardLink=new Ur("1","Hard Link"),this.SymbolicLink=new Ur("2","Symbolic Link"),this.CharacterSpecial=new Ur("3","Character Special"),this.BlockSpecial=new Ur("4","Block Special"),this.Directory=new Ur("5","Directory"),this.FIFO=new Ur("6","FIFO"),this.ContiguousFile=new Ur("7","Contiguous File"),this.LongFilePath=new Ur("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let e=0;e<this._All.length;e++){const r=this._All[e];this._All[r.id]=r}}}l(ay,"TarFileTypeFlag_Instances");class pu{constructor(e,r,n,i,o,a,s,c,u,d,f,p,g,_,v,y){this.fileName=e,this.fileMode=r,this.userIDOfOwner=n,this.userIDOfGroup=i,this.fileSizeInBytes=o,this.timeModifiedInUnixFormat=a,this.checksum=s,this.typeFlag=c,this.nameOfLinkedFile=u,this.uStarIndicator=d,this.uStarVersion=f,this.userNameOfOwner=p,this.groupNameOfOwner=g,this.deviceNumberMajor=_,this.deviceNumberMinor=v,this.filenamePrefix=y,this.fullFileName=y.length?y.endsWith("/")?y+e:`${y}/${e}`:e}static fromBytes(e){const r=new Yf(e),n=r.readString(100).trim(),i=r.readString(8),o=r.readString(8),a=r.readString(8),s=r.readString(12),c=r.readBytes(12),u=r.readString(8),d=r.readString(1),f=r.readString(100),p=r.readString(6),g=r.readString(2),_=r.readString(32),v=r.readString(32),y=r.readString(8),x=r.readString(8),C=r.readString(155),k=r.readBytes(12),I=parseInt(s.trim(),8),B=parseInt(u,8),J=Ur.Instances()._All,re=`_${d}`,K=J[re];return new pu(n,i,o,a,I,c,B,K,f,p,g,_,v,y,x,C)}}l(pu,"TarFileEntryHeader");const sy=512;class gu{constructor(e,r){this.header=e,this.dataAsBytes=r}static fromBytes(e,r){const n=sy,i=pu.fromBytes(e),o=i.fileSizeInBytes,s=Math.ceil(o/n)*n,c=r.readBytes(s).slice(0,o);return new gu(i,c)}}l(gu,"TarFileEntry");class mu{constructor(e){this.entries=e}static fromBytes(e){const r=new Yf(e),n=[],i=sy;let o=0;for(;r.hasMoreBytes()==!0;){const s=r.readBytes(i);let c=!0;for(let u=0;u<s.length;u++)if(s[u]!=0){c=!1;break}if(c==!0){if(o++,o==2)break}else{o=0;const u=gu.fromBytes(s,r);n.push(u)}}const a=new mu(n);return a.consolidateLongPathEntries(),a}consolidateLongPathEntries(){var e;const r=Ur.Instances().LongFilePath.name,n=this.entries;for(let i=0;i<n.length;i++){const o=n[i];if(((e=o.header.typeFlag)==null?void 0:e.name)==r){const a=n[i+1];a.header.fileName=o.dataAsBytes.reduce((s,c)=>s+=String.fromCharCode(c),""),a.header.fileName=a.header.fileName.replace(/\0/g,""),n.splice(i,1),i--}}}}l(mu,"TarFile");const iE=l(t=>mu.fromBytes(t),"readTar"),io=(0,O.loadMessageBundle)(),vu=new TextDecoder,wu=new TextEncoder;class cy{constructor(e,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,r;const n=(r=this.strongRef)!=null?r:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}l(cy,"TimedRetainingRef");class ly{constructor(e,r){this.root=e,this.providerService=r,this._onDidChangeIndexingEnablement=new h.EventEmitter,this._onDidDownloadTar=new h.EventEmitter,this.ongoingRequests=new Map,this.indexingDisabled=!1,this.usageFile=h.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=h.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=h.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await xi(Vn.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),r=await this.getIndexingEnabledRepos(),n=r.has("*")||e.every(i=>r.has(i));await xi(Vn.EnabledSomeSearchIndexes,r.size>0),await xi(Vn.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[h.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),h.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),h.commands.registerCommand("remoteHub.enableIndexing",async()=>{const e={title:io("search download prompt enable","Enable")},r={title:io("search download prompt enable always","Always Enable")},n={title:io("search download prompt configure","Configure")},i={title:io("search download prompt cancel","Cancel"),isCloseAffordance:!0},o=await h.window.showInformationMessage(io("search download prompt",`Indexing creates a copy of this repository in your browser's storage in order to provide enhanced text searches.

Without indexing, searches will use GitHub's text search, which is imprecise.

Do you want to enable creating local indexes for this repository on this browser? You should only enable indexing on machines you trust.`),{modal:!0,useCustom:!0},e,r,n,i);if(o===n&&await h.commands.executeCommand("workbench.action.openSettings","remoteHub.search.download"),o===e)return await this.markIndexingEnabledForRepos(...this.providerService.repositories.map(a=>a.name)),{triggerSearch:!0};if(o===r)return await this.markIndexingEnabledForRepos("*"),{triggerSearch:!0}}),h.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=l(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const a of o)if(i>10**a.power)return`${Math.round(i/10**a.power)} ${a.name}`;return"Unknown size"},"humanReadableSize"),r=await this.listTars();if(r.length===0){await h.window.showInformationMessage("No Search Indexes Found");return}const n=h.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:a})=>({label:i,path:a,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const a=h.workspace.fs.delete(o),s=h.window.setStatusBarMessage(`$(loading) Deleting ${i}`,a);await a,s.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),h.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>h.window.withProgress({location:h.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0,await Promise.all([h.workspace.fs.delete(this.root,{recursive:!0})]),this.updateContext()}))]}getTarFromMemory(e){var r;if(e===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;E.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const r=await h.workspace.fs.readFile(e);return!r||!r.length?void 0:r}catch(r){(!(r instanceof h.FileSystemError)||r.code!==h.FileSystemError.FileNotFound.name)&&(h.window.showWarningMessage(io("diskReadUnexpectedError","Unexpected error reading index from disk, attempting to reload from network")),E.error(r,"Unexpected error reading tarball from disk"));return}}async getTarFromNetwork(e){try{if(!await this.isIndexingEnabledForRepo(e))throw Error("Unable to search without indexing allowed");const r=await this.providerService.getTarGz(e);if(r===void 0)throw Error("Unable to retrieve search index from provider");return r}finally{this.updateContext()}}async getTar(e,r){r===void 0&&({HEAD:{sha:r}}=await this.providerService.getMetadata(e)),e=this.providerService.getCanonicalUri(e);const n=this.getTarStorageUri(e,r),i=n.toString();try{let o=this.ongoingRequests.get(i);return o===void 0&&(o=this.getTarCore(e,r,n),this.ongoingRequests.set(i,o)),await o}finally{this.ongoingRequests.delete(i)}}async getCachedTar(e,r){return e=this.providerService.getCanonicalUri(e),this.getTarCore(e,r,this.getTarStorageUri(e,r),{skipDownload:!0})}async getTarCore(e,r,n,i){var o;const a=`${le(e,{excludeScheme:!0})}/${r}`,s=new Be(`TarPit.getTar(${a})`),c=n.toString(),u=Date.now();let d,f;try{if(s.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),f=this.getTarFromMemory(c),f)return d=" \u2022 Got .tar from memory",f;s.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let p=!1,g=await this.getTarFromDisk(n);if(g==null?void 0:g.length)d=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){d=" \u2022 Skipped download";return}s.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),g=await this.getTarFromNetwork(e),p=!0,d=" \u2022 Got .tar from network",h.workspace.fs.writeFile(n,g).then(()=>E.debug(`Sucessfully wrote tarball to disk in ${Date.now()-u}ms`),y=>E.error(y,`Error writing tarball to disk in ${Date.now()-u}ms`))}if(!(g==null?void 0:g.length))throw new Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `GitHub Repositories: Delete Local Repository Data...`");s.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const _=oy(g);s.logStep("Parsing .tar",{suffix:" \u2022 Parsing .tar..."}),f=iE(_),s.logStep("Fixing up .tar entries",{suffix:" \u2022 Fixing up .tar entries..."});const v=[];for(const y of f.entries)((o=y.header.typeFlag)==null?void 0:o.name)==="Normal"&&(y.header.fullFileName=y.header.fullFileName.replace(/^[^/]+\/?/,""),v.push(y));return f.entries=v,this.lastReadValue=new cy(f,Date.now()-u),this.lastReadKey=c,p&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:r}),0),f}catch(p){throw d=` \u2022 Failed; ${String(p)}`,p}finally{f&&(this.markCacheEntryUsed(`${a}`).catch(p=>E.log(`Error marking entry used: ${p}`)),this.cleanUpCache().catch(p=>E.log(`Error cleaning cache: ${p}`))),s.stop(d?{suffix:d}:void 0)}}getTarStorageUri(e,r){return h.Uri.joinPath(this.root,"tars",le(e,{excludeScheme:!0}),r)}async readDir(e){try{return(await h.workspace.fs.readDirectory(e)).map(r=>h.Uri.joinPath(e,r[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const r=await this.getIndexingEnabledRepos();if(r.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);return n?r.has(n):!1}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],r=await h.window.showQuickPick(e.map(n=>({picked:!0,description:n==="*"?io("all","All Repositories"):"",label:n})),{canPickMany:!0,title:io("select repos where indexing is allowed","Select repositories that should be indexed")});r&&await this.resetIndexingAllowedRepos(r.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(vu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(r){r instanceof h.FileSystemError&&r.code!==h.FileSystemError.FileNotFound().code&&E.error(r,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(h.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(r.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await h.workspace.fs.stat(o)).size})))}async resetIndexingAllowedRepos(e){await h.workspace.fs.writeFile(this.indexingAllowanceFile,wu.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markIndexingEnabledForRepos(...e){let r;try{r=JSON.parse(vu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&E.error(n,"Error reading index allowance data."),r=[]}for(const n of e)r.includes(n)||r.push(n);this.indexingDisabled=!1,await h.workspace.fs.writeFile(this.indexingAllowanceFile,wu.encode(JSON.stringify(r))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let r;try{r=JSON.parse(vu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&E.error(n,"Error reading usage data."),r={}}r[e]=Number(Date.now()),await h.workspace.fs.writeFile(this.usageFile,wu.encode(JSON.stringify(r)))}async cleanUpCache(){var e,r;E.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(vu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(f){f instanceof h.FileSystemError&&f.code!==h.FileSystemError.FileNotFound().code&&E.error(f,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(f=>{var p;const g=/^([^/]*\/[^/]*)\//.exec(f.name);if(!g)throw Error("Unexpected repo entry");const _=g[1],v=(p=i[f.name])!=null?p:0;o.push({...f,lastUsed:v,repo:_})}),o.sort((f,p)=>p.lastUsed-f.lastUsed);let a=0;const s=[],c=new Map,u=((e=j.get("search.download.sizeLimit"))!=null?e:100)*1024*1024,d=(r=j.get("search.download.repoLimit"))!=null?r:4;o.forEach(f=>{var p,g;(f.lastUsed===0||a>u||((p=c.get(f.repo))!=null?p:0)>d)&&s.push(f),a+=f.size,c.set(f.repo,((g=c.get(f.repo))!=null?g:0)+1)}),await Promise.all(s.map(async f=>{try{await h.workspace.fs.delete(f.path,{recursive:!0}),delete i[f.name],E.log(`Deleted cache entry for ${f.name}`)}catch(p){E.log(`Deleting cache entry for ${f.name} failed; ${String(p)}`)}})),await h.workspace.fs.writeFile(this.usageFile,wu.encode(JSON.stringify(i))),await this.updateContext()}}l(ly,"TarPit");const oE=(0,O.loadMessageBundle)();async function aE(t,e,r,n,i,o,a){return Jf("provideTextSearchResults",async()=>{const s=sS(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let c;try{c=await Jf("fetch tarball",()=>r.getTar(i.folder))}catch(y){return{limitHit:!1,message:{type:h.TextSearchCompleteMessageType.Warning,trusted:!0,text:oE("indexNotAvailable","Search index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(a.isCancellationRequested)return{limitHit:!1};const{maxResults:u,maxFileSize:d,includes:f,excludes:p}=i,g=await sE(i.folder,t,c,e);if(a.isCancellationRequested)return{limitHit:!0};let _=u;const v=cS(g,f,p,d);return Jf("searchFiles",async()=>{var y,x;let C=0;for(const k of g){if(!v.has(k.path))continue;const I=lS(k.contents,k.path,s,{beforeContext:(y=i.beforeContext)!=null?y:0,afterContext:(x=i.afterContext)!=null?x:0,previewOptions:i.previewOptions,remainingResultQuota:_});for(const B of I)o.report({...B,uri:h.Uri.joinPath(i.folder,B.uri.path)});if(_!==void 0&&(_-=I.length,_<=0))return{limitHit:!0};if(C++,C%1e4==0&&(await new Promise(B=>setTimeout(B,0)),a.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}l(aE,"provideTextSearchResults");async function sE(t,e,r,n){const i=r.entries,o=e.getVirtualRootUri(t),a=await n.getChanges(o,{predicate:f=>f.fileType===h.FileType.File});if(a.length===0)return i.map(f=>({contents:f.dataAsBytes,path:f.header.fullFileName,size:f.dataAsBytes.byteLength}));const s=await Promise.all(M(a,f=>{if(f.type===ht.Created)return n.getContent(f.uri).then(p=>({path:e.getRelativeFilePath(o,f.uri),size:p.length,contents:p}))})),c=await Promise.all(M(a,f=>{if(f.type===ht.Changed)return n.getContent(f.uri).then(p=>({path:e.getRelativeFilePath(o,f.uri),size:p.length,contents:p}))})),u=new Set(Wt(ye(c,f=>f.path),M(a,f=>{if(f.type===ht.Deleted)return e.getRelativeFilePath(o,f.uri)})));return[...M(i,f=>{if(!u.has(f.header.fullFileName))return{contents:f.dataAsBytes,path:f.header.fullFileName,size:f.dataAsBytes.byteLength}}),...s,...c]}l(sE,"listAllFiles");function WR(t,e){const r=Date.now(),n=e();return Logger.log(`${t} time: ${Date.now()-r}`),n}l(WR,"timeSync");async function Jf(t,e){const r=Date.now(),n=await e();return E.log(`${t} time: ${Date.now()-r}`),n}l(Jf,"time");var cE=Object.defineProperty,lE=Object.getOwnPropertyDescriptor,ep=l((t,e,r,n)=>{for(var i=n>1?void 0:n?lE(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&cE(e,r,i),i},"github_fs_decorateClass");const tp=(0,O.loadMessageBundle)(),uE=h.FileSystemError.FileNotFound().code,dE=/(\/|\\)/g,uy=".vscode/.github-pull-request.rec";class vc{constructor(e,r,n,i){this.providerService=e,this.github=r,this.changeStore=n,this.tarPit=i,this._onDidChangeFile=new h.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(o=>{o.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([o.repository.uri])}),e.onDidRefresh(o=>this.onRefreshOrRepositoryChanged(o)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Pt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){E.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>tt(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>tt(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));E.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(W(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{E.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=W(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var r,n;const i=W(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),a={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,a);const s=await this.github.getFileTree(e),c=await s.get(o);if(c==null?void 0:c.stat)return c==null?void 0:c.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:h.FileType.File,size:0,ctime:0,mtime:(r=s.timestamp)!=null?r:Date.now(),permissions:h.FilePermission.Readonly};if(o===uy){const{ref:u}=this.providerService.getVirtualUriMetadata(e);if((u==null?void 0:u.type)===Ue.PullRequest)return{type:h.FileType.File,size:0,ctime:0,mtime:(n=s.timestamp)!=null?n:Date.now(),permissions:h.FilePermission.Readonly}}throw h.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(a==null?void 0:a.outdated)&&setTimeout(()=>{E.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,r){this.implicitlyWatchedUris.set(W(e),e);const n=await this.github.getFileTree(e),i=this.providerService.getRelativeFilePath(e),o=(await n.getChildren(i,r)).map(([a,{stat:{type:s}}])=>[a,s]);return i===""&&Be.stop("Time to root directory"),o}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){const r=W(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(r,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(r),i instanceof h.FileSystemError&&i.code===uE){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===uy){const{ref:a}=this.providerService.getVirtualUriMetadata(e);if((a==null?void 0:a.type)===Ue.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(r),(n==null?void 0:n.outdated)&&setTimeout(()=>{E.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw h.FileSystemError.NoPermissions()}delete(e,r){throw h.FileSystemError.NoPermissions()}rename(e,r,n){throw h.FileSystemError.NoPermissions()}copy(e,r,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},a){const s=`${W(r)}|${JSON.stringify({includes:i,excludes:o})}`;let c=this.fileSearchCache.get(s);if(c===void 0){const d=this.providerService.getRelativeFilePath(r);let f;await this.github.hasFileTree(r)&&(f=await this.github.getFileTree(r));let p;if(f===void 0||f.loading||!f.hasEntireTree?p=await this.github.getFileList(r,d):p=(await f.getChildren(d,{filter:h.FileType.File,recursive:!0})).map(([g])=>g),p.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(p=[...nf(p,i,o)]),c=p.map(g=>Aa.prepareSlow(g)),this.fileSearchCache.set(s,c)}let u;return e.pattern===""?u=c.map(d=>h.Uri.joinPath(r,d.target)):(u=Aa.go(e.pattern.replace(dE,"/"),c,{allowTypo:!0,limit:n}).map(d=>h.Uri.joinPath(r,d.target)),Aa.cleanup()),n!==void 0&&n!==0&&n<u.length&&(u=u.slice(0,n)),u}async provideTextSearchResults(e,r,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(r.folder))try{return aE(this.providerService,this.changeStore,this.tarPit,e,r,n,i)}catch{o.push({text:tp("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:h.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:tp("flags not supported","Search flags are not supported by GitHub search. [Enable indexing]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:tp("enable index","Currently using GitHub text search. [Enable indexing]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Information,trusted:!0});const a=await this.github.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(a.warnings&&a.warnings.forEach(c=>{o.push({text:c,trusted:!0,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let s;for(const c of a.matches)s=h.Uri.joinPath(r.folder,c.path),n.report({uri:s,ranges:c.ranges,preview:{text:c.preview,matches:c.matches}});return{limitHit:!1,message:o}}}l(vc,"GitHubFS"),ep([en()],vc.prototype,"stat",1),ep([en()],vc.prototype,"readDirectory",1),ep([en()],vc.prototype,"readFile",1);var hE=__webpack_require__(6470),wc=__webpack_require__(4155);function yu(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof wc=="object"&&"version"in wc?`Node.js/${wc.version.substr(1)} (${wc.platform}; ${wc.arch})`:"<environment undetectable>"}l(yu,"getUserAgent");var fE=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function dy(t){return Object.prototype.toString.call(t)==="[object Object]"}l(dy,"isObject");function hy(t){var e,r;return dy(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(dy(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}l(hy,"isPlainObject");function pE(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}l(pE,"lowercaseKeys");function fy(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{hy(e[n])?n in t?r[n]=fy(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}l(fy,"mergeDeep");function py(t){for(const e in t)t[e]===void 0&&delete t[e];return t}l(py,"removeUndefinedProperties");function rp(t,e,r){if(typeof e=="string"){let[i,o]=e.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},e);r.headers=pE(r.headers),py(r),py(r.headers);const n=fy(t||{},r);return t&&t.mediaType.previews.length&&(n.mediaType.previews=t.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}l(rp,"dist_web_merge");function gE(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}l(gE,"addQueryParameters");const mE=/\{[^}]+\}/g;function vE(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}l(vE,"removeNonChars");function wE(t){const e=t.match(mE);return e?e.map(vE).reduce((r,n)=>r.concat(n),[]):[]}l(wE,"extractUrlVariableNames");function gy(t,e){return Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{})}l(gy,"omit");function my(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}l(my,"encodeReserved");function La(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}l(La,"encodeUnreserved");function yc(t,e,r){return e=t==="+"||t==="#"?my(e):La(e),r?La(r)+"="+e:e}l(yc,"encodeValue");function Oa(t){return t!=null}l(Oa,"isDefined");function np(t){return t===";"||t==="&"||t==="?"}l(np,"isKeyOperator");function yE(t,e,r,n){var i=t[r],o=[];if(Oa(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(yc(e,i,np(e)?r:""));else if(n==="*")Array.isArray(i)?i.filter(Oa).forEach(function(a){o.push(yc(e,a,np(e)?r:""))}):Object.keys(i).forEach(function(a){Oa(i[a])&&o.push(yc(e,i[a],a))});else{const a=[];Array.isArray(i)?i.filter(Oa).forEach(function(s){a.push(yc(e,s))}):Object.keys(i).forEach(function(s){Oa(i[s])&&(a.push(La(s)),a.push(yc(e,i[s].toString())))}),np(e)?o.push(La(r)+"="+a.join(",")):a.length!==0&&o.push(a.join(","))}else e===";"?Oa(i)&&o.push(La(r)):i===""&&(e==="&"||e==="?")?o.push(La(r)+"="):i===""&&o.push("");return o}l(yE,"getValues");function bE(t){return{expand:_E.bind(null,t)}}l(bE,"parseUrl");function _E(t,e){var r=["+","#",".","/",";","?","&"];return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let s="";const c=[];if(r.indexOf(i.charAt(0))!==-1&&(s=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(u){var d=/([^:\*]*)(?::(\d+)|(\*))?/.exec(u);c.push(yE(e,s,d[1],d[2]||d[3]))}),s&&s!=="+"){var a=",";return s==="?"?a="&":s!=="#"&&(a=s),(c.length!==0?s:"")+c.join(a)}else return c.join(",")}else return my(o)})}l(_E,"expand");function vy(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),i,o=gy(t,["method","baseUrl","url","headers","request","mediaType"]);const a=wE(r);r=bE(r).expand(o),/^http/.test(r)||(r=t.baseUrl+r);const s=Object.keys(t).filter(d=>a.includes(d)).concat("baseUrl"),c=gy(o,s);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(d=>d.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),t.mediaType.previews.length)){const d=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=d.concat(t.mediaType.previews).map(f=>{const p=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${f}-preview${p}`}).join(",")}return["GET","HEAD"].includes(e)?r=gE(r,c):"data"in c?i=c.data:Object.keys(c).length?i=c:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:r,headers:n},typeof i!="undefined"?{body:i}:null,t.request?{request:t.request}:null)}l(vy,"parse");function xE(t,e,r){return vy(rp(t,e,r))}l(xE,"endpointWithDefaults");function wy(t,e){const r=rp(t,e),n=xE.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:wy.bind(null,r),merge:rp.bind(null,r),parse:vy})}l(wy,"withDefaults");const SE=`octokit-endpoint.js/6.0.12 ${yu()}`,CE=wy(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":SE},mediaType:{format:"",previews:[]}});var EE=__webpack_require__(3672),RE=__webpack_require__.n(EE);class ip extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}l(ip,"Deprecation");var AE=__webpack_require__(447),yy=__webpack_require__.n(AE);const TE=yy()(t=>console.warn(t)),kE=yy()(t=>console.warn(t));class oi extends Error{constructor(e,r,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return TE(new ip("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),Object.defineProperty(this,"headers",{get(){return kE(new ip("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}l(oi,"RequestError");const IE="5.6.1";function DE(t){return t.arrayBuffer()}l(DE,"getBufferResponse");function by(t){const e=t.request&&t.request.log?t.request.log:console;(hy(t.body)||Array.isArray(t.body))&&(t.body=JSON.stringify(t.body));let r={},n,i;return(t.request&&t.request.fetch||RE())(t.url,Object.assign({method:t.method,body:t.body,headers:t.headers,redirect:t.redirect},t.request)).then(async a=>{i=a.url,n=a.status;for(const s of a.headers)r[s[0]]=s[1];if("deprecation"in r){const s=r.link&&r.link.match(/<([^>]+)>; rel="deprecation"/),c=s&&s.pop();e.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${r.sunset}${c?`. See ${c}`:""}`)}if(!(n===204||n===205)){if(t.method==="HEAD"){if(n<400)return;throw new oi(a.statusText,n,{response:{url:i,status:n,headers:r,data:void 0},request:t})}if(n===304)throw new oi("Not modified",n,{response:{url:i,status:n,headers:r,data:await op(a)},request:t});if(n>=400){const s=await op(a);throw new oi(FE(s),n,{response:{url:i,status:n,headers:r,data:s},request:t})}return op(a)}}).then(a=>({status:n,url:i,headers:r,data:a})).catch(a=>{throw a instanceof oi?a:new oi(a.message,500,{request:t})})}l(by,"fetchWrapper");async function op(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json():!e||/^text\/|charset=utf-8$/.test(e)?t.text():DE(t)}l(op,"getResponseData");function FE(t){return typeof t=="string"?t:"message"in t?Array.isArray(t.errors)?`${t.message}: ${t.errors.map(JSON.stringify).join(", ")}`:t.message:`Unknown error: ${JSON.stringify(t)}`}l(FE,"toErrorMessage");function ap(t,e){const r=t.defaults(e);return Object.assign(l(function(i,o){const a=r.merge(i,o);if(!a.request||!a.request.hook)return by(r.parse(a));const s=l((c,u)=>by(r.parse(r.merge(c,u))),"request");return Object.assign(s,{endpoint:r,defaults:ap.bind(null,r)}),a.request.hook(s,a)},"newApi"),{endpoint:r,defaults:ap.bind(null,r)})}l(ap,"dist_web_withDefaults");const bu=ap(CE,{headers:{"user-agent":`octokit-request.js/${IE} ${yu()}`}}),PE="4.8.0";function NE(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}l(NE,"_buildMessageForResponseErrors");class Ha extends Error{constructor(e,r,n){super(NE(n));this.request=e,this.headers=r,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}l(Ha,"GraphqlResponseError");const $E=["method","baseUrl","url","headers","request","query","mediaType"],ME=["query","method","url"],_y=/\/api\/v3\/?$/;function BE(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const a in r)if(!!ME.includes(a))return Promise.reject(new Error(`[@octokit/graphql] "${a}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,i=Object.keys(n).reduce((a,s)=>$E.includes(s)?(a[s]=n[s],a):(a.variables||(a.variables={}),a.variables[s]=n[s],a),{}),o=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return _y.test(o)&&(i.url=o.replace(_y,"/api/graphql")),t(i).then(a=>{if(a.data.errors){const s={};for(const c of Object.keys(a.headers))s[c]=a.headers[c];throw new Ha(i,s,a.data)}return a.data.data})}l(BE,"graphql");function sp(t,e){const r=t.defaults(e);return Object.assign(l((i,o)=>BE(r,i,o),"newApi"),{defaults:sp.bind(null,r),endpoint:bu.endpoint})}l(sp,"graphql_dist_web_withDefaults");const jR=sp(bu,{headers:{"user-agent":`octokit-graphql.js/${PE} ${yu()}`},method:"POST",url:"/graphql"});function UE(t){return sp(t,{method:"POST",url:"/graphql"})}l(UE,"withCustomRequest");const LE=/^v1\./,OE=/^ghs_/,HE=/^ghu_/;async function WE(t){const e=t.split(/\./).length===3,r=LE.test(t)||OE.test(t),n=HE.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}l(WE,"auth");function zE(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}l(zE,"withAuthorizationPrefix");async function qE(t,e,r,n){const i=e.endpoint.merge(r,n);return i.headers.authorization=zE(t),e(i)}l(qE,"hook");const jE=l(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(WE.bind(null,e),{hook:qE.bind(null,e)})},"createTokenAuth"),xy="3.5.1";class bc{constructor(e={}){const r=new fE.Collection,n={baseUrl:bu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${xy} ${yu()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=bu.defaults(n),this.graphql=UE(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=r,e.authStrategy){const{authStrategy:o,...a}=e,s=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:a},e.auth));r.wrap("request",s.hook),this.auth=s}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=jE(e.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return l(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var r;const n=this.plugins;return r=l(class extends this{},"_a"),r.plugins=n.concat(e.filter(o=>!n.includes(o))),r}}l(bc,"Octokit"),bc.VERSION=xy,bc.plugins=[];function VE(t,e){return t.reduce((n,i)=>{const o=e(i),a=n.get(o);return a===void 0?n.set(o,[i]):a.push(i),n},new Map)}l(VE,"groupBy");function GE(t){let e=0;for(const r of t){if(r===0)return!0;if(e++,e>8e3)break}return!1}l(GE,"isBinary");function cp(t,e,r=n=>n){return[...t.reduce((i,o)=>{const a=e(o),s=i.get(a);if(s===void 0)i.set(a,o);else{const c=r(s,o);c!==void 0&&i.set(a,c)}return i},new Map).values()]}l(cp,"uniqueBy");function lp(t){const e="$memoize$";return function(...r){return this.hasOwnProperty(e)||Object.defineProperty(this,e,{configurable:!1,enumerable:!1,writable:!1,value:t.apply(this,r)}),this[e]}}l(lp,"memoize");class up{constructor(e,r){this.path=e,this.relativePath=r}}l(up,"TrieNode");class Sy{constructor(){this.root=new up("","")}get(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const a=(r=n.children)==null?void 0:r.get(o);if(a===void 0)return i;n=a}if(n.children!==void 0){let o=l(function(a,s,c){for(const u of a.values()){const d=`${s?`${s}/`:""}${u.relativePath}`;u.data&&c.push([d,u.data]),u.children!==void 0&&o(u.children,d,c)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,r){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const a of e.split("/")){let s=(n=i.children)==null?void 0:n.get(a);o=`${o?`${o}/`:""}${a}`,s===void 0&&(i.children===void 0&&(i.children=new Map),s=new up(o,a),i.children.set(a,s)),i=s}i.data=r}}l(Sy,"Trie");class dp{constructor(e,r,n,i,o){if(this.rootUri=e,this.sha=r,this.timestamp=n,this.provider=i,this.trie=new Sy,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const a=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&a.push(i.onDidTriggerContentCaching(s=>{(!s||W(s.rootUri)===W(this.rootUri)&&s.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(c=>this._isContentCached=c,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(s=>(this._hasEntireTree=(s==null?void 0:s.success)?s.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var c;return void((c=i.tryCachingContent)==null?void 0:c.call(i,this.trie.get.bind(this.trie)).then(u=>this._isContentCached=u,()=>this._isContentCached=!0))},0),bx("_codespaces.webeditor.connectWorkspace",{result:(s==null?void 0:s.success)?"Success":"Failure",errorMessage:this._hasEntireTree?"":"Unable to load entire tree",errorDetail:(s==null?void 0:s.success)===!1?s.error:void 0}),this._loading=void 0,this.preloading=void 0,this.treeSha=(s==null?void 0:s.success)?s.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=h.Disposable.from(...a)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var r;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:h.FileType.Directory,size:0,ctime:0,mtime:(r=this.timestamp)!=null?r:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,r){await this.ensureLoaded(e,!0);const n=(r==null?void 0:r.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(r==null?void 0:r.filter)===void 0?n:n.filter(([,i])=>i.stat.type===r.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,r=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(r)i=this.preloading.get(e);else{const o=Z(this.preloading,([a])=>e.startsWith(a)&&e.lastIndexOf("/")===(a?a.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return r&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),r&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,r=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new Be(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const a=await this.provider.getTree(e,r);if(a.truncated){E.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${a.sha};`,suffix:" \u2022 Fixing directories..."});for(const[c,u]of this.trie.getDescendants(""))u.stat.type===h.FileType.Directory&&(u.loadChildren=lp(()=>this.load(c).then(()=>u.loadChildren=void 0)));return o=` \u2022 Tree=${a.sha} \u2022 Truncated`,{sha:a.sha,recursive:!1,success:!0}}let s;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${a.sha};`,suffix:" \u2022 Waiting for permissions..."}),s=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:c,item:u}of a.tree)if(c!==void 0){switch(c=e?`${e}/${c}`:c,u.stat.permissions=s,u.stat.type){case h.FileType.File:u.getContent=lp(()=>this.provider.getContent(u));break;case h.FileType.Directory:r||(u.loadChildren=lp(()=>this.load(c).then(()=>u.loadChildren=void 0)));break}this.trie.set(c,u)}return o=` \u2022 Tree=${a.sha}`,{sha:a.sha,recursive:r,success:!0}}catch(a){return o=`\u2022 Loading for path=${e} failed; ${String(a)}`,{error:a,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}l(dp,"FileTree");var KE=__webpack_require__(7769);const QE="github-pr-owner-number";function ZE(t){return`branch.${t}.${QE}`}l(ZE,"getMetadataKeyForBranch");const XE=(0,O.loadMessageBundle)(),Cy=new TextDecoder;class Ey{constructor(e,r,n,i,o,a){this.providerService=e,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=a,this._onDidChangeSelection=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._objects=new Map,this.disposable=h.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(u=>{const d=W(this.rootUri);!u.some(f=>W(f)===d)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:u})=>{W(this.rootUri)===W(u.uri)&&this.updateState(await u.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(u){n.inputBox.value=u}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:s,name:c}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${s}/${c}.git`,isReadOnly:i.accessLevel<De.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case _e.Branch:return{type:Kn.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case _e.RemoteBranch:{const r=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<De.Write,i=this.remotes.findIndex(o=>o.name===r);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:r,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:Kn.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case _e.Tag:return{type:Kn.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case _e.Commit:return{type:Kn.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const r=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:s=>s.fileType===h.FileType.File}),n=r.conflicts.map(s=>({uri:s.uri,status:hp(s.type),originalUri:s.uri,renameUri:s.uri})),i=r.staged.map(s=>({uri:s.uri,status:hp(s.type),originalUri:s.uri,renameUri:s.uri})),o=r.working.map(s=>({uri:s.uri,status:hp(s.type),originalUri:s.uri,renameUri:s.uri})),a=j.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:a?i:[],workingTreeChanges:a?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===ZE(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,r){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,r){const n=new Be(`IGit.getObjectDetails(${e}, ${r})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async detectObjectType(e){var r;const n=new Be(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!GE(i))return{mimetype:"text/plain"};const a=await(0,KE.fromBuffer)(i);return{mimetype:(r=a==null?void 0:a.mime)!=null?r:"application/octet-stream"}}finally{n.stop()}}async buffer(e,r){const n=new Be(`IGit.buffer(${e}, ${r})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async show(e,r){const n=new Be(`IGit.show(${e}, ${r})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r));return Cy.decode(i)}finally{n.stop()}}async getCommit(e){const r=new Be(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{r.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,r){const n=new Be(`IGit.apply(reverse=${r})`);try{return await this.changeStore.applyPatch(this.rootUri,e,r?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const r=new Be(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{r.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,r){return r?this.diffBetween("",e,r):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,r){return r?this.diffBetween("~",e,r):this.diffBetween("~",e)}async diffBetween(e,r,n){if(!n)throw new Error("Method not implemented.");const i=new Be(`IGit.diffBetween(${e}, ${r}, ${n})`);try{const[o,a]=await Promise.all([this.getContent(e,n),this.getContent(r,n)]);return Ju(n,o,a)}finally{i.stop()}}async diffBlobs(e,r){const n=new Be(`IGit.diffBlobs(${e}, ${r})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(r),a=Ju("untitled",i,o);return Promise.resolve(a)}finally{n.stop()}}async getBlobContent(e){const r=new Be(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return Cy.decode(o)}finally{r.stop()}}async getContent(e,r){const n=new Be(`IGit.getContent(${e}, ${r})`);try{const i=this.pathToRelativeUri(r);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,r)}finally{n.stop()}}async hashObject(e){const r=new Be("IGit.hashObject");try{const n=Ja(await so(e));return this._objects.set(n,e),n}finally{r.stop()}}async createBranch(e,r,n){const i=new Be(`IGit.createBranch(${e}, ${r}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);r&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,r){throw new Error("Method not implemented.")}async getBranch(e){const r=new Be(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:i.commitUrl}}}finally{r.stop()}}async getBranches(e){var r,n;const i=(n=(r=e.contains)!=null?r:e.pattern)!=null?n:"",o=new Be(`IGit.getBranches(${i})`);try{const{branches:a}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(a.length===0)throw new Error(`Unable to find branches for "${i}"`);return a.map(s=>({type:s.type,name:s.name,commit:s.commit}))}finally{o.stop()}}setBranchUpstream(e,r){throw new Error("Method not implemented.")}getMergeBase(e,r){throw new Error("Method not implemented.")}async status(){}async checkout(e){const r=new Be(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await dn(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:a}=this.providerService.getVirtualUriMetadata(this.rootUri),s=this.providerService.getRemoteUri(o.id,{repo:a,pullRequest:{id:i}});if(s!==void 0){const c=await this.providerService.createWorkspaceForRemoteUrl(s.toString());c!==void 0&&await dn(c)}}throw new Error("User aborted")}finally{r.stop()}}addRemote(e,r){var n;let i;const o=this.remotes.findIndex(a=>a.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const r=this.remotes.findIndex(n=>n.name===e);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(e,r){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(e,r,n){const i=new Be("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const r=new Be("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:cr.Merge})}finally{r.stop()}}push(e,r,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,r){const n=new Be("IGit.commit");try{if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(r==null?void 0:r.all)===!1})).filter(o=>o.fileType===h.FileType.File);if(!i.length){h.window.showInformationMessage(XE("no changes to commit","There are no changes to commit."));return}if(j.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return Ve(this.rootUri,eR(e))}}l(Ey,"GitHubRepository");const YE=/^\/?([a-zA-Z])(?::\/)(.*)$/,JE=/\\/g;function eR(t){t=h.Uri.file(t).fsPath.replace(JE,"/");const e=YE.exec(t);return e!==null&&([,,t]=e),t.startsWith("/")?t:`/${t}`}l(eR,"normalizePath");function hp(t){switch(t){case ht.Changed:return Ws.MODIFIED;case ht.Created:return Ws.INTENT_TO_ADD;case ht.Deleted:return Ws.DELETED}}l(hp,"opTypeToStatus");var tR=Object.defineProperty,rR=Object.getOwnPropertyDescriptor,Ry=l((t,e,r,n)=>{for(var i=n>1?void 0:n?rR(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&tR(e,r,i),i},"github_provider_decorateClass");const Wa=(0,O.loadMessageBundle)(),Ay=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,Ty=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,_u=["repo","workflow"],xu=1,ky=Object.freeze({id:"github",name:"GitHub"});function za(t){const{scheme:e,metadata:r}=Pt.decodeAuthority(t,a=>{if(a.v!==void 0)return a;if(typeof a.pr=="string")return{v:xu,ref:{type:Ue.PullRequest,id:a.pr},idx:a.idx};if(typeof a.ref=="string")return{v:xu,ref:{type:Ue.Tree,id:a.ref},idx:a.idx}}),[,n,i,...o]=t.path.split("/");return{scheme:e,provider:ky,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}l(za,"getGitHubMetadata");function nR(t,e){const{repo:r}=e!=null?e:za(t);return t.with({path:`/${r.owner}/${r.name}`,query:"",fragment:""})}l(nR,"getGitHubRootUri");function fp(t,e,r){const{repo:{owner:n,name:i}}=t instanceof h.Uri?za(t):t;return h.Uri.parse(`github://${Pt.encodeAuthority("github",{v:xu,ref:{type:Ue.Commit,id:e}})}/${n}/${i}/${r}`)}l(fp,"getGitHubRevisionUri");class Su{constructor(e,r){this.providerService=e,this.tarPit=r,this.fileTreeCache=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),kn&&(this.tarballProxyEndpoint=h.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"]))}get isReadonly(){return!1}get scheme(){return"github"}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>Pt.getProviderId(r)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(r=>r.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const r=new Be("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await h.authentication.getSession("github",_u,{forceNewSession:e}):await h.authentication.getSession("github",_u,{createIfNone:!0})}catch(o){E.error(o);try{const a=await h.authentication.getSession("github",_u,{createIfNone:!1});if(a!==void 0)return a}catch{}return new Promise(a=>{async function s(){const u=await h.authentication.getSession("github",_u,{createIfNone:!0});u!==void 0&&a(u)}l(s,"getSession");const c=h.authentication.onDidChangeSessions(async u=>{u.provider.id==="github"&&(c.dispose(),await s())})})}}l(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:ky,session:r,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${r.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if(kn){async function i(o,a){if(a.headers!==void 0){const{"user-agent":s,...c}=a.headers;s&&(a.headers=c)}return Gn(o,a)}l(i,"fetchCore"),this._octokitDefaults=bc.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=bc.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(e);return(E.logLevel===me.Debug||E.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const a=new Be(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let s;try{if(typeof i.query=="string"){const c=/(^[^({\n]+)/.exec(i.query);s=` ${(o=c==null?void 0:c[1].trim())!=null?o:i.query}`}}catch{}a.stop({message:s})}}),r}async graphql(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,r)}catch(n){throw this.handleRequestErrors(n),n}}async request(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,r)}catch(n){throw this.handleRequestErrors(n),n}}handleRequestErrors(e){var r,n;if(e instanceof oi)switch(e.status){case 500:return e.response&&$r.showGitHubStatus500Message(),!0;case 401:return $r.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return $r.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof Ha&&((n=(r=e.errors)==null?void 0:r[0])==null?void 0:n.type)==="FORBIDDEN")return $r.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,r,n,i){return new Ey(this.providerService,e,r,n,i,this)}async createMetadata(e,r){var n,i,o,a,s,c;const u=new Be(`GitHub.createMetadata(${e.toString()}, ${r})`);let d;try{let{provider:f,name:p,repo:{owner:g,name:_},ref:v}=za(e);(!v||v.type===Ue.Commit&&/HEAD/i.test(v.id))&&(v={type:Ue.Commit,id:"HEAD"});const y=this.providerService.isInWorkspace(e);let x,C;j.get("experimental.prefetch")&&y&&(r?x=r:(v.type===Ue.Commit||v.type===Ue.Tree)&&(x=v.id),x&&(u.log({suffix:` \u2022 Prefetching tree for ${x}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(re=>C=re),repo:{owner:g,name:_},HEAD:{sha:x},timestamp:Date.now()}})));const k=await this.getRepositoryInfo(g,_,y,v.type===Ue.PullRequest?{pr:Number(v.id)}:{ref:v.id});if(k===void 0)throw d=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let I;if(r)I=r;else if(v.type===Ue.Commit||v.type===Ue.Tree&&k.ref===void 0)I=v.id;else if(I=(i=(n=k.ref)==null?void 0:n.sha)!=null?i:k.defaultBranch.sha,I===void 0)throw d=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let B;if(((o=k.ref)==null?void 0:o.prefix)==="refs/heads/")B={type:_e.Branch,name:k.ref.name,sha:I,branch:{name:k.ref.name,sha:k.ref.sha}};else if(((a=k.ref)==null?void 0:a.prefix)==="refs/remotes/"){if(!k.ref.remote)throw d=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);B={type:_e.RemoteBranch,name:`${k.ref.remote.repo.owner}${k.ref.remote.repo.name!==_?`/${k.ref.remote.repo.name}`:""}:${k.ref.name}`,sha:I,branch:{name:k.ref.name,sha:k.ref.sha,remote:k.ref.remote}}}else((s=k.ref)==null?void 0:s.prefix)==="refs/tags/"?B={type:_e.Tag,name:k.ref.name,sha:I,detached:{type:_e.Tag,name:k.ref.name}}:B={type:_e.Commit,name:wt(I),sha:I,detached:{type:_e.Commit,name:wt(I)}};if(x!==void 0&&x!==B.sha){const re=this.asFileTreeKey(e,x),K=this.fileTreeCache.get(re);K&&!Gt(x)&&B.sha===((c=B.branch)==null?void 0:c.sha)?(u.log({suffix:` \u2022 Updating prefetched tree for ${x}, since HEAD was resolved; HEAD=${B.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,B.sha),K),this.fileTreeCache.delete(re)):(u.log({suffix:` \u2022 Removing prefetched tree for ${x}, since the HEAD changed; HEAD=${B.sha}`}),this.fileTreeCache.delete(re),K==null||K.dispose())}const J={version:$e.schemaVersion,timestamp:Date.now(),provider:f,name:p,repo:k.repo,user:k.user,accessLevel:k.accessLevel,HEAD:B,defaultBranch:k.defaultBranch,pullRequest:k.pullRequest};return d=` \u2022 HEAD=${B.sha}`,C==null||C(J),J}finally{u.stop(d?{suffix:d}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:Wa("open repo from","Open Repository from {0}","GitHub"),placeholder:Wa("pick repo","Choose a repository"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchRepositoriesQuery(n,{...i,user:o})).map(c=>({providerId:"github",name:c.repoWithOwner,icon:"$(repo)",description:`${c.fork?`$(repo-forked) ${c.fork}`:""}${c.stars>0?`${c.fork?" \u2022 ":""}$(star-full) ${c.stars}`:""}`,detail:c.description,url:c.url}))}},{name:"GitHub",icon:"$(github)",label:Wa("open pr from","Open Pull Request from {0}","GitHub"),placeholder:Wa("pick pr","Choose a pull request"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");return a!==-1&&(o=n.substring(0,a),n=n.substr(a+1)),(await this.searchPullRequestsQuery(n,{user:o})).map(c=>({providerId:"azurerepos",name:c.title,icon:"$(git-pull-request)",description:c.reasons.length!==0?c.reasons.sort().join(", "):void 0,detail:`${c.repoWithOwner} #${c.number}`,url:c.url}))}}]}canOpenRemoteUrl(e){const r=Ay.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:a}=r.groups;return o?at.PullRequest:i?at.Commit:a?at.Branch:n?at.File:at.Repository}async createWorkspaceForRemoteUrl(e,r=Bt.CurrentWindow){const n=Ay.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:a,commit:s,pull:c,tree:u,fragment:d}=n.groups;const f=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,u!=null?u:a);if(f===void 0)return;let p,g;if({owner:i,repo:o,ref:g,path:p}=f,u||a){if(p&&d&&a){const y=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(d);if(y==null?void 0:y.groups){const{start:x,end:C}=y.groups;p+=`:${x}${C!==void 0?`-${C}`:""}`}}}else s?g={type:Ue.Commit,id:s}:c&&(g={type:Ue.PullRequest,id:c});const _=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:g});return{name:(await this.getMetadata(_)).name,uri:_,location:r,filesToOpen:p?[p]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){const a=n!==void 0||i!==void 0?{v:xu}:void 0;return a&&(n&&(a.ref={...n,type:n.type===Ue.Branch||n.type===Ue.Tag?Ue.Tree:n.type}),i&&(a.idx=i)),e.with({authority:Pt.encodeAuthority("github",a),path:`/${r.owner}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const r=`https://github.com/${e.repo.owner}/${e.repo.name}`,n=e.path?"blob":"tree",i=e.path?`/${e.path}`:"";return e.clone?h.Uri.parse(`${r}.git`):e.pullRequest?h.Uri.parse(`${r}/pull/${e.pullRequest.id}`):e.branch?h.Uri.parse(`${r}/${n}/${e.branch}${i}`):e.tag?h.Uri.parse(`${r}/${n}/${e.tag}${i}`):e.sha?h.Uri.parse(`${r}/${n}/${e.sha}${i}`):h.Uri.parse(r)}getProviderRootUri(e){return nR(e)}getRelativeFilePath(e,r){const{path:n}=za(e),{path:i}=za(Ve(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=za(e);return{provider:r,name:n,repo:i,ref:o}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case _e.Branch:return i!==void 0?q.PullRequestBranch:q.Branch;case _e.RemoteBranch:return i!==void 0?q.PullRequestRemoteBranch:q.RemoteBranch;case _e.Tag:return q.Tag;case _e.Commit:return q.Commit}}async createBranch(e,r,n,i){try{const{repo:{owner:o,name:a}}=i!=null?i:await this.getMetadata(e);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:a,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof oi&&o.status===422?o.message==="Reference already exists"?new de(o,!0):new de(o,!1):(E.error(o),o)}}async createAndPushCommit(e,r,n,i,o){var a;const s=new Be(`GitHub.createAndPushCommit(${e.toString()}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);if(n=n.filter(u=>u.fileType===h.FileType.File),n.length===0)throw s.stop({message:"Aborted; No changes to commit"}),new rt("No changes to commit");let c;try{const u=await this.getMetadata(e);let d;if(i!==void 0)d=i;else{if(u.HEAD.detached&&!u.HEAD.branch)throw new he("Unable to commit; no current branch");d=u.HEAD.branch.name}let f;if(o)f=`${o.repo.owner}/${o.repo.name}`;else if(u.HEAD.type===_e.RemoteBranch&&u.HEAD.branch.remote.accessLevel>=De.Write){const{owner:x,name:C}=u.HEAD.branch.remote.repo;f=`${x}/${C}`}else f=`${u.repo.owner}/${u.repo.name}`;const p=[],g=[];for(const x of n)switch(x.type){case ht.Created:case ht.Changed:p.push({path:x.path,contents:zo(await x.content)});break;case ht.Deleted:g.push({path:x.path});break}const _={branch:{branchName:d,repositoryNameWithOwner:f},message:{headline:r},fileChanges:{additions:p,deletions:g},expectedHeadOid:u.HEAD.sha},v=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,y=await this.graphql(v,{commitInput:_});if(c=y==null?void 0:y.createCommitOnBranch.commit.oid,!c)throw new Et;return i===void 0&&!u.HEAD.detached&&c!==void 0&&await this.fastForwardTo(e,c,u),c}catch(u){if(u instanceof Ha){const d=(a=u.errors)==null?void 0:a[0];if((d==null?void 0:d.type)==="STALE_DATA"&&d.message.includes("Pull and try again"))throw new qe(u)}throw E.error(u),u}finally{s.stop(c?{message:`: Created and pushed commit ${c}`}:void 0)}}async createCommit(e,r,n,i){const o=new Be(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(s=>s.fileType===h.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),new rt("No changes to commit");let a;try{const s=await this.getMetadata(e);let c,u,d;i?({repo:{owner:c,name:u}}=i,d=await this.getFileTree(this.createVirtualUri(e,i),s.HEAD.sha)):s.HEAD.type===_e.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=De.Write?({owner:c,name:u}=s.HEAD.branch.remote.accessLevel===De.WriteToPullRequest?s.repo:s.HEAD.branch.remote.repo,d=await this.getFileTree(this.createVirtualUri(e,{repo:s.HEAD.branch.remote.repo}),s.HEAD.sha)):({repo:{owner:c,name:u}}=s,d=await this.getFileTree(e,s.HEAD.sha));const f=await d.getTreeSha();if(!Gt(f))throw new Error(`Unable to create commit based on tree sha ${f}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${s.HEAD.sha} based on tree ${f}`,suffix:" \u2022 Creating blobs..."});const p=[];async function g(x){var C;try{const k=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:c,repo:u,encoding:"base64",content:zo(await x.content),mediaType:{format:"raw"}});let I;if(x.type===ht.Changed){const B=await d.get(x.path);I=(C=B==null?void 0:B.mode)!=null?C:"100644"}else I="100644";p.push({path:x.path,mode:I,type:"blob",sha:k.data.sha})}catch(k){throw E.error(k,`Failed to create blob for ${x.path}`),k}}l(g,"createOrUpdateBlob");const _=[];for(const x of n)switch(x.type){case ht.Created:case ht.Changed:{_.push(g.call(this,x));break}case ht.Deleted:{p.push({path:x.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all(_),o.logStep("Creating tree",{message:`: Created ${_.length} blobs;`,suffix:` \u2022 Creating tree based on ${f}...`});const v=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:c,repo:u,base_tree:f,tree:p});return o.logStep("Creating commit",{message:`: Created tree ${v.data.sha};`,suffix:" \u2022 Creating commit..."}),a=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:c,repo:u,message:r,tree:v.data.sha,parents:[s.HEAD.sha]})).data.sha,a}catch(s){throw E.error(s),s}finally{o.stop(a?{message:`: Created commit ${a}`}:void 0)}}async createPullRequest(e,r,n,i,o){var a,s,c;const u=new Be(`GitHub.createPullRequest(${e.toString()}, ${r}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:d,name:f},HEAD:{branch:p},defaultBranch:g}=await this.getMetadata(e),_=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:d,repo:f,base:`refs/heads/${(a=p==null?void 0:p.name)!=null?a:g.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(s=i==null?void 0:i.draft)!=null?s:!1,maintainer_can_modify:(c=i==null?void 0:i.canMaintainerModify)!=null?c:!0});return{id:_.data.number.toString(),uri:h.Uri.parse(_.data.html_url)}}catch(d){throw E.error(d),d}finally{u.stop()}}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,a,s,c,u,d,f,p;const{force:g,to:_}={...n,force:r||(n==null?void 0:n.force)},v=new Be(`GitHub.fetch(${e.toString()}, force=${g}, to=${_})`);let y;try{const x=await this.getMetadata(e);if(x.HEAD.detached)return y=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:x};const C=await this.getBranchTips(e);if(!C)throw y=" \u2022 Unable to fetch branch tips",new pt(r);if(!g&&!_&&((i=C.defaultBranch)==null?void 0:i.sha)!==void 0&&C.defaultBranch.sha===x.defaultBranch.sha&&((o=C.branch)==null?void 0:o.sha)!==void 0&&C.branch.sha===x.HEAD.branch.sha&&(x.HEAD.sha===x.HEAD.branch.sha||x.state!==void 0))return y=" \u2022 No changes detected",{fetched:!1,metadata:x};let k;if(((a=C.defaultBranch)==null?void 0:a.sha)!==void 0&&C.defaultBranch.sha!==x.defaultBranch.sha&&(k={defaultBranch:{...x.defaultBranch,sha:C.defaultBranch.sha}}),((s=C.branch)==null?void 0:s.sha)===void 0){if(y=" \u2022 Unable to find branch tip",g)throw new pt(r);return k!==void 0?{fetched:!0,metadata:{...x,...k}}:{fetched:!1,metadata:x}}if(C.branch.sha!==x.HEAD.branch.sha&&(k={...k,HEAD:{...x.HEAD,branch:{...x.HEAD.branch,sha:C.branch.sha},detached:void 0}}),C.branch.sha===((c=n==null?void 0:n.to)!=null?c:x.HEAD.sha))return y=" \u2022 Up to date",x.state!==void 0||k!==void 0?{fetched:!0,metadata:{...x,...k,state:void 0}}:{fetched:!1,metadata:x};v.logStep("Fetching upstream changes");try{const I=await this.getAheadBehindState(e,x,{base:(u=n==null?void 0:n.to)!=null?u:x.HEAD.sha,head:(p=(f=(d=k==null?void 0:k.HEAD)==null?void 0:d.branch)==null?void 0:f.sha)!=null?p:x.HEAD.branch.sha});return y=` \u2022 Changes detected; ${I==null?void 0:I.behind} commits behind`,{fetched:!0,metadata:{...x,...k,state:I?{ahead:I.ahead,behind:I.behind,incomingChanges:I.incomingChanges}:void 0}}}catch(I){if(y=` \u2022 Failed fetching upstream changes; ${String(I)}`,g)throw new pt(r);return k!==void 0?{fetched:!0,metadata:{...x,...k}}:{fetched:!1,metadata:x}}}finally{v.stop(y?{suffix:y}:void 0)}}async fork(e){try{const{repo:{owner:r,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(a=>setTimeout(a,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw E.error(r),r}}async getBranches(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),c=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,u=await this.graphql(c,{owner:a,repo:s,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{branches:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{branches:[]};const f=d.nodes.map(p=>({type:Kn.Head,name:p.name,commit:p.target.oid,commitUrl:p.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},branches:f}}catch(a){return{branches:[]}}}async getCommit(e,r){var n;try{const{HEAD:i,repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const c=await this.graphql(s,{owner:o,repo:a,ref:r});if(c===void 0)return;const u=(n=c.repository)==null?void 0:n.object;return u===void 0?void 0:{hash:u.oid,message:u.message,parents:u.parents.nodes.map(d=>d.oid),authorDate:new Date(u.author.date),authorEmail:u.author.email,authorName:u.author.name,commitDate:new Date(u.committer.date)}}catch(i){return}}async getCommits(e,r){var n,i,o;try{const{HEAD:a,repo:{owner:s,name:c}}=await this.getMetadata(e),u=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let d=r==null?void 0:r.ref;(d==null?void 0:d.toUpperCase())==="HEAD"&&(d=a.sha);const f=await this.graphql(u,{owner:s,repo:c,ref:d,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(f===void 0)return;const p=(o=(i=f.repository)==null?void 0:i.object)==null?void 0:o.history;if(p===void 0)return;const g=p.nodes.map(_=>({hash:_.oid,message:_.message,parents:_.parents.nodes.map(v=>v.oid),authorDate:new Date(_.author.date),authorEmail:_.author.email,authorName:_.author.name,commitDate:new Date(_.committer.date)}));return{paging:{cursor:p.pageInfo.endCursor,more:p.pageInfo.hasNextPage},commits:g}}catch(a){return}}async getBlobContent(e,r){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:r});return Ya(n.data.content)}catch(n){throw E.logLevel===me.Debug&&E.error(n),n}}async getFileContent(e,r,n){try{let i;if(r&&n&&!this.hasFileTree(e,r)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let a=(0,hE.dirname)(n);(a==="."||a==="/")&&(a=""),i=await(await this.getFileTree(o,r,{path:a,cache:!1,recursive:!1})).get(n)}else{const[o,{path:a}]=await Promise.all([this.getFileTree(e,r),n?{path:void 0}:this.providerService.getMetadata(e)]);i=await o.get(n!=null?n:a)}if((i==null?void 0:i.sha)===void 0)throw h.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw E.logLevel===me.Debug&&E.error(i),i}}async getFileList(e,r,n){const i=new Be(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:a},HEAD:{sha:s}}=await this.getMetadata(e),c=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:a,treeish:`${n!=null?n:s}${r?`:${r}`:""}`});return c.status!==200?[]:c.data}catch(o){return E.error(o),[]}finally{i.stop()}}hasFileTree(e,r){return r?this.fileTreeCache.has(this.asFileTreeKey(e,r)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,r,n){var i,o,a,s,c;const u=this.providerService.isInWorkspace(e);let d=(i=n==null?void 0:n.cache)!=null?i:u,f,p,g;if(d||!r){const x=(a=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?a:this.getMetadata(e);f=u?this.getFileTreePermissions(e,x):void 0;let C;({repo:p,HEAD:{sha:C},timestamp:g}=(s=n==null?void 0:n.prefetched)!=null?s:await x),r&&C!==r?(d=!1,g=Date.now()):r=C}else({repo:p}=(c=n==null?void 0:n.prefetched)!=null?c:this.providerService.getVirtualUriMetadata(e)),g=Date.now();const _=this.asFileTreeKey(e,r),v=this.providerService.getProviderRootUri(e),y=new Be(`GitHub.getFileTree(${_}): ${e.toString()}`,{log:!1,logLevel:me.Debug});try{let x=l(function(){var k;const I=new Be(`GitHub.createFileTree(${_})`);let B,J;d&&u&&(B=new h.EventEmitter,J=h.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>B.fire()),this.tarPit.onDidDownloadTar(K=>B.fire({rootUri:this.providerService.getProviderRootUri(K.rootUri),sha:K.sha}))));const re={dispose:()=>J==null?void 0:J.dispose(),permissions:f,getContent:K=>this.getBlobContent(p,K.sha),getTree:async(K,we)=>{const ie=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:p.owner,repo:p.name,recursive:we?"1":void 0,tree_sha:`${r}${K?`:${K}`:""}`});return ie.data.truncated?{sha:ie.data.sha,truncated:!0}:{sha:ie.data.sha,truncated:!1,tree:ye(ie.data.tree,pe=>{var Se;return{path:pe.path,item:{mode:pe.mode,sha:pe.sha,stat:{type:oR(pe.type),size:(Se=pe.size)!=null?Se:0,ctime:0,mtime:g,permissions:void 0}}}})}},onDidTriggerContentCaching:B==null?void 0:B.event,tryCachingContent:d&&u?async K=>{const we=j.get("experimental.fs.useTars");if(we!=="always"&&we!=="ifAvailable")return!1;const ie=new Be(`FileTree.loadAllContent(${r})`);let pe;try{let Se;if(we==="ifAvailable"){if(ie.logStep("Tar cache query"),Se=await this.tarPit.getCachedTar(v,r),Se===void 0)return pe=" \u2022 No cached Tar",!1}else ie.logStep("Tar query"),Se=await this.tarPit.getTar(v,r);ie.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const Je of Se.entries){const ae=K(Je.header.fullFileName);if(ae===void 0)continue;const Ae=Je.dataAsBytes;ae.getContent=()=>Ae}return!0}catch(Se){return pe=` \u2022 Failed ${String(Se)}`,!1}finally{ie.stop(pe?{suffix:pe}:void 0)}}:void 0};try{return new dp(v,r,g,re,{path:n==null?void 0:n.path,recursive:(k=n==null?void 0:n.recursive)!=null?k:d,preload:d||(n==null?void 0:n.recursive)})}catch(K){return E.error(K),new dp(v,r,g,void 0)}finally{I.stop()}},"createFileTree"),C=this.fileTreeCache.get(_);return C!==void 0||(C=x.call(this),d&&this.fileTreeCache.set(_,C)),C}finally{y.stop()}}async getFileTreePermissions(e,r){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,r)).display===P.Edit)return;const i=await this.providerService.getIndexMetadata(e);return $t.isActive(i)?h.FilePermission.Readonly:void 0}async getFork(e){var r,n,i;try{const{repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,c=await this.graphql(s,{owner:o,repo:a});if(c===void 0)return;const[u]=(i=(n=(r=c.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return u===void 0?void 0:{name:`${u.owner.login}/${u.name}`,repo:{owner:u.owner.login,name:u.name},url:u.url}}catch(o){return}}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:r.base,head:r.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,r,n){var i,o,a,s,c;const{base:u,head:d}={base:r.HEAD.sha,head:(i=r.HEAD.branch)==null?void 0:i.sha,...n},f=new Be(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d})`);let p,g;try{if(!d){p=` \u2022 Skipped; Unsupported HEAD type (${r.HEAD.type})`;return}const _=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:r.repo.owner,repo:r.repo.name,base:u,head:d}),v=[];for(const y of(o=_.data.files)!=null?o:[])switch(y.status){case"added":case"copied":v.push({uri:h.Uri.joinPath(e,y.filename),type:ht.Created});break;case"removed":v.push({uri:h.Uri.joinPath(e,y.filename),type:ht.Deleted});break;case"modified":v.push({uri:h.Uri.joinPath(e,y.filename),type:ht.Changed});break;case"renamed":v.push({uri:h.Uri.joinPath(e,y.filename),type:ht.Created}),v.push({uri:h.Uri.joinPath(e,y.previous_filename),type:ht.Deleted});break;default:E.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d}): Unknown file status encountered '${y.status}'`);break}return g={ahead:(a=_.data.behind_by)!=null?a:0,behind:(s=_.data.ahead_by)!=null?s:0,incomingChanges:v},g}catch(_){throw p=` \u2022 Failed; ${String(_)}`,E.error(_),_}finally{f.stop({suffix:p!=null?p:` \u2022 ${(c=g==null?void 0:g.behind)!=null?c:0} commits behind`})}}async getObjectDetails(e,r,n){var i;try{const o=await this.getFileTree(e,r);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const a=await o.get(n);if((a==null?void 0:a.mode)===void 0||(a==null?void 0:a.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:a.mode,object:a.sha,size:(i=a.stat.size)!=null?i:0}}catch(o){throw E.error(o),o}}async getPullRequest(e,r){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(e,r,n){var i,o,a,s,c,u,d;try{const f=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,p=await this.graphql(f,{owner:e,repo:r,number:Number(n)}),g=(i=p==null?void 0:p.repository)==null?void 0:i.pullRequest;return g?{author:{name:g.author.login,avatarUrl:g.author.avatarUrl,url:g.author.url},closedAt:g.closedAt?new Date(g.closedAt):void 0,mergedAt:g.mergedAt?new Date(g.mergedAt):void 0,id:g.number.toString(),repo:{name:g.repository.name,owner:g.repository.owner.login},state:pp(g.state),title:g.title,updatedAt:new Date(g.updatedAt),url:g.permalink,refs:{base:{owner:g.baseRepository.owner.login,repo:g.baseRepository.name,branch:g.baseRefName,sha:g.baseRefOid,exists:g.baseRef!=null},head:{owner:(c=(s=(o=g.headRepository)==null?void 0:o.owner.login)!=null?s:(a=g.headRepositoryOwner)==null?void 0:a.login)!=null?c:"<unknown>",repo:(d=(u=g.headRepository)==null?void 0:u.name)!=null?d:g.baseRepository.name,branch:g.headRefName,sha:g.headRefOid,exists:g.headRef!=null}}}:void 0}catch(f){E.error(f);return}}async getPullRequestForBranch(e,r,n){var i,o,a,s,c;try{const{repo:{owner:u,name:d}}=await this.getMetadata(e),f=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,p=await this.graphql(f,{owner:u,repo:d,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:iR(n==null?void 0:n.include)}),g=(c=(s=(a=(o=p==null?void 0:p.repository)==null?void 0:o.refs.nodes[0])==null?void 0:a.associatedPullRequests)==null?void 0:s.nodes)==null?void 0:c.filter(v=>!v.repository.isFork||v.repository.owner.login===u);if(g==null||g.length===0)return;g.length>1&&g.sort((v,y)=>(v.repository.owner.login===u?-1:1)-(y.repository.owner.login===u?-1:1)||(v.state==="OPEN"?-1:1)-(y.state==="OPEN"?-1:1)||new Date(y.updatedAt).getTime()-new Date(v.updatedAt).getTime());const[_]=g;return{author:{name:_.author.login,avatarUrl:_.author.avatarUrl,url:_.author.url},closedAt:_.closedAt?new Date(_.closedAt):void 0,mergedAt:_.mergedAt?new Date(_.mergedAt):void 0,id:_.number.toString(),repo:{name:_.repository.name,owner:_.repository.owner.login},state:pp(_.state),title:_.title,updatedAt:new Date(_.updatedAt),url:_.permalink}}catch(u){E.error(u);return}}async getTags(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),c=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,u=await this.graphql(c,{owner:a,repo:s,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{tags:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{tags:[]};const f=d.nodes.map(p=>({type:Kn.Tag,name:p.name,commit:p.target.oid,commitUrl:p.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},tags:f}}catch(a){return{tags:[]}}}async getTarGz(e){const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(e),o=await this.ensureAuthenticated();return h.window.withProgress({location:h.ProgressLocation.Notification,cancellable:!0,title:Wa("fetching index","Fetching search index...")},async(a,s)=>{try{if(kn){let d;try{const _=await this.tarballProxyEndpoint;_!==void 0&&(d=_.replace("{owner}",r).replace("{repo}",n).replace("{sha}",i))}catch{}if(!d)throw new Error("Workbench embedder must set `_tarballProxyEndpoints` in workbench construction options to enable GitHub fulltext search.");const p=await(await tf(d,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"},s)).text(),g=await tf(p,{},s);return new Uint8Array(await g.arrayBuffer())}const c=`https://api.github.com/repos/${r}/${n}/tarball/${i}`,u=await tf(c,{headers:{Authorization:`Bearer ${o.accessToken}`}},s);return new Uint8Array(await u.arrayBuffer())}catch(c){throw E.error(c),c}})}async pushCommit(e,r,n,i){const o=new Be(`GitHub.pushCommit(${e.toString()}, sha=${r}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let a;try{const s=await this.getMetadata(e);let c,u;if(i?{repo:{owner:c,name:u}}=i:s.HEAD.type===_e.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=De.Write?{owner:c,name:u}=s.HEAD.branch.remote.repo:{repo:{owner:c,name:u}}=s,n===void 0&&s.HEAD.detached)throw new he("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const d=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:c,repo:u,ref:`heads/${n!=null?n:s.HEAD.branch.name}`,sha:r});return n===void 0&&!s.HEAD.detached&&await this.fastForwardTo(e,r,s),a=d.data.ref,a}catch(s){throw s instanceof oi&&s.status===422&&s.message.includes("Update is not a fast forward")?new qe(s):(E.error(s),s)}finally{o.stop(a?{message:`: Pushed commit to ${a}`}:void 0)}}async queryRepositoryObject(e,r,n,i){var o,a;try{const{repo:{owner:s,name:c},HEAD:{sha:u},path:d}=await this.providerService.getMetadata(e),f=`query ${r}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,p=await this.graphql(f,{owner:s,repo:c,expression:i!=null?i:`${u}:${d}`});return(a=(o=p==null?void 0:p.repository)==null?void 0:o.object)!=null?a:void 0}catch(s){E.error(s);return}}async repositoryObjectExists(e,r){return await this.queryRepositoryObject(e,"exists","			__typename",r)!==void 0}async searchPullRequestsQuery(e,r){try{let n=l(function(s,c){return{number:s.number,title:s.title,repoWithOwner:s.repository.nameWithOwner,reasons:c?[c]:[],url:s.url}},"toResult");const i=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(r==null?void 0:r.user)&&(e+=` user:${r.user}`);const o=await this.graphql(i,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return o===void 0?[]:cp([...o.assigned.nodes.map(s=>n(s,"assigned")),...o.reviewRequested.nodes.map(s=>n(s,"review requested")),...o.mentioned.nodes.map(s=>n(s,"mentioned")),...o.authored.nodes.map(s=>n(s,"authored")),...m(o.viewer.repositories.nodes,s=>s.pullRequests.nodes.map(c=>n(c)))],s=>s.url,(s,c)=>(c.reasons.length!==0&&s.reasons.push(...c.reasons),s))}catch(n){return[]}}async searchRepositoriesQuery(e,r){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(e+=` user:${r.user}`),(r==null?void 0:r.sort)&&(e+=` sort:${r.sort}`),e+=" fork:true";const i=await this.graphql(n,{search:e.trim()});return i===void 0?[]:cp((r==null?void 0:r.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],a=>a.url).map(a=>{var s,c,u;return{repoWithOwner:a.nameWithOwner,description:(s=a.description)!=null?s:void 0,url:a.url,fork:(u=(c=a.parent)==null?void 0:c.nameWithOwner)!=null?u:void 0,stars:a.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(e,r,n){var i,o,a;const{repo:{owner:s,name:c},HEAD:u,defaultBranch:d}=await this.getMetadata(r),f=[];((i=u.branch)==null?void 0:i.name)!==d.name&&f.push(Wa("Cant search branch","Unable to search {0} without index, falling back to {1}.",(a=(o=u.branch)==null?void 0:o.name)!=null?a:u.detached.name,d.name));try{const g=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${s}/${c}`}),_=new h.Range(0,0,0,0),v=[];let y=0,x;for(const C of g.data.items)for(const k of C.text_matches){if(y++,n.maxResults!==void 0&&y>n.maxResults)return{matches:v,limitHit:!0};x={path:C.path,ranges:[],preview:k.fragment,matches:[]};for(const I of k.matches){let B=0,J=0,re=0;for(let K=0;K<I.indices[1];K++)K===I.indices[0]&&(J=re),k.fragment[K]===`
`?(B++,re=0):re++;x.ranges.push(_),x.matches.push(new h.Range(B,J,B,re))}v.push(x)}return{matches:v,limitHit:!1,warnings:f}}catch(p){return{matches:[],limitHit:!0}}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let s;if(!(r!==void 0&&(typeof r=="string"?(r==null?void 0:r.startsWith("refs/heads/"))?(s={type:Ue.Tree,id:r.substr(11)},r=r.substr(11)):(r==null?void 0:r.startsWith("refs/tags/"))?s={type:Ue.Tree,id:r.substr(10)}:s={type:Ue.Tree,id:r}:s={...r,type:r.type===Ue.Branch||r.type===Ue.Tag?Ue.Tree:r.type},(a==null?void 0:a.name)===s.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:s}),location:(n==null?void 0:n.openInNewWindow)?Bt.NewWindow:Bt.CurrentWindow}}async sync(e,r,n){var i,o,a,s,c,u;const d=new Be(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let f;try{const{metadata:p}=await this.fetchCore(e,!0,{to:n.to});if(p.HEAD.detached){f=" \u2022 Skipped; detached HEAD";return}if(((o=(i=p==null?void 0:p.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){d.logStep("Fetching upstream changes");const g=[],_=(s=(a=p.state)==null?void 0:a.incomingChanges)!=null?s:[];if(_.length>0){const v=await r.getChanges(e);for(const y of v){const x=this.providerService.getRelativeFilePath(e,y.uri),C=_.find(k=>k.uri.path===x);if(C!==void 0){g.push({path:x,current:y,incomingType:C.type});break}}}if(g.length>0)switch(n.conflictResolution){case cr.KeepCurrent:d.logStep("Syncing (keep) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const v of g)await r.keep(v.current.uri,{type:v.incomingType,providerUri:fp(p,p.HEAD.branch.sha,v.path)});break;case cr.DiscardCurrent:d.logStep("Syncing (discard) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const v of g)await r.discard(v.current.uri);break;case cr.Merge:d.logStep("Syncing (merge) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const v of g)await r.merge(v.current.uri,{type:v.incomingType,providerUri:fp(p,p.HEAD.branch.sha,v.path)},{providerUri:fp(p,p.HEAD.sha,v.path)});break;case cr.Abort:default:throw d.logStep("Syncing (abort) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,p),new Vt}}f=` \u2022 to=${(c=n.to)!=null?c:p.HEAD.branch.sha}`,await this.fastForwardTo(e,(u=n.to)!=null?u:p.HEAD.branch.sha,p)}finally{d.stop(f?{suffix:f}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new he("Unable to fast-forward; no current branch");if(n.HEAD.sha===r&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),E.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:r!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:r})}async getBranchTips(e,r){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);r===void 0&&(o.type===_e.RemoteBranch?r=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:r=o.branch?`refs/heads/${o.branch.name}`:"");const a=Ty.exec(r);if(a==null?void 0:a.groups)return this.getRemoteBranchTips(n,i,r);const s=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,c=await this.graphql(s,{owner:n,repo:i,ref:r});if((c==null?void 0:c.repository)==null)return;const{defaultBranchRef:u,ref:d}=c.repository;return!u&&!d?void 0:{defaultBranch:u?{sha:u.target.oid}:void 0,branch:d?{sha:d.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,r,n){try{const i=Ty.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:a,remoteRef:s}=i.groups;a||(a=r);const c=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,u=await this.graphql(c,{owner:e,repo:r,remoteOwner:o,remoteRepo:a,remoteRef:s});if((u==null?void 0:u.repository)==null||(u==null?void 0:u.remote)==null)return;const{repository:{defaultBranchRef:d},remote:{ref:f}}=u;return!d&&!f?void 0:{defaultBranch:d?{sha:d.target.oid}:void 0,branch:f?{sha:f.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,r,n,i){var o,a,s,c,u,d,f,p,g,_,v,y,x,C,k,I;try{const B=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,J=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${B}
		}
	}
}`;let re,K;try{const Se=await this.graphql(J,{owner:e,repo:r,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((Se==null?void 0:Se.repository)==null)return;({repository:K,viewer:{login:re}}=Se)}catch(Se){if((i==null?void 0:i.pr)&&Se instanceof Ha&&((s=(a=Se.errors)==null?void 0:a[0])==null?void 0:s.type)==="NOT_FOUND"&&((c=Se.errors[0])==null?void 0:c.message.includes("Could not resolve to a PullRequest"))){({repository:K,viewer:{login:re}}=Se.data);try{const Je=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${B}
			}
		}
	}
}`,{owner:e,repo:r,pr:i==null?void 0:i.pr});if(((d=(u=Je==null?void 0:Je.repository)==null?void 0:u.parent)==null?void 0:d.pullRequest)==null)throw Se;K.pullRequest=Je.repository.parent.pullRequest}catch{throw Se}}else throw Se}const we=(f=K.defaultBranchRef)!=null?f:void 0;if((we==null?void 0:we.name)==null)return;const ie=K.pullRequest;let pe;if(K==null?void 0:K.ref)pe={prefix:K.ref.prefix,name:K.ref.name,sha:K.ref.target.oid};else if(ie==null?void 0:ie.headRef){let Se=gp(ie.headRepository.viewerPermission);Se<De.Write&&ie.maintainerCanModify&&gp(K.viewerPermission)>=De.Write&&(Se=De.WriteToPullRequest),pe=ie.headRepository.owner.login===e?{prefix:"refs/heads/",name:ie==null?void 0:ie.headRef.name,sha:(g=(p=ie.mergeCommit)==null?void 0:p.oid)!=null?g:ie==null?void 0:ie.headRefOid}:{prefix:"refs/remotes/",name:ie==null?void 0:ie.headRef.name,sha:(v=(_=ie.mergeCommit)==null?void 0:_.oid)!=null?v:ie==null?void 0:ie.headRefOid,remote:{name:`${ie.headRepository.owner.login}/${ie.headRepository.name}`,accessLevel:Se,repo:{owner:ie.headRepository.owner.login,name:ie.headRepository.name}}}}else(ie==null?void 0:ie.baseRef)?(pe={prefix:"refs/heads/",name:ie==null?void 0:ie.baseRef.name,sha:(x=(y=ie.mergeCommit)==null?void 0:y.oid)!=null?x:ie==null?void 0:ie.baseRefOid},n&&(E.log("Did not find a headRef for PR, falling back to baseRef",ie.baseRef),$r.showPullRequestHeadNotFoundMessage(`${e}/${r}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(pe={prefix:"refs/heads/",name:we.name,sha:we.target.oid});return{user:re,repo:{owner:K.owner.login,name:K.name},accessLevel:gp(K.viewerPermission),ref:pe,defaultBranch:{name:we.name,sha:we.target.oid},pullRequest:ie?{id:ie.number.toString(),state:pp(ie.state),title:ie.title}:void 0}}catch(B){if(B instanceof Ha)switch((k=(C=B.errors)==null?void 0:C[0])==null?void 0:k.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&((I=B.errors[0])==null?void 0:I.message.includes("Could not resolve to a PullRequest"))){const re=new ne(B,`${e}/${r}`,`#${i==null?void 0:i.pr}`);throw n&&$r.showPullRequestNotFoundMessage(re.name,re.id),re}const J=new Ke(B,`${e}/${r}`);throw n&&$r.showRepositoryNotFoundMessage(J.name),J}case"FORBIDDEN":{const J=new vt(B,`${e}/${r}`);throw n&&$r.showRepositoryForbiddenMessage(J.name),J}}E.error(B,`Failed to get repository info for '${e}/${r}'`),!this.handleRequestErrors(B)&&n&&$r.showUnableToOpenRepositoryMessage(B);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,r,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:r});return[e,r]=i.data.name_with_owner.split("/"),n?{owner:e,repo:r,ref:{type:Ue.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:r}}catch(i){if(i instanceof oi)switch(i.status){case 401:throw new Qe(i,()=>void this.reauthenticate());case 403:throw new vt(i,`${e}/${r}`);case 404:throw new Ke(i,`${e}/${r}`);case 409:throw new ct(i,`${e}/${r}`)}return}}asFileTreeKey(e,r){return`${se(this.providerService.getProviderRootUri(e))}:${r}`}}l(Su,"GitHubRepositoryProvider"),Ry([Er()],Su.prototype,"ensureAuthenticated",1),Ry([Er()],Su.prototype,"octokit",1);function pp(t){switch(t){case"OPEN":return st.Open;case"CLOSED":return st.Closed;case"MERGED":return st.Merged}}l(pp,"toPullRequestState");function iR(t){if(t!==void 0)return t.map(e=>{switch(e){case st.Open:return"OPEN";case st.Closed:return"CLOSED";case st.Merged:return"MERGED"}})}l(iR,"fromPullRequestStates");var Oo;(function(t){t.ADMIN="ADMIN",t.MAINTAIN="MAINTAIN",t.WRITE="WRITE",t.TRIAGE="TRIAGE",t.READ="READ",t.NONE="NONE"})(Oo||(Oo={}));function gp(t){switch(t){case Oo.ADMIN:return De.Admin;case Oo.MAINTAIN:return De.Maintain;case Oo.WRITE:return De.Write;case Oo.TRIAGE:return De.Triage;case Oo.READ:return De.Read;default:return De.None}}l(gp,"permissionToAccessLevel");function oR(t){switch(t&&(t=t.toLocaleLowerCase()),t){case"blob":return h.FileType.File;case"tree":return h.FileType.Directory;default:return h.FileType.Unknown}}l(oR,"typenameToFileType");const Iy=l(class{constructor(t,e,r){this.providerService=t,this.storageService=e,this.changeStore=r,this.lock=new ls("PendingRepositoryOpenActions"),this.disposable=h.Disposable.from(t.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const r=await this.getAndDelete(e);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(e,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(e.uri,r.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(t){await this.changeStore.hasChanges(t.uri)?await this.providerService.fetch(t.uri):await this.providerService.sync(t.uri,this.changeStore,{reason:"invoked"})}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){E.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t.uri);if(r!==void 0)return await this.storeCore(t.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(e){E.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){E.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let r of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(r);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),r=r.substring(0,n.index));const a=h.Uri.joinPath(t,r);let s;try{s=await h.workspace.fs.stat(a)}catch{}if((s==null?void 0:s.type)===h.FileType.Directory)h.commands.executeCommand("revealInExplorer",a);else{let c;i!==void 0&&(c={selection:new h.Range(Number(i)-1,0,o!=null?o:i,0)}),h.commands.executeCommand("vscode.open",a,c)}}}}setChangesetToApply(t,e){return E.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return E.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){E.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);try{await this.changeStore.applyChangeset(t.uri,e,{save:!0})}catch(r){E.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.storageService.get(this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(t)):this.storageService.store(this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${W(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&ut(n)?h.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return E.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:Iy.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let Dy=Iy;Dy.storageSchemaVersion=1;const mn=(0,O.loadMessageBundle)();class Fy{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFileDecorations=new h.EventEmitter,this._decorations=new Map,this.disposable=h.Disposable.from(h.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const r=e.map(({uri:n})=>(this._decorations.delete(W(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(r),0)}async provideFileDecoration(e,r){if(e.scheme!==Pt.scheme)return;const n=W(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(c=>W(c.uri)===n));const s=await this.changeStore.getChange(e);if(s===void 0){if(a!==void 0)switch(a.type){case ht.Created:i={badge:"\u2193A",color:new h.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:mn("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case ht.Deleted:i={badge:"\u2193D",color:new h.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:mn("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case ht.Changed:i={badge:"\u2193M",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:mn("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:mn("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(s.conflicts)i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:mn("decoration tooltip conflicts","Merge Conflicts ({0})",hb(s.conflicts.status))};else if(a!==void 0)switch(a.type){case ht.Created:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case ht.Deleted:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case ht.Changed:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(s.type){case ht.Created:i={badge:"A",color:new h.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:mn("decoration tooltip added","Added")};break;case ht.Changed:i={badge:"M",color:new h.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:mn("decoration tooltip modified","Modified")};break;case ht.Deleted:i={badge:"D",color:new h.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:mn("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}l(Fy,"ScmDecorationProvider");const aR=(0,O.loadMessageBundle)();class Fi{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await h.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}l(Fi,"CommandQuickPickItem");var Cu;(function(t){async function e(r,n,i,o,a,s){let c;Array.isArray(a)?c=a:s===void 0&&(c=[],s=a);const u=h.window.createQuickPick(),d=new Ul(500),f=[d],{defaultBranch:p,HEAD:g}=await r.getMetadata(n);async function _(k){var I;const[B,J,re]=await Promise.all([r.getBranches(n,{query:k,limit:100}),r.getTags(n,{query:k,limit:100}),r.getSnapshots(n)]),K=new Set,we=new Set;for(const Je of re)K.add(Je.hash),we.add(Je.branch.name);const ie=((s==null?void 0:s.filterBranches)?B.branches.filter(s==null?void 0:s.filterBranches):B.branches).filter(Je=>Je.name!==p.name),pe=aR("indexedCommit","Open indexed commit"),Se=[{iconPath:new h.ThemeIcon("layers-active"),tooltip:pe}];return[...c,...((I=g.branch)==null?void 0:I.name)!==p.name?[{label:`$(git-branch) ${p.name} (default)`,description:`\u2022$(git-commit) ${wt(p.sha)}${we.has(p.name)||K.has(p.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:Ue.Branch,name:void 0,sha:p.sha,buttons:we.has(p.name)||K.has(p.sha)?Se:void 0}]:[],...ie.map(Je=>({label:`$(git-branch) ${Je.name}`,description:`\u2022$(git-commit) ${wt(Je.commit)}${we.has(Je.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Ue.Branch,name:Je.name,sha:Je.commit,buttons:we.has(Je.name)?Se:void 0})),...J.tags.map(Je=>({label:`$(tag) ${Je.name}`,description:`\u2022$(git-commit) ${wt(Je.commit)}${K.has(Je.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:Ue.Tag,name:Je.name,sha:Je.commit,buttons:K.has(Je.commit)?Se:void 0}))]}l(_,"getItems");const v=_(void 0);let y,x=!1;async function C(k){y=void 0;const I=u.activeItems;u.items=k!=null?k:await v,x&&I.length!==0&&(u.activeItems=u.items.filter(B=>I.some(J=>J.label===B.label))),u.busy=!1}l(C,"setItems");try{return await new Promise(I=>{var B;f.push(u.onDidHide(()=>I(void 0)),u.onDidChangeValue(J=>{if(x=!1,J=J.trim(),(s==null?void 0:s.allowResetToSha)&&g.branch&&Gt(J)){C([{label:`Reset $(git-branch) ${g.branch.name} to $(git-commit) ${J}`,name:g.branch.name,sha:J,type:Ue.Branch}]);return}u.busy=!0;const re=d.debounce(J?()=>_(J):()=>v);y===void 0&&(y=re.then(async K=>C(K)))}),u.onDidAccept(()=>{if(u.activeItems.length!==0){const[J]=u.activeItems;I(J)}}),u.onDidTriggerItemButton(J=>{const re=J.item;re instanceof Fi||(re.useIndex=!0),I(re)})),u.title=o,u.placeholder=i,u.matchOnDescription=!0,u.ignoreFocusOut=(B=s==null?void 0:s.ignoreFocusOut)!=null?B:!0,u.busy=!0,u.show(),y=d.debounce(async()=>v,0).then(J=>C(J))})}finally{u.dispose(),f.forEach(k=>void k.dispose())}}l(e,"show"),t.show=e})(Cu||(Cu={}));function mp(t,e){switch(t){case _e.Branch:case _e.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case _e.Tag:return"$(tag)";case _e.Commit:return"$(git-commit)"}}l(mp,"headTypeToCodicon");function sR(t){switch(t){case Ye.Active:return"$(layers-active)";case Ye.Match:return"$(layers-dot)";case Ye.Indexed:return"$(layers)"}}l(sR,"indexTypeToCodicon");function cR(t,e){switch(t){case _e.Branch:case _e.RemoteBranch:return e?new h.ThemeIcon("git-pull-request"):new h.ThemeIcon("git-branch");case _e.Tag:return new h.ThemeIcon("tag");case _e.Commit:return new h.ThemeIcon("git-commit")}}l(cR,"headTypeToThemeIcon");const ve=(0,O.loadMessageBundle)(),lR=new TextDecoder;class Py{constructor(e,r,n,i){this.providerService=e,this.changeStore=r,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new h.EventEmitter,this._onDidOpenRepository=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=h.Disposable.from(j.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:a})=>{const s=this.getScmProvider(this.providerService.getVirtualUri(a.uri));s!==void 0&&await this.updateStatusBarCommands(s,void 0)}),this.providerService.onDidSyncRepository(async({repository:a,syncing:s})=>{const c=this.getScmProvider(this.providerService.getVirtualUri(a.uri));c!==void 0&&await this.updateStatusBarCommands(c,{syncing:s})}),this.providerService.onDidRefresh(a=>{for(const s of a)this.update(s)}),this.changeStore.onDidChange(a=>this.update(a[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=j.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){j.changed(e,"staging")&&(this._staging=void 0,j.changed(e,"staging.enabled")&&this.refresh()),j.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const r of e.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const r of e.removed){const n=this._scmProviders.findIndex(i=>W(i.sourceControl.rootUri)===W(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),xi(Vn.HasWriteableScmProvider,this._scmProviders.some(r=>!r.isReadonly))}registerCommands(){return[h.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),h.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),h.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e)}),h.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(Ny(e)){const o=e.resourceStates.filter(_c);if(o.length!==0){if(await wp(o))for(const a of o)await this.changeStore.discard(a.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(r.rootUri);await wp(n)?await this.changeStore.discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),h.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const r of e)!_c(r)||(this.telemetryService.sendEvent("command.discardChanges"),await wp([r])?await this.changeStore.discard(r.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),h.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const r=this.getSourceControlFrom(e);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(r.rootUri))}),h.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const r of e)!_c(r)||(this.telemetryService.sendEvent("command.stageChanges"),await this.changeStore.stage(r.resourceUri))}),h.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(r.rootUri)}),h.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const r of e)!_c(r)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.changeStore.unstage(r.resourceUri))}),h.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const r of e)!_c(r)||(this.telemetryService.sendEvent("command.keepChanges"),await this.changeStore.keep(r.resourceUri))}),h.commands.registerCommand("remoteHub.openChanges",e=>{var r;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void h.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),h.commands.registerCommand("remoteHub.openFile",async(...e)=>{var r;for(const n of e)if(vp(n)){const i=n,o=this.changeStore.resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:h.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await h.commands.executeCommand(o.command,...(r=o.arguments)!=null?r:[])}else if(n instanceof h.Uri){this.telemetryService.sendEvent("command.openFile");const i=n;await h.window.showTextDocument(i)}}),h.commands.registerCommand("remoteHub.createBranch",async e=>{await Yh("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),h.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await xc(this._scmProviders,ve("choose repo for create branch placeholder","Choose which repository to create a new branch on"),ve("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<De.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),h.window.showErrorMessage(ve("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const g=await Cu.show(this.providerService,n,ve("choose branch for create placeholder","Choose which branch to create the new branch from"),ve("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!g){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=g.sha,a=Boolean(g.useIndex)}let s;try{s=await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>Eu(this.providerService,n,o,ve("create branch","Please provide a new branch name"),ve("create branch placeholder","New branch name"),ve("create branch title","Create Branch \u2022 {0}",i.name)))}catch(g){E.error(g),h.window.showErrorMessage(ve("unable to create branch","Unable to create the new branch."));return}if(!s){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const c=await this.providerService.switchTo(n,{type:Ue.Branch,id:s});if(!c)return;const u=await this.changeStore.createChangeset(n);u&&await this.openActionsService.setChangesetToApply(c.uri,u);const d=ve("switch to branch prompt open","Switch to Branch"),f=ve("switch to branch prompt open in new window","Open in New Window"),p=await h.window.showInformationMessage(ve("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,s),{modal:!0,useCustom:!0},d,f);!p||(c.location=p===f?Bt.NewWindow:Bt.CurrentWindow,a&&await j.setMode(c.uri,U.getIndexDefault(q.Branch)),await dn(c,{skipChangesPrompt:!0}))}),h.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=h.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await h.window.showOpenDialog({openLabel:ve("open patch","Open Patch"),title:ve("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;r=lR.decode(await h.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.changeStore.applyPatch(e.rootUri,r)}catch{h.window.showErrorMessage(ve("invalid patch file","Invalid patch file"))}}),h.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const r=Array.isArray(e)?e:[e];for(const n of r){const i=this.getSourceControlFrom(n);if((i==null?void 0:i.rootUri)===void 0)return;let o;vp(n)&&(o=n.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const a=await this.changeStore.createPatch(i.rootUri,o),s=await h.workspace.openTextDocument({language:"diff",content:a});await h.window.showTextDocument(s)}}),h.commands.registerCommand("remoteHub.switchToBranch",async e=>{var r,n;const i=(r=e==null?void 0:e.uri)!=null?r:await xc(this._scmProviders,ve("choose repo for switch branch placeholder","Choose which repository to switch branches on"),ve("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=De.Write&&o.push(new Fi(Fn({command:"remoteHub.createBranch",title:ve("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new Fi(Fn({command:"remoteHub.createBranchFrom",title:ve("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),a.HEAD.type){case _e.Branch:o.push(new Fi(Fn({command:"remoteHub.openOnRemote",title:ve("open branch on remote command","$(globe) Open Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case _e.RemoteBranch:o.push(new Fi(Fn({command:"remoteHub.openOnRemote",title:ve("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case _e.Tag:o.push(new Fi(Fn({command:"remoteHub.openOnRemote",title:ve("open tag on remote command","$(globe) Open Tag on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case _e.Commit:o.push(new Fi(Fn({command:"remoteHub.openOnRemote",title:ve("open commit on remote command","$(globe) Open Commit on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const s=(n=a.HEAD.branch)==null?void 0:n.name,c=Boolean(s&&!await this.changeStore.hasChanges(i)),u=await Cu.show(this.providerService,i,ve("choose switch branch placeholder","Choose which branch to switch to"),ve("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:c,filterBranches:s?d=>d.name!==s:void 0,ignoreFocusOut:!1});if(!u){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return u instanceof Fi?void u.execute():c&&u.type===Ue.Branch&&u.name===s&&u.sha?h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,this.changeStore,{to:u.sha})}catch(d){E.error(d),h.window.showErrorMessage(ve("reset failed","Unable to reset the repository to commit '{0}'.",wt(u.sha)))}}):void h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const d=await this.providerService.switchTo(i,u.name?{type:u.type,id:u.name}:void 0);if(d!==void 0){if(u.useIndex){const f=await this.providerService.getModeRefType(d.uri);await j.setMode(d.uri,U.getIndexDefault(f))}return dn(d)}})}),h.commands.registerCommand("remoteHub.fetch",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await xc(this._scmProviders,ve("choose repo for fetch placeholder","Choose which repository to fetch"),ve("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){h.window.showErrorMessage(ve("fetch failed","Unable to fetch repository"))}}}),h.commands.registerCommand("remoteHub.fetchAll",async e=>{const r=this.providerService.repositories;if(r.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&h.window.showErrorMessage(r.length?ve("fetch all failed","Unable to fetch repositories"):ve("fetch failed","Unable to fetch repository"))}),h.commands.registerCommand("remoteHub.pull",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await xc(this._scmProviders,ve("choose repo for pull placeholder","Choose which repository to pull"),ve("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),h.commands.registerCommand("remoteHub.sync",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await xc(this._scmProviders,ve("choose repo for sync placeholder","Choose which repository to sync"),ve("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),h.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),j.updateEffective("commitDirectlyWarning",F.Off)})]}async sync(e,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,n))}catch(i){if(i instanceof Vt){const o={title:ve("sync confirm","Continue")},a={title:ve("sync cancel","Cancel"),isCloseAffordance:!0};await h.window.showWarningMessage(r?ve("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):ve("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,a)===o?await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,{conflictResolution:cr.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw E.error(i),this.telemetryService.sendException(i),h.window.showErrorMessage(ve("sync failed","Unable to sync the repository.")),i}}async commitChanges(e){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.commitChangesCore(e))}catch(r){if(r instanceof rt){h.window.showInformationMessage(ve("no changes to commit","There are no changes to commit."));return}E.error(r),h.window.showErrorMessage(ve("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e){const r=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=new Be(`VirtualSourceControl.commitChanges(${r.toString()})`);let i;try{const o=await this.providerService.getMetadata(r);let a,s;const c=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const d=e.inputBox.value;if(await this.changeStore.hasMergeConflicts(r)){e.inputBox.showValidationMessage(ve("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),i=": Aborted; Unresolved conflicts";return}const f=await this.providerService.getCommitOperations(r,this.changeStore,{staged:c});if(f.length===0){e.inputBox.showValidationMessage(this.staging.enabled?ve("commit no staged changes","There are no staged changes to commit."):ve("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),i=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!d){e.inputBox.showValidationMessage(ve("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),i=": Aborted; No message";return}let p,g;if(o.HEAD.type===_e.RemoteBranch?(g=o.HEAD.branch.remote.accessLevel<De.Write,p=g&&o.accessLevel<De.Write):(p=o.accessLevel<De.Write,g=p),s===void 0&&p&&(s=await this.providerService.getFork(r),s===void 0)){const _={title:ve("fork confirm","Fork Repository")},v={title:ve("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(ve("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},_,v)!==_){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),i=": Aborted; Abandoned fork prompt";return}if(s=await h.window.withProgress({location:h.ProgressLocation.Notification,title:ve("fork progress","Forking {0}...",o.name)},()=>this.providerService.fork(r)),s===void 0){h.window.showErrorMessage(ve("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),i=": Aborted; Fork failed";return}}if(s||g){if(s===void 0){const v={title:ve("remote branch create branch prompt confirm","Commit to New Branch")},y={title:ve("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(ve("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},v,y)!==v){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),i=": Aborted; Abandoned commit to new branch prompt";return}}let _=0;try{const v=await this.providerService.getBranches(s?this.providerService.createVirtualUri(r,s):r,{query:"patch-"});for(const y of v.branches){const x=/^patch-(?<num>\d+)$/.exec(y.name);if(x==null?void 0:x.groups){const C=Number(x.groups.num);C>_&&(_=C)}}}catch{}if(a=await Eu(this.providerService,r,o.HEAD.sha,ve("create new branch prompt","Create a new branch to commit your changes to"),ve("create new branch placeholder","New branch name"),ve("create new branch title","Commit \u2022 Create Branch \u2022 {0}",s?s.name:o.name),s,`patch-${_+1}`),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),i=": Aborted; Abandoned create branch prompt";return}}try{if(j.getUseNewCommitApi())await this.providerService.createAndPushCommit(r,d,f,a,s);else{n.logStep("Creating commit");const _=await this.providerService.createCommit(r,d,f,s);n.logStep("Pushing",{message:`: Created commit ${_}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(r,_,a,s)}}catch(_){if(_ instanceof he){const v={title:ve("detached head prompt confirm","Commit to New Branch")},y={title:ve("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(ve("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},v,y)!==v){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),i=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(a=await Eu(this.providerService,r,o.HEAD.sha,ve("create new branch prompt","Create a new branch to commit your changes to"),ve("create new branch placeholder","New branch name"),ve("create new branch title","Commit \u2022 Create Branch \u2022 {0}",s?s.name:o.name),s),!a){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),i=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(_ instanceof qe){const v={title:ve("push conflicts prompt pull","Pull")},y={title:ve("push conflicts prompt sync","Sync (Pull & Push)")},x={title:ve("cancel","Cancel"),isCloseAffordance:!0},C=await h.window.showErrorMessage(ve("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},v,y,x);if(C!==v&&C!==y){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),i=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:C===v,conflictResolution:cr.Merge}),C===v){i=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw E.error(_),i=`: Aborted; ${String(_)}`,_}break}if(e.inputBox.value="",s?await this.changeStore.discardAll(r,{staged:c}):await this.changeStore.acceptAll(r,{staged:c}),Sp(Wo.HasCommitted,!0),!s&&!a)return;async function u(){if(s){const g={title:ve("commit to fork confirm","Switch to Fork")},_={title:ve("cancel","Cancel"),isCloseAffordance:!0},v=await h.window.showInformationMessage(ve("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",o.name),{modal:!0,useCustom:!0},g,_);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(v===g)}),v===g){let y;a!==void 0?y={type:Ue.Branch,id:a}:o.HEAD.branch!==void 0&&(y={type:Ue.Branch,id:o.HEAD.branch.name}),dn({name:s.name,uri:this.providerService.createVirtualUri(r,{repo:s.repo,ref:y}),location:Bt.CurrentWindow})}return}const d={title:ve("commit to new branch confirm","Switch to Branch")},f={title:ve("cancel","Cancel"),isCloseAffordance:!0},p=await h.window.showInformationMessage(ve("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",a),{modal:!0,useCustom:!0},d,f);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(p===d)}),p===d&&dn({name:o.name,uri:this.providerService.createVirtualUri(r,{repo:o.repo,ref:a?{type:Ue.Branch,id:a}:void 0}),location:Bt.CurrentWindow})}l(u,"showSwitchToPrompt"),u.call(this)}finally{n.stop(i?{message:i}:void 0)}}async createPullRequest(e,r){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,r))}catch(n){if(n instanceof rt){h.window.showInformationMessage(ve("no changes to commit","There are no changes to commit."));return}if(n instanceof Et){h.window.showErrorMessage(ve("commit unable","Unable to commit."));return}E.error(n),h.window.showErrorMessage(ve("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,r){var n,i;const o=e.rootUri,a=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(a),staging:String(this.staging.enabled)});const s=new Be(`VirtualSourceControl.createPullRequest(${o.toString()})`);let c;try{let u=l(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),c=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),d;const f=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(r==null?void 0:r.sha)){if(await this.changeStore.hasMergeConflicts(o)){e.inputBox.showValidationMessage(ve("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),c=": Aborted; Unresolved conflicts";return}if(d=await this.providerService.getCommitOperations(o,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),d.length===0){e.inputBox.showValidationMessage(this.staging.enabled?ve("commit no staged changes","There are no staged changes to commit."):ve("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),c=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const p=e.inputBox.value;if(!p){e.inputBox.showValidationMessage(ve("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),c=": Aborted; No message";return}const g=await this.providerService.getMetadata(o);let _,v;g.HEAD.type===_e.RemoteBranch?(v=g.HEAD.branch.remote.accessLevel<De.Write,_=v&&g.accessLevel<De.Write):(_=g.accessLevel<De.Write,v=_);let y=r==null?void 0:r.fork;if(y===void 0&&_&&(y=await this.providerService.getFork(o),y===void 0)){const J={title:ve("fork confirm","Fork Repository")},re={title:ve("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(ve("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},J,re)!==J){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),c=": Aborted; Abandoned fork prompt";return}if(y=await h.window.withProgress({location:h.ProgressLocation.Notification,title:ve("fork progress","Forking {0}...",g.name)},()=>this.providerService.fork(o)),y===void 0){h.window.showErrorMessage(ve("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),c=": Aborted; Fork failed";return}}const x=await h.window.showInputBox({ignoreFocusOut:!0,placeHolder:ve("create pr placeholder","Pull request title"),prompt:ve("create pr prompt","Enter a title for the new pull request"),title:ve("create pr title","New Pull Request"),value:p});if(!x){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),c=": Aborted; Abandoned title prompt";return}async function C(J){let re=0;try{const K=await this.providerService.getBranches(y?this.providerService.createVirtualUri(o,y):o,{query:"patch-"});for(const we of K.branches){const ie=/^patch-(?<num>\d+)$/.exec(we.name);if(ie==null?void 0:ie.groups){const pe=Number(ie.groups.num);pe>re&&(re=pe)}}}catch{}return Eu(this.providerService,o,J,ve("create pr branch prompt","Create a new branch for this pull request"),ve("create pr branch placeholder","New branch name"),ve("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",y?y.name:g.name),y,`patch-${re+1}`)}l(C,"createBranch");let k;if(j.getUseNewCommitApi()){if(k=await C.call(this,g.HEAD.sha),!k){u.call(this);return}(d==null?void 0:d.length)&&await this.providerService.createAndPushCommit(o,p,d,k,y)}else{let J;if((d==null?void 0:d.length)?(J=await this.providerService.createCommit(o,p,d,y),s.log({message:`: Created commit ${J}`})):(J=(i=r==null?void 0:r.sha)!=null?i:g.HEAD.sha,s.log({message:`: Using commit ${J}`})),k=await C.call(this,J),!k){u.call(this);return}}const I=await this.providerService.createPullRequest(o,k,x,{draft:a},y);e.inputBox.value="",(d==null?void 0:d.length)&&(y?await this.changeStore.discardAll(o,{staged:f}):await this.changeStore.acceptAll(o,{staged:f}));async function B(){const J={title:ve("created pr notification confirm","Switch to Pull Request")},re={title:ve("cancel","Cancel"),isCloseAffordance:!0},K=await h.window.showInformationMessage(ve("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',I.id,I.uri.toString(!0),g.provider.name,g.name),{modal:!0,useCustom:!0},J,re);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(K===J)}),K===J&&dn({name:g.name,uri:this.providerService.createVirtualUri(o,{repo:g.repo,ref:{type:Ue.PullRequest,id:I.id}}),location:Bt.CurrentWindow})}l(B,"showSwitchToPrompt"),B.call(this)}finally{s.stop(c?{message:c}:void 0)}}async update(e){const r=h.workspace.getWorkspaceFolder(e);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(e,r.name),i=await this.changeStore.getGroupedChanges(e,{predicate:c=>c.fileType===h.FileType.File}),o=await Promise.all(i.conflicts.map(async c=>({type:c.type,resourceUri:c.uri,command:await this.changeStore.resolveDiffCommand(c.uri,c.conflicts.incomingUri,ve("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",ue(c.uri)))}))),a=await Promise.all(i.staged.map(async c=>({type:c.type,resourceUri:c.uri,command:await this.changeStore.resolveDiffCommand(c.uri,this.providerService.getProviderUri(c.uri),ve("diff title index","{0} (Index)",ue(c.uri)))}))),s=await Promise.all(i.working.map(async c=>({type:c.type,resourceUri:c.uri,decorations:{strikeThrough:c.type===ht.Deleted},command:await this.changeStore.resolveDiffCommand(c.uri,this.providerService.getProviderUri(c.uri),ve("diff title working","{0} (Working Tree)",ue(c.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?s:[...a,...s],n}async createOrUpdateScmProvider(e,r){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const a=n.HEAD.branch?n.HEAD.name:void 0;let s=this.getScmProvider(e);if(s===void 0){r=n.name,o=h.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,e),o.quickDiffProvider={provideOriginalResource:u=>this.providerService.getProviderUri(u)};const c=this.providerService.createIGitRepository(e,o,n,this.changeStore);s={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:c,isReadonly:i},this.ensureMergeConflictsGroup(s),this.ensureStagedChangesGroup(s),this.ensureWorkingChangesGroup(s),this._scmProviders.push(s)}else o=s.sourceControl;return n.accessLevel>=De.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:ve("scm input accept command title commit","Commit"),arguments:[o]},a?o.inputBox.placeholder=ve("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",a,n.provider.name):o.inputBox.placeholder=ve("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),j.get("commitDirectlyWarning")===F.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=c=>{if(j.get("commitDirectlyWarning")===F.Auto&&Ky(Wo.HasCommitted))return;const u=new h.MarkdownString(a?ve("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",a,n.provider.name):ve("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return u.isTrusted=!0,u.appendMarkdown(`&nbsp; [${ve("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${ve("scm input validation action tip","Hide")}')`),{message:u,type:h.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=ve("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:ve("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=ve("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r)),await this.updateStatusBarCommands(s,{syncing:!1},n),s}async updateStatusBarCommands(e,r,n){var i,o,a;const s=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(s);const{HEAD:c}=n,u=await this.providerService.getIndexMetadata(s),d=(u==null?void 0:u.type)===Ye.Active,f=(u==null?void 0:u.type)===Ye.Active,p=Ye.hasIndex(u==null?void 0:u.type),g=await this.changeStore.hasChanges(s),_=mp(c.type),v=[];if(v.push(Fn({command:"remoteHub.switchToBranch",title:`${_} ${c.name}${g?"*":""}`,tooltip:`${wt(c.sha)}`,arguments:[{uri:s,commands:!0}]})),c.detached||((r==null?void 0:r.syncing)?v.push(Fn({command:"",title:"$(sync~spin)",tooltip:ve("sync command syncing","Syncing Changes..."),arguments:[]})):v.push(Fn({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=n.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:d||f?ve("sync index","Sync to latest indexed commit"):ve("sync command","Sync (Pull & Push)"),arguments:[{uri:s}]}))),n.pullRequest&&v.push(Fn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:ve("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),p){const y=this.providerService.getIndexProvider(s);y&&v.push(...await y.getStatusBarContributions(s))}e.sourceControl.statusBarCommands=v}ensureMergeConflictsGroup(e){const r="conflicts";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,ve("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const r="staged";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,ve("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const r="changes";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,ve("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const r=W(e);return this._scmProviders.find(n=>W(n.sourceControl.rootUri)===r)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let r;if(uR(e))r=e;else if(Ny(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else if(vp(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;r=this._scmProviders[0].sourceControl}return r}}l(Py,"VirtualSourceControl");function uR(t){return"rootUri"in t&&"inputBox"in t}l(uR,"isSourceControl");function Ny(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}l(Ny,"isSourceControlResourceGroup");function vp(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof h.Uri}l(vp,"isSourceControlResourceState");function _c(t){return"type"in t}l(_c,"isTrackedChange");async function wp(t){var e,r,n;if(t.length===0)return!0;let i,o=ve("discard","Discard Changes");if(t.length===1){const s=t[0];s.type===ht.Created?(i=ve("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,ue((e=s.resourceUri)!=null?e:s.uri)),o=ve("delete file","Delete file")):s.type===ht.Deleted?(o=ve("restore file","Restore file"),i=ve("confirm restore","Are you sure you want to restore {0}?",ue((r=s.resourceUri)!=null?r:s.uri))):i=ve("confirm discard","Are you sure you want to discard changes in {0}?",ue((n=s.resourceUri)!=null?n:s.uri))}else t.every(s=>s.type===ht.Created)?i=ve("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(s=>s.type===ht.Deleted)?(o=ve("restore files","Restore files"),i=ve("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=ve("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await h.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}l(wp,"confirmDiscard");async function xc(t,e,r){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const n=await h.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:r});if(!!n)return n.uri}l(xc,"getOrPickRootUri");async function Eu(t,e,r,n,i,o,a,s){const c=new Set;let u;const d=h.window.createInputBox();d.ignoreFocusOut=!0;try{return await new Promise((f,p)=>{u=h.Disposable.from(d.onDidHide(()=>f(void 0)),d.onDidChangeValue(g=>{if(g=g.trim(),!g){d.validationMessage=ve("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(c.has(g)){d.validationMessage=ve("scm create branch prompt validation already exists","Branch '{0}' already exists",g);return}if(!ot(g)){d.validationMessage=ve("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",g);return}d.validationMessage=void 0}),d.onDidAccept(async()=>{const g=d.value;try{d.enabled=!1,d.busy=!0;const _=await t.createBranch(e,g,r,a);f(_)}catch(_){if(_ instanceof de){d.enabled=!0,d.busy=!1,d.validationMessage=_.duplicate?ve("scm create branch prompt validation already exists","Branch '{0}' already exists",g):ve("scm create branch prompt validation invalid","Invalid branch name '{0}'",g),c.add(g);return}p(_)}})),d.prompt=n,d.placeholder=i,d.title=o,s&&(d.value=s),d.show()})}finally{d.dispose(),u==null||u.dispose()}}l(Eu,"createBranchWithPrompt");class Ru{constructor(e,r){this.memento=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Be(`MementoStorage.get(${e}): scopedKey=${r}`,{logLevel:me.Debug});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(e){const r=this.getScoped(e),n=new Be(`MementoStorage.getKeys(${e}): scopedPrefix=${r}`,{logLevel:me.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(a=>a.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let r=this.memento.keys();return e&&(r=r.filter(n=>n.startsWith(e))),r}async store(e,r){const n=this.getScoped(e),i=new Be(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:me.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Be(`MementoStorage.delete(${e}): scopedKey=${r}`,{logLevel:me.Debug});try{return await this.storeCore(e,r,void 0)}finally{n.stop()}}async deleteKeys(e){const r=this.getScoped(e),n=new Be(`MementoStorage.deleteKeys(${e}): scopedPrefix=${r}`,{logLevel:me.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,a=this.getKeysCore(r);for(const s of a){const c=o!==0?s.substr(o):s;E.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${c}, scopedKey=${s}`);try{await this.storeCore(c,s,void 0)}catch(u){E.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${c}, scopedKey=${s}`),i.push(c)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new Ru(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}l(Ru,"MementoStorageService");class Au{constructor(e,r){this.storageUri=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Be(`ExtFileStorageService.get(${e}): scopedKey=${r}`,{logLevel:me.Debug});try{return await h.workspace.fs.readFile(h.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(e,r){const n=this.getScoped(e),i=new Be(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:me.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await h.workspace.fs.writeFile(h.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Be(`ExtFileStorageService.delete(${e}): scopedKey=${r}`,{logLevel:me.Debug});try{return await h.workspace.fs.delete(h.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(e){return new Au(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}l(Au,"ExtFileStorageService");const Jt=(0,O.loadMessageBundle)();class ai extends h.TimelineItem{static is(e){return e instanceof ai}constructor(e,r,n,i,{dateType:o,showAuthor:a,dateFormatter:s}){var c;const u=n.message.indexOf(`
`),d=u!==-1?`${n.message.substring(0,u)} \u2026`:n.message,f=o==="authored"?n.authorDate:n.commitDate;super(d,(c=f==null?void 0:f.getTime())!=null?c:0);this.id=n.hash,this.contextValue=`vscode-vfs:${r}:file:commit`,this.command=i,a&&(this.description=n.authorName),this.detail=Jt("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,wt(n.hash),s.format(f),n.message),this.iconPath=new h.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}l(ai,"CommitTimelineItem");class Ho extends h.TimelineItem{static is(e){return e instanceof Ho}constructor(e,r,n,i,o,{dateFormatter:a,staged:s}){const c=s?Jt("timeline staged changes","Staged Changes"):Jt("timeline uncommitted changes","Uncommitted Changes");super(c,n.timestamp);this.id=s?"index":"working",this.contextValue=`vscode-vfs:${r}:file:${this.id}`,this.command=o,this.iconPath=new h.ThemeIcon("git-commit"),s?this.detail=Jt("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,Jt("timeline you","You"),Jt("timeline index","Index"),a.format(new Date(n.timestamp)),Lp(n.type)):this.detail=Jt("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,Jt("timeline you","You"),Jt("timeline working","Working Tree"),a.format(new Date(n.timestamp)),Lp(n.type)),this.rootUri=e,this.providerId=r,this.hash=s?"~":"",this.parents=i,this.message=c}}l(Ho,"ChangeOperationTimelineItem");class $y{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChange=new h.EventEmitter,this.id="github-file-history",this.label=Jt("timeline.source","GitHub File History"),this.debouncer=new Ul(500),this.disposable=h.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this),j.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const r=W(this.rootUri);!e.some(n=>W(n)===r)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const r=W(this.rootUri);(e.added.some(n=>W(n.uri)===r)||e.removed.some(n=>W(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||W(this.rootUri)!==W(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const r=W(this.rootUri);e.some(n=>W(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(e,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const _ of this.providerService.repositories)if(_.uri.path===this.rootUri.path){this.rootUri=_.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||n.isCancellationRequested)return{items:[]};const s=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(s===void 0||s.commits.length===0||n.isCancellationRequested)return{items:[]};const c=((i=s.paging)==null?void 0:i.more)?{cursor:s.paging.cursor}:void 0,u=new Intl.DateTimeFormat(h.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),d=j.getAny("git.timeline.date",void 0,"committed"),f=j.getAny("git.timeline.showAuthor",void 0,!0),p=s.commits.map(_=>new ai(this.rootUri,a.provider.id,_,this.resolveDiffCommand(_,a,e,o),{dateType:d,showAuthor:f,dateFormatter:u})),g=r.cursor===void 0?await this.changeStore.getChange(e):void 0;if(g){const _=Boolean(g.staged&&j.get("staging.enabled")),v=new Ho(this.rootUri,a.provider.id,g,[s.commits[0].hash],await this.changeStore.resolveDiffCommand(g.uri,this.providerService.getProviderUri(g.uri),_?Jt("diff title index","{0} (Index)",ue(g.uri)):Jt("diff title working","{0} (Working Tree)",ue(g.uri))),{dateFormatter:u,staged:_});p.splice(0,0,v)}return{items:p,paging:c}}catch(o){return E.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=h.workspace.registerTimelineProvider([Pt.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[h.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!ai.is(r)||h.env.clipboard.writeText(r.hash)}),h.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!ai.is(r)||h.env.clipboard.writeText(r.message)}),h.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!ai.is(r)&&!Ho.is(r)||r.command!==void 0&&await h.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),h.commands.registerCommand("remoteHub.timeline.openOnGitHub",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!ai.is(r)&&!Ho.is(r)||(e={uri:n,left:r},await h.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),h.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!e||!ai.is(r)&&!Ho.is(r)||W(n)!==W(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(r.rootUri,n),s=await this.providerService.getMetadata(r.rootUri),c=ue(n),u=o.parents[0];let d;u===void 0?d=Jt("timeline diff title ref","{0} ({1})",c,wt(r.hash)):o.hash===""?d=Jt("timeline diff title working","{0} (Working Tree)",c):o.hash==="~"?d=Jt("timeline diff title index","{0} (Index)",c):d=Jt("timeline diff title ref","{0} ({1})",c,wt(o.hash));let f=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:Ue.Commit,id:u!=null?u:"0000000000000000000000000000000000000000"}},a);u===void 0&&(f=f.with({query:"~"}));const p=r.parents[0];let g;p===void 0?g=Jt("timeline diff title ref","{0} ({1})",c,wt(r.hash)):p==="~"&&r.hash===""?g=Jt("timeline diff title working","{0} (Working Tree)",c):r.hash==="~"?g=Jt("timeline diff title index","{0} (Index)",c):g=Jt("timeline diff title ref","{0} ({1})",c,wt(r.hash));const _=Jt("timeline diff title","{0} \u27F7 {1}",d,g),v=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:Ue.Commit,id:r.hash}},a);await h.commands.executeCommand("vscode.diff",f,v,_)})]}resolveDiffCommand(e,r,n,i,o){const a=ue(n),s=e.parents[0];let c;s===void 0?c=Jt("timeline diff title ref","{0} ({1})",a,wt(e.hash)):e.hash===""?c=Jt("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?c=Jt("timeline diff title index","{0} (Index)",a):c=Jt("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,wt(s),wt(e.hash));let u=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:Ue.Commit,id:s!=null?s:"0000000000000000000000000000000000000000"}},i);s===void 0&&(u=u.with({query:"~"}));const d=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:Ue.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[u,d,c,o]}}async openOnRemote(e){if(!ai.is(e))return;const r=await this.providerService.getMetadata(e.rootUri);await Yh("remoteHub.openOnRemote",{provider:r.provider,repo:r.repo,sha:e.hash})}}l($y,"VirtualTimelineProvider");class My{constructor(e,r){this.providerService=e,this.telemetryService=r,this.disposable=h.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var r;const n=new Be(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const s of e.query.split("&")){const[c,u]=s.split("=");switch(c){case"url":i=decodeURIComponent(u);break;case"location":o=u===Bt.CurrentWindow?Bt.CurrentWindow:Bt.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:Bt.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),dn(a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[s,c]=a.split("=");if(s==="url"){i=decodeURIComponent(c);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((r=Iu())==null?void 0:r.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}case"/login":{Fv.fire(e);break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}l(My,"RemoteUriHandler");const Jr=(0,O.loadMessageBundle)(),Sc=l(class{constructor(t,e,r,n){this.providerService=t,this.storageService=e,this.changeStore=r,this.workspaceId=n,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new ls("WorkspaceRepositories"),this.disposable=h.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await h.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void h.window.showTextDocument(t)}onChangeStoreChanged(t){const e=cp(t.map(r=>r.rootUri),r=>W(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(t){const r=W(t);e=e.filter(n=>W(n.canonicalUri)===r)}return e}async getCore(){return this.fromStorage(await this.storageService.get(Sc.storageKey))}async getByCanonicalUri(){let t=this.cache.get("groupedWorkspaceRepositories");return t===void 0&&(t=VE(await this.get(),e=>W(e.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",t)),t}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(){const t=await this.getRecents();if(t.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Jr("pick","Choose a recent repository"),provideSources:function(e,r,n,i){return t.map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:qs(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${Pt.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${mp(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${Uy(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${sR(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:Bt.CurrentWindow}}))}}}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),r=`${t.workspaceId}/${W(t.uri)}`,n=e.get(r);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const a={title:Jr("remove remote repo prompt confirm","Yes")},s={title:Jr("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await h.window.showWarningMessage(o.length===1?Jr("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):Jr("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},a,s)!==a)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(r);try{await this.storageService.store(Sc.storageKey,this.toStorage(e))}catch(a){throw E.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const r of t){const[{HEAD:n,pullRequest:i},o]=await Promise.all([r.getMetadata(),r.getIndexMetadata()]),a=await this.changeStore.getChanges(r.uri);e.set(`${this.workspaceId}/${W(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&Ye.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:hR(a),timestamp:Date.now()})}try{await this.storageService.store(Sc.storageKey,this.toStorage(e)),xi(Vn.HasRecentRepositories,e.size>0)}catch(r){throw E.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&ut(n)?h.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return E.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:Sc.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let yp=Sc;yp.storageKey="workspaceRepositories",yp.storageSchemaVersion=1;function By(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}l(By,"hasChanges");function dR(t){return By(t.changes)}l(dR,"hasUncommittedChanges");function hR(t){let e=0,r=0,n=0;for(const i of t)switch(i.type){case ht.Created:e++;break;case ht.Changed:r++;break;case ht.Deleted:n++;break}return e||r||n?{added:e,changed:r,deleted:n,timestamp:Date.now()}:void 0}l(hR,"toChangesSummary");function Uy(t,{compact:e=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(!By(t))return Jr("no changes","Everything up to date");const{added:a,changed:s,deleted:c}=t;if(o){const d=a+s+c;return d===1?Jr("summary change","{0} change",d):Jr("changes changes","{0} changes",d)}let u=`${r!=null?r:""}`;return(a||!e)&&(u+=i?`+${a}`:a===1?Jr("file added","{0} file added",a):Jr("files added","{0} files added",a),(s||c||!e)&&(u+=n)),(s||!e)&&(u+=i?`~${s}`:s===1?Jr("file changed","{0} file changed",s):Jr("files changed","{0} files changed",s),(c||!e)&&(u+=n)),(c||!e)&&(u+=i?`-${c}`:c===1?Jr("file deleted","{0} file deleted",c):Jr("files deleted","{0} files deleted",c)),u}l(Uy,"formatChangesSummary");var fR=Object.defineProperty,pR=Object.getOwnPropertyDescriptor,gR=l((t,e,r,n)=>{for(var i=n>1?void 0:n?pR(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&fR(e,r,i),i},"view_decorateClass"),qa;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(qa||(qa={}));const Ly=l(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof Ly}get id(){}toString(){return`${E.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let ja=Ly;gR([Er((t=!1,e=!1,r)=>JSON.stringify([t,e,r==null?void 0:r.toString()]))],ja.prototype,"triggerChange",1);class Oy{constructor(e,r,n,i){this.id=e,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new h.EventEmitter,this.disposables=[];const o=!1;if(E.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(s){var c;const u=await a.apply(this,[s]),d=s.getParent();return u.tooltip===void 0&&(u.tooltip=new h.MarkdownString(u.label!==void 0&&typeof u.label!="string"?u.label.label:(c=u.label)!=null?c:"")),typeof u.tooltip=="string"?u.tooltip=`${u.tooltip}

---
context: ${u.contextValue}
node: ${s.toString()}${d!==void 0?`
parent: ${d.toString()}`:""}`:u.tooltip.appendMarkdown(`

---

context: \`${u.contextValue}\`\\
node: \`${s.toString()}\`${d!==void 0?`\\
parent: \`${d.toString()}\``:""}`),u}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!j.changed(e,`views.${this.configKey}`)}dispose(){h.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=h.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(j.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,e)),this.triggerNodeChange()}async refreshNode(e,r=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,r));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,r){if(this.tree!==void 0)try{await this.tree.reveal(e,r)}catch(n){E.error(n)}}async show(){try{await h.commands.executeCommand(`${this.id}.focus`)}catch(e){E.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=j.get("views")[this.configKey]),this._config}}l(Oy,"View");class Hy extends ja{constructor(e,r,n,i,o,a,s){super(e,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=s}getChildren(){return[]}getTreeItem(){var e;const r=new h.TreeItem(this._message,h.TreeItemCollapsibleState.None);return r.contextValue=(e=this._contextValue)!=null?e:qa.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}l(Hy,"MessageNode");var mR=Object.defineProperty,vR=Object.getOwnPropertyDescriptor,bp=l((t,e,r,n)=>{for(var i=n>1?void 0:n?vR(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&mR(e,r,i),i},"workspaceRepositoriesView_decorateClass");const _r=(0,O.loadMessageBundle)(),Wy=l(class extends ja{constructor(t,e,r,n,i,o,a){super(t,e);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(t,e,r){return`${Cc.getId(t,e)}:${this.key}(${r.uri.toString()})`}get id(){return Wy.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new h.TreeItem(t,h.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${qa.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const r=Boolean(this.operation.staged&&j.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?_r("diff title index","{0} (Index)",ue(this.operation.uri),this.workspaceRepository.ref.name):_r("diff title working","{0} (Working Tree)",ue(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:Ue.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?_r("diff title changeset index","{0} (Index of {1})",ue(this.operation.uri),this.workspaceRepository.ref.name):_r("diff title changeset working","{0} (Working Tree of {1})",ue(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await h.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await h.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){h.window.showErrorMessage(String(e))}}},"_FileChangeNode");let zy=Wy;zy.key=":changes";const qy=l(class extends ja{constructor(t,e,r,n,i){super(t,e);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(t,e){return`${Tu.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return qy.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||h.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(r=>new zy(this.view,this,t,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=dR(this.workspaceRepository),r=Pt.isCanonicalUri(this.workspaceRepository.uri)?_r("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new h.TreeItem(this.root?this.canonical.name:r,e?h.TreeItemCollapsibleState.Collapsed:h.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${qa.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${qs(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=t?new h.ThemeIcon("check"):this.root?Gy(this.canonical.provider.id):cR(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new h.MarkdownString(void 0,!0).appendMarkdown(_r("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?_r("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",wR(this.workspaceRepository.ref.type),mp(this.workspaceRepository.ref.type),r,t?` \u2014 _${_r("repositories view repository tooltip active","Active")}_ `:"",qs(this.workspaceRepository.timestamp,{ago:!0}),Uy(this.workspaceRepository.changes,{preamble:`${_r("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=h.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository)}catch(e){h.window.showErrorMessage(String(e))}}remove(){return this.view.workspaceRepositories.remove(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let Cc=qy;Cc.key=":wsrepo",bp([Er()],Cc.prototype,"refresh",1);const jy=l(class extends ja{constructor(t,e,r,n){super(t,e);this.canonical=r,this.workspaceRepositories=n}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return jy.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new Hy(this.view,this,_r("repositories view message empty","No GitHub repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new Cc(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),e=new h.TreeItem(this.canonical.name,t?h.TreeItemCollapsibleState.Expanded:h.TreeItemCollapsibleState.Collapsed);return e.contextValue=qa.WorkspaceRepositories,e.iconPath=Gy(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let Tu=jy;Tu.key=":wsrepos",bp([Er()],Tu.prototype,"refresh",1);class _p extends ja{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.workspaceRepositories.getByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const r=[];for(const[n,i]of e){const o=h.Uri.parse(n);try{const{name:a,provider:s}=this.view.providerService.getVirtualUriMetadata(o),c={uri:o,name:a,provider:s,hasActive:i.some(u=>u.workspaceId===this.view.workspaceId)};i.length===1?r.push(new Cc(this.view,this,c,i[0],!0)):r.push(new Tu(this.view,this,c,i))}catch(a){if(a instanceof _t)continue;E.error(a)}}this.children=r}return this.children}getTreeItem(){return new h.TreeItem("Repositories",h.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}l(_p,"WorkspaceRepositoriesViewNode"),bp([Er()],_p.prototype,"refresh",1);class Vy extends Oy{constructor(e,r,n,i,o){super("remoteHub.views.workspaceRepositories",_r("remote view title","GitHub Repositories"),e,o);this.workspaceRepositories=r,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),h.window.registerFileDecorationProvider({provideFileDecoration:(a,s)=>{if(!(a.scheme!=="remotehub-view"||a.authority!=="wsrepo"||!a.path.includes("/changes")))return{badge:"\u25CF",color:new h.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:_r("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new _p(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[h.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),h.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),dn({name:e.name,uri:e.uri,location:Bt.CurrentWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),dn({name:e.name,uri:e.uri,location:Bt.NewWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),h.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),h.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const r=W(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>W(o.canonicalUri)===r);return await yR(n,_r("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}l(Vy,"WorkspaceRepositoriesView");function wR(t,e){switch(t){case _e.Branch:return e?_r("type pr branch","Pull Request #{0}",e.id):_r("type branch","Branch");case _e.RemoteBranch:return e?_r("type pr remote branch","Pull Request #{0}",e.id):_r("type remote branch","Remote Branch");case _e.Tag:return _r("type tag","Tag");case _e.Commit:return _r("type commit","Commit")}}l(wR,"headTypeToString");function Gy(t){switch(t){case"github":return new h.ThemeIcon("github");case"azurerepos":return new h.ThemeIcon("azure-devops");default:return new h.ThemeIcon("vm")}}l(Gy,"providerToIconPath");async function yR(t,e){if(t.length!==0){if(t.length>1){const r=await h.window.showQuickPick(t.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return r?r.repository:void 0}return t[0]}}l(yR,"getRepository");const Ec=(0,O.loadMessageBundle)();let ku;function Iu(){return ku}l(Iu,"getOpenActionsService");var Wo;(function(t){t.HasCommitted="has:committed",t.Version="version"})(Wo||(Wo={}));let xp;function Ky(t){return xp.globalState.get(t)}l(Ky,"getState");async function Sp(t,e){return xp.globalState.update(t,e)}l(Sp,"updateState");let Cp=!1;function Qy(){return Cp}l(Qy,"isInsiders");async function bR(t){xp=t,$.configure(t),E.configure(t,j.get("logLevel")),Be.start("Time to root directory",{log:!1});const e=t.extension.packageJSON.displayName,r="GitHub.remotehub",[,n]=t.extension.packageJSON.version.split(".");if(t.extension.id.toLowerCase()===r.toLowerCase()&&Number.parseInt(n)%2==1&&(Cp=!0),t.extension.id.toLowerCase()==="github.remotehub-insiders"){Cp=!0;const s=Ec("review uncommitted changes","Review Uncommitted Changes"),c=Ec("switch to pre-release","Switch to Pre-Releases");switch(await h.window.showWarningMessage(Ec("deprecated","GitHub Repositories (Insiders) has been deprecated and will no longer be updated. To continue using nightly builds, commit all uncommitted changes across your repositories and switch to pre-releases of Remote Repositories."),s,c)){case s:await h.commands.executeCommand("remoteHub.views.workspaceRepositories.focus");break;case c:await h.commands.executeCommand("workbench.extensions.installExtension",r,{installPreReleaseVersion:!0}),await h.commands.executeCommand("workbench.extensions.uninstallExtension",t.extension.id);return;default:break}const d=h.extensions.getExtension(r);if(d!==void 0){const f=d.packageJSON.displayName;E.warn(`${e} was NOT activated because ${f} is also enabled`),setTimeout(()=>void h.window.showErrorMessage(Ec("more than one version enabled warning","{0} cannot be used while {1} is also enabled. Please ensure that only one version is enabled.",e,f),Ec("ok","OK")),0);return}}const i=Gh.configure(t),o=new Us(t),a=t.extension.packageJSON.version;await Sp(Wo.Version,a),await t.workspaceState.update(Wo.Version,a);try{const s=new Ru(t.globalState),c=s.with(i),u=new Au(t.globalStorageUri,i),d=new $e(c),f=new Pt(d,o),p=new ds(f,c,u,o,i);p.getWorkspacesWithChanges(),ku=new Dy(f,s,p);const g=new Py(f,p,ku,o),_=new ly(t.globalStorageUri,f),v=new M0(f,_),y=new yp(f,s,p,i);return t.subscriptions.push(j.onDidChange(x=>{!j.changed(x,"logLevel")||(E.logLevel=j.get("logLevel"))}),f.onDidChangeRepositories(async x=>{for(const C of x.added)try{const k=await C.getMetadata(),{HEAD:I,defaultBranch:B,name:J,provider:re,pullRequest:K}=k,we=I.name.replace(/\//g,"\u2009\u2215\u2009");let ie=" ";if(K!==void 0)ie=` (PR ${K.id}) `;else if(I.type===_e.Tag)ie=` (${we}) `;else if(I.type===_e.Commit)ie=` (${we}) `;else if(I.type===_e.Branch||I.type===_e.RemoteBranch){const Se=I.branch.name.replace(/\//g,"\u2009\u2215\u2009");I.branch.name!==B.name&&(ie=` (${Se})`)}const pe={uri:C.uri,type:"folder",label:`${J}${ie}[${re.name}]`};h.commands.executeCommand("_workbench.addToRecentlyOpened",pe)}catch(k){E.error(k,"Failed to add repository to recently opened")}}),new Fy(f,p),new kv,new Ys(f,p),new My(f,o),...Tx(f,p,y,t.extension.id,o),...CR(f,p,o),..._R(f,p,g,_,t,o),new $y(f,p),new Vy(f,y,p,i,o),_,y,g,ku,p,f,o),o.sendEvent("activate"),Promise.resolve(v)}catch(s){throw E.error(s),s}}l(bR,"activate");function _R(t,e,r,n,i,o){const a=Zy()?new F0(t,o):void 0;return[xR(t,e,a,r,n),...j.get("azureRepos.enabled")?[new Ao(i),SR(t,e,a)]:[]]}l(_R,"registerProviders");function xR(t,e,r,n,i){const o=new Su(t,i),a=new vc(t,o,e,i);async function s(){var u;try{let d=(u=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?u:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");d||(E.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(y=>{const x=h.extensions.onDidChange(()=>{var C;d=(C=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?C:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),d&&(x.dispose(),y())})})),E.log("[ GHPR] Registering..."),xi(Vn.HasPullRequestExtension,!0);const f=await d.activate();if(!f)throw new Error("Unable to get registration api");const p=f.registerGitProvider(n),g=t.onDidChangeRepositories(y=>_(y));async function _(y){const x=y.added.filter(C=>C.provider.id==="github");if(x.length!==0){E.log("[ GHPR] Checking for opened PRs...");for(const C of x){const k=await t.getBestRemoteUri(C.uri,Ee.PullRequest);if(!!k){g.dispose(),E.log("[ GHPR] Opened PR found; preloading"),h.commands.executeCommand("github.api.preloadPullRequest",k.toString());return}}E.log("[ GHPR] No opened PRs found")}}l(_,"onRepositoriesChanged"),E.log("[ GHPR] Registration complete");const v=t.repositories;return v.length&&_({added:v,removed:[]}),h.Disposable.from(p,g)}catch(d){return E.error(d,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}l(s,"registerWithGHPR");const c=s();return h.Disposable.from(t.register("github","GitHub",o,a,r),o,a,{dispose:async()=>{var u;return void((u=await c)==null?void 0:u.dispose())}})}l(xR,"registerGitHub");function SR(t,e,r){const n=new sf(t),i=new Hs(t,n,e);return h.Disposable.from(t.register("azurerepos","Azure Repos",n,i,r),n,i)}l(SR,"registerAzDO");function CR(t,e,r){if(!Zy())return[];r.publicLog2("codex.enableRichNav",{});const n=new Wv(t,e);return[n,n.register(new xf(r)),...xf.createStatus()]}l(CR,"registerNavigationServiceProviders");function Zy(){return h.env.uiKind===h.UIKind.Desktop||j.get("richNavigation.enabled")===!0}l(Zy,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();
